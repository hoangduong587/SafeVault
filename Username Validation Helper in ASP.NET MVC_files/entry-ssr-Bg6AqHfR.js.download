const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/react-DnKNOS96.js","assets/vendor-Cd-bHg8d.js","assets/msal-BgQLBKjO.js","assets/index-CqM2fyUO.js","assets/index-CsddE2Rg.js","assets/tslib.es6-QbsNV-zR.js","assets/_commonjs-dynamic-modules-TDtrdbi3.js","assets/index-BSt8OmGF.js","assets/index-DejNz1LK.js","assets/index.es-_st7_bnK.js","assets/botd.esm-CqBqtDMb.js","assets/temporary-conversation-BKE1QPYP.js","assets/index-DqCLogWr.js","assets/deferred-ejL8Zvk-.js","assets/math.scalar.functions-B0475LkX.js","assets/animationGroup-DTsJU5nR.js","assets/skeleton-AT2eOQ8q.js","assets/rawTexture-lymo5SoX.js","assets/easing-QwYax6be.js","assets/weightedsound-D3hYyHHC.js","assets/audioEngine-1JK7e6Ao.js","assets/babylonFileParser.function-CWsVgwsY.js","assets/outlineRenderer-vYsCX_HG.js","assets/discBuilder-3LY1P313.js","assets/backgroundMaterial-CuasCg23.js","assets/standardMaterial-C7pnoNzw.js","assets/cubeTexture-pKEVH-If.js","assets/abstractEngine.cubeTexture-Dxge0idK.js","assets/lazy-QDW4TSbx.js","assets/ray-CCbrptt1.js","assets/dds-7LhIsIAg.js","assets/dumpTools-MOXNqcHf.js","assets/khronosTextureContainer2-VrwXeBL-.js","assets/workerPool-H9Ji3mCo.js","assets/assetContainer-DUwEM7Mq.js","assets/shaderMaterial-C4JHiK5j.js","assets/timer-Cm9St495.js","assets/math.scalar-Iv6t9gal.js","assets/logDepthDeclaration-CjaI91iE.js","assets/fogFragmentDeclaration-CQ6HCfaq.js","assets/sceneUboDeclaration-GnA5nXtM.js","assets/meshUboDeclaration-BcKKQtGO.js","assets/logDepthVertex-D8sg5qhY.js","assets/helperFunctions-DfAY4hGY.js","assets/clipPlaneFragment-Be_hCdkM.js","assets/logDepthDeclaration-BMGdQ5l6.js","assets/fogFragmentDeclaration-tZaDBbg5.js","assets/sceneUboDeclaration-BMVAxDYN.js","assets/meshUboDeclaration-CafNC6tf.js","assets/helperFunctions-CG55aWie.js","assets/clipPlaneVertex-DlrHcXZO.js","assets/logDepthVertex-DbRho2wK.js","assets/pointLight-DbH08WdT.js","assets/fresnelFunction-BMcZ_hLX.js","assets/proceduralTexture-CEknOdsa.js","assets/abstractAudioBus-CxYN56yI.js","assets/webAudioBus-BVObkxoI.js","assets/webAudioMainBus-CItXrk4Y.js","assets/webgpuEngine-DIRCtdXf.js","assets/bakedVertexAnimation-CLstY7ex.js","assets/instancesDeclaration-DWKXiZxE.js","assets/fresnelFunction-CixvqXMJ.js","assets/decalFragment-DJCg2r01.js","assets/flowGraphVectorMathBlocks-CNiiRd0M.js","assets/flowGraphParser-CNW9_YtA.js","assets/flowGraphRichTypes-qfwHwwi4.js","assets/flowGraphBinaryOperationBlock-BH4vAy7C.js","assets/flowGraphCachedOperationBlock-VCxEWoVD.js","assets/flowGraphUnaryOperationBlock-CtLdlTu_.js","assets/bonesVertex-BgBvODsd.js","assets/morphTargetsVertex-Bcy0dONl.js","assets/asyncLock-D73bTKcO.js","assets/engine.multiRender-CfOLGtum.js","assets/environmentTextureTools-CeS6F2cg.js","assets/engine.multiRender-DCEhBurM.js","assets/flowGraphJsonPointerParserBlock-DkqE4cUz.js","assets/flowGraphConsoleLogBlock-BeR03V_8.js","assets/flowGraphBranchBlock-DMTvoqcm.js","assets/flowGraphDoNBlock-CmyiJkK-.js","assets/flowGraphForLoopBlock-CJPoVeiu.js","assets/flowGraphThrottleBlock-27xHidBB.js","assets/flowGraphMultiGateBlock-0YggLZWJ.js","assets/flowGraphSwitchBlock-CMFEshdk.js","assets/flowGraphWaitAllBlock-DupRTuPk.js","assets/flowGraphCounterBlock-_q1FpXVL.js","assets/flowGraphWhileLoopBlock-Cg4jw9fr.js","assets/flowGraphDebounceBlock-Ds6L8vdk.js","assets/flowGraphFlipFlopBlock-DnU_kqe7.js","assets/flowGraphSequenceBlock-DLIiKc3Z.js","assets/flowGraphSetDelayBlock-DOS1Cw6D.js","assets/flowGraphCancelDelayBlock-Ct47KvX5.js","assets/flowGraphPlayAnimationBlock-B0yDOwTT.js","assets/flowGraphStopAnimationBlock-nhHe58Iw.js","assets/flowGraphPauseAnimationBlock-BsmeWB04.js","assets/flowGraphInterpolationBlock-95cBh4C8.js","assets/flowGraphEasingBlock-WVNn6nEp.js","assets/flowGraphBezierCurveEasingBlock-C0QXV7AS.js","assets/flowGraphConditionalDataBlock-B_gGHoJO.js","assets/flowGraphGetVariableBlock-B1v3SHfL.js","assets/flowGraphSetVariableBlock-eMYdfge5.js","assets/flowGraphTransformCoordinatesSystemBlock-BZdDe0Ck.js","assets/flowGraphGetPropertyBlock-2H5xbFoF.js","assets/flowGraphSetPropertyBlock-CumLPEJT.js","assets/flowGraphConstantBlock-BJByy_cs.js","assets/flowGraphGetAssetBlock-BQrkLkFb.js","assets/flowGraphDataSwitchBlock-Dks20QKR.js","assets/flowGraphMathBlocks-2GeEzlde.js","assets/flowGraphMathCombineExtractBlocks-Rxvx0SaX.js","assets/flowGraphMatrixMathBlocks-CMe-4paI.js","assets/flowGraphTypeToTypeBlocks-BEDgKf3g.js","assets/flowGraphContextBlock-DcdYghIN.js","assets/flowGraphArrayIndexBlock-R8eruYSt.js","assets/flowGraphCodeExecutionBlock-Bdj5vGRj.js","assets/flowGraphIndexOfBlock-f2vazGSn.js","assets/flowGraphFunctionReferenceBlock-v8xd4yeC.js","assets/flowGraphMeshPickEventBlock-oCdPEBBj.js","assets/flowGraphSceneReadyEventBlock-j5SKwO2G.js","assets/flowGraphReceiveCustomEventBlock-BkJNvryn.js","assets/flowGraphSendCustomEventBlock-BdPVCw3J.js","assets/flowGraphSceneTickEventBlock-BX2VocbR.js","assets/flowGraphPointerOutEventBlock-D8_1c7BW.js","assets/flowGraphPointerOverEventBlock-DPEoFoGg.js","assets/spotLight-CKshBat_.js","assets/glowMapGeneration.fragment-CO09N_A7.js","assets/glowMapGeneration.vertex-dF-Lcs8J.js","assets/glowMapGeneration.fragment-ClbFGbEO.js","assets/glowMapGeneration.vertex-BHnYDIik.js","assets/glowMapMerge.fragment-BWPRIdrf.js","assets/glowMapMerge.vertex-DpdLk3UD.js","assets/glowBlurPostProcess.fragment-5TaUe09b.js","assets/glowMapMerge.fragment-C1Zn4qfD.js","assets/glowMapMerge.vertex-BEV453d-.js","assets/glowBlurPostProcess.fragment-Cb4nZjmo.js","assets/shadowGeneratorSceneComponent-BbX4r6xG.js","assets/shadowMap.fragment-CVQo2Hze.js","assets/packingFunctions-LssY2FPl.js","assets/shadowMapFragment-C4qqcP3B.js","assets/shadowMap.vertex-Cx6S47PT.js","assets/shadowMapVertexMetric-XydkkiKU.js","assets/depthBoxBlur.fragment-B1YoW43D.js","assets/shadowMapFragmentSoftTransparentShadow-Cir4ibvc.js","assets/shadowMap.fragment-CgrUr-op.js","assets/shadowMapFragment-DkRk7reC.js","assets/shadowMap.vertex-CQ72E08o.js","assets/shadowMapVertexMetric-v0ItV8IF.js","assets/depthBoxBlur.fragment-Vs-FCw_o.js","assets/shadowMapFragmentSoftTransparentShadow-DlDyv9Ip.js","assets/rectAreaLight-C6QfO5bL.js","assets/thinInstanceMesh-DHXPpbZo.js","assets/lightFragment-B6kUN3jM.js","assets/imageProcessingFunctions-CFC4LmMA.js","assets/iesTextureLoader-CLk7ERSW.js","assets/hdrCubeTexture-DGrVqoB8.js","assets/iblCdfGenerator-BeTNAI1m.js","assets/hdr-BTnWHps1.js","assets/background.vertex-A79H__8H.js","assets/backgroundUboDeclaration-DsHnHz1s.js","assets/shadowsVertex-sv-MB2Bg.js","assets/background.fragment-ZCptBctV.js","assets/lightsFragmentFunctions-0cDE0_B_.js","assets/lightFragment-B20xJi68.js","assets/background.vertex-BB-ognfb.js","assets/backgroundUboDeclaration-C80Bxjvn.js","assets/shadowsVertex-BBygsIHS.js","assets/background.fragment-C_BOoW3Y.js","assets/imageProcessingFunctions-C7y3aoy6.js","assets/lightsFragmentFunctions-B3okT0op.js","assets/color.fragment-1iEd3rku.js","assets/color.vertex-D14eE1Dl.js","assets/vertexColorMixing-DcQsX3zK.js","assets/openpbrMaterial-CR0seNT0.js","assets/pbr.vertex-BL8khmkM.js","assets/pbrUboDeclaration-C6pk6dWG.js","assets/samplerVertexImplementation-BiEgyxHn.js","assets/mainUVVaryingDeclaration-DWSsGjGm.js","assets/harmonicsFunctions-BRBt508h.js","assets/bumpVertexDeclaration-bv1SlOY3.js","assets/bumpVertex-CgihaXmv.js","assets/vertexColorMixing-dKrHdiUD.js","assets/pbr.fragment-CxHhZTqI.js","assets/oitFragment-BGSD3Iv4.js","assets/pbrDebug-FzfGs5rL.js","assets/samplerFragmentDeclaration-B44t46lV.js","assets/bumpFragment-CH2SEX2z.js","assets/pbr.vertex-R1biEWfr.js","assets/samplerVertexImplementation-B87aHPEj.js","assets/pbrUboDeclaration-DxcJ8X4w.js","assets/mainUVVaryingDeclaration-CXUPIhaD.js","assets/harmonicsFunctions-DlUzkoat.js","assets/bumpVertexDeclaration-1Qfxciu4.js","assets/bumpVertex-BroBDUQB.js","assets/pbr.fragment-Bl-6YUDc.js","assets/oitFragment-D6t64WUw.js","assets/pbrDebug-CHt0-sC_.js","assets/samplerFragmentDeclaration-COQPO5ee.js","assets/bumpFragment-D3sFDzH4.js","assets/decalFragment-C5okuZQ3.js","assets/openpbr.vertex-CW79Dbh6.js","assets/openpbrUboDeclaration-9bpqRCFi.js","assets/openpbr.fragment-ZR8qKbnk.js","assets/openpbr.vertex-BL6WU_33.js","assets/openpbrUboDeclaration-DgDs0L3_.js","assets/openpbr.fragment-CCc5-YFT.js","assets/shaderLanguage-BjwqUAVi.js","assets/exrTextureLoader-WI7JbMdS.js","assets/ddsTextureLoader-N1KECWcx.js","assets/envTextureLoader-BYRFNvWH.js","assets/ktxTextureLoader-fWZmQIRh.js","assets/tgaTextureLoader-F9LJJrDi.js","assets/hdrTextureLoader-CQTannGW.js","assets/basisTextureLoader-Dt2kMu4U.js","assets/geometryBufferRenderer-DNSAmFs8.js","assets/rawCubeTexture-DwYaUxOI.js","assets/iblShadowsRenderPipeline-Bm-cNu6M.js","assets/iblCdfGeneratorSceneComponent-DdC_qutA.js","assets/procedural.vertex-DU1ZJcla.js","assets/procedural.vertex-CccBwKB_.js","assets/default.fragment-BReuceax.js","assets/defaultUboDeclaration-3wYnOSZF.js","assets/default.vertex-DEPjG0Pe.js","assets/default.fragment-CKsjw4Be.js","assets/defaultUboDeclaration-48rmA_M8.js","assets/default.vertex-BJNQv7cV.js","assets/dracoDecoder-C9Pwi2h1.js","assets/meshoptCompression-BVzOPuvp.js","assets/mesh.vertexData.functions-BXkNVxNr.js","assets/pointsCloudSystem-CKC9nH9O.js","assets/color.fragment-CV-9FZzW.js","assets/color.vertex-BN3VjRZj.js","assets/lodCube.fragment-CWRKt_oN.js","assets/lod.fragment-BTUqV3Fm.js","assets/lodCube.fragment-Donk_oUK.js","assets/lod.fragment-Dlgjrw2k.js","assets/rgbdDecode.fragment-DhWsvM-A.js","assets/rgbdEncode.fragment-Bmeodehg.js","assets/rgbdDecode.fragment-DjTkBxM0.js","assets/rgbdEncode.fragment-C9QvO2i5.js","assets/particles.fragment-CJhsYhN9.js","assets/particles.vertex-C8KKUZKX.js","assets/particles.fragment-Bxt33VVu.js","assets/particles.vertex-gOAMOdo5.js","assets/postProcessRenderPipelineManagerSceneComponent-Cw9jq6qD.js","assets/postprocess.vertex-kJ7Owq8H.js","assets/kernelBlur.fragment-Fx2bi3Bg.js","assets/kernelBlurVaryingDeclaration-DSxv7iLj.js","assets/kernelBlur.vertex-DSij-RrE.js","assets/kernelBlur.fragment-Df1JbNSw.js","assets/kernelBlurVaryingDeclaration-B0d0W18T.js","assets/kernelBlur.vertex-SvRXf-Bk.js","assets/pass.fragment-0hv5zeqI.js","assets/passCube.fragment-Be-iCbID.js","assets/pass.fragment-CTNupV0H.js","assets/passCube.fragment-DXgBEJFl.js","assets/vrDistortionCorrection.fragment-CCVoMeLI.js","assets/vrDistortionCorrection.fragment-CaHIXTbX.js","assets/depth.fragment-C5hZBhsI.js","assets/depth.vertex-xHZ1jn3k.js","assets/geometry.fragment-Df8kV5U1.js","assets/geometry.vertex-BpTZbfTb.js","assets/boundingBoxRenderer.fragment-C5Sq6rNF.js","assets/boundingBoxRendererUboDeclaration-t6o4NEFb.js","assets/boundingBoxRenderer.vertex-DmKm1w5D.js","assets/boundingBoxRenderer.fragment-yLV6B6IQ.js","assets/boundingBoxRenderer.vertex-U4BCFV6X.js","assets/outline.fragment-Clt3nOye.js","assets/outline.vertex-CWAINvXc.js","assets/outline.fragment-CNjeNZKk.js","assets/outline.vertex-uGL5EvCv.js","assets/index-BpzazC4O.js","assets/glTFLoader-CrAMzyd8.js","assets/glTFLoaderExtensionRegistry-uaqcviG9.js","assets/objectModelMapping-BjR_U080.js","assets/glTFLoaderAnimation-CiT3TwKW.js","assets/openpbrMaterialLoadingAdapter-DUmKUa7I.js","assets/pbrMaterialLoadingAdapter-CrwcfElW.js","assets/EXT_lights_image_based-C9ek8fo-.js","assets/EXT_mesh_gpu_instancing-DeQCDL0g.js","assets/EXT_meshopt_compression-Dv5ZCLfy.js","assets/EXT_texture_webp-Dh0VI7_l.js","assets/EXT_texture_avif-CUAeOT1R.js","assets/EXT_lights_ies-5kr-zhvC.js","assets/KHR_draco_mesh_compression-Bwkamxb1.js","assets/KHR_lights_punctual-RvrGmabn.js","assets/EXT_lights_area-DzoZmPfz.js","assets/KHR_materials_pbrSpecularGlossiness-CJq4XQg_.js","assets/KHR_materials_unlit-ldD0y75x.js","assets/KHR_materials_clearcoat-BYjUmHCJ.js","assets/KHR_materials_iridescence-IsYEZAIx.js","assets/KHR_materials_anisotropy-QjAsgPAv.js","assets/KHR_materials_emissive_strength-BSY-BF9U.js","assets/KHR_materials_sheen-CPTKgUKB.js","assets/KHR_materials_specular-BcQH5-sS.js","assets/KHR_materials_ior-DVZ3T8fB.js","assets/KHR_materials_variants-BxIAyHco.js","assets/KHR_materials_transmission-Jss7q3Uw.js","assets/KHR_materials_diffuse_transmission-E2SkzOk6.js","assets/KHR_materials_volume-DYqWF7lZ.js","assets/KHR_materials_dispersion-B4SVQbSm.js","assets/KHR_materials_diffuse_roughness-DjRk9wXw.js","assets/KHR_mesh_quantization-DVwdd82t.js","assets/KHR_texture_basisu-B0QZQhjX.js","assets/KHR_texture_transform-CFzMQEGT.js","assets/KHR_xmp_json_ld-BPcqcs3x.js","assets/KHR_animation_pointer-CAkEYerm.js","assets/MSFT_audio_emitter-DIdzavSH.js","assets/MSFT_lod-C7gAhatt.js","assets/MSFT_minecraftMesh-Cib_s_Qd.js","assets/MSFT_sRGBFactors-BxqGj_sO.js","assets/KHR_interactivity-BCBybW_c.js","assets/declarationMapper-BOXiCRr4.js","assets/KHR_node_visibility-Dz7b6s6-.js","assets/KHR_node_selectability-DMrGtNBM.js","assets/KHR_node_hoverability-DSPEEwaG.js","assets/ExtrasAsMetadata-C8Q1SFs_.js","assets/index-DoiVkAx0.js","assets/stlFileLoader.metadata-CdJMeZll.js","assets/babylon.inspector.bundle-RyN0am4a.js","assets/index-CreTxM14.js","assets/bvhFileLoader-CWgxna3V.js","assets/objFileLoader-wb2-bElg.js","assets/stlFileLoader-C3sucDSz.js","assets/splatFileLoader-Beo64IH8.js","assets/sidebar-settings-DjuMjw6x.js","assets/info-DOMYsUJ5.js","assets/settings-button-BWGgd5d-.js","assets/settings-C0vunB8-.js","assets/settings-yeq8-NFE.js","assets/use-is-memory-management-enabled-BEGaZzVU.js","assets/settings-state-CeLf-jVJ.js","assets/delete-Ch2aXfPb.js","assets/settings-personality-adjustment-menu-ChK-yvMI.js","assets/wallet-schemas-DOYTPirq.js","assets/utils-CCblikWn.js","assets/order-details-view-D3CqA8uj.js","assets/variants-selection-screen-Cnd4kvqL.js","assets/index-Chjiymov.js","assets/1ds-analytics-js-BQ_ODquZ.js","assets/card-info-BXAa2vFh.js","assets/visa-Bh8dqaXO.js","assets/fee-tooltip-BHKtGth4.js","assets/product-info-qTPlPebN.js","assets/pidl-pages-DZKjW9I_.js","assets/add-BQHRU7t3.js","assets/subtract-DPKGhGfd.js","assets/atoms-C4ICq62k.js","assets/shipping-address-CiQz1Z4R.js","assets/tracked-product-settings-CKbYUN-m.js","assets/use-price-tracking-Bh3ieMD_.js","assets/buy-button-BQYUJNMX.js","assets/use-checkout-modal-2ZKNnMjA.js","assets/shopping-telemetry-CMO_x4s2.js","assets/shopping-utils-DR3XUMDD.js","assets/format-money-DXk9Rllb.js","assets/shopping-api-Cfgth9Pm.js","assets/conversion-tracking-disclaimer-DN1v__Wp.js","assets/use-ocv-feedback-Bq85KB64.js","assets/use-set-first-name-Sc0UTyTV.js","assets/moon-Du2eJDTb.js","assets/sun-DQT31t-w.js","assets/task-manager-BnhmHXUD.js","assets/wallet-element-factory-BefqEfd8.js","assets/disconnect-BWdhVYiZ.js","assets/use-dismiss-event-CLlobAPq.js","assets/sidebar-pages-CS6fCQt4.js","assets/sidebar-projects-DJq03mEj.js","assets/folder-add-Czv_NjYK.js","assets/project-more-menu-BhmshZDG.js","assets/project-item-delete-modal-KVLdg8J6.js","assets/rename-BBQ9k8V0.js","assets/sidebar-tasks-tvpHi1Gm.js","assets/scheduled-tasks-api-CI4WnhJT.js","assets/tasks_._conversationId.lazy--76oaE_-.js","assets/telemetry-BXgrFrC2.js","assets/task-pages-state-CisEE6MV.js","assets/task-chat-D-0R3zn7.js","assets/vnc-view-BDdu-yD2.js","assets/task-composer-Cv3XPlnr.js","assets/consent-utils-oTzX5EC8.js","assets/globe-j8vqKU3i.js","assets/use-composer-file-upload-D_rtZyy6.js","assets/message-reactions-DW1Sd6ID.js","assets/content-blocks-B9sAWqRa.js","assets/reaction-utils-dYQBA6ax.js","assets/activity-artifacts-drawer-DpiT_tVY.js","assets/research-progress-step-content-tEsNPUIe.js","assets/copy-D4ZMsp7d.js","assets/power-point-DDMMotGA.js","assets/markdown-462kcqTC.js","assets/use-text-to-content-blocks-B8Znwnbg.js","assets/citation-chip-CEikcKoH.js","assets/sum-TKy2wozW.js","assets/chain-of-thought-steps-jMbz0MLj.js","assets/markdown-0-Dwg19Q.js","assets/progress-bar-optimistic-DPfhhciG.js","assets/research-final-response-33UyU2N7.js","assets/citations-CqinW01P.js","assets/citation-chips-row-D4bTSjLC.js","assets/citation-Dutpoett.js","assets/citation-card-ZpG_uWdC.js","assets/podcast-CjlJXJCu.js","assets/use-podcast-share-GI8nP1g1.js","assets/use-podcasts-navigation-enhxztXh.js","assets/progress-bar-BOQSuAjl.js","assets/use-research-navigation-BT2t4Bh8.js","assets/arrow-counter-clockwise-B6FgnEi2.js","assets/play-VAUWVQuq.js","assets/types-S47nI6MK.js","assets/regenerate-button-CkkeukAW.js","assets/arrow-refresh-XX0dYJIq.js","assets/edit-line-horizontal-MC7zeQbW.js","assets/thumbs-up-YLHcMM7-.js","assets/use-ads-card-operations-CCuGoITQ.js","assets/calendar-BT0pDl2K.js","assets/task-state-reset-ByuEX6FO.js","assets/clock-CdWqNxRq.js","assets/panel-right-contract-DKTMh9VL.js","assets/panel-right-expand-T1ObSvZJ.js","assets/consent-connector-mapping-Dah1VIV6.js","assets/tasks.lazy-Ba7PLAw8.js","assets/conversations-DaYzRBJ1.js","assets/arrow-forward-Bz64SD52.js","assets/door-arrow-left-BMKuDcZT.js","assets/edit-line-horizontal-qeYEFWL0.js","assets/people-add-BKegB5mx.js","assets/shield-error-CIQjaw86.js","assets/use-group-chat-D3nGcbrU.js","assets/use-leave-group-CzCIV4a7.js","assets/open-CDvmcIZm.js","assets/people-DSXRLXIq.js","assets/use-tasks-WSKg8T07.js","assets/use-list-key-down-BoXJFMom.js","assets/sidebar-search-content-DITO8o6N.js","assets/index-B7ft8GyI.js","assets/appearance-component-interface-DjEXOxQ1.js","assets/starter-prompt-category-CNSy16of.js","assets/mode-specific-card-widget-section-rvKcTJJ2.js","assets/composer-auto-complete-BMuTwVoK.js","assets/composer-actions-prompt-suggestions-BhuSXzVf.js","assets/composer-prompt-suggestions-BGbbC8E0.js","assets/composer-file-upload-prompt-suggestions-DJMgNNZ4.js","assets/character-D7G0e5MN.js","assets/use-set-up-babylon-CWMFMX5d.js","assets/upsell-block-F8ou4XAG.js","assets/price-tracking-block-CmIGwOIf.js","assets/use-shopping-telemetry-DpC69cBT.js","assets/chevron-bolded-CHjaGrXE.js","assets/over-task-quota-DxdK4Ng-.js","assets/composer-action-CNvPGiiK.js","assets/turn-limit-light-BSAxF8jC.js","assets/computer-use-task-closed-BbosIeBB.js","assets/arrow-export-BMeJZAns.js","assets/arrow-import-DH3pWTwU.js","assets/settings-CYGI8fmf.js","assets/speed-BSvKWDav.js","assets/audio-controls-BDFLt0DD.js","assets/pause-Dn_e0W9l.js","assets/close-button-BMjW714e.js","assets/replay-BW_zNsyx.js","assets/safety-risk-card-DD3r4TT1.js","assets/add-to-page-BYi-w3eM.js","assets/composer-prompt-review-CjokCwdy.js","assets/biometric-consent-BrZNj-4u.js","assets/composer-sign-in-C-BNjax6.js","assets/merge-conversation-checkbox-PJw_skr7.js","assets/character-talk-CAJD506h.js","assets/use-appearance-first-run-experience-animation-BfwJMw2Q.js","assets/appearance-analytics-adapter-CpWd99uS.js","assets/appearance-component-wrapper-Bo7fv97Z.js","assets/use-appearance-preload-behind-modal-Bm8RrtId.js","assets/document-code-32-DP9DM_oy.js","assets/document-csv-32-DxXguZ3z.js","assets/document-dotx-32-DFAEJ-W6.js","assets/document-excel-32-DkDhauqH.js","assets/document-generic-32-yyut672N.js","assets/document-html-32-gu-6QF85.js","assets/document-onenote-32-Cq_ga7y1.js","assets/document-pdf-32-B1cYARBr.js","assets/document-photo-32-BJAw2m8C.js","assets/document-potx-32-Cl3X85Gf.js","assets/document-ppsx-32-8jZ9oal9.js","assets/document-ppt-32-CMiLCw8X.js","assets/document-project-32-Dz7c3bjL.js","assets/document-rtf-32-Cl0Bfldz.js","assets/document-toc-32-DdoxrI8u.js","assets/document-txt-32-B6fpeHEp.js","assets/document-word-32-BADTqaKC.js","assets/document-xltx-32-smtzvNFL.js","assets/document-xml-32-CevQm9oF.js","assets/daily-briefing-composer-player-DA2guUmg.js","assets/composer-voice-ui-B1XwRhmr.js","assets/microphone-mute-DOzblYpQ.js","assets/arrow-highlighter-BnKFkuB7.js","assets/settings-wrapper-C9cB8uv8.js","assets/media-viewer-C1gXUrSm.js","assets/media-carousel-D5ygxfuI.js","assets/async-image-wrapper-vYTmXBlY.js","assets/utils-Brfo0tdT.js","assets/picture-in-picture-DQ-K9Vwc.js","assets/video-player-41XicZJt.js","assets/native-player-CA_c46JD.js","assets/app-modals-2Er66Kf3.js","assets/utils-J9IU3j4b.js","assets/link-filled-BsZ3YHRL.js","assets/lock-XPy9dKvl.js","assets/shield-checkmark-C5l2tB0A.js","assets/research-progress-steps-BX_Ed5us.js","assets/use-start-new-chat-with-prompt-69JO0U9M.js","assets/copy-filled-BPsD7Wn6.js","assets/sharing-schemas-CLE0KGpj.js","assets/invite-action-Bk-e83u3.js","assets/use-get-link-CNua0ou0.js","assets/sender-share-modal-copy-button-DWk49Ut7.js","assets/link-DW2L_TOf.js","assets/check-circle-CqkB837U.js","assets/key-DxqoViko.js","assets/consents-CY_nvX44.js","assets/source-item-BlnStm1Q.js","assets/location-filled-D6YNLwoI.js","assets/attachment-Ce_WK2zF.js","assets/calendar-date-pad-DmMZQESe.js","assets/labs_-SjphyWD9.js","assets/index-BXCaAV_v.js","assets/shopping-starter-card-Cxvhy6qo.js","assets/sse-stream-reader-BESKfxQr.js","assets/use-shopping-duration-telemetry-Cj4d_qO_.js","assets/product-rating-B22SXGZq.js","assets/bell-filled-DZvEUUDi.js","assets/bell-CFdnovib.js","assets/star-filled-DUaLtMSY.js","assets/use-shopping-visibility-telemetry-CInCppvc.js","assets/arrow-up-right-CgPikRI7.js","assets/arrow-trending-down-Scnc3jk0.js","assets/price-history-chart-BxOwTO_2.js","assets/CategoricalChart-Dy0rbJD3.js","assets/decimal-ZKFLnszB.js","assets/CartesianChart-Dgf3O8Fo.js","assets/ReferenceDot-LPyCqwWX.js","assets/rich-card-actions-CAXciO9Q.js","assets/appearance-chat-beopTOCJ.js","assets/entry-button-D49OGEMR.js","assets/chat-empty-Cxpj_uuH.js","assets/shares._conversationId-BenWw7n8.js","assets/_galleryItemId-BIYcaNzN.js","assets/gallery-schemas-tnkP0xhH.js","assets/character-deprecation-modal-CeRhy27z.js","assets/ai-message-BQLOW48u.js","assets/topic-selection.lazy-C8gRKz2S.js","assets/login.lazy-BtqCTRJf.js","assets/imagine._galleryItemId.lazy-COTafpTs.js","assets/bing-images-D-wXHlKc.js","assets/heart-filled-BtWq6Ia2.js","assets/heart-BeUKVFP-.js","assets/separator-CzZiRO51.js","assets/model-viewer-3d-CL6K6kIj.js","assets/cube-filled-Cg5tnzzI.js","assets/cube-VZlSGG6q.js","assets/share-url-modal-Cb-FLFDj.js","assets/sender-share-modal-cta-with-social-media-Cp0ya0GD.js","assets/paperclip-CUD4Yo9s.js","assets/agents.lazy-khLedAwL.js","assets/shopping.lazy-TrDq79-Q.js","assets/use-conversation-panel-MZFBmM_7.js","assets/use-should-show-conversation-panel-as-modal-DyQQinOY.js","assets/conversation-panel-DPtAKc6M.js","assets/healthcare-entity-panel-8rCBPTyu.js","assets/healthcare-telemetry-CK13a2Ow.js","assets/animated-panel-container-CMJHNFRU.js","assets/price-tracking-modal-C6-3Y17e.js","assets/bell-alert-Ccr0uf0X.js","assets/card-carousel-DroOSTUX.js","assets/use-carousel-IFwBJtM_.js","assets/use-product-details-entrypoint-BtPs7ySJ.js","assets/library.lazy-Di5mVHqk.js","assets/use-delete-library-item-Df9FctXR.js","assets/page-share-modal-DLKCIUT7.js","assets/word-DGTOrbe8.js","assets/page-delete-modal-8yCvp7gV.js","assets/shared-page-delete-modal-CXEfV2eI.js","assets/secondsToMinutes-BXW8IOcB.js","assets/research-BtRdjMnV.js","assets/task-share-modal-DJP2mg-B.js","assets/tasks-schemas-Clcwz4su.js","assets/health.lazy-CogV11nL.js","assets/chat-multiple-ColXOgTJ.js","assets/heart-pulse-gradient-IMSxcrHQ.js","assets/library-BX4lYeyO.js","assets/gaming.lazy-Cdx-ct5T.js","assets/use-labs-telemetry-kJoyrS9u.js","assets/daily.lazy-DRWCqtVj.js","assets/daily-briefing-Blf-RdIG.js","assets/formatDistanceToNow-CPLEhdDM.js","assets/en-US-CX2OYmwH.js","assets/parseISO-CSmAqnyL.js","assets/use-scroll-element-into-view-B5c1qpf-.js","assets/arrow-maximize-DQ1Y9ysI.js","assets/arrow-minimize-DE9k5wnU.js","assets/use-is-portrait-CJjzQPp4.js","assets/wand-CQKwHWJO.js","assets/use-discover-feed-BpZXwxbU.js","assets/index.lazy-74fkva2i.js","assets/index-BIucVSWi.js","assets/subscription.start.lazy-Bs0DT3zL.js","assets/subscription.pricing.lazy-D8Ny2UkM.js","assets/checkout-wrapper-Cgj9fYj8.js","assets/constants-CcWGPmh3.js","assets/add-address-DrB4Yg6Y.js","assets/address-DGfM9x9P.js","assets/pidl-element-factory-CeV22Io2.js","assets/workflow-pi-dropdown-disabler-Dwir04a1.js","assets/react-number-format.es-TN7udAYH.js","assets/dropdown-radio-CsK7-HEB.js","assets/credit-card-4pemzmnr.js","assets/wallet-dropdown-qif0wKiW.js","assets/wallet-list-bPHgzhFu.js","assets/wallet-dropdown-expanded-title-CY9vJJkY.js","assets/paypal-CEtuBvxo.js","assets/pidl-element-factory-SYC29XA1.css","assets/add-address-view-BfvggNDp.js","assets/form-field-skeleton-DId-JbST.js","assets/add-payment-instrument-Cp-Z6IJS.js","assets/add-payment-instrument-view-CcbnoTRD.js","assets/add-ewallet-skeleton-D8JYmcx5.js","assets/select-payment-instrument-IJv7w27r.js","assets/start-line-DXR77bmU.js","assets/paywall-container-Bt2peUf2.js","assets/links-C8LfUvbx.js","assets/subscription-benefit-list-aACoUm29.js","assets/apps-TnVx_wje.js","assets/checklist-DFVkJc4U.js","assets/cloud-BySu0v6s.js","assets/shield-BAbmrGRI.js","assets/subscription.pricing-jQX9gqYg.css","assets/subscription.manage.lazy-W9C6Vly3.js","assets/research._researchId.lazy-D4-XOxuk.js","assets/task-error-JDFnS5fP.js","assets/e.sol.lazy-PXtOSJJJ.js","assets/e.so.lazy-_rucXbLr.js","assets/connector.callback.lazy-8tw92Q2p.js","assets/campaigns._campaignId.lazy-BtzJdI9J.js","assets/shares._conversationId.lazy-DReKbB2S.js","assets/projects._projectId.lazy-nSk9fPnZ.js","assets/use-project-DkMzCE6O.js","assets/flash-card-D5yotQUF.js","assets/quiz-C1mhCzyQ.js","assets/text-bullet-list-square-sparkle-Bi1gWIh5.js","assets/text-list-abc-e6QDeasx.js","assets/format-date-CVr-vFBA.js","assets/use-clean-history-state-B-_4BiQp.js","assets/editable-title-DHa63QgS.js","assets/edit-Na8FFGaa.js","assets/page-error-BSWuPvMx.js","assets/partners.feedback.lazy-BdBkb3DO.js","assets/index-hZPYaZ3-.js","assets/pages._pageId.lazy-Bc1wRaYA.js","assets/use-copy-page-CAK77mBK.js","assets/text-bold-CXEIH21J.js","assets/text-bullet-list-DgT13n35.js","assets/text-italic-DA3xM_4g.js","assets/text-numbered-list-CeX-x5Cw.js","assets/text-paragraph-CaGX0eyk.js","assets/chat-CMWll7IE.js","assets/use-ensure-authenticated-MJ2TFyFO.js","assets/arrow-enter-up-DE5ZLQxy.js","assets/thumbs-down-filled-BGUkmSke.js","assets/thumbs-up-filled-BicpP9qc.js","assets/use-emit-page-loaded-DmtsSx3W.js","assets/use-copy-page-BAjD-LHh.css","assets/copy-add-vMV48DHy.js","assets/chats._conversationId.lazy-BiNFmIxK.js","assets/use-chat-details-enabled-B2voMxg-.js","assets/index.lazy-DMSiybUK.js","assets/portrait-gallery-CSKlTks3.js","assets/consent-modal-BzsLo6qV.js","assets/portrait-cache-8ahWmtnv.js","assets/portrait-header-DW18QA34.js","assets/use-start-portrait-chat-DLxcYlqZ.js","assets/mock-interview.lazy-Ct4Qqhiu.js","assets/index.lazy-CP9oPFyl.js","assets/labs-badge-DOg2xZKA.js","assets/subscription.redeem.enel.lazy-BpD05zbk.js","assets/subscription.ewallet.return.lazy-XtrHx5SP.js","assets/shares.tasks._shareId.lazy-BdzlXwhr.js","assets/shares.podcasts._shareId.lazy-B87Fbe9D.js","assets/podcasts._podcastType._podcastId.lazy-DimKEsuy.js","assets/gallery.lazy-BMLHZaBh.js","assets/discover._-_modalType_._-_modalId_.lazy-BGQHie2b.js","assets/fetch-entire-history-for-conversation-CEz20DjO.js","assets/shares.pages._shareId.lazy-DWch-mmI.js","assets/eye-1AnP8HBI.js","assets/shares.3d-generations._shareId.lazy-CwDujRQV.js","assets/use-sidebar-position-cklw97t3.js","assets/printer-3d-CMGV3zeq.js","assets/talk.lazy-Cu0UlK4f.js","assets/audio-call-BGsc7jLP.js","assets/timer-7LFkuMiz.js","assets/experiments._experimentAlias.lazy-D0_QuSnr.js","assets/health_.chats._conversationId.lazy-Dz0WD2eE.js","assets/conversations.join._token.lazy-DY30lyyz.js","assets/chats_._conversationId.talk.lazy-KWFT6eWU.js","assets/index.lazy-D_SXaXQF.js","assets/self-portrait-api-B6UVfjUQ.js","assets/my-creations.lazy-BLgl71t3.js","assets/magnifier-DeFsQEJ6.js","assets/use-responsive-masonry-Vv00c4mR.js","assets/use-window-size-kimoDiMX.js","assets/cube-add-TUF1ace1.js","assets/my-creations-BiEk7v8n.css","assets/create.lazy-BmvpvSey.js","assets/projects_._projectId.chats._conversationId.lazy-BWi_dLaE.js"])))=>i.map(i=>d[i]);
import{aA as f9,r as l,j as c,_ as N,aB as h9,aC as g9,o as f,t as Rn,s as u,aD as v9,y as Q,l as v,m as _,aE as y9,aF as C9,a6 as Xt,c as G,a8 as Pu,w as z,x as Mt,n as k,d as fe,a as A,b as V,aG as Ho,aH as hr,aI as S9,aJ as Tv,a4 as _r,aK as rb,aL as va,aM as dl,v as Mu,ad as b9,S as ke,ai as Fi,aN as I9,f as M,aO as E9,W as Ru,aP as jo,aQ as T9,aR as wv,k as st,aS as w9,z as F,aT as A9,aU as Ap,K as Nu,E as nc,F as oc,M as sc,C as ac,aV as x9,aW as _9,H as rc,I as Lu,J as Du,D as kr,u as Z,Y as ts,P as Ou,aX as k9,aY as P9,aa as M9,aZ as R9,a_ as Av,a$ as N9,b0 as L9,a7 as ch,ac as D9,a9 as ib,b1 as O9,Z as cb,e as Le,g as Uu,U as lb,T as mn,A as Fu,G as lh,N as uh,b2 as U9,b3 as F9,L as dh,af as j9,b4 as B9,b5 as V9,b6 as ri,ae as H9,b7 as z9,ab as G9,b8 as W9,i as $9,R as xp,b9 as q9,ba as K9,bb as Y9,bc as Z9,bd as J9,O as ub,be as Q9,Q as Re,bf as X9,bg as db,bh as e7,bi as wm,bj as t7,bk as n7,ar as xv,aj as o7,bl as s7}from"./vendor-Cd-bHg8d.js";import{r as ya,e as mb,g as ua,I as Am,a as a7,s as ju}from"./msal-BgQLBKjO.js";f9({jitless:!0});const pb=l.createContext({});function qo(e){const t=l.useRef(null);return t.current===null&&(t.current=e()),t.current}const ic=l.createContext(null),da=l.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});class r7 extends l.Component{getSnapshotBeforeUpdate(t){const n=this.props.childRef.current;if(n&&t.isPresent&&!this.props.isPresent){const o=n.offsetParent,s=o instanceof HTMLElement&&o.offsetWidth||0,a=this.props.sizeRef.current;a.height=n.offsetHeight||0,a.width=n.offsetWidth||0,a.top=n.offsetTop,a.left=n.offsetLeft,a.right=s-a.width-a.left}return null}componentDidUpdate(){}render(){return this.props.children}}function i7({children:e,isPresent:t,anchorX:n}){const o=l.useId(),s=l.useRef(null),a=l.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:r}=l.useContext(da);return l.useInsertionEffect(()=>{const{width:i,height:d,top:m,left:p,right:h}=a.current;if(t||!s.current||!i||!d)return;const g=n==="left"?`left: ${p}`:`right: ${h}`;s.current.dataset.motionPopId=o;const y=document.createElement("style");return r&&(y.nonce=r),document.head.appendChild(y),y.sheet&&y.sheet.insertRule(`
          [data-motion-pop-id="${o}"] {
            position: absolute !important;
            width: ${i}px !important;
            height: ${d}px !important;
            ${g}px !important;
            top: ${m}px !important;
          }
        `),()=>{document.head.removeChild(y)}},[t]),c.jsx(r7,{isPresent:t,childRef:s,sizeRef:a,children:l.cloneElement(e,{ref:s})})}const c7=({children:e,initial:t,isPresent:n,onExitComplete:o,custom:s,presenceAffectsLayout:a,mode:r,anchorX:i})=>{const d=qo(l7),m=l.useId(),p=l.useCallback(g=>{d.set(g,!0);for(const y of d.values())if(!y)return;o&&o()},[d,o]),h=l.useMemo(()=>({id:m,initial:t,isPresent:n,custom:s,onExitComplete:p,register:g=>(d.set(g,!1),()=>d.delete(g))}),a?[Math.random(),p]:[n,p]);return l.useMemo(()=>{d.forEach((g,y)=>d.set(y,!1))},[n]),l.useEffect(()=>{!n&&!d.size&&o&&o()},[n]),r==="popLayout"&&(e=c.jsx(i7,{isPresent:n,anchorX:i,children:e})),c.jsx(ic.Provider,{value:h,children:e})};function l7(){return new Map}function u7(e=!0){const t=l.useContext(ic);if(t===null)return[!0,null];const{isPresent:n,onExitComplete:o,register:s}=t,a=l.useId();l.useEffect(()=>{if(e)return s(a)},[e]);const r=l.useCallback(()=>e&&o&&o(a),[a,o,e]);return!n&&o?[!1,r]:[!0]}function dIe(){return d7(l.useContext(ic))}function d7(e){return e===null?!0:e.isPresent}const ml=e=>e.key||"";function _v(e){const t=[];return l.Children.forEach(e,n=>{l.isValidElement(n)&&t.push(n)}),t}const fb=typeof window<"u",cc=fb?l.useLayoutEffect:l.useEffect,It=({children:e,custom:t,initial:n=!0,onExitComplete:o,presenceAffectsLayout:s=!0,mode:a="sync",propagate:r=!1,anchorX:i="left"})=>{const[d,m]=u7(r),p=l.useMemo(()=>_v(e),[e]),h=r&&!d?[]:p.map(ml),g=l.useRef(!0),y=l.useRef(p),b=qo(()=>new Map),[C,T]=l.useState(p),[S,E]=l.useState(p);cc(()=>{g.current=!1,y.current=p;for(let w=0;w<S.length;w++){const P=ml(S[w]);h.includes(P)?b.delete(P):b.get(P)!==!0&&b.set(P,!1)}},[S,h.length,h.join("-")]);const I=[];if(p!==C){let w=[...p];for(let P=0;P<S.length;P++){const D=S[P],L=ml(D);h.includes(L)||(w.splice(P,0,D),I.push(D))}return a==="wait"&&I.length&&(w=I),E(_v(w)),T(p),null}const{forceRender:x}=l.useContext(pb);return c.jsx(c.Fragment,{children:S.map(w=>{const P=ml(w),D=r&&!d?!1:p===S||h.includes(P),L=()=>{if(b.has(P))b.set(P,!0);else return;let j=!0;b.forEach(U=>{U||(j=!1)}),j&&(x?.(),E(y.current),r&&m?.(),o&&o())};return c.jsx(c7,{isPresent:D,initial:!g.current||n?void 0:!1,custom:t,presenceAffectsLayout:s,mode:a,onExitComplete:D?void 0:L,anchorX:i,children:w},P)})})},Ms=e=>e;let m7=Ms,hb=Ms;const _p={skipAnimations:!1,useManualTiming:!1},pl=["read","resolveKeyframes","update","preRender","render","postRender"];function p7(e,t){let n=new Set,o=new Set,s=!1,a=!1;const r=new WeakSet;let i={delta:0,timestamp:0,isProcessing:!1};function d(p){r.has(p)&&(m.schedule(p),e()),p(i)}const m={schedule:(p,h=!1,g=!1)=>{const b=g&&s?n:o;return h&&r.add(p),b.has(p)||b.add(p),p},cancel:p=>{o.delete(p),r.delete(p)},process:p=>{if(i=p,s){a=!0;return}s=!0,[n,o]=[o,n],n.forEach(d),n.clear(),s=!1,a&&(a=!1,m.process(p))}};return m}const f7=40;function gb(e,t){let n=!1,o=!0;const s={delta:0,timestamp:0,isProcessing:!1},a=()=>n=!0,r=pl.reduce((S,E)=>(S[E]=p7(a),S),{}),{read:i,resolveKeyframes:d,update:m,preRender:p,render:h,postRender:g}=r,y=()=>{const S=_p.useManualTiming?s.timestamp:performance.now();n=!1,_p.useManualTiming||(s.delta=o?1e3/60:Math.max(Math.min(S-s.timestamp,f7),1)),s.timestamp=S,s.isProcessing=!0,i.process(s),d.process(s),m.process(s),p.process(s),h.process(s),g.process(s),s.isProcessing=!1,n&&t&&(o=!1,e(y))},b=()=>{n=!0,o=!0,s.isProcessing||e(y)};return{schedule:pl.reduce((S,E)=>{const I=r[E];return S[E]=(x,w=!1,P=!1)=>(n||b(),I.schedule(x,w,P)),S},{}),cancel:S=>{for(let E=0;E<pl.length;E++)r[pl[E]].cancel(S)},state:s,steps:r}}const{schedule:kn,cancel:Bu,state:ji,steps:mIe}=gb(typeof requestAnimationFrame<"u"?requestAnimationFrame:Ms,!0),mh=l.createContext({strict:!1}),kv={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Kl={};for(const e in kv)Kl[e]={isEnabled:t=>kv[e].some(n=>!!t[n])};function kp(e){for(const t in e)Kl[t]={...Kl[t],...e[t]}}function h7({children:e,features:t,strict:n=!1}){const[,o]=l.useState(!xm(t)),s=l.useRef(void 0);if(!xm(t)){const{renderer:a,...r}=t;s.current=a,kp(r)}return l.useEffect(()=>{xm(t)&&t().then(({renderer:a,...r})=>{kp(r),s.current=a,o(!0)})},[]),c.jsx(mh.Provider,{value:{renderer:s.current,strict:n},children:e})}function xm(e){return typeof e=="function"}const g7=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Yl(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||g7.has(e)}let vb=e=>!Yl(e);function yb(e){e&&(vb=t=>t.startsWith("on")?!Yl(t):e(t))}try{yb(require("@emotion/is-prop-valid").default)}catch{}function v7(e,t,n){const o={};for(const s in e)s==="values"&&typeof e.values=="object"||(vb(s)||n===!0&&Yl(s)||!t&&!Yl(s)||e.draggable&&s.startsWith("onDrag"))&&(o[s]=e[s]);return o}function Cb({children:e,isValidProp:t,...n}){t&&yb(t),n={...l.useContext(da),...n},n.isStatic=qo(()=>n.isStatic);const o=l.useMemo(()=>n,[JSON.stringify(n.transition),n.transformPagePoint,n.reducedMotion]);return c.jsx(da.Provider,{value:o,children:e})}function y7(e){if(typeof Proxy>"u")return e;const t=new Map,n=(...o)=>e(...o);return new Proxy(n,{get:(o,s)=>s==="create"?e:(t.has(s)||t.set(s,e(s)),t.get(s))})}const Vu=l.createContext({});function Sb(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function Pp(e){return typeof e=="string"||Array.isArray(e)}const C7=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],S7=["initial",...C7];function ph(e){return Sb(e.animate)||S7.some(t=>Pp(e[t]))}function b7(e){return!!(ph(e)||e.variants)}function I7(e,t){if(ph(e)){const{initial:n,animate:o}=e;return{initial:n===!1||Pp(n)?n:void 0,animate:Pp(o)?o:void 0}}return e.inherit!==!1?t:{}}function E7(e){const{initial:t,animate:n}=I7(e,l.useContext(Vu));return l.useMemo(()=>({initial:t,animate:n}),[Pv(t),Pv(n)])}function Pv(e){return Array.isArray(e)?e.join(" "):e}const T7=Symbol.for("motionComponentSymbol");function bb(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function w7(e,t,n){return l.useCallback(o=>{o&&e.onMount&&e.onMount(o),t&&(o?t.mount(o):t.unmount()),n&&(typeof n=="function"?n(o):bb(n)&&(n.current=o))},[t])}const Ib=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),A7="framerAppearId",x7="data-"+Ib(A7),{schedule:_7}=gb(queueMicrotask,!1),k7=l.createContext({});function P7(e,t,n,o,s){var a,r;const{visualElement:i}=l.useContext(Vu),d=l.useContext(mh),m=l.useContext(ic),p=l.useContext(da).reducedMotion,h=l.useRef(null);o=o||d.renderer,!h.current&&o&&(h.current=o(e,{visualState:t,parent:i,props:n,presenceContext:m,blockInitialAnimation:m?m.initial===!1:!1,reducedMotionConfig:p}));const g=h.current,y=l.useContext(k7);g&&!g.projection&&s&&(g.type==="html"||g.type==="svg")&&M7(h.current,n,s,y);const b=l.useRef(!1);l.useInsertionEffect(()=>{g&&b.current&&g.update(n,m)});const C=n[x7],T=l.useRef(!!C&&!(!((a=window.MotionHandoffIsComplete)===null||a===void 0)&&a.call(window,C))&&((r=window.MotionHasOptimisedAnimation)===null||r===void 0?void 0:r.call(window,C)));return cc(()=>{g&&(b.current=!0,window.MotionIsMounted=!0,g.updateFeatures(),_7.render(g.render),T.current&&g.animationState&&g.animationState.animateChanges())}),l.useEffect(()=>{g&&(!T.current&&g.animationState&&g.animationState.animateChanges(),T.current&&(queueMicrotask(()=>{var S;(S=window.MotionHandoffMarkAsComplete)===null||S===void 0||S.call(window,C)}),T.current=!1))}),g}function M7(e,t,n,o){const{layoutId:s,layout:a,drag:r,dragConstraints:i,layoutScroll:d,layoutRoot:m}=t;e.projection=new n(e.latestValues,t["data-framer-portal-id"]?void 0:Eb(e.parent)),e.projection.setOptions({layoutId:s,layout:a,alwaysMeasureLayout:!!r||i&&bb(i),visualElement:e,animationType:typeof a=="string"?a:"both",initialPromotionConfig:o,layoutScroll:d,layoutRoot:m})}function Eb(e){if(e)return e.options.allowProjection!==!1?e.projection:Eb(e.parent)}function R7({preloadedFeatures:e,createVisualElement:t,useRender:n,useVisualState:o,Component:s}){var a,r;e&&kp(e);function i(m,p){let h;const g={...l.useContext(da),...m,layoutId:N7(m)},{isStatic:y}=g,b=E7(m),C=o(m,y);if(!y&&fb){L7();const T=D7(g);h=T.MeasureLayout,b.visualElement=P7(s,C,g,t,T.ProjectionNode)}return c.jsxs(Vu.Provider,{value:b,children:[h&&b.visualElement?c.jsx(h,{visualElement:b.visualElement,...g}):null,n(s,m,w7(C,b.visualElement,p),C,y,b.visualElement)]})}i.displayName=`motion.${typeof s=="string"?s:`create(${(r=(a=s.displayName)!==null&&a!==void 0?a:s.name)!==null&&r!==void 0?r:""})`}`;const d=l.forwardRef(i);return d[T7]=s,d}function N7({layoutId:e}){const t=l.useContext(pb).id;return t&&e!==void 0?t+"-"+e:e}function L7(e,t){l.useContext(mh).strict}function D7(e){const{drag:t,layout:n}=Kl;if(!t&&!n)return{};const o={...t,...n};return{MeasureLayout:t?.isEnabled(e)||n?.isEnabled(e)?o.MeasureLayout:void 0,ProjectionNode:o.ProjectionNode}}const Tb=e=>t=>typeof t=="string"&&t.startsWith(e),wb=Tb("--"),O7=Tb("var(--"),U7=e=>O7(e)?F7.test(e.split("/*")[0].trim()):!1,F7=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Mp={};function pIe(e){for(const t in e)Mp[t]=e[t],wb(t)&&(Mp[t].isCSSVariable=!0)}const lc=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],fh=new Set(lc);function Ab(e,{layout:t,layoutId:n}){return fh.has(e)||e.startsWith("origin")||(t||n!==void 0)&&(!!Mp[e]||e==="opacity")}const Ko=e=>!!(e&&e.getVelocity),xb=(e,t)=>t&&typeof e=="number"?t.transform(e):e,xs=(e,t,n)=>n>t?t:n<e?e:n,uc={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},Bi={...uc,transform:e=>xs(0,1,e)},fl={...uc,default:1},dc=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),Gs=dc("deg"),Ii=dc("%"),Ve=dc("px"),fIe=dc("vh"),hIe=dc("vw"),Mv={...Ii,parse:e=>Ii.parse(e)/100,transform:e=>Ii.transform(e*100)},j7={borderWidth:Ve,borderTopWidth:Ve,borderRightWidth:Ve,borderBottomWidth:Ve,borderLeftWidth:Ve,borderRadius:Ve,radius:Ve,borderTopLeftRadius:Ve,borderTopRightRadius:Ve,borderBottomRightRadius:Ve,borderBottomLeftRadius:Ve,width:Ve,maxWidth:Ve,height:Ve,maxHeight:Ve,top:Ve,right:Ve,bottom:Ve,left:Ve,padding:Ve,paddingTop:Ve,paddingRight:Ve,paddingBottom:Ve,paddingLeft:Ve,margin:Ve,marginTop:Ve,marginRight:Ve,marginBottom:Ve,marginLeft:Ve,backgroundPositionX:Ve,backgroundPositionY:Ve},B7={rotate:Gs,rotateX:Gs,rotateY:Gs,rotateZ:Gs,scale:fl,scaleX:fl,scaleY:fl,scaleZ:fl,skew:Gs,skewX:Gs,skewY:Gs,distance:Ve,translateX:Ve,translateY:Ve,translateZ:Ve,x:Ve,y:Ve,z:Ve,perspective:Ve,transformPerspective:Ve,opacity:Bi,originX:Mv,originY:Mv,originZ:Ve},Rv={...uc,transform:Math.round},_b={...j7,...B7,zIndex:Rv,size:Ve,fillOpacity:Bi,strokeOpacity:Bi,numOctaves:Rv},V7={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},H7=lc.length;function z7(e,t,n){let o="",s=!0;for(let a=0;a<H7;a++){const r=lc[a],i=e[r];if(i===void 0)continue;let d=!0;if(typeof i=="number"?d=i===(r.startsWith("scale")?1:0):d=parseFloat(i)===0,!d||n){const m=xb(i,_b[r]);if(!d){s=!1;const p=V7[r]||r;o+=`${p}(${m}) `}n&&(t[r]=m)}}return o=o.trim(),n?o=n(t,s?"":o):s&&(o="none"),o}function kb(e,t,n){const{style:o,vars:s,transformOrigin:a}=e;let r=!1,i=!1;for(const d in t){const m=t[d];if(fh.has(d)){r=!0;continue}else if(wb(d)){s[d]=m;continue}else{const p=xb(m,_b[d]);d.startsWith("origin")?(i=!0,a[d]=p):o[d]=p}}if(t.transform||(r||n?o.transform=z7(t,e.transform,n):o.transform&&(o.transform="none")),i){const{originX:d="50%",originY:m="50%",originZ:p=0}=a;o.transformOrigin=`${d} ${m} ${p}`}}const hh=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function Pb(e,t,n){for(const o in t)!Ko(t[o])&&!Ab(o,n)&&(e[o]=t[o])}function G7({transformTemplate:e},t){return l.useMemo(()=>{const n=hh();return kb(n,t,e),Object.assign({},n.vars,n.style)},[t])}function W7(e,t){const n=e.style||{},o={};return Pb(o,n,e),Object.assign(o,G7(e,t)),o}function $7(e,t){const n={},o=W7(e,t);return e.drag&&e.dragListener!==!1&&(n.draggable=!1,o.userSelect=o.WebkitUserSelect=o.WebkitTouchCallout="none",o.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=o,n}const q7=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Mb(e){return typeof e!="string"||e.includes("-")?!1:!!(q7.indexOf(e)>-1||/[A-Z]/u.test(e))}const K7={offset:"stroke-dashoffset",array:"stroke-dasharray"},Y7={offset:"strokeDashoffset",array:"strokeDasharray"};function Z7(e,t,n=1,o=0,s=!0){e.pathLength=1;const a=s?K7:Y7;e[a.offset]=Ve.transform(-o);const r=Ve.transform(t),i=Ve.transform(n);e[a.array]=`${r} ${i}`}function Nv(e,t,n){return typeof e=="string"?e:Ve.transform(t+n*e)}function J7(e,t,n){const o=Nv(t,e.x,e.width),s=Nv(n,e.y,e.height);return`${o} ${s}`}function Rb(e,{attrX:t,attrY:n,attrScale:o,originX:s,originY:a,pathLength:r,pathSpacing:i=1,pathOffset:d=0,...m},p,h){if(kb(e,m,h),p){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:g,style:y,dimensions:b}=e;g.transform&&(b&&(y.transform=g.transform),delete g.transform),b&&(s!==void 0||a!==void 0||y.transform)&&(y.transformOrigin=J7(b,s!==void 0?s:.5,a!==void 0?a:.5)),t!==void 0&&(g.x=t),n!==void 0&&(g.y=n),o!==void 0&&(g.scale=o),r!==void 0&&Z7(g,r,i,d,!1)}const Nb=()=>({...hh(),attrs:{}}),Lb=e=>typeof e=="string"&&e.toLowerCase()==="svg";function Q7(e,t,n,o){const s=l.useMemo(()=>{const a=Nb();return Rb(a,t,Lb(o),e.transformTemplate),{...a.attrs,style:{...a.style}}},[t]);if(e.style){const a={};Pb(a,e.style,e),s.style={...a,...s.style}}return s}function X7(e=!1){return(n,o,s,{latestValues:a},r)=>{const d=(Mb(n)?Q7:$7)(o,a,r,n),m=v7(o,typeof n=="string",e),p=n!==l.Fragment?{...m,...d,ref:s}:{},{children:h}=o,g=l.useMemo(()=>Ko(h)?h.get():h,[h]);return l.createElement(n,{...p,children:g})}}function Lv(e){const t=[{},{}];return e?.values.forEach((n,o)=>{t[0][o]=n.get(),t[1][o]=n.getVelocity()}),t}function e8(e,t,n,o){if(typeof t=="function"){const[s,a]=Lv(o);t=t(n!==void 0?n:e.custom,s,a)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[s,a]=Lv(o);t=t(n!==void 0?n:e.custom,s,a)}return t}const t8=e=>Array.isArray(e),n8=e=>!!(e&&typeof e=="object"&&e.mix&&e.toValue),gIe=e=>t8(e)?e[e.length-1]||0:e;function o8(e){const t=Ko(e)?e.get():e;return n8(t)?t.toValue():t}function s8({scrapeMotionValuesFromProps:e,createRenderState:t,onUpdate:n},o,s,a){const r={latestValues:a8(o,s,a,e),renderState:t()};return n&&(r.onMount=i=>n({props:o,current:i,...r}),r.onUpdate=i=>n(i)),r}const Db=e=>(t,n)=>{const o=l.useContext(Vu),s=l.useContext(ic),a=()=>s8(e,t,o,s);return n?a():qo(a)};function a8(e,t,n,o){const s={},a=o(e,{});for(const g in a)s[g]=o8(a[g]);let{initial:r,animate:i}=e;const d=ph(e),m=b7(e);t&&m&&!d&&e.inherit!==!1&&(r===void 0&&(r=t.initial),i===void 0&&(i=t.animate));let p=n?n.initial===!1:!1;p=p||r===!1;const h=p?i:r;if(h&&typeof h!="boolean"&&!Sb(h)){const g=Array.isArray(h)?h:[h];for(let y=0;y<g.length;y++){const b=e8(e,g[y]);if(b){const{transitionEnd:C,transition:T,...S}=b;for(const E in S){let I=S[E];if(Array.isArray(I)){const x=p?I.length-1:0;I=I[x]}I!==null&&(s[E]=I)}for(const E in C)s[E]=C[E]}}}return s}function Ob(e,t,n){var o;const{style:s}=e,a={};for(const r in s)(Ko(s[r])||t.style&&Ko(t.style[r])||Ab(r,e)||((o=n?.getValue(r))===null||o===void 0?void 0:o.liveStyle)!==void 0)&&(a[r]=s[r]);return a}const r8={useVisualState:Db({scrapeMotionValuesFromProps:Ob,createRenderState:hh})};function i8(e,t){try{t.dimensions=typeof e.getBBox=="function"?e.getBBox():e.getBoundingClientRect()}catch{t.dimensions={x:0,y:0,width:0,height:0}}}function c8(e,{style:t,vars:n},o,s){Object.assign(e.style,t,s&&s.getProjectionStyles(o));for(const a in n)e.style.setProperty(a,n[a])}const l8=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function u8(e,t,n,o){c8(e,t,void 0,o);for(const s in t.attrs)e.setAttribute(l8.has(s)?s:Ib(s),t.attrs[s])}function d8(e,t,n){const o=Ob(e,t,n);for(const s in e)if(Ko(e[s])||Ko(t[s])){const a=lc.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;o[a]=e[s]}return o}const Dv=["x","y","width","height","cx","cy","r"],m8={useVisualState:Db({scrapeMotionValuesFromProps:d8,createRenderState:Nb,onUpdate:({props:e,prevProps:t,current:n,renderState:o,latestValues:s})=>{if(!n)return;let a=!!e.drag;if(!a){for(const i in s)if(fh.has(i)){a=!0;break}}if(!a)return;let r=!t;if(t)for(let i=0;i<Dv.length;i++){const d=Dv[i];e[d]!==t[d]&&(r=!0)}r&&kn.read(()=>{i8(n,o),kn.render(()=>{Rb(o,s,Lb(n.tagName),e.transformTemplate),u8(n,o)})})}})};function p8(e,t){return function(o,{forwardMotionProps:s}={forwardMotionProps:!1}){const r={...Mb(o)?m8:r8,preloadedFeatures:e,useRender:X7(s),createVisualElement:t,Component:o};return R7(r)}}const f8=p8(),he=y7(f8);let Ll;function h8(){Ll=void 0}const sa={now:()=>(Ll===void 0&&sa.set(ji.isProcessing||_p.useManualTiming?ji.timestamp:performance.now()),Ll),set:e=>{Ll=e,queueMicrotask(h8)}};function g8(e,t){e.indexOf(t)===-1&&e.push(t)}function v8(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}function vIe([...e],t,n){const o=t<0?e.length+t:t;if(o>=0&&o<e.length){const s=n<0?e.length+n:n,[a]=e.splice(t,1);e.splice(s,0,a)}return e}class y8{constructor(){this.subscriptions=[]}add(t){return g8(this.subscriptions,t),()=>v8(this.subscriptions,t)}notify(t,n,o){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](t,n,o);else for(let a=0;a<s;a++){const r=this.subscriptions[a];r&&r(t,n,o)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function gh(e,t){return t?e*(1e3/t):0}const Ov=30,C8=e=>!isNaN(parseFloat(e)),Ei={current:void 0};class S8{constructor(t,n={}){this.version="12.4.7",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(o,s=!0)=>{const a=sa.now();this.updatedAt!==a&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(o),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),s&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(t),this.owner=n.owner}setCurrent(t){this.current=t,this.updatedAt=sa.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=C8(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,n){this.events[t]||(this.events[t]=new y8);const o=this.events[t].add(n);return t==="change"?()=>{o(),kn.read(()=>{this.events.change.getSize()||this.stop()})}:o}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,n){this.passiveEffect=t,this.stopPassiveEffect=n}set(t,n=!0){!n||!this.passiveEffect?this.updateAndNotify(t,n):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,n,o){this.set(n),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-o}jump(t,n=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return Ei.current&&Ei.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){const t=sa.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>Ov)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,Ov);return gh(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(t){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=t(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function or(e,t){return new S8(e,t)}function b8(e){let t;return()=>(t===void 0&&(t=e()),t)}const I8=b8(()=>window.ScrollTimeline!==void 0),vh=e=>e*1e3,lr=e=>e/1e3,E8={current:!1};function Ub(e){return typeof e=="function"}const T8=e=>Array.isArray(e)&&typeof e[0]=="number",Hu=(e,t,n)=>{const o=t-e;return o===0?1:(n-e)/o},w8=(e,t,n=10)=>{let o="";const s=Math.max(Math.round(t/n),2);for(let a=0;a<s;a++)o+=e(Hu(0,s-1,a))+", ";return`linear(${o.substring(0,o.length-2)})`},Fb=(e,t,n)=>(((1-3*n+3*t)*e+(3*n-6*t))*e+3*t)*e,A8=1e-7,x8=12;function _8(e,t,n,o,s){let a,r,i=0;do r=t+(n-t)/2,a=Fb(r,o,s)-e,a>0?n=r:t=r;while(Math.abs(a)>A8&&++i<x8);return r}function mc(e,t,n,o){if(e===t&&n===o)return Ms;const s=a=>_8(a,0,1,e,n);return a=>a===0||a===1?a:Fb(s(a),t,o)}const jb=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,Bb=e=>t=>1-e(1-t),Vb=mc(.33,1.53,.69,.99),yh=Bb(Vb),k8=jb(yh),P8=e=>(e*=2)<1?.5*yh(e):.5*(2-Math.pow(2,-10*(e-1))),Ch=e=>1-Math.sin(Math.acos(e)),M8=Bb(Ch),R8=jb(Ch),Ti=e=>Math.round(e*1e5)/1e5,Hb=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function N8(e){return e==null}const L8=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,Sh=(e,t)=>n=>!!(typeof n=="string"&&L8.test(n)&&n.startsWith(e)||t&&!N8(n)&&Object.prototype.hasOwnProperty.call(n,t)),zb=(e,t,n)=>o=>{if(typeof o!="string")return o;const[s,a,r,i]=o.match(Hb);return{[e]:parseFloat(s),[t]:parseFloat(a),[n]:parseFloat(r),alpha:i!==void 0?parseFloat(i):1}},D8=e=>xs(0,255,e),_m={...uc,transform:e=>Math.round(D8(e))},na={test:Sh("rgb","red"),parse:zb("red","green","blue"),transform:({red:e,green:t,blue:n,alpha:o=1})=>"rgba("+_m.transform(e)+", "+_m.transform(t)+", "+_m.transform(n)+", "+Ti(Bi.transform(o))+")"};function O8(e){let t="",n="",o="",s="";return e.length>5?(t=e.substring(1,3),n=e.substring(3,5),o=e.substring(5,7),s=e.substring(7,9)):(t=e.substring(1,2),n=e.substring(2,3),o=e.substring(3,4),s=e.substring(4,5),t+=t,n+=n,o+=o,s+=s),{red:parseInt(t,16),green:parseInt(n,16),blue:parseInt(o,16),alpha:s?parseInt(s,16)/255:1}}const Rp={test:Sh("#"),parse:O8,transform:na.transform},sr={test:Sh("hsl","hue"),parse:zb("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:n,alpha:o=1})=>"hsla("+Math.round(e)+", "+Ii.transform(Ti(t))+", "+Ii.transform(Ti(n))+", "+Ti(Bi.transform(o))+")"},Vi={test:e=>na.test(e)||Rp.test(e)||sr.test(e),parse:e=>na.test(e)?na.parse(e):sr.test(e)?sr.parse(e):Rp.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?na.transform(e):sr.transform(e)},U8=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function F8(e){var t,n;return isNaN(e)&&typeof e=="string"&&(((t=e.match(Hb))===null||t===void 0?void 0:t.length)||0)+(((n=e.match(U8))===null||n===void 0?void 0:n.length)||0)>0}const Gb="number",Wb="color",j8="var",B8="var(",Uv="${}",V8=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Zl(e){const t=e.toString(),n=[],o={color:[],number:[],var:[]},s=[];let a=0;const i=t.replace(V8,d=>(Vi.test(d)?(o.color.push(a),s.push(Wb),n.push(Vi.parse(d))):d.startsWith(B8)?(o.var.push(a),s.push(j8),n.push(d)):(o.number.push(a),s.push(Gb),n.push(parseFloat(d))),++a,Uv)).split(Uv);return{values:n,split:i,indexes:o,types:s}}function $b(e){return Zl(e).values}function qb(e){const{split:t,types:n}=Zl(e),o=t.length;return s=>{let a="";for(let r=0;r<o;r++)if(a+=t[r],s[r]!==void 0){const i=n[r];i===Gb?a+=Ti(s[r]):i===Wb?a+=Vi.transform(s[r]):a+=s[r]}return a}}const H8=e=>typeof e=="number"?0:e;function z8(e){const t=$b(e);return qb(e)(t.map(H8))}const Kb={test:F8,parse:$b,createTransformer:qb,getAnimatableNone:z8},yIe=e=>e===uc||e===Ve,Fv=(e,t)=>parseFloat(e.split(", ")[t]),jv=(e,t)=>(n,{transform:o})=>{if(o==="none"||!o)return 0;const s=o.match(/^matrix3d\((.+)\)$/u);if(s)return Fv(s[1],t);{const a=o.match(/^matrix\((.+)\)$/u);return a?Fv(a[1],e):0}},G8=new Set(["x","y","z"]),W8=lc.filter(e=>!G8.has(e));function $8(e){const t=[];return W8.forEach(n=>{const o=e.getValue(n);o!==void 0&&(t.push([n,o.get()]),o.set(n.startsWith("scale")?1:0))}),t}const Jl={width:({x:e},{paddingLeft:t="0",paddingRight:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),height:({y:e},{paddingTop:t="0",paddingBottom:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:jv(4,13),y:jv(5,14)};Jl.translateX=Jl.x;Jl.translateY=Jl.y;const aa=new Set;let Np=!1,Lp=!1;function Yb(){if(Lp){const e=Array.from(aa).filter(o=>o.needsMeasurement),t=new Set(e.map(o=>o.element)),n=new Map;t.forEach(o=>{const s=$8(o);s.length&&(n.set(o,s),o.render())}),e.forEach(o=>o.measureInitialState()),t.forEach(o=>{o.render();const s=n.get(o);s&&s.forEach(([a,r])=>{var i;(i=o.getValue(a))===null||i===void 0||i.set(r)})}),e.forEach(o=>o.measureEndState()),e.forEach(o=>{o.suspendedScrollY!==void 0&&window.scrollTo(0,o.suspendedScrollY)})}Lp=!1,Np=!1,aa.forEach(e=>e.complete()),aa.clear()}function Zb(){aa.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(Lp=!0)})}function q8(){Zb(),Yb()}class K8{constructor(t,n,o,s,a,r=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...t],this.onComplete=n,this.name=o,this.motionValue=s,this.element=a,this.isAsync=r}scheduleResolve(){this.isScheduled=!0,this.isAsync?(aa.add(this),Np||(Np=!0,kn.read(Zb),kn.resolveKeyframes(Yb))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:n,element:o,motionValue:s}=this;for(let a=0;a<t.length;a++)if(t[a]===null)if(a===0){const r=s?.get(),i=t[t.length-1];if(r!==void 0)t[0]=r;else if(o&&n){const d=o.readValue(n,i);d!=null&&(t[0]=d)}t[0]===void 0&&(t[0]=i),s&&r===void 0&&s.set(t[0])}else t[a]=t[a-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),aa.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,aa.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const Bv=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(Kb.test(e)||e==="0")&&!e.startsWith("url("));function Y8(e){const t=e[0];if(e.length===1)return!0;for(let n=0;n<e.length;n++)if(e[n]!==t)return!0}function Z8(e,t,n,o){const s=e[0];if(s===null)return!1;if(t==="display"||t==="visibility")return!0;const a=e[e.length-1],r=Bv(s,t),i=Bv(a,t);return!r||!i?!1:Y8(e)||(n==="spring"||Ub(n))&&o}const J8=e=>e!==null;function Jb(e,{repeat:t,repeatType:n="loop"},o){const s=e.filter(J8),a=t&&n!=="loop"&&t%2===1?0:s.length-1;return!a||o===void 0?s[a]:o}const Q8=40;class X8{constructor({autoplay:t=!0,delay:n=0,type:o="keyframes",repeat:s=0,repeatDelay:a=0,repeatType:r="loop",...i}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=sa.now(),this.options={autoplay:t,delay:n,type:o,repeat:s,repeatDelay:a,repeatType:r,...i},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>Q8?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&q8(),this._resolved}onKeyframesResolved(t,n){this.resolvedAt=sa.now(),this.hasAttemptedResolve=!0;const{name:o,type:s,velocity:a,delay:r,onComplete:i,onUpdate:d,isGenerator:m}=this.options;if(!m&&!Z8(t,o,s,a))if(E8.current||!r){d&&d(Jb(t,this.options,n)),i&&i(),this.resolveFinishedPromise();return}else this.options.duration=0;const p=this.initPlayback(t,n);p!==!1&&(this._resolved={keyframes:t,finalKeyframe:n,...p},this.onPostResolved())}onPostResolved(){}then(t,n){return this.currentFinishedPromise.then(t,n)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(t=>{this.resolveFinishedPromise=t})}}const Dp=2e4;function Qb(e){let t=0;const n=50;let o=e.next(t);for(;!o.done&&t<Dp;)t+=n,o=e.next(t);return t>=Dp?1/0:t}const zu=(e,t,n)=>e+(t-e)*n;function km(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function eP({hue:e,saturation:t,lightness:n,alpha:o}){e/=360,t/=100,n/=100;let s=0,a=0,r=0;if(!t)s=a=r=n;else{const i=n<.5?n*(1+t):n+t-n*t,d=2*n-i;s=km(d,i,e+1/3),a=km(d,i,e),r=km(d,i,e-1/3)}return{red:Math.round(s*255),green:Math.round(a*255),blue:Math.round(r*255),alpha:o}}function Ql(e,t){return n=>n>0?t:e}const Pm=(e,t,n)=>{const o=e*e,s=n*(t*t-o)+o;return s<0?0:Math.sqrt(s)},tP=[Rp,na,sr],nP=e=>tP.find(t=>t.test(e));function Vv(e){const t=nP(e);if(!t)return!1;let n=t.parse(e);return t===sr&&(n=eP(n)),n}const Hv=(e,t)=>{const n=Vv(e),o=Vv(t);if(!n||!o)return Ql(e,t);const s={...n};return a=>(s.red=Pm(n.red,o.red,a),s.green=Pm(n.green,o.green,a),s.blue=Pm(n.blue,o.blue,a),s.alpha=zu(n.alpha,o.alpha,a),na.transform(s))},oP=(e,t)=>n=>t(e(n)),bh=(...e)=>e.reduce(oP),Op=new Set(["none","hidden"]);function sP(e,t){return Op.has(e)?n=>n<=0?e:t:n=>n>=1?t:e}function aP(e,t){return n=>zu(e,t,n)}function Ih(e){return typeof e=="number"?aP:typeof e=="string"?U7(e)?Ql:Vi.test(e)?Hv:cP:Array.isArray(e)?Xb:typeof e=="object"?Vi.test(e)?Hv:rP:Ql}function Xb(e,t){const n=[...e],o=n.length,s=e.map((a,r)=>Ih(a)(a,t[r]));return a=>{for(let r=0;r<o;r++)n[r]=s[r](a);return n}}function rP(e,t){const n={...e,...t},o={};for(const s in n)e[s]!==void 0&&t[s]!==void 0&&(o[s]=Ih(e[s])(e[s],t[s]));return s=>{for(const a in o)n[a]=o[a](s);return n}}function iP(e,t){var n;const o=[],s={color:0,var:0,number:0};for(let a=0;a<t.values.length;a++){const r=t.types[a],i=e.indexes[r][s[r]],d=(n=e.values[i])!==null&&n!==void 0?n:0;o[a]=d,s[r]++}return o}const cP=(e,t)=>{const n=Kb.createTransformer(t),o=Zl(e),s=Zl(t);return o.indexes.var.length===s.indexes.var.length&&o.indexes.color.length===s.indexes.color.length&&o.indexes.number.length>=s.indexes.number.length?Op.has(e)&&!s.values.length||Op.has(t)&&!o.values.length?sP(e,t):bh(Xb(iP(o,s),s.values),n):Ql(e,t)};function eI(e,t,n){return typeof e=="number"&&typeof t=="number"&&typeof n=="number"?zu(e,t,n):Ih(e)(e,t)}const lP=5;function tI(e,t,n){const o=Math.max(t-lP,0);return gh(n-e(o),t-o)}const At={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},zv=.001;function uP({duration:e=At.duration,bounce:t=At.bounce,velocity:n=At.velocity,mass:o=At.mass}){let s,a,r=1-t;r=xs(At.minDamping,At.maxDamping,r),e=xs(At.minDuration,At.maxDuration,lr(e)),r<1?(s=m=>{const p=m*r,h=p*e,g=p-n,y=Up(m,r),b=Math.exp(-h);return zv-g/y*b},a=m=>{const h=m*r*e,g=h*n+n,y=Math.pow(r,2)*Math.pow(m,2)*e,b=Math.exp(-h),C=Up(Math.pow(m,2),r);return(-s(m)+zv>0?-1:1)*((g-y)*b)/C}):(s=m=>{const p=Math.exp(-m*e),h=(m-n)*e+1;return-.001+p*h},a=m=>{const p=Math.exp(-m*e),h=(n-m)*(e*e);return p*h});const i=5/e,d=mP(s,a,i);if(e=vh(e),isNaN(d))return{stiffness:At.stiffness,damping:At.damping,duration:e};{const m=Math.pow(d,2)*o;return{stiffness:m,damping:r*2*Math.sqrt(o*m),duration:e}}}const dP=12;function mP(e,t,n){let o=n;for(let s=1;s<dP;s++)o=o-e(o)/t(o);return o}function Up(e,t){return e*Math.sqrt(1-t*t)}const pP=["duration","bounce"],fP=["stiffness","damping","mass"];function Gv(e,t){return t.some(n=>e[n]!==void 0)}function hP(e){let t={velocity:At.velocity,stiffness:At.stiffness,damping:At.damping,mass:At.mass,isResolvedFromDuration:!1,...e};if(!Gv(e,fP)&&Gv(e,pP))if(e.visualDuration){const n=e.visualDuration,o=2*Math.PI/(n*1.2),s=o*o,a=2*xs(.05,1,1-(e.bounce||0))*Math.sqrt(s);t={...t,mass:At.mass,stiffness:s,damping:a}}else{const n=uP(e);t={...t,...n,mass:At.mass},t.isResolvedFromDuration=!0}return t}function nI(e=At.visualDuration,t=At.bounce){const n=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:o,restDelta:s}=n;const a=n.keyframes[0],r=n.keyframes[n.keyframes.length-1],i={done:!1,value:a},{stiffness:d,damping:m,mass:p,duration:h,velocity:g,isResolvedFromDuration:y}=hP({...n,velocity:-lr(n.velocity||0)}),b=g||0,C=m/(2*Math.sqrt(d*p)),T=r-a,S=lr(Math.sqrt(d/p)),E=Math.abs(T)<5;o||(o=E?At.restSpeed.granular:At.restSpeed.default),s||(s=E?At.restDelta.granular:At.restDelta.default);let I;if(C<1){const w=Up(S,C);I=P=>{const D=Math.exp(-C*S*P);return r-D*((b+C*S*T)/w*Math.sin(w*P)+T*Math.cos(w*P))}}else if(C===1)I=w=>r-Math.exp(-S*w)*(T+(b+S*T)*w);else{const w=S*Math.sqrt(C*C-1);I=P=>{const D=Math.exp(-C*S*P),L=Math.min(w*P,300);return r-D*((b+C*S*T)*Math.sinh(L)+w*T*Math.cosh(L))/w}}const x={calculatedDuration:y&&h||null,next:w=>{const P=I(w);if(y)i.done=w>=h;else{let D=0;C<1&&(D=w===0?vh(b):tI(I,w,P));const L=Math.abs(D)<=o,j=Math.abs(r-P)<=s;i.done=L&&j}return i.value=i.done?r:P,i},toString:()=>{const w=Math.min(Qb(x),Dp),P=w8(D=>x.next(w*D).value,w,30);return w+"ms "+P}};return x}function Wv({keyframes:e,velocity:t=0,power:n=.8,timeConstant:o=325,bounceDamping:s=10,bounceStiffness:a=500,modifyTarget:r,min:i,max:d,restDelta:m=.5,restSpeed:p}){const h=e[0],g={done:!1,value:h},y=L=>i!==void 0&&L<i||d!==void 0&&L>d,b=L=>i===void 0?d:d===void 0||Math.abs(i-L)<Math.abs(d-L)?i:d;let C=n*t;const T=h+C,S=r===void 0?T:r(T);S!==T&&(C=S-h);const E=L=>-C*Math.exp(-L/o),I=L=>S+E(L),x=L=>{const j=E(L),U=I(L);g.done=Math.abs(j)<=m,g.value=g.done?S:U};let w,P;const D=L=>{y(g.value)&&(w=L,P=nI({keyframes:[g.value,b(g.value)],velocity:tI(I,L,g.value),damping:s,stiffness:a,restDelta:m,restSpeed:p}))};return D(0),{calculatedDuration:null,next:L=>{let j=!1;return!P&&w===void 0&&(j=!0,x(L),D(L)),w!==void 0&&L>=w?P.next(L-w):(!j&&x(L),g)}}}const gP=mc(.42,0,1,1),vP=mc(0,0,.58,1),oI=mc(.42,0,.58,1),yP=e=>Array.isArray(e)&&typeof e[0]!="number",CP={linear:Ms,easeIn:gP,easeInOut:oI,easeOut:vP,circIn:Ch,circInOut:R8,circOut:M8,backIn:yh,backInOut:k8,backOut:Vb,anticipate:P8},$v=e=>{if(T8(e)){hb(e.length===4);const[t,n,o,s]=e;return mc(t,n,o,s)}else if(typeof e=="string")return CP[e];return e};function SP(e,t,n){const o=[],s=n||eI,a=e.length-1;for(let r=0;r<a;r++){let i=s(e[r],e[r+1]);if(t){const d=Array.isArray(t)?t[r]||Ms:t;i=bh(d,i)}o.push(i)}return o}function Eh(e,t,{clamp:n=!0,ease:o,mixer:s}={}){const a=e.length;if(hb(a===t.length),a===1)return()=>t[0];if(a===2&&t[0]===t[1])return()=>t[1];const r=e[0]===e[1];e[0]>e[a-1]&&(e=[...e].reverse(),t=[...t].reverse());const i=SP(t,o,s),d=i.length,m=p=>{if(r&&p<e[0])return t[0];let h=0;if(d>1)for(;h<e.length-2&&!(p<e[h+1]);h++);const g=Hu(e[h],e[h+1],p);return i[h](g)};return n?p=>m(xs(e[0],e[a-1],p)):m}function bP(e,t){const n=e[e.length-1];for(let o=1;o<=t;o++){const s=Hu(0,t,o);e.push(zu(n,1,s))}}function sI(e){const t=[0];return bP(t,e.length-1),t}function IP(e,t){return e.map(n=>n*t)}function EP(e,t){return e.map(()=>t||oI).splice(0,e.length-1)}function Xl({duration:e=300,keyframes:t,times:n,ease:o="easeInOut"}){const s=yP(o)?o.map($v):$v(o),a={done:!1,value:t[0]},r=IP(n&&n.length===t.length?n:sI(t),e),i=Eh(r,t,{ease:Array.isArray(s)?s:EP(t,s)});return{calculatedDuration:e,next:d=>(a.value=i(d),a.done=d>=e,a)}}const TP=e=>{const t=({timestamp:n})=>e(n);return{start:()=>kn.update(t,!0),stop:()=>Bu(t),now:()=>ji.isProcessing?ji.timestamp:sa.now()}},wP={decay:Wv,inertia:Wv,tween:Xl,keyframes:Xl,spring:nI},AP=e=>e/100;class xP extends X8{constructor(t){super(t),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:d}=this.options;d&&d()};const{name:n,motionValue:o,element:s,keyframes:a}=this.options,r=s?.KeyframeResolver||K8,i=(d,m)=>this.onKeyframesResolved(d,m);this.resolver=new r(a,i,n,o,s),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(t){const{type:n="keyframes",repeat:o=0,repeatDelay:s=0,repeatType:a,velocity:r=0}=this.options,i=Ub(n)?n:wP[n]||Xl;let d,m;i!==Xl&&typeof t[0]!="number"&&(d=bh(AP,eI(t[0],t[1])),t=[0,100]);const p=i({...this.options,keyframes:t});a==="mirror"&&(m=i({...this.options,keyframes:[...t].reverse(),velocity:-r})),p.calculatedDuration===null&&(p.calculatedDuration=Qb(p));const{calculatedDuration:h}=p,g=h+s,y=g*(o+1)-s;return{generator:p,mirroredGenerator:m,mapPercentToKeyframes:d,calculatedDuration:h,resolvedDuration:g,totalDuration:y}}onPostResolved(){const{autoplay:t=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!t?this.pause():this.state=this.pendingPlayState}tick(t,n=!1){const{resolved:o}=this;if(!o){const{keyframes:L}=this.options;return{done:!0,value:L[L.length-1]}}const{finalKeyframe:s,generator:a,mirroredGenerator:r,mapPercentToKeyframes:i,keyframes:d,calculatedDuration:m,totalDuration:p,resolvedDuration:h}=o;if(this.startTime===null)return a.next(0);const{delay:g,repeat:y,repeatType:b,repeatDelay:C,onUpdate:T}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-p/this.speed,this.startTime)),n?this.currentTime=t:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(t-this.startTime)*this.speed;const S=this.currentTime-g*(this.speed>=0?1:-1),E=this.speed>=0?S<0:S>p;this.currentTime=Math.max(S,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=p);let I=this.currentTime,x=a;if(y){const L=Math.min(this.currentTime,p)/h;let j=Math.floor(L),U=L%1;!U&&L>=1&&(U=1),U===1&&j--,j=Math.min(j,y+1),!!(j%2)&&(b==="reverse"?(U=1-U,C&&(U-=C/h)):b==="mirror"&&(x=r)),I=xs(0,1,U)*h}const w=E?{done:!1,value:d[0]}:x.next(I);i&&(w.value=i(w.value));let{done:P}=w;!E&&m!==null&&(P=this.speed>=0?this.currentTime>=p:this.currentTime<=0);const D=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&P);return D&&s!==void 0&&(w.value=Jb(d,this.options,s)),T&&T(w.value),D&&this.finish(),w}get duration(){const{resolved:t}=this;return t?lr(t.calculatedDuration):0}get time(){return lr(this.currentTime)}set time(t){t=vh(t),this.currentTime=t,this.holdTime!==null||this.speed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.speed)}get speed(){return this.playbackSpeed}set speed(t){const n=this.playbackSpeed!==t;this.playbackSpeed=t,n&&(this.time=lr(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:t=TP,onPlay:n,startTime:o}=this.options;this.driver||(this.driver=t(a=>this.tick(a))),n&&n();const s=this.driver.now();this.holdTime!==null?this.startTime=s-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=s):this.startTime=o??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var t;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(t=this.currentTime)!==null&&t!==void 0?t:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:t}=this.options;t&&t()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}}function _P(e){return new xP(e)}function aI(e,t,n){var o;if(e instanceof EventTarget)return[e];if(typeof e=="string"){let s=document;t&&(s=t.current);const a=(o=n?.[e])!==null&&o!==void 0?o:s.querySelectorAll(e);return a?Array.from(a):[]}return Array.from(e)}function rI(e,t){let n;const o=()=>{const{currentTime:s}=t,r=(s===null?0:s.value)/100;n!==r&&e(r),n=r};return kn.update(o,!0),()=>Bu(o)}const Dl=new WeakMap;let vs;function kP(e,t){if(t){const{inlineSize:n,blockSize:o}=t[0];return{width:n,height:o}}else return e instanceof SVGElement&&"getBBox"in e?e.getBBox():{width:e.offsetWidth,height:e.offsetHeight}}function PP({target:e,contentRect:t,borderBoxSize:n}){var o;(o=Dl.get(e))===null||o===void 0||o.forEach(s=>{s({target:e,contentSize:t,get size(){return kP(e,n)}})})}function MP(e){e.forEach(PP)}function RP(){typeof ResizeObserver>"u"||(vs=new ResizeObserver(MP))}function NP(e,t){vs||RP();const n=aI(e);return n.forEach(o=>{let s=Dl.get(o);s||(s=new Set,Dl.set(o,s)),s.add(t),vs?.observe(o)}),()=>{n.forEach(o=>{const s=Dl.get(o);s?.delete(t),s?.size||vs?.unobserve(o)})}}const Ol=new Set;let wi;function LP(){wi=()=>{const e={width:window.innerWidth,height:window.innerHeight},t={target:window,size:e,contentSize:e};Ol.forEach(n=>n(t))},window.addEventListener("resize",wi)}function DP(e){return Ol.add(e),wi||LP(),()=>{Ol.delete(e),!Ol.size&&wi&&(wi=void 0)}}function OP(e,t){return typeof e=="function"?DP(e):NP(e,t)}const UP=50,qv=()=>({current:0,offset:[],progress:0,scrollLength:0,targetOffset:0,targetLength:0,containerLength:0,velocity:0}),FP=()=>({time:0,x:qv(),y:qv()}),jP={x:{length:"Width",position:"Left"},y:{length:"Height",position:"Top"}};function Kv(e,t,n,o){const s=n[t],{length:a,position:r}=jP[t],i=s.current,d=n.time;s.current=e[`scroll${r}`],s.scrollLength=e[`scroll${a}`]-e[`client${a}`],s.offset.length=0,s.offset[0]=0,s.offset[1]=s.scrollLength,s.progress=Hu(0,s.scrollLength,s.current);const m=o-d;s.velocity=m>UP?0:gh(s.current-i,m)}function BP(e,t,n){Kv(e,"x",t,n),Kv(e,"y",t,n),t.time=n}function VP(e,t){const n={x:0,y:0};let o=e;for(;o&&o!==t;)if(o instanceof HTMLElement)n.x+=o.offsetLeft,n.y+=o.offsetTop,o=o.offsetParent;else if(o.tagName==="svg"){const s=o.getBoundingClientRect();o=o.parentElement;const a=o.getBoundingClientRect();n.x+=s.left-a.left,n.y+=s.top-a.top}else if(o instanceof SVGGraphicsElement){const{x:s,y:a}=o.getBBox();n.x+=s,n.y+=a;let r=null,i=o.parentNode;for(;!r;)i.tagName==="svg"&&(r=i),i=o.parentNode;o=r}else break;return n}const Fp={start:0,center:.5,end:1};function Yv(e,t,n=0){let o=0;if(e in Fp&&(e=Fp[e]),typeof e=="string"){const s=parseFloat(e);e.endsWith("px")?o=s:e.endsWith("%")?e=s/100:e.endsWith("vw")?o=s/100*document.documentElement.clientWidth:e.endsWith("vh")?o=s/100*document.documentElement.clientHeight:e=s}return typeof e=="number"&&(o=t*e),n+o}const HP=[0,0];function zP(e,t,n,o){let s=Array.isArray(e)?e:HP,a=0,r=0;return typeof e=="number"?s=[e,e]:typeof e=="string"&&(e=e.trim(),e.includes(" ")?s=e.split(" "):s=[e,Fp[e]?e:"0"]),a=Yv(s[0],n,o),r=Yv(s[1],t),a-r}const GP={All:[[0,0],[1,1]]},WP={x:0,y:0};function $P(e){return"getBBox"in e&&e.tagName!=="svg"?e.getBBox():{width:e.clientWidth,height:e.clientHeight}}function qP(e,t,n){const{offset:o=GP.All}=n,{target:s=e,axis:a="y"}=n,r=a==="y"?"height":"width",i=s!==e?VP(s,e):WP,d=s===e?{width:e.scrollWidth,height:e.scrollHeight}:$P(s),m={width:e.clientWidth,height:e.clientHeight};t[a].offset.length=0;let p=!t[a].interpolate;const h=o.length;for(let g=0;g<h;g++){const y=zP(o[g],m[r],d[r],i[a]);!p&&y!==t[a].interpolatorOffsets[g]&&(p=!0),t[a].offset[g]=y}p&&(t[a].interpolate=Eh(t[a].offset,sI(o),{clamp:!1}),t[a].interpolatorOffsets=[...t[a].offset]),t[a].progress=xs(0,1,t[a].interpolate(t[a].current))}function KP(e,t=e,n){if(n.x.targetOffset=0,n.y.targetOffset=0,t!==e){let o=t;for(;o&&o!==e;)n.x.targetOffset+=o.offsetLeft,n.y.targetOffset+=o.offsetTop,o=o.offsetParent}n.x.targetLength=t===e?t.scrollWidth:t.clientWidth,n.y.targetLength=t===e?t.scrollHeight:t.clientHeight,n.x.containerLength=e.clientWidth,n.y.containerLength=e.clientHeight}function YP(e,t,n,o={}){return{measure:()=>KP(e,o.target,n),update:s=>{BP(e,n,s),(o.offset||o.target)&&qP(e,n,o)},notify:()=>t(n)}}const ii=new WeakMap,Zv=new WeakMap,Mm=new WeakMap,Jv=e=>e===document.documentElement?window:e;function Th(e,{container:t=document.documentElement,...n}={}){let o=Mm.get(t);o||(o=new Set,Mm.set(t,o));const s=FP(),a=YP(t,e,s,n);if(o.add(a),!ii.has(t)){const i=()=>{for(const g of o)g.measure()},d=()=>{for(const g of o)g.update(ji.timestamp)},m=()=>{for(const g of o)g.notify()},p=()=>{kn.read(i,!1,!0),kn.read(d,!1,!0),kn.update(m,!1,!0)};ii.set(t,p);const h=Jv(t);window.addEventListener("resize",p,{passive:!0}),t!==document.documentElement&&Zv.set(t,OP(t,p)),h.addEventListener("scroll",p,{passive:!0})}const r=ii.get(t);return kn.read(r,!1,!0),()=>{var i;Bu(r);const d=Mm.get(t);if(!d||(d.delete(a),d.size))return;const m=ii.get(t);ii.delete(t),m&&(Jv(t).removeEventListener("scroll",m),(i=Zv.get(t))===null||i===void 0||i(),window.removeEventListener("resize",m))}}function ZP({source:e,container:t,axis:n="y"}){e&&(t=e);const o={value:0},s=Th(a=>{o.value=a[n].progress*100},{container:t,axis:n});return{currentTime:o,cancel:s}}const Rm=new Map;function iI({source:e,container:t=document.documentElement,axis:n="y"}={}){e&&(t=e),Rm.has(t)||Rm.set(t,{});const o=Rm.get(t);return o[n]||(o[n]=I8()?new ScrollTimeline({source:t,axis:n}):ZP({source:t,axis:n})),o[n]}function JP(e){return e.length===2}function cI(e){return e&&(e.target||e.offset)}function QP(e,t){return JP(e)||cI(t)?Th(n=>{e(n[t.axis].progress,n)},t):rI(e,iI(t))}function XP(e,t){if(e.flatten(),cI(t))return e.pause(),Th(n=>{e.time=e.duration*n[t.axis].progress},t);{const n=iI(t);return e.attachTimeline?e.attachTimeline(n,o=>(o.pause(),rI(s=>{o.time=o.duration*s},n))):Ms}}function eM(e,{axis:t="y",...n}={}){const o={axis:t,...n};return typeof e=="function"?QP(e,o):XP(e,o)}function Qv(e,t){m7(!!(!t||t.current))}const tM=()=>({scrollX:or(0),scrollY:or(0),scrollXProgress:or(0),scrollYProgress:or(0)});function nM({container:e,target:t,layoutEffect:n=!0,...o}={}){const s=qo(tM);return(n?cc:l.useEffect)(()=>(Qv("target",t),Qv("container",e),eM((r,{x:i,y:d})=>{s.scrollX.set(i.current),s.scrollXProgress.set(i.progress),s.scrollY.set(d.current),s.scrollYProgress.set(d.progress)},{...o,container:e?.current||void 0,target:t?.current||void 0})),[e,t,JSON.stringify(o.offset)]),s}function lI(e){const t=qo(()=>or(e)),{isStatic:n}=l.useContext(da);if(n){const[,o]=l.useState(e);l.useEffect(()=>t.on("change",o),[])}return t}function uI(e,t){const n=lI(t()),o=()=>n.set(t());return o(),cc(()=>{const s=()=>kn.preRender(o,!1,!0),a=e.map(r=>r.on("change",s));return()=>{a.forEach(r=>r()),Bu(o)}}),n}function oM(e,t={}){const{isStatic:n}=l.useContext(da),o=l.useRef(null),s=qo(()=>Ko(e)?e.get():e),a=qo(()=>typeof s=="string"?s.replace(/[\d.-]/g,""):void 0),r=lI(s),i=l.useRef(s),d=l.useRef(Ms),m=()=>{p(),o.current=_P({keyframes:[ey(r.get()),ey(i.current)],velocity:r.getVelocity(),type:"spring",restDelta:.001,restSpeed:.01,...t,onUpdate:d.current})},p=()=>{o.current&&o.current.stop()};return l.useInsertionEffect(()=>r.attach((h,g)=>n?g(h):(i.current=h,d.current=y=>g(Xv(y,a)),kn.postRender(m),r.get()),p),[JSON.stringify(t)]),cc(()=>{if(Ko(e))return e.on("change",h=>r.set(Xv(h,a)))},[r,a]),r}function Xv(e,t){return t?e+t:e}function ey(e){return typeof e=="number"?e:parseFloat(e)}const sM=e=>e&&typeof e=="object"&&e.mix,aM=e=>sM(e)?e.mix:void 0;function rM(...e){const t=!Array.isArray(e[0]),n=t?0:-1,o=e[0+n],s=e[1+n],a=e[2+n],r=e[3+n],i=Eh(s,a,{mixer:aM(a[0]),...r});return t?i(o):i}function iM(e){Ei.current=[],e();const t=uI(Ei.current,e);return Ei.current=void 0,t}function eu(e,t,n,o){if(typeof e=="function")return iM(e);const s=typeof t=="function"?t:rM(t,n,o);return Array.isArray(e)?ty(e,s):ty([e],([a])=>s(a))}function ty(e,t){const n=qo(()=>[]);return uI(e,()=>{n.length=0;const o=e.length;for(let s=0;s<o;s++)n[s]=e[s].get();return t(n)})}const cM={some:0,all:1};function lM(e,t,{root:n,margin:o,amount:s="some"}={}){const a=aI(e),r=new WeakMap,i=m=>{m.forEach(p=>{const h=r.get(p.target);if(p.isIntersecting!==!!h)if(p.isIntersecting){const g=t(p.target,p);typeof g=="function"?r.set(p.target,g):d.unobserve(p.target)}else typeof h=="function"&&(h(p),r.delete(p.target))})},d=new IntersectionObserver(i,{root:n,rootMargin:o,threshold:typeof s=="number"?s:cM[s]});return a.forEach(m=>d.observe(m)),()=>d.disconnect()}function wh(e,{root:t,margin:n,amount:o,once:s=!1,initial:a=!1}={}){const[r,i]=l.useState(a);return l.useEffect(()=>{if(!e.current||s&&r)return;const d=()=>(i(!0),s?void 0:()=>i(!1)),m={root:t&&t.current||void 0,margin:n,amount:o};return lM(e.current,d,m)},[t,e,n,s,o]),r}const dI=l.createContext(void 0);function uM(){return l.useContext(dI)}function dM(e){const{children:t,randomSeed:n}=e;return c.jsx(dI.Provider,{value:n,children:t})}const mM=()=>N(()=>import("./react-DnKNOS96.js"),__vite__mapDeps([0,1,2])).then(e=>e.domMax);function pM(e){const{children:t,queryClient:n,randomSeed:o}=e;return c.jsx(Cb,{reducedMotion:"user",children:c.jsx(h7,{features:mM,strict:!0,children:c.jsx(h9,{client:n,children:c.jsx(dM,{randomSeed:o,children:t})})})})}const Ah=new g9({defaultOptions:{queries:{retry:0,refetchOnWindowFocus:!1}}});l.createContext(null);const mI=[{name:"Arabic",i18nCode:"ar",direction:"rtl"},{name:"Basque",i18nCode:"eu",direction:"ltr"},{name:"Bengali",i18nCode:"bn-IN",direction:"ltr"},{name:"Bulgarian",i18nCode:"bg",direction:"ltr"},{name:"Catalan",i18nCode:"ca",direction:"ltr"},{name:"Chinese (Simplified)",i18nCode:"zh-Hans",direction:"ltr"},{name:"Chinese (Traditional)",i18nCode:"zh-Hant",direction:"ltr"},{name:"Croatian",i18nCode:"hr",direction:"ltr"},{name:"Czech",i18nCode:"cs",direction:"ltr"},{name:"Danish",i18nCode:"da",direction:"ltr"},{name:"Dutch",i18nCode:"nl",direction:"ltr"},{name:"English (US)",i18nCode:"en-US",direction:"ltr"},{name:"English (UK)",i18nCode:"en-GB",direction:"ltr"},{name:"Estonian",i18nCode:"et",direction:"ltr"},{name:"Finnish",i18nCode:"fi",direction:"ltr"},{name:"French",i18nCode:"fr",direction:"ltr"},{name:"Galician",i18nCode:"gl",direction:"ltr"},{name:"German",i18nCode:"de",direction:"ltr"},{name:"Gujarati",i18nCode:"gu",direction:"ltr"},{name:"Hebrew",i18nCode:"he",direction:"rtl"},{name:"Hindi",i18nCode:"hi",direction:"ltr"},{name:"Hungarian",i18nCode:"hu",direction:"ltr"},{name:"Icelandic",i18nCode:"is",direction:"ltr"},{name:"Indonesian",i18nCode:"id",direction:"ltr"},{name:"Italian",i18nCode:"it",direction:"ltr"},{name:"Japanese",i18nCode:"ja",direction:"ltr"},{name:"Kannada",i18nCode:"kn",direction:"ltr"},{name:"Korean",i18nCode:"ko",direction:"ltr"},{name:"Latvian",i18nCode:"lv",direction:"ltr"},{name:"Lithuanian",i18nCode:"lt",direction:"ltr"},{name:"Malay",i18nCode:"ms",direction:"ltr"},{name:"Malayalam",i18nCode:"ml",direction:"ltr"},{name:"Marathi",i18nCode:"mr",direction:"ltr"},{name:"Norwegian (Bokml)",i18nCode:"nb-NO",direction:"ltr"},{name:"Polish",i18nCode:"pl",direction:"ltr"},{name:"Portuguese (Brazil)",i18nCode:"pt-BR",direction:"ltr"},{name:"Portuguese (Portugal)",i18nCode:"pt-PT",direction:"ltr"},{name:"Punjabi",i18nCode:"pa",direction:"ltr"},{name:"Romanian",i18nCode:"ro",direction:"ltr"},{name:"Russian",i18nCode:"ru",direction:"ltr"},{name:"Serbian (Latin)",i18nCode:"sr-Latn-RS",direction:"ltr"},{name:"Slovak",i18nCode:"sk",direction:"ltr"},{name:"Slovenian",i18nCode:"sl",direction:"ltr"},{name:"Spanish",i18nCode:"es",direction:"ltr"},{name:"Swedish",i18nCode:"sv",direction:"ltr"},{name:"Tamil",i18nCode:"ta",direction:"ltr"},{name:"Telugu",i18nCode:"te",direction:"ltr"},{name:"Thai",i18nCode:"th",direction:"ltr"},{name:"Turkish",i18nCode:"tr",direction:"ltr"},{name:"Ukrainian",i18nCode:"uk",direction:"ltr"},{name:"Vietnamese",i18nCode:"vi",direction:"ltr"}],pI=mI.map(e=>e.i18nCode);function xh(e){const t="en-US";if(!e)return[t];const n=fM(e),o=hM(e),s=gM(e);return[n,o,s,t].filter(a=>!!a).filter((a,r,i)=>i.indexOf(a)===r)}function fM(e){return pI.find(t=>t.toLowerCase()===e.toLowerCase())}function hM(e){if(["en-AU","en-NZ","en-IE"].includes(e))return"en-GB";if(e.startsWith("zh-")){const t=e.toLocaleLowerCase();return t==="zh-TW".toLocaleLowerCase()||t==="zh-HK".toLocaleLowerCase()?"zh-Hant":"zh-Hans"}}function gM(e){const t=e.split("-")[0]?.toLowerCase();if(t){const n=pI.find(o=>o.toLowerCase()===t||o.toLowerCase().startsWith(`${t}-`));if(n)return n}}const vM=f({lng:u(),resources:Rn(u(),f({translation:Rn(u(),u())}))});function yM(e){return vM.safeParse(e).success}const CM="__i18n-data__";function SM(e){if(typeof window>"u")return;const t=document.getElementById(e);if(!(!t||t.tagName!=="SCRIPT"||!t.textContent))try{return JSON.parse(t.textContent)}catch{return}}function bM(e,t){const n=SM(e);return n!==void 0&&t(n)?n:void 0}const Ss="colorTheme",tu="userSidebarOpen",fI="greetingKey",jp="greetingName",gr="hasBeenMsalAuthenticated";function Ca(e){const t={title:"og:title",siteName:"og:site_name",description:"og:description",type:"og:type",url:"og:url",imageUrl:"og:image",imageWidth:"og:image:width",imageHeight:"og:image:height"},n=[];for(const[o,s]of Object.entries(e))s&&n.push({property:t[o],content:s});return n}const IM="@MSFTCopilot";function Sa(e){const t={title:"twitter:title",description:"twitter:description",card:"twitter:card",image:"twitter:image"},n=[];for(const[o,s]of Object.entries(e))s&&n.push({name:t[o],content:s});return n.push({name:"twitter:site",content:IM}),n}const EM="noindex, nofollow";async function Rs(e){try{return await e()}catch(t){throw t}}function TM(e){const{Root:t,routerConfig:n={}}=e;return v9()({head:void 0,...n,component:()=>c.jsxs(c.Fragment,{children:[c.jsx(t,{}),!1]})})}const wM="/static/cmc/assets/copilot-qr-dark-desktop-setting-banner-CqsoJ8gk.webp",AM="/static/cmc/assets/copilot-qr-light-desktop-setting-banner-C2lNCEe_.webp",ny="/static/cmc/assets/copilot-qr-light-shopping-Dm2se5Rq.png",xM={appLayout:{showSettings:!0,showCookieBanner:!0,showMobileCrossSelling:!0},surfaceQueryParam:null,showScrollbarOnHover:!1,dailyBriefingOcid:"cp_msn_cmc",persistThemeChoice:!0,entraRedirectModalBehaviour:"replace",redirectBackEnabled:!0,crossPromotion:{settingBanner:{dark:wM,light:AM}},connectorPlatform:{isGoogleDriveEnabled:!0,isGoogleCalendarEnabled:!0,isOutlookEnabled:!0,isOneDriveEnabled:!0,isGmailEnabled:!0,isGoogleContactsEnabled:!0,isEdgeBrowserEnabled:!0},proSubscription:{enabled:!0,manageRefId:"cmc",urlParams:{ocids:{Management:{buy:"cmmw7mw3yqb"},"Management-FromWinNative":{buy:"cmmuqx95kk5"},"Management-FromWinChromium":{buy:"cmmuqx95kk5"},Settings:{buy:"cmma1qqdrup"},"Settings-FromWinNative":{buy:"cmmgeuw7z2g"},"Settings-FromWinChromium":{buy:"cmmgeuw7z2g"},Unknown:{buy:"cmmipliy5qj"},VisionLimit:{buy:"cmm1z6j7vhd"},"VisionLimit-FromWinNative":{buy:"cmmipxlurfj"},"VisionLimit-FromWinChromium":{buy:"cmmipxlurfj"},"VisionLimit-FromEdge":{buy:"cmmkxmbp63s"},"VisionLimit-FromEdgeCopilotMode":{buy:"cmmtardi03n"},PodcastLimit:{buy:"cmml80k74li"},"PodcastLimit-FromWinNative":{buy:"cmmeqe0ui7z"},"PodcastLimit-FromWinChromium":{buy:"cmmeqe0ui7z"},"PodcastLimit-FromEdgeCopilotMode":{buy:"cmmxl5ui5bi"},ActionsLimit:{buy:"cmm77pn9501"},"ActionsLimit-FromWinNative":{buy:"cmm5tgy4bxa"},"ActionsLimit-FromWinChromium":{buy:"cmm5tgy4bxa"},"ActionsLimit-FromEdgeCopilotMode":{buy:"cmmq2as5182"},VideoGenLimit:{buy:"cmmbme9rppw"},"VideoGenLimit-FromWinNative":{buy:"cmmz6nczsl1"},"VideoGenLimit-FromWinChromium":{buy:"cmmz6nczsl1"},"VideoGenLimit-FromEdgeCopilotMode":{buy:"cmmvlp7mpo5"},DeepResearchLimit:{buy:"cmmnfbwmed3"},"DeepResearchLimit-FromWinNative":{buy:"cmmoehrafkb"},"DeepResearchLimit-FromWinChromium":{buy:"cmmoehrafkb"},"DeepResearchLimit-FromEdgeCopilotMode":{buy:"cmm8w5fhoop"},UpsellProToPremium:{buy:"cmm7zptzbn8"},"UpsellProToPremium-FromWinNative":{buy:"cmmtftzk1ke"},"UpsellProToPremium-FromWinChromium":{buy:"cmmtftzk1ke"},UpsellPFToPremium:{buy:"cmmmomom1i8"},"UpsellPFToPremium-FromWinNative":{buy:"cmmmkce74lz"},"UpsellPFToPremium-FromWinChromium":{buy:"cmmmkce74lz"},UpsellFreeInSidePane:{buy:"cmmdc6nkdch"},"UpsellFreeInSidePane-FromWinChromium":{buy:"cmm7276zt38"},"Management-FromEdge":{buy:"cmms9lc34s3"},"Management-FromEdgeCopilotMode":{buy:"cmmmpw9yzgm"}}},upsellFromAuth0:{navigateToProSubPageAfterLogin:!0}},adsEnabled:!0,adsShowroomEnabled:!0,thinkDeeperFreemiumEnabled:!0,monitorAccountChangesAcrossTabs:!0,shopping:{upsell:{banner:{light:ny,dark:ny}},showPdpSidepane:!0,payment:{isPayPalCheckoutEnabled:!0}},sidebarNavigation:!0,enableAuth0:!0,enableMultiAuthProviders:!0,settingsOverrides:{shouldShowActivityHistory:!0,shouldShowMemoryDelete:!0,shouldShowEdgePasswordsAccessSetting:!0,includeScrollForLightDismiss:!1},enableCustom1DS:!0,actions:{enableActions:()=>Promise.resolve(!0)},landingPage:{enableCentralComposer:!0,enableStarterPrompts:!0,enableAutoSuggest:!0,enablePromptedGreetings:!0,shouldFetchWidgetsData:!0,regexForAutoSuggest:/\S+/},supportsYouTubeVideos:!0,useMSALPwBApp:!0,isBotDetectionEnabled:!0,enableLabs:!0,supportsChatDetails:!0,pages:{enableEditorImageUpload:!0},webWorkerEnabled:!0};class J{cfg=xM;static singleton=null;static instance(){return J.singleton??=new J,J.singleton}config(){return this.cfg}setConfig(t){this.cfg=t}}function _M(e,t){return e.addEventListener("change",t),()=>e.removeEventListener("change",t)}function _h(e){const t=l.useMemo(()=>typeof window<"u"?window.matchMedia(e):null,[e]),[n,o]=l.useState(!!t?.matches);return l.useEffect(()=>{if(t)return o(t.matches),_M(t,s=>o(s.matches))},[t]),n}function hI(e){const{children:t,serverFallback:n=null}=e;return ba()?t:n}function ba(){return l.useSyncExternalStore(kM,()=>!0,()=>!1)}function kM(){return()=>{}}const gI={sm:"640",md:"768",lg:"1024",xl:"1280","2xl":"1536","3xl":"1920"};function gt(e){const{breakpoint:t}=e,n=gI[t],o=!_h(`(min-width: ${n}px)`);return ba()?o:!1}function Gu(e){const{breakpoint:t}=e,o=`(min-width: ${gI[t]}px)`;return!(typeof window<"u"&&typeof window.matchMedia=="function"?window.matchMedia(o):null)?.matches}function Eo(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function nu(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function pc(e,t){const n=Eo(e);return isNaN(t)?nu(e,NaN):(t&&n.setDate(n.getDate()+t),n)}const vI=typeof document<"u",PM=typeof navigator<"u";function MM(e,t){if(vI)return document.cookie.split(";").filter(n=>n.trim().startsWith(`${e}=`)).at(t)}function Yo(e,t=0){const n=MM(e,t),o=n?.indexOf("=");if(!n||typeof o!="number"||o===-1)return;const s=n.substring(o+1);if(s)return decodeURIComponent(s)}function Zo(e,t,n={}){const{expireDays:o,path:s="/",domain:a,secure:r=!0,host:i}=n;if(!vI)return;let d=e;r&&!a&&s==="/"&&i&&(d=`__Host-${e}`);let m=`${d}=${encodeURIComponent(t)}; path=${s}`;if(o){const p=pc(new Date,o);m+=`; expires=${p.toUTCString()}`}a&&(m+=`; domain=${a}`),r&&(m+="; secure"),document.cookie=m}function vr(e,t={}){Zo(e,"",{...t,expireDays:-1})}const tr={name:"CMCCP",expirationDays:365},Wu={name:"BCP"},RM="3PAdsOptOut";function kh(){return Yo(tr.name)??Yo(Wu.name)}function oy(e,t){const{analytics:n,advertising:o,socialMedia:s}=e,a=new URLSearchParams;a.set("AD",o?"1":"0"),a.set("AL",n?"1":"0"),a.set("SM",s?"1":"0");const r=pc(new Date,t);return a.set("expires",r.getTime().toString()),a.toString()}function NM(e){Zo(tr.name,oy(e,tr.expirationDays),{expireDays:tr.expirationDays}),Zo(Wu.name,oy(e,tr.expirationDays),{expireDays:tr.expirationDays})}function Ia(){const e=Yo(Wu.name);if(!e)return{advertising:!1,analytics:!1,socialMedia:!1};const t=new URLSearchParams(e),n=t.get("AD")==="1",o=t.get("AL")==="1",s=t.get("SM")==="1";return{advertising:n,analytics:o,socialMedia:s}}function yI(){const e=Yo(RM)!=="1";return PM?navigator.globalPrivacyControl?!1:e:!1}function $u(){if(!(typeof window>"u"))return window.isStudioSsr?"ssr":"csr"}const sy="mobileCrossSellingLastClosed",Nm="mobilePromoCountClose",LM="hasBeenAuthenticated",Ph="auth0MigrationInteractionRequired",qu="auth0MigrationLinkForbidden",ou="auth0MigrationLinkFailed",su="auth0UserAvatar",Hi="auth0UserName",Ku="newConversationsStarted",yr="timeOfNewConversationThreshold",Bp="hasResetConversationDisclaimer",Vp="banAppealSubmitted",CIe="hideDeleteConversationModal",DM="hasSeenCharacter",ay="voiceAppearanceId",ry="voiceLiveCaptionEnabled",OM="disableAppearanceOnHomeScreen",CI="hasSeenAppearance",SIe="hasSeenAppearanceDeviceCompatNoticeToast",UM="hasSeenAppearanceOnVoiceCall",FM="hasSeenFirstRunExperienceAnimation",jM="hasClickedAppearanceEducationModal",BM="hasUsedAppearanceColorShuffler",VM="hasUsedAppearanceVoiceCustomization",au="voiceCallCount",HM="unlockedSpecialEvents",iy="actionOnAppearanceDiscoveryCta",cy="crossPromoFirstVisit",ly="reviewActiveDays",Hp="reviewPromptResponse",zM="coachmark",GM="isMsalSilentSsoEnabled",SI="user.UserFirstName",WM="m365WxpHistorySyncEnabled",zp="loginStartTime",Gp="reauthLoginFlag",bIe="m365.consent.modal.showed",IIe="subscription.m365SubscriberFRE",uy="userConversationVoiceSpeed",Wp="3pMigrationPhase1Enabled",$p="test3rdPartyCookie",$M="copilotBeta",qM="copilotBetaAnnouncementRequired",bI="msalSilentSsoLastRunAt",KM="copilotVisionLastClicked",YM="hasEnteredGalleryDetailFromHome",EIe="portraitsConfig",dy="voiceFeedbackReviewRequestRejected",TIe="appearanceLowFpsStats",wIe="hasClickedPersonalityAdjustment";function $t(e,t){typeof window<"u"&&localStorage.setItem(e,t)}function kt(e){return typeof window<"u"?localStorage.getItem(e):null}function mt(e){typeof window<"u"&&localStorage.removeItem(e)}function qt(e,t){const n=kt(e);if(!n)return null;try{const o=JSON.parse(n);return t.parse(o)}catch{return null}}function Jo(e,t,n){try{t.parse(n),$t(e,JSON.stringify(n))}catch{}}const Mh=Q([v("open"),v("close")]),II=f({sidebarVisibility:Mh.optional()});function ZM(e){Jo(tu,II,{sidebarVisibility:e}),Zo(tu,e,{expireDays:365*10})}function JM(e){const t=Mh.safeParse(e);return t.success?t.data:"close"}function EI(){const e=Mh.safeParse(Yo(tu));if(e.success)return e.data;const t=$u()==="ssr"?void 0:qt(tu,II)?.sidebarVisibility;return JM(t)}function QM(){return J.instance().config().sidebarNavigation?EI()!=="close":!1}const ur=_({left:QM(),right:!1}),To=_(e=>e(ur).left,(e,t,n)=>{const o=e(ur);t(ur,{left:n,right:n&&Gu({breakpoint:"xl"})?!1:o.right})}),fc=_(e=>e(ur).right,(e,t,n)=>{const o=e(ur);t(ur,{left:n&&Gu({breakpoint:"xl"})?!1:o.left,right:n})});function XM(){return J.instance().config().sidebarNavigation??!1}const eR=_(XM());function tR(e){const{children:t,routeId:n}=e,{i18n:o,entryPointScript:s,nonce:a,theme:r,sidebarOpen:i}=y9({from:n});return c.jsxs(c.Fragment,{children:[t,c.jsx(C9,{})]})}const TI=l.createContext(null),Lm={didCatch:!1,error:null};class wI extends l.Component{constructor(t){super(t),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=Lm}static getDerivedStateFromError(t){return{didCatch:!0,error:t}}resetErrorBoundary(){const{error:t}=this.state;if(t!==null){for(var n,o,s=arguments.length,a=new Array(s),r=0;r<s;r++)a[r]=arguments[r];(n=(o=this.props).onReset)===null||n===void 0||n.call(o,{args:a,reason:"imperative-api"}),this.setState(Lm)}}componentDidCatch(t,n){var o,s;(o=(s=this.props).onError)===null||o===void 0||o.call(s,t,n)}componentDidUpdate(t,n){const{didCatch:o}=this.state,{resetKeys:s}=this.props;if(o&&n.error!==null&&nR(t.resetKeys,s)){var a,r;(a=(r=this.props).onReset)===null||a===void 0||a.call(r,{next:s,prev:t.resetKeys,reason:"keys"}),this.setState(Lm)}}render(){const{children:t,fallbackRender:n,FallbackComponent:o,fallback:s}=this.props,{didCatch:a,error:r}=this.state;let i=t;if(a){const d={error:r,resetErrorBoundary:this.resetErrorBoundary};if(typeof n=="function")i=n(d);else if(o)i=l.createElement(o,d);else if(s!==void 0)i=s;else throw r}return l.createElement(TI.Provider,{value:{didCatch:a,error:r,resetErrorBoundary:this.resetErrorBoundary}},i)}}function nR(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return e.length!==t.length||e.some((n,o)=>!Object.is(n,t[o]))}function oR(e){if(e==null||typeof e.didCatch!="boolean"||typeof e.resetErrorBoundary!="function")throw new Error("ErrorBoundaryContext not found")}function AI(){const e=l.useContext(TI);oR(e);const[t,n]=l.useState({error:null,hasError:!1}),o=l.useMemo(()=>({resetBoundary:()=>{e.resetErrorBoundary(),n({error:null,hasError:!1})},showBoundary:s=>n({error:s,hasError:!0})}),[e.resetErrorBoundary]);if(t.hasError)throw t.error;return o}const Rh=_(!1),ut=_(null),my=_(null),py=_(null),hc=_(e=>{const t=e(ut);return t?t.accountType==="AAD":!1}),Yu=_(e=>{const t=e(ut);return t?t.accountType==="MSA":!1}),AIe=_(e=>e(ut)!==null),bs=_(null),sR=_(!0);function gc(e){const t=_(e,(n,o,s)=>o(t,Xt(n(t),typeof s=="function"?s:()=>s)));return t}function Nh(e,t){const n=G(e);return l.useCallback(o=>n(Xt(o)),[n])}const vc={Namibia:"NA","South Africa":"ZA",Cameroon:"CM",Japan:"JP",Ghana:"GH",Ethiopia:"ET","United States":"US","United Arab Emirates":"AE",Bahrain:"BH",Djibouti:"DJ",Algeria:"DZ",Egypt:"EG","Western Sahara":"EH",Eritrea:"ER",Israel:"IL",Iraq:"IQ",Jordan:"JO",Comoros:"KM",Kuwait:"KW",Lebanon:"LB",Libya:"LY",Morocco:"MA",Mauritania:"MR",Oman:"OM","Palestinian Territories":"PS",Qatar:"QA","Saudi Arabia":"SA",Sudan:"SD",Somalia:"SO","South Sudan":"SS",Syria:"SY",Chad:"TD",Tunisia:"TN",Yemen:"YE",Chile:"CL",India:"IN",Tanzania:"TZ",Spain:"ES",Azerbaijan:"AZ",Russia:"RU",Belarus:"BY",Zambia:"ZM",Bulgaria:"BG",Mali:"ML",Bangladesh:"BD","China mainland":"CN",France:"FR","Bosnia & Herzegovina":"BA",Andorra:"AD",Italy:"IT",Philippines:"PH",Uganda:"UG",Iran:"IR",Czechia:"CZ","United Kingdom":"GB",Denmark:"DK",Greenland:"GL",Kenya:"KE",Austria:"AT",Belgium:"BE",Switzerland:"CH",Germany:"DE",Liechtenstein:"LI",Luxembourg:"LU",Niger:"NE",Maldives:"MV",Senegal:"SN",Bhutan:"BT",Togo:"TG",Cyprus:"CY",Greece:"GR","Antigua & Barbuda":"AG",Anguilla:"AI",Albania:"AL",Argentina:"AR","American Samoa":"AS",Australia:"AU",Barbados:"BB",Burundi:"BI",Bermuda:"BM",Brunei:"BN",Brazil:"BR",Bahamas:"BS",Botswana:"BW",Belize:"BZ",Canada:"CA","Cocos (Keeling) Islands":"CC","Cook Islands":"CK",Colombia:"CO","Cape Verde":"CV","Christmas Island":"CX","Diego Garcia":"DG",Dominica:"DM",Estonia:"EE",Finland:"FI",Fiji:"FJ","Falkland Islands":"FK",Micronesia:"FM",Grenada:"GD",Guernsey:"GG",Gibraltar:"GI",Gambia:"GM",Guam:"GU",Guyana:"GY","Hong Kong":"HK",Hungary:"HU",Indonesia:"ID",Ireland:"IE","Isle of Man":"IM","Chagos Archipelago":"IO",Jersey:"JE",Jamaica:"JM",Kiribati:"KI","St. Kitts & Nevis":"KN","South Korea":"KR","Cayman Islands":"KY","St. Lucia":"LC",Liberia:"LR",Lesotho:"LS",Lithuania:"LT",Latvia:"LV",Madagascar:"MG","Marshall Islands":"MH","Myanmar (Burma)":"MM",Macao:"MO","Northern Mariana Islands":"MP",Montserrat:"MS",Malta:"MT",Mauritius:"MU",Malawi:"MW",Mexico:"MX",Malaysia:"MY","Norfolk Island":"NF",Nigeria:"NG",Netherlands:"NL",Norway:"NO",Nauru:"NR",Niue:"NU","New Zealand":"NZ","Papua New Guinea":"PG",Pakistan:"PK",Poland:"PL","Pitcairn Islands":"PN","Puerto Rico":"PR",Portugal:"PT",Palau:"PW",Rwanda:"RW","Solomon Islands":"SB",Seychelles:"SC",Sweden:"SE",Singapore:"SG","St. Helena":"SH",Slovenia:"SI",Slovakia:"SK","Sierra Leone":"SL","Sint Maarten":"SX",Eswatini:"SZ","Turks & Caicos Islands":"TC",Thailand:"TH",Tokelau:"TK",Tonga:"TO",Trkiye:"TR","Trinidad & Tobago":"TT",Tuvalu:"TV",Taiwan:"TW",Ukraine:"UA","U.S. Outlying Islands":"UM","St. Vincent & Grenadines":"VC","British Virgin Islands":"VG","U.S. Virgin Islands":"VI",Vanuatu:"VU",Samoa:"WS",Zimbabwe:"ZW",Bolivia:"BO","Caribbean Netherlands":"BQ","Costa Rica":"CR",Cuba:"CU",Curaao:"CW","Dominican Republic":"DO","Ceuta & Melilla":"EA",Ecuador:"EC","Equatorial Guinea":"GQ",Guatemala:"GT",Honduras:"HN",Haiti:"HT","Canary Islands":"IC",Nicaragua:"NI",Panama:"PA",Peru:"PE",Paraguay:"PY","El Salvador":"SV",Uruguay:"UY",Venezuela:"VE",Afghanistan:"AF","Burkina Faso":"BF",Guinea:"GN","Guinea-Bissau":"GW","Faroe Islands":"FO",Benin:"BJ","St. Barthlemy":"BL","Congo - Kinshasa":"CD","Central African Republic":"CF","Congo - Brazzaville":"CG","Cte d'Ivoire":"CI",Gabon:"GA","French Guiana":"GF",Guadeloupe:"GP",Monaco:"MC","St. Martin":"MF",Martinique:"MQ","New Caledonia":"NC","French Polynesia":"PF","St. Pierre & Miquelon":"PM",Runion:"RE","Wallis & Futuna":"WF",Mayotte:"YT",Croatia:"HR",Armenia:"AM",Iceland:"IS","San Marino":"SM","Vatican City":"VA",Georgia:"GE",Kazakhstan:"KZ",Cambodia:"KH","North Korea":"KP",Kyrgyzstan:"KG",Angola:"AO",Laos:"LA",Mozambique:"MZ","North Macedonia":"MK",Mongolia:"MN","Svalbard & Jan Mayen":"SJ",Nepal:"NP",Aruba:"AW",Suriname:"SR","So Tom & Prncipe":"ST","Timor-Leste":"TL",Moldova:"MD",Romania:"RO","Sri Lanka":"LK",Kosovo:"XK",Montenegro:"ME",Serbia:"RS","land Islands":"AX",Tajikistan:"TJ",Turkmenistan:"TM",Uzbekistan:"UZ",Vietnam:"VN"},xI=["blowing-dust","blowing-sand","blowing-snow","clear","clear-occasional-rain-or-thunderstorms","clear-then-cloudy","clear-then-occasional-rain","clear-then-occasional-snow","clear-then-rain","clear-then-rain-or-snow","clear-then-rain-or-thunderstorms","clear-then-snow","clear-then-snow-or-rain","clear-then-thunderstorms","clear-with-isolated-snow","clear-with-isolated-thunderstorms","clear-with-occasional-clouds","clear-with-occasional-rain","clear-with-occasional-rain-or-snow","clear-with-occasional-snow","clear-with-occasional-snow-or-rain","cloudy","cloudy-and-occasionally-clear","cloudy-occasional-rain-or-thunderstorms","cloudy-then-clear","cloudy-then-occasional-rain","cloudy-then-occasional-snow","cloudy-then-occasionally-clear","cloudy-then-rain","cloudy-then-rain-or-snow","cloudy-then-rain-or-thunderstorms","cloudy-then-snow","cloudy-then-snow-or-rain","cloudy-with-isolated-rain","cloudy-with-occasional-rain","cloudy-with-occasional-rain-or-snow","cloudy-with-occasional-snow","cloudy-with-occasional-snow-or-rain","cloudy-with-thundersnow-at-times","drifting-sand","drifting-snow","drizzle","duststorm","fair","fog","freezing-drizzle","freezing-fog","freezing-rain","hail","haze","heavy-drizzle","heavy-rain","heavy-snow","heavy-thunderstorms","ice-pellets","light-drizzle","light-fog","light-freezing-drizzle","light-freezing-rain","light-hail","light-rain","light-rain-and-snow","light-rain-and-snow-shower","light-rain-shower","light-snow","light-snow-shower","mostly-clear","mostly-cloudy","mostly-sunny","partly-cloudy","partly-sunny","patchy-fog","rain","rain-and-occasionally-clear","rain-and-occasionally-cloudy","rain-and-snow","rain-and-snow-shower","rain-or-snow","rain-or-snow-then-clear","rain-or-snow-then-cloudy","rain-showers","rain-then-clear","rain-then-cloudy","rain-then-occasional-snow","rain-turning-to-snow","rain-with-occasional-snow","severe-duststorm","sleet","smoke","snow","snow-and-occasionally-clear","snow-and-occasionally-cloudy","snow-or-rain","snow-or-rain-then-clear","snow-or-rain-then-cloudy","snow-showers","snow-then-clear","snow-then-cloudy","snow-then-rain","squalls","sunny","thundersnow","thunderstorms","unknown","windy-rainstorm","windy-with-heavy-snow"],aR=["adult","teen"],rR=["twenty-four-hours","one-day","five-days","one-week","one-month","one-year","five-years","max"],iR=["pro","m365-basic","m365-personal-classic","m365-family-classic-admin","m365-family-classic-guest","m365-personal","m365-family-admin","m365-family-guest","m365-premium-admin","m365-premium-guest"],cR=["direct","apple","google","retail"],lR=["guest","free","m365-personal","pro","m365-premium"],uR=["python"],_I=["ready","disconnected","disabled","sign-in-required","unavailable"],kI=["google-drive","google-calendar","gmail","one-drive","outlook","outlook-calendar","google-contacts","google-tasks","edge-browser","apple-health","health-ex","terra","fitbit","target","unknown"],dR=["implicit-consent","explicit-consent"],mR=["enel"],PI=10240,xIe=100,_Ie=2,pR=15e3,kIe=372,PIe=352,fR=6,at={mediaViewer:"z-10",composer:"z-10",composerBottomSlot:"z-20",coachmark:"z-30",chatScrollToBottomButton:"z-20",babylonCharacter:"z-10",chatTopDockedContainer:"z-10",citations:"z-40",settings:"z-30",audioBase:"z-10",audioDisplayContent:"z-40",modalBackground:"z-30",modal:"z-40",sidebar:"z-40",tooltip:"z-40",toastNotification:"z-50",dropdownMenuOverModal:"z-50",pages:{warning:"z-10",chat:"z-20",chatSmallScreenOverlay:"z-50",floatingMenu:"z-50"},shopping:{navigation:"z-10"},stickyHeader:"z-20",header:"z-[60]",default:"z-0",labs3d:{errorPage:"z-20",composerModal:"z-20"},citationHoverCard:"z-40",launchGreeting:"z-10"},Wn={default:.15,slow:.5,composerButton:.2,settings:.1,audio:{available:.5,unavailable:2,deepLinkLanding:.5},dailyBriefing:{background:.5,sourcePopoverScale:.2,sourcePopoverOpacity:.15}},MIe=.25,RIe=2,NIe=0,LIe=2e3,DIe=1e3,OIe=.25,je={opacity:0},rt={opacity:1},hR=.2,gR=.025,UIe={initial:je,animate:{...rt,transition:{delayChildren:hR,staggerChildren:gR}}},MI={willChange:"auto"},vR="9188040d-6c67-4c5b-b112-36a304b66dad",FIe="copilot.cloud.microsoft",jIe="mt-px text-end uppercase text-foreground-450 text-xs dark:text-foreground-600",BIe="flex items-center justify-between text-start",yR=["Austria","Belgium","Brazil","Bulgaria","Canada","Croatia","Cyprus","Czechia","Denmark","Estonia","Finland","France","Germany","Greece","Hungary","Iceland","Ireland","Italy","Latvia","Liechtenstein","Lithuania","Luxembourg","Malta","Netherlands","Norway","China mainland","Poland","Portugal","Romania","Slovakia","Slovenia","Spain","Sweden","Switzerland","Trkiye","United Kingdom"],Zu=yR.map(e=>vc[e]),CR=["Austria","Belgium","Bulgaria","Croatia","Cyprus","Czechia","Denmark","Estonia","Finland","France","Germany","Greece","Hungary","Ireland","Italy","Latvia","Lithuania","Luxembourg","Malta","Netherlands","Poland","Portugal","Romania","Slovakia","Slovenia","Spain","Sweden"],SR=CR.map(e=>vc[e]),bR=["Belarus","China mainland","Lebanon","Macao","Russia","Venezuela","North Korea","Cuba","Syria","Iran"],RI=bR.map(e=>vc[e]),IR="https://account.live.com/ep",ER="Smart",fy="Smart Plus",TR="GPT-5",wR="GPT-5.1",AR="GPT-5.2",VIe=1500,NI=24*60*60*1e3,zi=451,LI="Not allowed child account",Lh="LEGALLY_UNAVAILABLE_STATUS",qp=3,Dm=[80,100,110,125,150],yc=100,xR=1e3,hy=!1,HIe=!1,Dh="/chats/temporary",ru=3,Cc="userInput",_R=14*NI,zIe="voice-reconnected-toast",GIe="https://account.microsoft.com/",WIe="M365",$Ie="https://www.microsoft365.com",qIe="https://www.microsoft.com/microsoft-copilot/learn/#faqs";function Kt(e){const{key:t,schema:n,initialValue:o}=e;return Pu(t,o,{getItem:()=>qt(t,n)??o,setItem:(a,r)=>{r===void 0?mt(t):Jo(t,n,r)},removeItem:()=>mt(t)},{getOnInit:!0})}class Ju extends Error{endpoint;status;constructor(t,n){super(t),this.name="ApiError",this.endpoint=n.route,this.status=n.statusCode}get route(){return this.endpoint}get statusCode(){return this.status}}function Qu(e){const t=e.split("://");return t.length===1?`https://${e}`:t[0]==="http"?`https://${t[1]}`:e}async function kR(e){return new Promise(t=>{let n=!1;e?.catch(o=>{o instanceof Error?(n=!0,t(`Type: ${o.name}, Message: ${o.message}, Stack: ${o.stack}`)):(n=!0,t(`Type: ${typeof o}, Value: ${JSON.stringify(o)}`))}),setTimeout(()=>{n||t("Promise.catch wasn't called. The Promise is not rejected.")},1e3)})}function PR(e){let t;return"route"in e&&typeof e.route=="string"&&(t=e.route),t}function MR(e,t){if(!("route"in e)){const n=e;n.route=t}}class RR{latestClientExperimentationAssignmentRequestId=null;latestApiExperimentationAssignmentRequestId=null;getTraceIdAnalytics(){return{TraceId_LastClientAssignment:this.latestClientExperimentationAssignmentRequestId,TraceId_Latest:this.latestApiExperimentationAssignmentRequestId}}trackClientExperimentationAssignment(t){const n=this.getTraceIdFromResponseHeaders(t);n&&(this.latestClientExperimentationAssignmentRequestId=n)}trackLatestApiAssignment(t){const n=this.getTraceIdFromResponseHeaders(t);n&&(this.latestApiExperimentationAssignmentRequestId=n)}trackLatestChatConnectedAssignment(t){const{requestId:n}=t;this.latestApiExperimentationAssignmentRequestId=n}getTraceIdFromResponseHeaders(t){return(t.get("x-ceto-ref")??"").split("|")[0]??null}}const Gi=new RR;function Xu(){return"aabe15f"}function NR(){return`mscmc@${Xu().substring(0,7)}`}class Ai{static instance=null;listeners=new Map;static getInstance(){return Ai.instance??=new Ai,Ai.instance}on(t,n){this.listeners.has(t)||this.listeners.set(t,[]),this.listeners.get(t)?.push(n)}emit(t,n){const o=this.listeners.get(t);if(o)for(const s of o)s(n)}off(t,n){const o=this.listeners.get(t);o&&this.listeners.set(t,o.filter(s=>s!==n))}}const Ce=Ai.getInstance();function LR(e){let t="unknown";try{const n=/(?:CopilotNative|BingNative|MicrosoftLauncher)\/([0-9]+(?:\.[0-9]+)*(?:-[a-zA-Z0-9]+)?)/,o=e?.match(n);if(o?.[1]){const[,s]=o;t=s}return t}catch{return t}}function Wi(e,t){typeof sessionStorage>"u"||sessionStorage.setItem(e,t)}function Cr(e){return typeof sessionStorage>"u"?null:sessionStorage.getItem(e)}function DR(e){typeof sessionStorage>"u"||sessionStorage.removeItem(e)}const Tt=f({partId:u(),parentPartId:u().nullish()}),nn=f({event:v("invokeAction"),actionId:u()}),gn=nn.extend({actionType:u(),id:u()}),OR=Q([v("blocked"),v("not-allowed")]),DI=f({required:OR,allowed:Q([v("always-allow"),v("allow-once"),v("not-now")]),url:u()}).nullish(),UR=["application/vnd.openxmlformats-officedocument.presentationml.presentation","application/pdf","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","text/plain","text/csv","application/json","application/xml","text/html","text/css","text/javascript","text/markdown","application/javascript","image/jpeg","image/png","image/gif","image/svg+xml","image/webp","audio/mpeg","audio/wav","audio/ogg","video/mp4","video/webm","video/ogg","application/zip","application/x-rar-compressed","application/x-7z-compressed"],FR=z(uR),Sc=z(UR),jR=f({type:v("code"),language:FR,content:u()}),BR=f({type:v("file"),url:u().refine(e=>e.startsWith("/")||Mt().safeParse(e).success,{error:"Must be a valid URL or relative path"}),name:u(),contentType:Sc}),VR=f({type:v("browser"),screenshot:u().optional(),tabIds:k().array().optional(),activeTabId:k().optional()}),HR=fe("type",[jR,BR,VR]),Oh=Q([v("running"),v("completed"),v("failed")]),zR=f({title:u(),status:Oh}),OI=f({status:Oh,title:u(),steps:A(zR),artifacts:A(HR)}),UI=Tt.extend({type:v("activity"),activity:OI}),Et=f({amount:k(),currency:u().nullable(),currencySymbol:u().nullable()}),GR=z(["current-search-term","recent-searches","age","gender","website-visits","interests","custom-audience","similar-audience","profile-targeting"]);z(["multimedia","product","tourActivity","propertyPromotion","text","miniShowroom","mainShowroom"]);const WR=z(["top","bottom","left","right"]),FI=f({adDomain:u(),advertiser:f({name:u(),country:u()}),isVerified:V(),selectionReasons:A(GR)}),Ea=f({url:u(),urlPingSuffix:u()}),ns=f({url:u(),width:k().nullish(),height:k().nullish(),link:Ea.nullish(),impressionToken:u().nullish()}),jI=f({downPayment:u(),description:u()}),$R=f({rating:k(),link:Ea,impressionToken:u()}),bc=f({businessName:u(),image:ns,impressionToken:u().nullish()}),Uh=f({text:u(),url:u(),urlPingSuffix:u()}),qR=f({title:u(),text:u(),url:u(),layout:z(["inline","overlay"])}),Pr=f({impressionToken:u(),selectionCriteria:FI}),BI=f({rowIndex:Ho(),columnIndex:Ho(),textPosition:WR,imagesPerRow:Ho()}),KR=Pr.extend({type:v("multimedia"),description:u(),title:u(),displayUrl:u(),link:Ea,image:ns.nullish(),logo:bc.nullish(),action:Uh.nullish()}),Ic=f({category:u(),value:u()}),VI=f({seller:u(),link:Ea,price:Et,lowPrice:Et.nullish(),item:f({name:u(),image:ns})}),HI=f({isFree:V(),description:u()}),zI=Pr.extend({type:v("product"),offer:VI,tags:A(Ic).nullish(),shipping:HI.nullish(),productRating:$R.nullish(),installment:jI.nullish(),pricePerUnit:u().nullish(),energyRating:u().nullish()}),GI=Pr.extend({type:v("tourActivity"),title:u(),domain:u(),startingPrice:Et,image:ns,link:Ea,tags:A(Ic).nullish()}),WI=Pr.extend({type:v("propertyPromotion"),title:u(),domain:u(),price:Et,image:ns,link:Ea,tags:A(Ic).nullish()}),YR=Pr.extend({type:v("text"),title:u(),description:u(),displayUrl:u(),link:Ea,image:ns.nullish(),logo:bc.nullish(),disclaimer:qR.nullish()}),ZR=Pr.extend({type:v("miniShowroom"),title:u(),description:u(),displayUrl:u(),image:ns,logo:bc.nullish(),brandId:u().nullish(),brandBackground:Ho().nullish()}),$I=f({impressionToken:u(),layout:BI,selectionCriteria:FI.nullish()}),JR=$I.extend({type:v("multimedia"),image:ns,title:u(),description:u(),action:Uh.nullish()}),QR=$I.extend({type:v("product"),offer:VI,shipping:HI.nullish(),installment:jI.nullish(),pricePerUnit:u().nullish()}),XR=Q([QR,JR]),eN=f({ad:XR,adId:u().nullish()}),tN=f({isLoading:V().nullish(),loadErrorCount:Ho().nullish()}),qI=tN.extend({type:v("mainShowroom"),id:u(),impressionToken:u(),brandId:u().nullish(),title:u().nullish(),description:u().nullish(),backgroundColor:Ho().nullish(),images:A(ns).nullish(),logo:bc.nullish(),slotAds:A(eN).nullish(),action:Uh.nullish(),layout:BI.nullish()}),nN=Q([KR,zI,GI,WI,YR,ZR,qI]),oN=Q([zI,GI,WI]),Fh=f({pageLoadPingUrl:u(),visibilityPingUrlBase:u(),clickPingUrlBase:u()}),Om=f({tagsSupported:V()});f({supportedTypes:A(z(["multimedia","product","tourActivity","propertyPromotion","text","showroom","miniShowroom","mainShowroom"])),product:Om.nullish(),propertyPromotion:Om.nullish(),tourActivity:Om.nullish(),optOutOfPersonalization:V().nullish()});const KI=z(["open","expand","chat"]);f({showroom:f({scenario:KI.nullish(),brandId:u(),brandName:u().nullish(),adId:u().nullish()})});const sN=f({requestId:u(),ads:A(qI),instrumentation:Fh}),aN=sN.extend({key:u()}),rN=f({brandBackground:Ho().nullish(),brandLogo:bc.nullish(),conversationId:u(),miniShowroomAd:f({messageId:u(),partId:u(),rguid:u()}),showroomData:A(aN).nullish(),openAt:k(),theme:z(["light","dark"]).nullish(),viewMode:z(["cardView","extendedView"]),activeCardRguid:u().nullish(),lastUserMessageRguid:u().nullish()});rN.extend({brandId:u(),adId:u().nullish(),scenario:KI.nullish()});f({brandId:u(),brandName:u().nullish(),messageId:u(),conversationId:u(),visible:V()});const iN=f({selectedTag:Ic.nullish(),collapsed:V().nullish(),createdAt:k().nullish()}),cN=iN.extend({type:v("ads"),requestId:u(),summary:u(),ads:A(nN).nullish(),instrumentation:Fh,adsSessionId:u().nullish(),adTags:A(Ic).nullish()}),KIe=f({requestId:u(),ads:A(oN).nullish(),instrumentation:Fh}),YI=Q([v("sendEmail"),v("createCalendarEvent")]),ZI=f({messageId:u(),partId:u()}),gy=z(["sunday","monday","tuesday","wednesday","thursday","friday","saturday"]),lN=z(["first","second","third","fourth","last"]),uN=f({type:u(),interval:k().optional(),month:k().optional(),dayOfMonth:k().optional(),daysOfWeek:A(gy).optional(),weekIndex:lN.optional(),firstDayOfWeek:gy.optional()}),dN=f({type:z(["noEnd","endDate","numbered"]),startDate:u(),endDate:u().optional(),numberOfOccurrences:k().optional()}),mN=f({pattern:uN,range:dN}),pN=f({email:u(),displayName:u().nullable(),avatarUrl:u().nullable(),isRequired:V()}),fN=f({type:v("createCalendarEvent"),title:u(),startsAt:u(),endsAt:u(),location:u().nullable(),recurrence:mN.nullable(),description:u().nullable(),folder:u().nullable(),targetConnectors:A(z(["outlook-calendar","google-calendar"])).nullable(),url:u().nullable(),attendees:A(pN).nullish(),status:z(["pending-confirmation","success","failure","cancelled-by-user"])}),hN=ZI.extend({type:v("createCalendarEvent")});f({type:v("command"),command:f({type:v("updateCard"),messageId:u(),partId:u(),update:f({type:v("discardCalendarEvent")})})});const jn={OneDriveAccess:"one-drive-access",BrowserAction:"browser-action",ComputerUseActions:"computer-use-actions",OutlookAccess:"outlook-access",OutlookCalendarAccess:"outlook-calendar-access",GoogleDriveAccess:"google-drive-access",GoogleCalendarAccess:"google-calendar-access",GoogleContactsAccess:"google-contacts-access",GmailAccess:"gmail-access",EdgePasswords:"edge-passwords",EdgeBrowserAccess:"edge-browser-access",FileSearch:"file-search"},gN=z([jn.OneDriveAccess,jn.BrowserAction,jn.ComputerUseActions,jn.OutlookAccess,jn.OutlookCalendarAccess,jn.GoogleDriveAccess,jn.GoogleCalendarAccess,jn.GoogleContactsAccess,jn.GmailAccess,jn.EdgePasswords,jn.EdgeBrowserAccess,jn.FileSearch]),vy={active:"active",rejected:"rejected"},JI=z([vy.active,vy.rejected]),vN=f({type:v("consent"),consentTypes:A(gN),status:JI}),Um={notAllowed:"not-allowed",blocked:"blocked",safetyCheck:"safety-check"},yN=z([Um.notAllowed,Um.blocked,Um.safetyCheck]),CN=f({type:v("browserAction"),title:u(),description:u().nullish(),url:u().nullish(),reason:yN}),SN=f({id:u(),status:z(_I),missingScopes:A(u()).nullish()}),bN=f({type:v("connector"),connectionType:z(kI),existingConnection:SN.nullable()}),IN=fe("type",[CN,bN]),EN=f({type:v("consentV2"),status:JI,consents:A(IN)}),TN=fe("type",[vN,EN]),YIe={BrowserAction:"browser-action"},wN=fe("type",[f({type:v("consent"),status:v("rejected")}),f({type:v("discardCalendarEvent")})]);f({type:v("command"),command:f({type:v("updateCard"),messageId:u(),partId:u(),update:wN})});const AN=f({type:v("computerUseFeedback")}),Ta=Q([v("startTask"),v("pauseTask"),v("resumeTask"),v("cancelTask"),v("takeTaskControl"),v("releaseTaskControl"),v("sendFormData")]),xN=Q([v("bringAgentTabsToForeground"),v("failedTask"),v("completedTask"),v("moveAgentTabsToBackground"),v("showConsentDialog")]);Q([Ta,xN]);const _N=Q([v("allSessionInfo"),v("activeSessionInfo"),v("failedTask"),v("completedTask")]);Q([Ta,_N]);const kN=Q([v("allSessionInfo"),v("activeSessionInfo"),v("failedTask"),v("completedTask")]);Q([Ta,kN]);const QI=Q([v("askUserInput"),v("safetyRiskDetected"),v("userTakeControl"),v("giveBackControl"),v("resumeFromInput"),v("resumeFromRisk"),v("pauseByClick"),v("resumeByClick"),v("taskCompleted")]),PN=f({reason:QI,title:u().optional(),text:u().optional()}),wa=f({taskId:u()}),MN=wa.extend({type:v("startTask")}),RN=wa.extend({type:v("pauseTask")}),NN=wa.extend({type:v("resumeTask")}),LN=wa.extend({type:v("cancelTask")}),DN=wa.extend({type:v("takeTaskControl")}),ON=wa.extend({type:v("releaseTaskControl")}),UN=f({identifier:u(),value:u()}),FN=wa.extend({type:v("sendFormData"),fields:A(UN)}),XI=f({title:u(),instruction:f({text:u(),websites:A(f({url:Mt(),iconUrl:Mt().optional()}))})});XI.extend({id:u()});XI.extend({isActive:V()});const jN=z(["choose","replay"]),BN=z(["2","1","0.5"]),VN=f({isRunning:V().nullish(),speed:BN.nullish()}),HN=f({name:u(),url:u().nullish(),description:u().nullish(),phoneNumber:u().nullish(),smsNumber:u().nullish(),chatUrl:u().nullish(),whatsAppUrl:u().nullish()}),zN=f({type:v("safetyHelpline"),countryEmergencyNumber:u().nullable(),helplines:A(HN)}),GN=f({type:v("suggestAgentMode")}),WN=f({type:v("artifact"),title:u(),artifact:f({type:Q([v("code")]),language:Q([v("html")]),content:u(),role:Q([v("interactive-chart")]).nullish()})}),$N=f({type:v("audioCallSummary"),summaryText:u()}),hl={active:"active",approved:"approved",rejected:"rejected",running:"running"},qN=z([hl.active,hl.approved,hl.rejected,hl.running]),KN=f({type:v("shell"),command:u(),description:u(),partId:u(),shell:u()}),yy=f({url:u(),iconUrl:u()}),YN=f({type:v("requestBrowserInteraction"),partId:u(),taskId:u(),reason:u(),instruction:u().nullish(),environment:fe("type",[yy.extend({type:v("localBrowser"),id:k()}),yy.extend({type:v("remoteBrowser"),shouldShowRememberData:V()})]).nullish()}),ZN=fe("type",[KN,YN]),JN=f({type:v("command"),commands:A(ZN),conversationId:u(),status:qN}),QN=z(["draft","failed-to-send","sent"]),eE=z(["outlook","gmail"]),XN=f({type:v("composeEmail"),subject:u(),body:u(),toRecipients:A(u()).nullable(),ccRecipients:A(u()).nullable(),bccRecipients:A(u()).nullable(),status:QN.optional(),targetConnectors:A(eE).nullable(),url:u().nullable()}),eL=ZI.extend({type:v("sendEmail"),targetConnector:eE}),tL=f({type:v("document"),attachmentId:u(),fileName:u(),contentType:Sc}),nL=f({username:u(),password:u()}),oL=f({type:v("edge-passwords"),websiteName:u(),usernameSuggestion:u().optional(),savedCredentials:A(nL).optional(),allowManualEntry:V().optional()}),sL=z(["email","google","microsoft","apple","phone","x","facebook","amazon"]),aL=f({type:v("federatedLogin"),providers:A(sL),websiteName:u()}),rL=f({type:v("file"),url:Mt(),name:u(),contentType:Sc}),iL=f({modifiedAt:u(),name:u(),uri:u()}),cL=f({type:v("fileSearch"),query:u(),results:A(iL)}),lL=f({name:u(),disclaimerUrl:u(),url:u()}),tE=f({price:k().nullish(),changeInPercentage:k().nullish(),changeInAmount:k().nullish()}),uL=z(["unavailable","upcoming","live","beat","miss","inline"]),dL=f({releaseAt:u().nullish(),status:uL}),nE=f({id:u(),symbol:u(),displayName:u(),price:k(),previousClosePrice:k(),changeInPercentage:k(),changeInAmount:k(),updatedAt:u(),iconUrl:u(),provider:lL,isFollowed:V().nullish()}),mL=f({priceOpen:k().nullish(),priceHigh:k().nullish(),priceLow:k().nullish(),price52wHigh:k().nullish(),price52wLow:k().nullish()}),Ec=nE.extend({intradayPricing:mL,isMarketLastSale:V(),exchangeTimeZoneId:u().nullish(),isMarketRegularHours:V().nullish(),lastUpdatedAt:u(),tradingDayEndAt:u(),accumulatedVolume:k().nullish()}),pL=Ec.extend({securityType:v("stock"),marketCap:k().nullish(),marketCapCurrency:u().nullish(),averageVolume:k().nullish(),peRatio:k().nullish(),postMarket:tE.nullish(),earnings:dL.nullish()}),fL=Ec.extend({securityType:v("etf"),netAssets:k().nullish(),expenseRatio:k().nullish(),yieldPercent:k().nullish(),postMarket:tE.nullish()}),hL=Ec.extend({securityType:v("index")}),gL=nE.extend({securityType:v("fund"),price52wHigh:k().nullish(),price52wLow:k().nullish(),netAssets:k().nullish(),expenseRatio:k().nullish(),yieldPercent:k().nullish(),oneYearReturn:k().nullish()}),oE=f({amount:k().nullish(),currency:u().nullish(),currencySymbol:u().nullish()}),Cy=f({value:oE,fullName:u().nullish()}),vL=f({oneMonth:k().nullish(),sixMonths:k().nullish(),oneYear:k().nullish()}),yL=Ec.extend({securityType:v("currencyExchange"),fromCurrency:Cy,toCurrency:Cy,percentageReturns:vL}),CL=Ec.extend({securityType:v("cryptocurrency"),marketDominancePercentage:k().nullish(),circulatingSupply:k().nullish(),maxSupply:k().nullish(),oneYearReturn:k().nullish(),marketCap:oE,marketCapCurrency:u().nullish()}),SL=z(rR),bL=f({price:k(),volume:k(),at:u()}),Sy=A(bL),IL=f({afterHoursSeries:Sy,series:Sy,chartType:SL}),EL=fe("securityType",[pL,fL,hL,gL,yL,CL]),sE=f({currency:u(),instrument:EL,chart:IL.nullish()}),TL=sE.extend({type:v("financeChart")}),wL=f({securities:A(sE)}),AL=wL.extend({type:v("financeComparisonChart")}),xL=fe("type",[TL,AL]),_L=f({id:u()}),kL=A(_L),ZIe=f({entities:kL}),PL=f({type:v("basic"),front:u(),back:u()}),ML=f({type:v("flashcard"),title:u(),flashcards:A(PL)}),RL=f({id:k(),autocompleteAttribute:u(),autofillType:u(),fieldLabel:u(),fieldName:u(),formControlType:u()}),NL=f({fields:A(RL)}),LL=f({forms:A(NL)}),DL=f({type:v("form-fill"),websiteName:u(),headerText:u().optional(),bodyText:u().optional(),formStructure:LL}),OL=f({latitude:k(),longitude:k()}),iu=f({name:u(),location:OL}),UL=f({value:k(),count:k().nullish(),maxRating:k().nullish()}),FL=iu.extend({npi:u(),name:u(),primarySpecialtyTitle:u(),rating:UL.nullish(),professionalCredentials:A(u()).nullish(),location:iu.shape.location.extend({uuid:u(),address:u(),name:u().nullish(),phoneNumber:u().nullish()}),url:u().nullish()}),jL=f({type:v("healthcareEntity"),entities:A(FL)}),BL=f({name:u(),type:u().nullish(),year:Ho().nullish()}),VL=f({carrierName:u().nullish()}),HL=f({name:u().nullish(),address:u(),latitude:k(),longitude:k(),phoneNumber:u().nullish()}),JIe=f({npi:u(),name:u(),professionalCredentials:A(u()).nullish(),location:HL.nullish(),url:u().nullish(),primarySpecialtyTitle:u().nullish(),otherSpecialtyTitles:A(u()).nullish(),educations:A(BL).nullish(),insurances:A(VL).nullish(),performanceOutcomesIndex:k().nullish(),languages:A(u()).nullish(),dataSourceUrl:u()}),zL=f({name:u(),subtitle:u(),logoUrl:u()}),GL=f({title:u(),previewContent:u(),detailedContent:u().nullish()}),WL=f({type:v("healthcareInfo"),content:GL,source:zL}),$L=Q([jL,WL]),aE=f({image:f({url:u(),thumbnailUrl:u(),altText:u(),width:k(),height:k()}),source:f({title:u(),url:u(),iconUrl:u().nullable()})}),qL=f({type:v("image"),images:A(aE)}),KL=f({language:Q([v("html")]),htmlContent:u()}),YL=f({type:v("inline-artifact"),title:u(),artifact:KL}),ZL=f({type:v("inlineImage"),title:u(),description:u()}).extend(aE.shape),rE=f({title:u(),description:u(),startTime:k(),endTime:k()}),JL=f({video:f({url:u(),thumbnailUrl:u(),duration:k(),title:u(),isShort:V(),playlistIndex:k().optional()}),source:f({url:u(),iconUrl:u().optional()}),bestMomentIndex:k().optional(),moments:A(rE).optional()}),QL=f({type:v("video"),videos:A(JL)}),XL=f({type:v("inlineVideo"),title:u(),description:u(),video:f({url:u(),thumbnailUrl:u(),title:u(),isShort:V()}),source:f({url:u(),iconUrl:u().optional()}),moments:A(rE).optional()}),eD=f({name:u(),logoUrl:u().nullable(),postUrl:u()}),tD=f({title:u(),companyName:u(),companyLogoUrl:u().nullable(),postedAt:u(),location:u(),providers:A(eD),description:u(),salary:u().nullable(),type:u().nullable(),locationType:u().nullable(),tags:A(u()).nullable()}),nD=f({type:v("job"),jobs:A(tD)}),oD=A(f({url:u(),altText:u().nullish(),providerName:u().nullish(),providerUrl:u()})),sD=A(f({count:k(),rating:k(),providerName:u(),providerIconUrl:u().nullish(),url:u()})),aD=f({type:v("localEntity"),entities:A(iu.extend({phoneNumber:u().nullish(),url:u().nullish(),reviews:sD,location:iu.shape.location.extend({address:u().nullish()}),photos:oD,openState:u().nullish(),category:u().nullish(),price:u().nullish()})),layerLabel:u().nullish()}),rD=f({providerName:u(),url:u().nullish(),thumbnailUrl:u(),providerOptions:A(u()).nullish(),source:f({url:u(),name:u()}).nullish()}),iD=f({sourceName:u(),maxRating:k(),rating:k(),url:u()}),cD=f({url:u(),source:f({url:u(),name:u()}).nullish()}),Kp=f({url:u().nullish(),name:u().nullish()}),lD={thumbnail:f({url:u(),source:Kp.nullish()}),source:Kp.nullish()},uD=f({type:v("mediaSpotlight"),title:u(),label:u().nullish(),description:u(),thumbnail:cD,facts:Rn(u(),u()).nullish(),criticRatings:A(iD).nullish(),watchLinks:A(rD).nullish(),featuredVideo:f(lD).nullish(),sources:A(Kp).nullish()}),dD=f({entityId:u(),title:u(),subtitle:u(),thumbnailUrl:u()}),mD=f({type:v("mediaCarousel"),items:A(dD)}),iE=f({url:Mt(),title:u(),snippet:u().nullish(),publisher:u().nullish(),iconUrl:Q([Mt(),v("")]).nullish(),thumbnailUrl:Q([Mt(),v("")]).nullish()}),pD=A(iE),QIe=f({relatedResults:pD}),fD=iE.extend({type:v("navigation")}),hD=f({name:u(),thumbnailUrl:u()}),gD=f({provider:hD,title:u(),url:u(),thumbnailUrl:u(),updatedAt:u()}),vD=f({title:u(),articles:A(gD)}),yD=vD.extend({type:v("newsCarousel")}),CD=f({id:u(),type:v("oneDrive"),name:u(),lastModifiedAt:u(),url:u(),webDavUrl:u().optional(),contentType:u(),size:k()}),SD=f({type:v("m365"),items:A(CD)}),bD=f({type:v("linkedin"),firstName:u().nullish(),lastName:u().nullish(),profileUrl:Mt().nullish(),backgroundPictureUrl:Mt().nullish(),profilePictureUrl:Mt().nullish(),headline:u().nullish(),location:u().nullish(),followerCount:k().nullish(),positions:A(f({title:u().nullish(),company:u().nullish(),description:u().nullish()})).nullish(),educations:A(f({degree:u().nullish(),fieldOfStudy:u().nullish(),school:u().nullish()})).nullish(),isLimitedResult:V().nullish()}),ID=f({type:v("bing"),title:u().nullish(),label:u().nullish(),description:u().nullish(),thumbnail:f({url:Mt(),source:f({url:Mt(),name:u()}).nullish()}),facts:A(f({name:u(),value:u()})).nullish(),sources:A(f({url:Mt(),name:u()})).nullish()}),ED=fe("type",[bD,ID]),TD=f({type:v("person"),persons:A(ED)}),wD=z(["one-drive","google-drive","outlook-calendar","google-calendar","google-contacts","gmail","outlook","edge-browser","windows"]),Mr=f({id:u(),source:wD,url:u().nullish()}),AD=Mr.extend({type:v("document"),fileName:u(),modifiedAt:u().nullish(),sizeInBytes:k().nullish(),contentType:u().optional()}),xD=Mr.extend({type:v("image"),fileName:u(),modifiedAt:u().nullish(),sizeInBytes:k().nullish(),thumbnailUrl:u().nullish()}),_D=Mr.extend({type:v("event"),subject:u().nullish(),startsAt:u(),endsAt:u(),location:u().nullish(),calendarName:u().nullish()}),kD=Mr.extend({type:v("contact"),displayName:u(),thumbnailUrl:u().nullish(),emailAddresses:A(u()).nullish(),phoneNumbers:A(f({type:u().nullish(),value:u().nullish()})).nullish()}),PD=Mr.extend({type:v("email"),id:u(),senderEmailAddress:u(),senderEmailName:u().optional(),receivedAt:u(),subject:u().nullish(),isRead:V().optional(),hasAttachments:V().optional()}),MD=Mr.extend({type:v("webPage"),url:u(),title:u(),iconUrl:u().optional(),visitedAt:u()}),RD=fe("type",[AD,xD,_D,kD,PD,MD]),ND=f({type:v("personalArtifacts"),artifacts:A(RD)}),LD=f({name:u(),url:u(),width:k().optional(),height:k().optional(),thumbnailUrl:u().optional()}),DD=f({images:A(LD)}),OD=DD.extend({type:v("phoneImages")}),UD=f({qrCodeUrl:u(),linkDeviceUrl:u()}),FD=UD.extend({type:v("phoneLinking")}),jD=Q([v("executing"),v("completed"),v("failed")]),jh=f({deviceName:u().optional(),state:jD.optional(),disabled:V().optional(),completedAt:u().optional()}),BD=z(["sunday","monday","tuesday","wednesday","thursday","friday","saturday"]),VD=jh.extend({triggerAt:u(),repeatDays:A(BD).optional().nullable()}),HD=VD.extend({type:v("phoneAlarm")}),zD=jh.extend({seconds:k()}),GD=zD.extend({type:v("phoneTimer")}),WD=jh.extend({actionId:u(),text:u(),phoneNumber:u().nullable().optional(),contactName:u().nullable().optional(),deviceName:u().optional()}),$D=WD.extend({type:v("phoneSendMessage")}),qD=nn.extend({actionName:v("phone_send_message"),parameters:f({text:u(),phoneNumber:u().nullable().optional(),contactName:u().nullable().optional()})}),KD=fe("type",[FD,OD,HD,GD,$D]),YD=f({id:u(),label:u(),type:v("single-select"),options:A(u()),defaultOptionIndex:k()}),ZD=f({id:u(),label:u(),type:v("multiple-select"),options:A(u())}),JD=Q([YD,ZD]),QD=f({id:u(),displayName:u(),previewImageUrl:u()}),XD=f({type:v("powerPointCreator"),actionId:u(),actionType:u(),text:u(),questions:A(JD),themes:A(QD)}),eO=f({type:v("quiz"),title:u(),quiz:A(f({type:v("singleSelect"),question:u(),options:A(u()),answer:k(),topics:A(u()).nullable(),hint:u().nullable(),explanation:u()}))}),tO=f({value:k(),count:k().nullish(),maxRating:k().nullish()}),nO=f({hours:k(),minutes:k()}),cE=f({name:u(),quantity:k().nullish(),unit:u().nullish()}),oO=f({title:u(),url:Mt(),source:u(),imageUrl:Mt().nullish(),rating:tO.nullish(),serving:k().nullish(),calories:k().nullish(),cookingTime:nO.nullish(),instructions:A(u()).nullish(),ingredients:A(cE).nullish()}),sO=f({type:v("recipe"),recipes:A(oO)});f({title:u(),url:Mt(),ingredients:A(cE),instructions:A(u()).nullish(),imageUrl:Mt().nullish(),messageId:u().nullish()});const aO=f({type:v("suggestResearch")}),Bh=f({position:k(),url:u(),title:u(),iconUrl:u().nullish(),publisher:u().nullish(),snippet:u().nullish(),label:u().nullish()}),lE=f({url:u(),name:u(),imageUrl:u(),images:A(u()).nullish(),price:Et,seller:u().nullish()}),Vh=f({value:k(),count:k()}).nullish(),rO=lE.extend({type:v("shopping"),id:u(),rating:Vh}),iO=f({emailEnabled:V(),anyRetailer:V()}),uE=lE.extend({isNotificationEnabled:V().nullish(),offerId:u(),currentPrice:Et.nullish(),percentageDrop:k(),durationInWeeks:k(),notificationOptions:iO.nullish()}),Hh=f({title:u().nullish(),url:u()}),cO=z(["textual","visual"]),lO=f({displayName:u(),value:u(),isActive:V(),isSelected:V(),thumbnailImage:Hh.nullish()}),dE=f({id:u(),displayName:u(),filterValues:A(lO),filterType:cO}),zh=f({id:u().nullish(),groupId:u().nullish(),brandGroupId:u().nullish()}),mE=f({displayName:u(),values:A(u())}),pE=f({offerUrl:u(),domain:u(),logoUrl:u().nullish()}),fE=f({summary:u(),attributions:A(pE)}),hE=f({pros:A(u()).nullish(),cons:A(u()).nullish(),attributions:A(pE)}),ed=Q([v("lowest-price"),v("free-shipping")]),gE=fe("type",[f({type:v("buyWithMerchant"),checkoutUrl:u().nullish(),merchant:u().nullish()}),f({type:v("buyWithCopilot"),merchantProvider:u().nullish(),storeId:u().nullish()})]),Gh=f({product:zh,offerId:u(),url:u(),name:u(),description:u().nullish(),images:A(Hh).nullish(),filters:A(dE).nullish(),specifications:A(mE).nullish(),review:fE.nullish(),prosAndCons:hE.nullish(),price:Et,discountPrice:Et.nullish(),seller:u(),sellerLogoUrl:u().nullish(),brandName:u().nullish(),rating:Vh.nullish(),tags:A(ed).nullish(),checkoutOption:gE.nullish(),curation:u().nullish(),canTrackPrice:V()}),uO=f({type:v("shoppingProducts"),products:A(Gh),layout:Q([v("inline"),v("block")]).nullish()}),vE=f({offerName:u(),offerId:u(),url:u(),price:Et,discountPrice:Et.nullish(),seller:u(),sellerLogoUrl:u().nullish(),tags:A(ed).nullish(),canTrackPrice:V()}),XIe=f({error:u(),message:u()}),yE=f({minPrice:Et,maxPrice:Et,averagePrice:Et,timePeriodInDays:k()}),CE=f({date:hr(),price:Et}),SE=f({daily:CE.array()}),bE=f({label:u(),prompt:u()}),dO=Q([v("nudge"),v("flyout")]),IE=f({edgeEntryPoint:dO.optional()}),mO=IE.extend({scenario:v("priceHistory"),priceHistory:f({dailyPrices:CE.array(),type:Q([v("increase"),v("decrease")]),percentage:k()})}),pO=IE.extend({scenario:v("cashback"),cashbackData:f({isAdOffer:V()})}),EE=fe("scenario",[mO,pO]),Wh=f({name:u(),logoUrl:u().nullish()}),$h=z(["affiliate","storewideAd","productAd"]),td=z(["flat","percentage"]),fO=f({type:v(td.enum.percentage),percentage:k()}),hO=f({type:v(td.enum.flat),cashback:Et}),gO=fe("type",[fO,hO]),vO=f({rebate:gO,name:u()}),yO=f({type:v(td.enum.percentage),percentage:k(),maxCashback:Et}),CO=f({type:v(td.enum.flat),cashback:Et,minPurchaseRequired:Et}),SO=fe("type",[yO,CO]),TE=f({type:v($h.enum.productAd),cashback:Et,expiresAt:u()}),bO=TE.extend({seller:Wh}),wE=f({type:v($h.enum.storewideAd),rebate:SO,expiresAt:u()}),IO=wE.extend({seller:Wh}),AE=f({type:v($h.enum.affiliate),categories:A(vO),exclusions:u()}),EO=AE.extend({seller:Wh}),TO=fe("type",[TE,wE,AE]);fe("type",[bO,IO,EO]);const eEe=Gh.extend({otherBuyingOptions:A(vE).nullish(),priceInsight:yE.nullish(),tags:A(ed).nullish(),priceHistory:SE.nullish(),conversationStarters:A(bE).nullish(),insights:EE.nullish(),supportsPriceInsights:V()}),wO=f({product:zh.nullish(),offerId:u().nullish(),url:u().nullish(),name:u().nullish(),description:u().nullish(),images:A(Hh).nullish(),filters:A(dE).nullish(),specifications:A(mE).nullish(),review:fE.nullish(),prosAndCons:hE.nullish(),price:Et.nullish(),discountPrice:Et.nullish(),brandName:u().nullish(),rating:Vh.nullish(),checkoutOption:gE.nullish(),curation:u().nullish(),canTrackPrice:V().nullish(),otherBuyingOptions:A(vE).nullish(),priceInsight:yE.nullish(),tags:A(ed).nullish(),priceHistory:SE.nullish(),conversationStarters:A(bE).nullish(),insights:EE.nullish()});f({metadata:wO.nullish(),cashbackOffers:A(TO).nullish(),seller:u().nullish(),sellerLogoUrl:u().nullish()});const tEe=f({products:uE.array()}),AO=f({category:u(),curationGroupId:u(),position:Q([v("top"),v("middle"),v("bottom")]).nullish()}),Ul=Gh.extend({curationInfo:AO.nullish()});f({product:Ul,messageId:u(),allProducts:A(Ul).nullish(),accessories:A(Ul).nullish()});const xO=f({type:v("shoppingCurated"),title:u().optional(),products:A(Ul),groupType:u().nullish()}),_O=fe("type",[rO,uO,xO]),nEe=f({emailNotificationEnabled:V()}),kO=f({name:u(),url:u(),offerId:u()}),PO=f({url:u(),source:u()}),MO=f({reason:u(),references:A(PO)}),RO=z(["buy-now","buy-later"]),oEe=f({whenToBuy:RO,seller:kO,supportingReasons:A(MO)}),NO=Q([v("top-highlight"),v("buying-tip"),v("ideal-for"),v("review-snapshot")]),sEe=f({title:u(),content:u(),type:NO,citations:A(Bh)}),LO=f({muid:u().default(""),isShoppingEnabled:V().default(!1),isPersonalizationDataConsentEnabled:V().default(!1),impressionId:u().optional()}),DO=f({isRebatesActive:V().nullish(),ldClickData:u().nullish(),msClickId:u().nullish(),uClickData:u().nullish()});f({isPDP:V().nullish(),name:u().nullish(),image:Mt().nullish(),base64_image:u().nullish(),price_currency:u().nullish(),price_value:S9(e=>{if(typeof e=="string"){const t=e.replace(/[\s,]/g,""),n=parseFloat(t);return Number.isNaN(n)?void 0:n}return e},k()).nullish(),isShoppingEnabled:V().nullish(),cashback:DO.nullish(),isPersonalizationDataConsentEnabled:V().nullish(),muid:u().nullish(),impressionId:u().nullish(),"aggregateRating/ratingValue":Q([u(),Tv()]).nullish(),"aggregateRating/reviewCount":Q([u(),Tv()]).nullish(),"offers/price":u().nullish()});f({name:u().optional(),rating:f({value:k(),count:k()}).optional(),images:A(f({url:u()})).optional(),price:f({amount:k(),currency:u().nullable(),currencySymbol:u().nullable()}).optional(),offerPrice:u().optional(),isPDP:V().optional()});const OO=f({title:u(),prompt:u(),imageUrl:u()}),xE=f({name:u(),cards:A(OO)});f({tabs:A(xE)});f({title:u(),description:u(),imageUrl:u(),prompt:u()});f({title:u(),description:u(),videoSourceDarkMode:u(),videoSourceLightMode:u()});const UO=f({imageUrls:A(u()),title:u(),prompt:u()}),_E=f({title:u(),prompt:u()});A(_E);const FO=f({name:u(),url:u().nullish(),iconUrl:u().nullish()}),jO=f({imageUrl:u(),offerId:u(),price:Et.nullish(),name:u().nullish(),discountPrice:Et.nullish(),seller:FO,product:zh.nullish()}),BO=f({title:u(),subtitle:u(),products:A(jO),heroImageUrl:u().nullish(),reason:u().nullish(),conversationStarterPrompt:u().nullish()}),VO=BO.extend({type:v("productJourney")}),HO=f({type:v("continueShopping"),items:A(UO)}),zO=f({type:v("forYou"),items:A(_E)}),GO=f({type:v("trackedProducts"),products:A(uE)}),WO=f({type:v("momentInTime"),tabs:A(xE)}),$O=fe("type",[HO,zO,GO,WO,VO]),aEe=f({sections:A($O).nullable()});f({textPosition:z(["top","bottom"]),imageSize:z(["sm","md","lg"]),titleStringKey:u(),descriptionStringKey:u(),imgSrc:u()});const qO=z(["home","away"]),so=z(["win","loss","tie","no-game"]),kE=z(["pre-game","in-progress","final","postponed","delayed","abandoned","cancelled"]),KO=z(["test","odi","t20"]),YO=z(["test","limited-overs","super-over"]),ZO=z([...kE.options,"drinks","dinner","tea","lunch","innings-break","super-over","toss","stumps","strategic-timeout","forfeited"]),JO=z([...kE.options,"bye","retired","forfeited","unscheduled","suspended"]),QO=z(["men-singles","men-doubles","women-singles","women-doubles","mixed-doubles"]),XO=z(["round-of256","round-of128","round-of64","round-of32","round-of16","quarter-final","semi-final","final"]),PE=f({name:u(),city:u().nullish()}),eU=f({name:u(),thumbnailUrl:u().nullish(),seasonPhase:u().nullish(),seasonStartsAt:u().nullish(),seasonEndsAt:u().nullish(),leagueId:u()}),tU=f({type:v("league"),league:eU}),cu=f({name:u(),thumbnailUrl:u().nullish()}),nU=f({type:v("team"),team:cu}),oU=f({type:v("matchup"),matchup:f({teamA:cu,teamB:cu})}),Tc=fe("type",[tU,nU,oU]),sU=f({name:u(),alias:u().nullish(),thumbnailUrl:u().nullish()}),aU=f({playerName:u(),clock:f({minutes:k(),seconds:k()})}),rU=f({ballPossessionPercentage:k().nullish(),goals:A(aU).nullish()}),nd=f({wins:k(),losses:k(),overtimeLosses:k().nullish()}),iU=z(["quarter","half","halftime","extra","penalties","shoot-out","overtime","inning","period"]),cU=z(["top","bottom"]),os=f({type:iU,period:k().nullish(),division:cU.nullish()}),wc=f({playingPeriod:os,score:u()}),vn=sU.extend({primaryColorHex:u().nullish(),venueType:qO.nullish(),previousGameOutcomes:A(so).nullish(),seed:k().nullish(),gameOutcome:so.nullish(),score:u().nullish(),record:nd.nullish(),winProbability:k().nullish(),playingPeriodScores:A(wc).nullish()}),qh=vn.extend({winProbability:k().nullish()}),ME=vn.extend({score:u(),gameStats:rU.nullish()}),lU=ME.extend({gameOutcome:so}),uU=f({wins:k(),participantName:u()}),dU=z(["final","not-started","in-progress"]),mU=z(["national-championship","first-four","first-round","second-round","conference-semifinal","conference-final","sweet16","sweet-sixteen","elite-eight","final-four","final"]),pU=f({state:dU,winsInfo:A(uU).nullish(),gameNumber:k().nullish(),conference:u().nullish()}),RE=pU.extend({phase:mU}),Kh=f({name:u(),score:u()}),fU=f({current:k(),total:k(),aggregatedScores:A(Kh).nullish()}),Yh=f({startsAt:u(),status:u(),leagueName:u(),legInfo:fU.nullish(),leagueId:u().nullish(),gameId:u().nullish(),startTimeToBeAnnounced:V().nullish(),seasonPhase:u().nullish()}),Aa=f({minutes:k(),seconds:k()}),hU=qh.extend({record:nd.nullish(),gameOutcome:so.nullish(),score:u().nullish(),playingPeriodScores:A(wc).nullish(),gameStats:_r().nullish()}),xa=Yh.extend({name:u().nullish(),week:k().nullish(),clock:Aa.nullish(),bracket:_r().nullish(),currentPlayingPeriod:os.nullish()}),_a=Yh.extend({name:u().nullish(),bracket:RE.nullish(),week:k().nullish(),clock:Aa.nullish(),currentPlayingPeriod:os.nullish()}),gU=xa.extend({status:v("pre-game"),participants:A(qh)}),Zh=f({clock:Aa,description:u(),team:cu,participantScores:A(Kh).nullish()}),NE=Zh.extend({type:z(["score-change","yellow-card","red-card"])}),Jh=Zh.extend({type:z(["three-point-made","two-point-made","touchdown","field-goal","extra-point","safety","two-point-conversion","blocked-punt-safety","blocked-field-goal-safety","fumble-safety"])}),ka=f({url:u(),thumbnailUrl:u(),title:u(),durationInSeconds:k().nullish()}),vU=_a.extend({status:v("pre-game"),participants:A(hU),timeline:f({events:A(Jh)}).nullish(),videos:A(ka).nullish()}),yU=xa.extend({status:v("in-progress"),participants:A(ME),clock:Aa,currentPlayingPeriod:os.nullish(),timeline:f({events:A(NE)}).nullish(),videos:A(ka).nullish()}),CU=xa.extend({status:v("final"),participants:A(lU),videos:A(ka).nullish(),timeline:f({events:A(NE)}).nullish()}),SU=xa.extend({status:v("postponed"),participants:A(vn)}),bU=xa.extend({status:v("delayed"),participants:A(vn)}),IU=xa.extend({status:v("abandoned"),participants:A(vn)}),EU=xa.extend({status:v("cancelled"),participants:A(vn)}),Yp=fe("status",[gU,yU,CU,IU,EU,bU,SU]),LE=vn.extend({playingPeriodScores:A(wc).nullish(),score:u(),record:nd.nullish(),gameOutcome:so.nullish(),winProbability:k().nullish(),gameStats:_r().nullish()}),TU=LE.extend({gameOutcome:so}),wU=_a.extend({status:v("in-progress"),participants:A(LE),clock:Aa,currentPlayingPeriod:os,timeline:f({events:A(Jh)}).nullish(),videos:A(ka).nullish()}),AU=_a.extend({status:v("final"),participants:A(TU),videos:A(ka).nullish(),clock:Aa.nullish(),currentPlayingPeriod:os.nullish(),timeline:f({events:A(Jh)}).nullish()}),xU=_a.extend({status:v("postponed"),participants:A(vn)}),_U=_a.extend({status:v("delayed"),participants:A(vn)}),kU=_a.extend({status:v("abandoned"),participants:A(vn)}),PU=_a.extend({status:v("cancelled"),participants:A(vn)}),Zp=fe("status",[vU,wU,AU,kU,PU,_U,xU]),MU=f({type:v("sportsSchedule"),sport:z(["basketball","ice-hockey","football"]),games:A(Zp),header:Tc.nullish(),heroGame:Zp.nullish()}),RU=f({type:v("sportsSchedule"),sport:v("soccer"),games:A(Yp),header:Tc.nullish(),heroGame:Yp.nullish()}),NU=f({type:v("sportsGame"),sport:z(["basketball","ice-hockey","football"]),game:Zp}),LU=f({type:v("sportsGame"),sport:v("soccer"),game:Yp}),Pa=Yh.extend({name:u().nullish(),week:k().nullish(),videos:A(ka).nullish(),bracket:RE.nullish(),clock:Aa.nullish(),currentPlayingPeriod:os.nullish()}),DE=f({hits:k(),errors:k(),runs:k()}),Qh=Zh.extend({type:z(["conversion","bat"]),playingPeriod:os,participantScores:A(Kh)}),OE=qh.extend({record:nd.nullish(),gameOutcome:so.nullish(),score:u().nullish(),playingPeriodScores:A(wc).nullish(),gameStats:DE.nullish()}),UE=OE.extend({playingPeriodScores:A(wc).nullish(),score:u(),gameStats:DE.nullish()}),DU=UE.extend({gameOutcome:so}),OU=Pa.extend({status:v("pre-game"),participants:A(OE),timeline:f({events:A(Qh)}).nullish()}),UU=Pa.extend({status:v("in-progress"),participants:A(UE),currentPlayingPeriod:os.nullish(),timeline:f({events:A(Qh)}).nullish()}),FU=Pa.extend({status:v("final"),participants:A(DU),videos:A(ka).nullish(),timeline:f({events:A(Qh)}).nullish()}),jU=Pa.extend({status:v("postponed"),participants:A(vn)}),BU=Pa.extend({status:v("delayed"),participants:A(vn)}),VU=Pa.extend({status:v("abandoned"),participants:A(vn)}),HU=Pa.extend({status:v("cancelled"),participants:A(vn)}),Jp=fe("status",[OU,UU,FU,jU,BU,VU,HU]),zU=f({type:v("sportsSchedule"),sport:v("baseball"),games:A(Jp),header:Tc.nullish(),heroGame:Jp.nullish()}),GU=f({type:v("sportsGame"),sport:v("baseball"),game:Jp}),WU=f({ballsFaced:k(),runsScored:k(),isBatting:V()}),$U=f({oversBowled:u(),wicketsTaken:k(),runsConceded:k(),isBowling:V()}),qU=WU.extend({type:v("batting")}),KU=$U.extend({type:v("bowling")}),FE=fe("type",[qU,KU]),YU=f({name:u(),stats:FE}),ZU=f({playerName:u(),teamName:u(),gameStats:A(FE).nullish()}),JU=f({current:k(),required:k().nullish()}),QU=f({name:u(),currentMatch:k(),totalMatches:k(),roundName:u().nullish(),equation:u().nullish()}),jE=f({type:YO,runs:k(),wickets:k(),oversPlayed:u(),isFollowedOn:V(),isDeclared:V(),duckworthLewisEquation:f({target:k(),revisedOvers:u()}).nullish()}),Xh=f({name:u(),alias:u().nullish(),thumbnailUrl:u().nullish()}),XU=Xh.extend({previousGameOutcomes:A(so).nullish()}),eF=Xh.extend({inningScores:A(jE).nullish(),playersStats:A(YU).nullish(),yetToBat:V()}),tF=Xh.extend({gameOutcome:so,didNotBat:V(),inningScores:A(jE).nullish()}),nF=f({startsAt:u(),startTimeToBeAnnounced:V(),tossInfo:u().nullish(),participants:A(XU),type:v("pre")}),oF=f({gameSummary:u(),runRate:JU.nullish(),participants:A(eF),type:v("live")}),sF=f({startsAt:u(),gameSummary:u(),playerOfTheMatch:ZU.nullish(),participants:A(tF),type:v("final")}),aF=fe("type",[nF,oF,sF]),Qp=f({gameId:u(),leagueId:u(),venue:PE.nullish(),format:KO,status:ZO,seriesInfo:QU,phase:aF}),rF=f({type:v("sportsGame"),sport:v("cricket"),game:Qp}),iF=f({type:v("sportsSchedule"),sport:v("cricket"),games:A(Qp),header:Tc.nullish(),heroGame:Qp.nullable()}),cF=f({name:u(),countryFlagThumbnailUrl:u().nullish(),seed:k().nullish()}),lF=f({points:k(),isServing:V(),tieBreakerPoints:k().nullish(),currentGamePoints:u().nullish(),setWon:V().nullish()}),BE=f({players:A(cF)}),uF=BE,VE=BE.extend({setPoints:A(lF)}),dF=VE.extend({gameOutcome:so}),mF=f({type:v("pre"),participants:A(uF)}),pF=f({type:v("live"),participants:A(VE)}),fF=f({type:v("final"),participants:A(dF)}),hF=fe("type",[mF,pF,fF]),by=f({gameId:u(),leagueId:u(),status:JO,startsAt:u().nullish(),startTimeToBeAnnounced:V(),venue:PE.nullish(),matchType:QO,round:XO.nullish(),phase:hF}),gF=f({type:v("sportsSchedule"),sport:v("tennis"),games:A(by),header:Tc.nullish(),heroGame:by.nullish()}),vF=Q([MU,RU,zU,iF,gF]),yF=fe("sport",[LU,NU,GU,rF]),CF=Q([vF,yF]),SF=f({type:v("tapToReveal"),content:u()}),bF=f({type:v("suggestVision")}),IF=z(["c","f"]),EF=z(["mm","cm","in"]),TF=z(["hPa","inHg","mb","mmHg"]),wF=z(["bft","kph","mph","ms"]),AF=z(["m","km","mi"]),xF=f({temperature:IF,height:EF,pressure:TF.optional(),speed:wF.optional(),distance:AF.optional()}),eg=z(xI),_F=z(["rain","snow"]),tg=f({type:_F.nullish(),amount:k().nullish(),chance:k()}),kF=f({current:k(),high:k().optional(),low:k().optional()}),PF=f({at:u(),state:eg,summary:u(),description:u().optional(),temperature:kF,precipitation:tg.optional()}),HE=f({high:k(),low:k()}),MF=f({date:u(),state:eg,temperature:HE,precipitation:tg.optional()}),RF=f({at:u(),state:eg,temperature:HE,precipitation:tg.optional()}),NF=f({daily:A(MF),hourly:A(RF).nullish().optional()}),LF=f({type:v("weather"),location:u(),units:xF,spotlight:PF.optional(),forecast:NF}),$i=z(xI),DF=f({type:v("weatherTemperatureHourly"),location:u(),unit:Q([v("f"),v("c")]),spotlight:f({date:u(),state:$i,summary:u(),temperature:k().optional(),high:k(),low:k()}),forecast:A(f({at:u(),state:$i,temperature:k(),precipitationChance:k()}))}),OF=f({type:v("weatherTemperatureDaily"),location:u(),unit:Q([v("f"),v("c")]),forecast:A(f({date:u(),state:$i,high:k(),low:k(),precipitationChance:k()}))}),zE=Q([v("rain"),v("snow")]),GE=Q([v("in"),v("mm")]),UF=f({type:v("weatherPrecipitationHourly"),location:u(),unit:GE,precipitationType:zE,spotlight:f({date:u(),summary:u(),amount:k(),chance:k()}),forecast:A(f({at:u(),state:$i,amount:k(),chance:k()}))}),FF=f({type:v("weatherPrecipitationDaily"),location:u(),unit:GE,precipitationType:zE,forecast:A(f({date:u(),state:$i,amount:k(),chance:k()}))}),jF=Q([LF,DF,OF,UF,FF]),BF=f({type:v("windowsSettings"),settingsUri:u()}),VF=Q([aO,GN,bF]),WE=Q([cN,WN,$N,fN,YL,JN,TN,oL,aL,xL,DL,$L,qL,ZL,nD,aD,SD,uD,mD,TD,KD,eO,rL,zN,_O,XL,CF,QL,jF,sO,AN,tL,yD,ND,ML,fD,VF,XD,XN,SF,cL,BF]),$E="clicked",ng="dismissed",HF=f({mainColor:u().nullable().optional(),secondaryColor:u().nullable().optional(),leftAccentColor:u().nullable().optional(),rightAccentColor:u().nullable().optional(),selectedVariant:u().nullable().optional(),palette:u().nullable().optional(),randomPalette:V().optional()}),Iy=Q([z([$E,ng]),rb()]),qE=f({primaryColor:u(),secondaryColor:u().nullable().optional(),leftAccentColor:u().nullable().optional(),rightAccentColor:u().nullable().optional()}),og=f({headwear:u().nullish(),eyewear:u().nullish()}),rEe=f({body:HF,accessories:og.nullish()}),iEe=f({appearance:f({body:qE,accessories:og.nullish()}).nullable()}),Ey=f({id:u()}),zF=f({accessoryOptions:f({headwear:A(Ey),eyewear:A(Ey)}).nullable()}),GF=z(["sm","md","lg"]),WF=z(["info","secondary","success","danger","warning","discovery"]),$F=z(["soft","solid","outline"]),qF=f({label:u(),pill:V().optional(),size:GF.optional(),color:WF.optional(),variant:$F.optional()}),KF=f({type:v("Badge"),props:qF}),Co=Q([k(),u()]),KE=f({size:Co.optional(),width:Co.optional(),height:Co.optional(),minSize:Co.optional(),minWidth:Co.optional(),minHeight:Co.optional(),maxSize:Co.optional(),maxWidth:Co.optional(),maxHeight:Co.optional()}),YE=Q([v("xs"),v("sm"),v("md"),v("lg"),v("xl"),v("2xl"),v("3xl")]).optional(),Ac=z(["primary","secondary","tertiary","success","warning","danger","emphasis","prose","white","accent-550","foreground-450","foreground-600","foreground-700","foreground-800"]).optional(),Xp=["add","add-circle","address","alltabs","apple-icon","apps","arrow-back","arrow-counter-clockwise","arrow-enter-up","arrow-export","arrow-export-up","arrow-forward","arrow-highlighter","arrow-import","arrow-loop","arrow-maximize","arrow-minimize","arrow-refresh","arrow-reload","arrow-trending-down","arrow-undo","arrow-up","arrow-up-right","attachment","beaker","bell","bell-alert","bell-filled","block","calendar","calendar-agenda","call","caret","chat","chat-add","chat-empty","chat-multiple","chat-sparkle","check","check-circle","check-circle-filled","checklist","checkmark-circle-filled","chevron","chevron-bolded","chevron-down-up","chevron-up-down","clipboard-paste","clock","cloud","collections","color-palette","compass","compose","contract-down-left","copy","copy-add","copy-filled","credit-card","cube","cube-add","cube-filled","cursor-click","cursor-hover","delete","directions","disconnect","dismiss","dismiss-circle","dismiss-strong","document-one-page-sparkle","door-arrow-left","dots-horizontal","download","edit","edit-line-horizontal","edit-line-horizontal-filled","ellipse","email","error","external-link","eye","eye-filled","eye-off","filmstrip-image","flag","flag-filled","folder-add","food-apple","four-leaf-clover","gift","globe","hanger","headphones","heart","heart-filled","history","image","image-off","indicator-dot","info","invite-action","key","library","lightbulb","link","link-filled","link-multiple","live","location","location-filled","location-ripple","lock","magnifier","mail","microphone","microphone-mute","moon","new-tab","note","open","options","panel-left","panel-right-contract","panel-right-expand","paperclip","people","people-add","person","person-add","person-arrow-left","person-delete","phone","phone-headset","picture-in-picture","pin","pin-off","plant","podcast","printer-3d","prohibited","puzzle","qr","quiz","rename","replay","save","scales","screenshot","search","separator","settings","share","shield","shield-checkmark","shield-error","shopping-bag","speed","star","star-filled","start-line","stop-circle","study","subtract","sun","tab-add","tag","text-bold","text-bullet-list","text-bullet-list-square-sparkle","text-code","text-italic","text-length-expand","text-length-reduce","text-list-abc","text-numbered-list","text-paragraph","thinking","thumbs-down","thumbs-down-filled","thumbs-up","thumbs-up-filled","timer","toggle-off","vehicle-truck","vertical-divider","vision","voice","wand"],YF=f({name:z(Xp),color:Ac,size:YE}),ZF=f({type:v("Icon"),props:YF}),JF=f({type:v("navigate"),handler:v("client"),payload:f({url:u()})}),QF=f({type:v("previewImage"),handler:v("client"),payload:f({url:u(),altText:u(),thumbnail:u().optional()})}),XF=f({type:v("selectChange"),handler:v("server"),payload:f({name:u(),value:u(),previousValue:u().optional()})}),ej=f({type:v("datePickerChange"),handler:v("server"),payload:f({name:u(),value:u(),previousValue:u().optional()})}),tj=f({type:v("radioChange"),handler:v("server"),payload:f({name:u(),value:u(),previousValue:u().optional()})}),nj=fe("type",[JF,QF]),oj=fe("type",[XF,ej,tj]),sg={onClickAction:nj.optional()},ag={onChangeAction:oj.optional()},sj=z(["soft","solid","outline","ghost"]),aj=z(["secondary","info","discovery","success","warning","danger"]),rj=z(["primary","secondary"]),ij=z(["3xs","2xs","xs","sm","md","lg","xl","2xl","3xl"]),cj=f({label:u().optional(),variant:sj.optional(),color:aj.optional(),style:rj.optional(),size:ij.optional(),iconStart:z(Xp).optional(),iconEnd:z(Xp).optional(),iconSize:YE,disabled:V().optional(),block:V().optional(),pill:V().optional(),uniform:V().optional(),...sg}),lj=f({type:v("Button"),props:cj}),uj=z(["start","center","end"]),xc={textAlign:uj.optional()};f(xc);const od={truncate:V().optional(),maxLines:k().optional()};f(od);const rg=z(["xs","sm","md","lg","xl"]),dj=z(["sm","md","lg"]),mj=z(["sm","md","lg","xl","2xl","3xl","4xl","5xl"]),_c=z(["normal","medium","semibold","bold"]),pj={fontSize:rg.optional(),fontWeight:_c.optional()};f(pj);const fj=f({color:Ac,size:dj.optional(),...xc,...od,value:u(),weight:_c.optional()}),hj=f({type:v("Caption"),props:fj}),gj=z(["start","center","end"]),vj=z(["top","bottom","left","right"]),yj=z(["3xs","2xs","xs","sm","md","lg","xl","2xl","3xl"]),Cj=z(["solid","soft","outline","ghost"]),Sj=f({name:u(),align:gj.optional(),block:V().optional(),clearable:V().optional(),defaultValue:u().optional(),disabled:V().optional(),max:u().optional(),min:u().optional(),pill:V().optional(),placeholder:u().optional(),side:vj.optional(),size:yj.optional(),variant:Cj.optional(),...ag}),bj=f({type:v("DatePicker"),props:Sj}),Ij=z(["subtle","weak","accent"]).optional(),Ej=f({color:Ij,size:k().optional(),spacing:k().optional(),flush:V().optional()}),Tj=f({type:v("Divider"),props:Ej}),wj=z(["2xs","xs","sm","md","lg","xl","2xl","3xl","4xl","full","100%","none"]),ZE=f({radius:wj.optional()}),JE=Q([k(),f({top:k().optional(),right:k().optional(),bottom:k().optional(),left:k().optional(),x:k().optional(),y:k().optional()})]),QE=f({margin:JE.optional()}),sd=f({padding:JE.optional()}),Aj=f({src:u(),alt:u().optional(),aspectRatio:Q([u(),k()]).optional(),frame:V().optional(),fit:z(["cover","contain","fill","none","scale-down"]).optional(),...KE.shape,...ZE.shape,...QE.shape,...sd.shape,...sg}),xj=f({type:v("Image"),props:Aj}),_j=f({value:u(),fieldName:u(),size:rg.optional(),weight:_c.optional(),...xc,color:Ac}),kj=f({type:v("Label"),props:_j}),Pj=f({streaming:V().optional(),value:u()}),Mj=f({type:v("Markdown"),props:Pj}),Rj=f({name:u(),value:u().optional(),disabled:V().optional(),...ag}),Nj=f({type:v("RadioGroup"),props:Rj}),Lj=z(["solid","soft","outline","ghost"]),Dj=z(["3xs","2xs","xs","sm","md","lg","xl","2xl","3xl"]),Oj=f({label:u(),value:u()}),Uj=f({options:A(Oj),block:V().optional(),clearable:V().optional(),defaultValue:u().optional(),disabled:V().optional(),name:u(),pill:V().optional(),placeholder:u().optional(),size:Dj.optional(),variant:Lj.optional(),...ag}),Fj=f({type:v("Select"),props:Uj}),jj=f({minSize:Co.default("auto")}),Bj=f({type:v("Spacer"),props:jj}),Vj=f({color:Ac,italic:V().optional(),lineThrough:V().optional(),size:rg.optional(),streaming:V().optional(),...xc,...od,value:u(),weight:_c.optional()}),Hj=f({type:v("Text"),props:Vj}),zj=f({color:Ac,size:mj.optional(),...xc,...od,value:u(),weight:_c.optional()}),Gj=f({type:v("Title"),props:zj}),XE=z(["surface","surface-secondary","surface-tertiary","surface-elevated","surface-elevated-secondary","background-100","background-150","background-200","background-300","accent-200","accent-250","accent-350","accent-400","accent-450","stroke-300","spot-blue-300","spot-blue-450","spot-green-300","spot-green-600","spot-orange-300","spot-orange-750","system-blue-350","system-blue-550","system-green-350","system-green-550","system-green-600","system-orange-350","system-red-450","system-red-550","system-teal-550","system-yellow-350","shopping-curated-purple-350","shopping-purple-550","shopping-blue-750","black"]).optional(),Wj=f({dark:u(),light:u()}),$j=Q([u(),Wj]),qj=z(["solid","dashed","dotted","double","groove","ridge","inset","outset"]),Kj=f({size:k(),color:$j.optional(),style:qj.optional()}),Yj=Q([k(),Kj]),Zj=f({border:Yj.optional()}),e5=z(["start","center","end","stretch"]),Jj=z(["row","col"]),Qj=z(["start","center","end","between","around","evenly"]),Xj=z(["nowrap","wrap"]),t5=f({align:e5.optional(),direction:Jj.optional(),flex:k().optional(),gap:k().optional(),justify:Qj.optional(),wrap:Xj.optional()}),ig=f({aspectRatio:Q([u(),k()]).optional(),background:XE,scrollable:V().optional(),...Zj.shape,...t5.shape,...QE.shape,...sd.shape,...ZE.shape,...KE.shape}),Rr=va(()=>Q([KF,eB,lj,hj,sB,bj,Tj,ZF,xj,kj,Nj,Bj,Fj,Mj,Hj,Gj,nB])),eB=va(()=>f({type:v("Box"),props:ig,children:A(Rr).default([])})),tB=ig.omit({direction:!0}),nB=va(()=>f({type:v("Row"),props:tB,children:A(Rr).default([])})),oB=ig.omit({direction:!0}),sB=va(()=>f({type:v("Col"),props:oB,children:A(Rr).default([])})),aB=f({background:XE,size:z(["sm","md","lg","full"]).optional()}).extend(sd.shape),rB=va(()=>f({type:v("Card"),props:aB,children:A(Rr).default([])})),iB=f({align:e5.optional(),gap:k().optional(),key:u().optional().nullish(),...sg}),cB=f({type:v("ListViewItem"),props:iB,children:A(Rr).default([])}),cg=cB;function Ty(e){return cg.safeParse(e).success}const lB=f({limit:Q([k(),v("auto")]).optional()}),uB=f({type:v("ListView"),props:lB,children:A(cg).default([])}),dB=t5.omit({flex:!0,wrap:!0}).extend(sd.shape),mB=va(()=>f({type:v("Basic"),props:dB,children:A(lg).default([])})),ad=Q([mB,rB,uB]);function pB(e){return ad.safeParse(e).success}const lg=Q([ad,Rr,cg]),ef=f({userId:u(),userDisplayName:u().nullish()}),fB=f({participants:A(ef).nullish(),owner:ef.nullish(),hasUnreadMessages:V().optional()});f({latestMessageId:u()});ef.extend({isYou:V(),avatar:u().optional(),isOwner:V()});f({token:u().min(1),displayName:u().trim().min(1).optional()});const cEe=f({conversationId:u()}),lEe=f({url:Mt()}),uEe=f({url:Mt().nullish()}),dEe=f({owner:u().nullish(),conversationTitle:u().nullish(),numberOfOtherParticipants:k().min(1)}),mEe=f({errorCode:u().optional()}),hB=f({modelName:u(),correlationPartId:u()}),gB=f({type:v("modelStatement"),partId:u(),models:A(hB)}),vB=f({type:v("provideImageFeedback"),messageId:u(),feedbackTypes:A(u())}),yB=f({type:v("createPage"),messageId:u()}),CB=f({type:v("appendToPage"),messageId:u(),pageId:u()}),SB=f({id:u(),conversationId:u()}),bB=f({id:u(),fileName:u(),contentType:u()}),pEe=f({title:u().nullish(),content:u().nullish(),conversationId:u(),attachments:A(bB).optional().nullable()}),IB=Tt.extend({type:v("page"),page:f({id:u(),conversationId:u(),title:u().nullish()})}),EB=f({id:u(),title:u().nullish(),updatedAt:u(),conversationId:u().optional(),type:z(["page","sharedPage"]).optional(),previewContent:u().nullish()}),TB=f({results:A(EB),next:u().nullish()}),fEe=f({title:u().nullish(),content:u().nullish(),shareLink:u(),page:f({id:u()}).nullable()}),hEe=f({id:u(),url:u()}),wB=z(["page-count-exceeded","page-content-length-exceeded"]),AB=f({errorCode:wB}),gEe=f({title:u().nullish()}).nullish(),vEe=z(["public","user"]),yEe=f({id:u(),url:u()});f({type:v("podcast"),id:u().min(1)});const n5=v("generatePodcast"),xB=f({type:n5,taskId:u().min(1)}),_B=f({id:u(),imageUrl:u(),voiceId:u()}),CEe=Rn(u(),f({voiceId:u()})),SEe=fe("type",[f({type:v("media"),delta:u()}),f({type:v("remainingTime"),seconds:k()}),f({type:v("startFailed"),startFailedType:Q([v("time-expired"),v("start-model-failed"),v("throttled")])}),f({type:v("terminated"),reason:Q([v("time-expired-day"),v("interrupted")])})]);z(["free-talk","prepare-interview","learn-about-x","practice-speaking","talk-to-future-self"]);const kB=f({id:u(),previewImageUrl:u(),voiceId:u().optional()}),bEe=f({portraits:A(kB)});Q([v("take-photo"),v("select-voice")]);const o5=v("createPowerPoint"),PB=f({type:o5,messageId:u(),themeId:u(),responses:Rn(u(),A(k()))}),MB=f({prompt:u()}),rd=v("executeTask"),RB=f({type:rd,taskId:u(),context:MB.optional()}),NB=["default","concise","imaginative","skeptical","curious","casual","supportive"],IEe={concise:"rgba(229, 242, 196, 0.35)",imaginative:"rgba(255, 227, 234, 0.35)",skeptical:"rgba(235, 232, 255, 0.35)",curious:"rgba(188, 248, 252, 0.35)",casual:"rgba(255, 233, 188, 0.35)",supportive:"rgba(215, 239, 255, 0.35)"},EEe={concise:"rgba(53, 64, 0, 0.35)",imaginative:"rgba(100, 28, 55, 0.35)",skeptical:"rgba(62, 44, 108, 0.35)",curious:"rgba(2, 67, 71, 0.35)",casual:"rgba(75, 55, 1, 0.35)",supportive:"rgba(14, 57, 113, 0.35)"},TEe={concise:"rgba(78, 96, 40, 1)",imaginative:"rgba(126, 26, 67, 1)",skeptical:"rgba(77, 51, 137, 1)",curious:"rgba(2, 82, 87, 1)",casual:"rgba(92, 67, 2, 1)",supportive:"rgba(5, 68, 143, 1)"},wEe={concise:"rgba(229, 242, 196, 1)",imaginative:"rgba(255, 227, 234, 1)",skeptical:"rgba(235, 232, 255, 1)",curious:"rgba(188, 248, 252, 1)",casual:"rgba(255, 233, 188, 1)",supportive:"rgba(223, 236, 255, 1)"},wy={concise:"102, 121, 1",imaginative:"188, 46, 104",skeptical:"119, 80, 208",curious:"2, 82, 87",casual:"140, 104, 1",supportive:"1, 105, 218"},Fm=.2,LB=1.2,DB="0px 2px 8px 1px",OB="0px 8px 24px 0px",UB=u();z(mR);const FB=f({currentConversationId:u().nullable(),isNewUser:V(),banExpiresAt:u().nullable(),remainingTurns:k().nullable(),features:A(UB),allowBeta:V().nullish(),userId:u().nullish(),inDataUseWaitingPeriod:V().nullish(),isBlocked:V()}),jB=f({id:u(),name:u(),previewUrl:u(),voicemails:A(u())}),BB=f({id:u(),backgroundImageUrl:u()}),VB=f({id:u(),name:u(),location:BB.nullish()}),pn=f({type:u(),label:u()}),HB=A(pn),zB=f({positive:A(pn),negative:A(pn)}),rn=Q([HB,zB]),Ws=f({type:u(),label:u(),subOptions:A(pn).nullish()}),s5=f({local:rn,ads:rn,video:rn,image:rn,sports:rn,job:rn,shopping:rn,recipe:rn,finance:rn,quiz:rn,weather:rn,personalArtifacts:rn,healthcareInfo:rn,navigation:rn,healthcareEntity:rn}),GB=f({positive:A(pn).nullish(),negative:A(pn)});s5.keyof();const a5=f({newsArticle:A(Ws),newsVideo:A(Ws),newsGem:A(Ws),chat:A(Ws),dailyBriefing:A(Ws),podcast:A(Ws),default:A(Ws)}),r5=f({journey:A(pn),product:A(pn)});r5.keyof();a5.keyof();const WB=f({computerUse:A(pn)}),$B=f({negative:A(pn)}),qB=f({text:A(pn),image:A(pn),call:A(pn),appearance:A(pn),vision:A(pn).optional(),card:s5,showroom:GB.nullish(),discover:a5.nullish(),shoppingHome:r5.nullish(),task:WB.nullish(),map:$B.nullish()}),KB=f({maxFilesPerMessage:k(),maxFileNameLength:k(),image:f({mimeTypes:A(u()),maxBytes:k()}),document:f({mimeTypes:A(u()),maxBytes:k()}),binary:f({mimeTypes:A(u()),maxBytes:k()})}),YB=f({minTextLength:k().min(0),textDeltaPercent:k().min(0).max(100),debounceInMilliseconds:k().min(0)}),ZB=f({language:u(),label:u()}),JB=f({signInPrompts:A(k()),voices:A(jB),voiceLanguages:A(ZB).optional(),maxTextMessageLength:k(),feedbackOptions:qB,characters:A(VB).nullish(),pageLimit:k(),maxPageContentLength:k(),maxPageTitleLength:k(),messagePreview:YB,attachments:KB,portraits:A(_B).nullish(),characterAppearance:zF.nullish()});f({hasVisionAccess:V(),allowedDomains:A(u()).nullable(),allowedDomainSuffixes:A(u()).nullable(),blockedDomains:A(u()).nullable(),blockedDomainSuffixes:A(u()).nullable()});const QB=f({startTime:u(),text:u()}),XB=f({startTime:u(),text:u(),words:A(QB)}),Ay=f({url:u(),duration:k(),transcript:A(XB).nullish()}),eV=f({title:u(),image:u(),url:u(),createdAt:u()}),tV=f({publisherName:u(),publisherIcon:u(),articles:A(eV)}),xy=f({url:u(),foregroundColor:u(),backgroundColor:u()}),_y=f({name:u(),foregroundColor:u(),backgroundColor:u(),altText:u().nullish(),url:u()}),nV=f({landscape:_y,portrait:_y}),oV=f({id:u(),title:u(),image:f({landscape:xy,portrait:xy}),audio:Rn(u(),Ay),transitionMusic:Ay.nullable(),sources:A(tV)}),i5=f({topics:A(f({id:u(),label:u(),imageUrl:u(),isFollowed:V()}))}),sV=f({position:k(),chapterId:u()}),c5=f({isAvailable:V(),podcastId:u(),chapters:A(oV),topics:i5.optional(),playback:sV}),aV=f({positionInSeconds:k(),chapterId:u()}),rV=f({id:u(),title:u(),topic:u().nullable().optional(),image:nV,audio:f({name:u(),duration:k()})}),lu=f({isAvailable:V(),podcastId:u(),chapters:A(rV),playback:aV}),iV=z(lR),l5=z(iR),cV=z(cR),lV=f({channel:cV,tier:l5,isAutoRenew:V()}),ug=Q([v("biometric-data-use"),v("biometric-data-use-notice")]),uV=f({portrait:f({consentType:v("portrait"),version:u().nullable()}).nullable(),compliance:f({consentType:v("teen"),version:u()}).nullable(),vision:f({consentType:ug,version:u().nullable()}).nullable()}),u5=dl({id:u(),preferredName:u().nullish(),firstName:u().nullable(),anid:u().nullable(),isPro:V(),isDeprecated:V().nullish(),inEeaPlusRegion:V(),inGdprRegion:V(),regionCode:z(Object.values(vc)),isHistoryMigrationPending:V(),isInsider:V(),isEligibleForFreeTrial:V().optional(),phoneLink:dl({deviceName:u().nullable()}).nullable(),ageGroup:z(aR).nullable(),allowedToggles:dl({textTraining:V(),voiceTraining:V(),personalization:V(),adsPersonalization:V().nullish()}),remainingUsage:dl({reasoningCalls:k(),podcastGenerations:k(),researchCalls:k(),visionCallSeconds:k(),videoGenerations:k()}).nullish(),accountTier:iV.nullish(),subscriptions:A(lV).nullish(),requiredConsents:uV,privacyRequirement:z(dR).nullable()}),dV=f({type:v("message"),conversationId:u(),title:u(),updatedAt:u(),messageId:u(),snippet:u()}),mV=f({type:v("conversation"),conversationId:u(),title:u(),updatedAt:u()}),pV=fe("type",[dV,mV]);f({results:A(pV),next:u().nullable()});const fV=f({preferredVoice:u().nullable(),preferredVoiceLanguage:u().nullable().optional(),preferredCharacter:u().nullable().optional(),personality:f({traits:A(z(NB))}).nullable().optional(),toggles:f({training:V(),personalization:V(),"phone-connection":V(),"voice-training":V(),"biometric-data-use":V().optional(),"browser-cookies":V().optional(),"one-drive-access":V().optional(),"computer-use-actions":V().optional(),"ads-personalization":V().optional(),"microsoft-profile-access":V().optional(),proactivity:V().optional(),allowEdgePasswordsAccess:V().optional(),allowOutlookAccess:V().optional(),optInToGenerativeUI:V().optional()})}),hV=f({assertion:u().optional()});f({result:z(["new-microsoft-account-linked","already-linked"]).optional()});const dg=f({errorCode:Q([v("attachment-too-large"),v("unsupported-content-type"),v("empty-attachment"),v("content-blocked"),v("rate-limit-exceeded"),v("not-signed-in")])}),gV=Q([f({url:u()}),dg]),vV=Q([f({id:u()}),dg]),yV=Q([f({results:A(f({externalId:u(),attachmentId:u(),isSuccessful:V(),url:u().nullable()}))}),dg]),CV=f({errorCode:u()}),SV=Q([f({callId:u()}),CV]),bV=z(["excel","copilot-chat","copilot-notebook","outlook","power-point","teams","word"]),IV=f({app:bV,documentUrl:u().nullish(),documentName:u().nullish(),documentUpdatedAt:u().nullish()}),mg=f({id:u(),title:u().optional(),updatedAt:u(),characterId:u().nullable().optional(),continuedAt:u().nullable(),group:fB.nullish(),isPinned:V().nullish(),type:u().optional(),url:u().optional(),source:IV.nullish(),taskId:u().optional(),status:u().optional(),hasUnreadMessages:V().optional()}),EV=f({results:A(mg),next:u().nullable()}),TV=f({id:u()}),pg=Q([v("thumbs-down"),v("thumbs-up"),_r()]),Ma=Q([v("running"),v("completed"),v("failed"),v("cancelled"),v("pending"),v("paused")]),wV=Q([v("research"),v("computerUse"),v("podcast"),v("videoGeneration"),v("planning"),v("threeDGeneration")]),AV=f({type:v("chainOfThought"),text:u()}),xV=f({type:v("query"),text:u()}),_V=f({type:v("citation"),title:u(),url:u()}),kV=z(["start","preplan","plan","exploration","reflection","report"]),PV=f({completion:k().min(0).max(1),step:kV}),MV=fe("type",[AV,xV,_V]),RV=f({url:u().nullish(),prompt:u()}),d5=f({url:u(),createdAt:u()}),NV=f({type:v("computerUse"),title:u().nullish(),conversationId:u().nullish(),id:u(),status:Ma,lastScreenshot:d5.nullish(),updatedAt:u().nullish()}),m5=f({id:u(),title:u().nullish(),thumbnail:f({name:u().nullish()}).nullish()}),LV=f({type:v("podcast"),id:u(),podcast:m5.nullish(),status:Ma,updatedAt:u().nullish()}),DV=f({type:v("error"),errorCode:z(["Failed","Blocked","Throttled"])}),OV=f({type:v("success"),thumbnailUrl:u().nullish(),videoUrl:u().nullish()}),p5=fe("type",[DV,OV]),UV=f({type:v("error"),errorCode:z(["Failed","Blocked","Throttled","InvalidInput"])}),FV=f({type:v("success"),glbUrl:u(),gifUrl:u().optional(),stlUrl:u().optional(),thumbnailUrl:u()}),f5=fe("type",[UV,FV]),h5=z(["default","cartoon","mecha","miniature","realistic"]),jV=f({type:v("videoGeneration"),id:u(),result:p5.nullish(),status:Ma,prompt:u().nullish(),updatedAt:u().nullish()}),BV=f({type:v("threeDGeneration"),id:u(),result:f5.nullish(),status:Ma,attachmentId:u(),style:h5.nullish(),updatedAt:u().nullish()}),Nr=f({id:u(),title:u().optional(),conversationId:u().optional(),scheduledTaskId:u().nullish(),updatedAt:u(),status:Ma,type:wV,reaction:Mu().nullish()}),VV=Nr.extend({type:v("research")}),HV=Nr.extend({type:v("computerUse"),screenshot:u().nullish(),lastScreenshot:d5.nullish(),chainOfThought:A(u()).nullish(),computerAction:u().nullish(),statusChange:PN.optional(),lastUserCommand:Ta.optional(),reaction:pg.optional(),activeTabFaviconUrl:u().nullish(),activeTabTitle:u().nullish(),viewMode:jN.nullish(),replay:VN.nullish()}),zV=Nr.extend({type:v("podcast"),podcast:m5.nullish()}),GV=Nr.extend({type:v("videoGeneration"),result:p5.nullish()}),WV=Nr.extend({type:v("planning"),agentConversationId:u().optional()}),$V=Nr.extend({type:v("threeDGeneration"),result:f5.nullish(),attachmentId:u(),style:h5.nullish(),reaction:pg.optional()}),qV=fe("type",[VV,HV,zV,GV,WV,$V]),AEe=f({results:A(qV),next:u().nullable()}),Qt=Q([v("report"),...pg.options]),KV=f({type:v("planning"),id:u(),title:u().nullish(),agentConversationId:u(),status:Ma,updatedAt:u(),reaction:Qt.nullable()}),YV=Q([v("generating"),v("generated"),v("failed"),v("non-complete")]),id=f({id:u(),createdAt:u()}),ZV=f({index:u(),title:u(),url:u(),iconUrl:u().nullable(),publisher:u().nullable(),snippet:u().nullish(),label:u().nullish()}),fg=Tt.extend({type:v("image"),url:u().optional(),prompt:u().optional().nullable(),isPartiallyLoading:V().optional(),reaction:Qt.optional(),partialGenerationStep:k().optional(),status:YV.optional(),progressionText:u().nullable().optional()}),JV=Tt.extend({type:v("generativeUI"),rootNode:Q([ad,_r()]),partIdToPath:Rn(u(),A(k())),completed:V(),startTime:k().optional()}),QV=Tt.extend({type:v("uiComponent"),parentPartId:u().nullable(),component:Mu(),requiredComponents:Rn(u(),u()).optional()}),g5=Tt.extend({type:v("citation"),...Bh.shape}),hg=Tt.extend({type:v("text"),text:u(),citations:A(ZV).optional(),reaction:Qt.optional()}),gg=Tt.extend({type:v("card"),card:WE,reaction:Qt.optional()}),XV=Q([v("loading"),v("success"),v("failed")]),eH=Tt.extend({type:v("indicator-ai-response"),text:u(),state:XV}),tH=Tt.extend({type:v("inline-consent-disclaimer")}),v5=Tt.extend({type:v("document"),attachmentId:u(),fileName:u(),contentType:Sc,reaction:Qt.optional()}),nH=Tt.extend({type:v("deleted"),partType:z(["page","task"])}),oH=Tt.extend({type:v("error"),text:u()});f({text:u(),title:u().optional(),lastSubActionScreenshotUrl:u().nullish()});const y5=Tt.extend({type:v("chainOfThought"),text:u(),title:u().optional(),screenshotUrl:u().nullish(),reaction:Qt.optional(),partId:u()}),sH=Q([y5,UI]),aH=Tt.extend({type:v("chainOfThoughtGroup"),items:A(sH).optional(),isComplete:V()}),rH=Tt.extend({type:v("memorySignal"),text:u(),signalType:Q([v("remember"),v("forget"),v("remember-name"),v("forget-name")]).nullish()}),iH=f({position:Q([v("left"),v("right")]),isDefault:V(),isStreamingComplete:V().optional()}),cH=fe("type",[hg,fg,g5,gg]),C5=f({id:u(),title:u().nullish(),contents:A(MV).nullish(),inlineCitations:A(Bh).nullish(),partialOutput:A(u()).nullish(),finalResponse:u().nullish(),reportContent:A(cH).nullish(),summary:u().nullish(),coverImage:RV.nullish(),type:v("research"),status:Ma,prompt:u().optional(),progress:PV.nullish()}),xEe=C5.omit({id:!0}).extend({shareId:u()}),S5=fe("type",[C5,NV,LV,jV,KV,BV]),lH=Tt.extend({type:v("task"),task:S5.nullish(),reaction:Qt.optional()}),b5=Q([Oh,v("pending")]),I5=Tt.extend({type:v("step"),title:u(),status:b5,partId:u(),reaction:Qt.nullish()}),uH=f({title:u().min(1),snippet:u().nullish(),iconUrl:u().nullish(),url:u().min(1)}),E5=Tt.extend({type:v("webSearch"),partId:u(),reaction:Qt.nullish(),query:u().min(1),results:A(uH)}),T5=Tt.extend({type:v("textFile"),partId:u(),reaction:Qt.nullish(),content:u().min(1),contentType:u().min(1),fileName:u().min(1)}),w5=Tt.extend({type:v("shellCommandExecution"),partId:u(),reaction:Qt.nullish(),shell:u().min(1),command:u().min(1),output:u().nullable()}),dH=f({id:k(),url:u().optional(),title:u().optional()}),mH=f({url:u().optional(),iconUrl:u().optional()}),pH=f({type:v("localBrowser"),tabs:A(dH).nullish()}),fH=f({type:v("remoteBrowser"),tabs:A(mH).nullish()}),hH=fe("type",[pH,fH]),A5=Tt.extend({type:v("computerUse"),screenshotUrls:A(u()).nullish(),environment:hH.nullish()}),gH=fe("type",[hg,I5,E5,gg,v5,fg,T5,w5,A5]),vH=Tt.extend({type:v("agentTaskProgressGroup"),items:A(gH).optional(),isComplete:V()}),yH=fe("type",[hg,JV,fg,IB,g5,oH,gg,v5,lH,nH,y5,aH,UI,rH,eH,gB,tH,I5,E5,T5,w5,A5,vH,QV]),x5=f({type:v("text"),text:u()}),_5=f({type:v("browserTabs"),tabs:A(f({title:u().optional(),url:u().optional(),id:k().optional(),favIconUrl:u().optional(),windowId:k()}))}),k5=f({type:v("image"),url:u(),fileName:u().optional(),localUrl:u().optional()}),P5=f({type:v("document"),partId:u(),fileName:u(),contentType:u()});f({type:v("document"),attachmentId:u()});const vg=v("startProductCheckoutActions"),CH=f({type:vg,offerId:u().nullish()}),M5=v("requestPrompt"),SH=f({type:M5,promptKey:u()});Q([Ta,rd,vg]);Q([v("provideImageFeedback"),v("createPage"),v("appendToPage"),v("promptCharacterSpeech"),v("sendFormData"),v("topicClick"),v("setCharacterAppearance"),v("triggerPlanningAgent"),v("startCall"),v("editPresentation"),YI,Ta,rd,n5,o5,vg,M5]);const bH=f({type:v("promptCharacterSpeech")}),IH=f({type:v("topicClick"),topic:u()}),EH=f({type:v("setCharacterAppearance"),body:qE,accessories:og.optional()}),TH=f({type:v("triggerPlanningAgent")}),wH=f({type:v("startCall"),callType:u(),initiator:u().optional()}),AH=f({type:v("editPresentation"),artifactId:u(),slideId:u(),elementId:u().optional(),editType:u()}),xH=fe("type",[vB,yB,CB,MN,RN,NN,LN,DN,ON,FN,bH,RB,xB,PB,IH,CH,EH,SH,hN,TH,eL,wH,AH]),R5=f({type:v("command"),command:xH}),_H=f({type:v("dailyBriefing"),chapterId:u()}),kH=f({type:v("greeting"),greetingMessage:u()}),PH=f({type:v("news"),articleId:u()}),MH=f({type:v("newsGem"),gemId:u(),snapshotKey:u()}),RH=f({type:v("url"),url:u()}),NH=f({type:v("user"),id:u(),displayName:u()}),LH=f({type:v("copilot")}),DH=f({type:v("discoveryCard"),feedId:u(),cardId:u()}),N5=fe("type",[_H,kH,PH,MH,RH,NH,LH,DH]);f({type:v("reference"),reference:N5});const L5=f({type:v("reference"),content:N5}),D5=fe("type",[x5,k5,P5,R5,_5,L5]),yg=["chat","smart","smart-latest","study","reasoning","research","computerUse","search","coco","browserAction","analyst"],kc=z(yg),Cg=f({type:v("ai")}),Sg=f({type:v("human")}),bg=f({type:v("groupParticipant"),id:u(),displayName:u().nullish()});fe("type",[Cg,Sg,bg]);const OH=z(["idle","streaming"]),Ig=id.extend({author:v("ai"),authorMetadata:Cg.optional(),content:A(yH),mode:kc.optional(),sideBySideConfig:iH.optional(),reaction:Qt.optional(),streamingState:OH.optional().default("idle")}),Eg=id.extend({author:v("human"),authorMetadata:Sg.optional(),content:A(D5),mode:kc.nullable()}),Tg=id.extend({author:v("groupParticipant"),authorMetadata:bg.optional(),content:A(D5),mode:kc.nullable()}),UH=id.extend({author:v("system")}),FH=z(["kicked","joined","left"]),jH=UH.extend({participant:f({userId:u(),userDisplayName:u()}),updateType:FH}),BH=Ig.omit({authorMetadata:!0}).extend({author:Cg}),O5=Q([BH,Eg.omit({authorMetadata:!0}).extend({author:Sg}),Tg.omit({authorMetadata:!0}).extend({author:bg})]),U5=f({results:A(O5),next:u().nullable()}),_Ee=f({url:u()}),VH=f({conversation:f({id:u(),title:u()})});f({qc:f({q:u(),gt:u(),sc:u()}),s:A(f({st:u(),t:u()}))});const HH=f({suggestions:A(f({text:u(),source:u()}))}),zH=z(["actions","image","podcast","researchReport","quiz","homeworkHelper","video","page"]),Oo=z(["prefillComposer","sendMessage","changeChatMode","changeComposerCreateMode","uploadFile","tutoringCall","createPage","createProject","openHomeworkHelper"]),cd=fe("type",[f({type:v(Oo.enum.prefillComposer),prompt:u()}),f({type:v(Oo.enum.sendMessage),prompt:u()}),f({type:v(Oo.enum.changeChatMode),key:kc}),f({type:v(Oo.enum.changeComposerCreateMode),key:zH}),f({type:v(Oo.enum.uploadFile)}),f({type:v(Oo.enum.tutoringCall)}),f({type:v(Oo.enum.createPage)}),f({type:v(Oo.enum.createProject)}),f({type:v(Oo.enum.openHomeworkHelper)})]),F5=f({id:u(),text:u(),action:cd});f({id:u(),text:u(),action:cd});const GH=z(["quiz","flashcards","learn-live","upload-files","pages","projects","homework-helper"]),WH=f({id:GH,title:u(),description:u(),iconType:u().optional(),action:cd}),$H=f({id:u(),label:u(),items:A(F5)}),qH=f({type:v("banner"),id:u(),title:u(),description:u().nullish(),thumbnail:f({url:u(),urlDark:u().nullish(),altText:u()}),action:cd}),j5=fe("type",[f({type:v("text"),id:u(),title:u().nullish(),items:A(F5)}),f({type:v("categories"),id:u(),title:u().nullish(),categories:A($H)}),qH,f({type:v("card"),id:u(),title:u().nullish(),items:A(WH)})]);f({widgets:A(j5)});const KH=f({text:u()}),YH=f({greetingOptions:A(KH),widgets:A(j5)}),ZH=f({pages:A(YH)});f({Questions:A(u()),Url:u(),NormalizedUrl:u().optional(),DebugInfo:u().optional()});f({tabId:k(),windowId:k(),url:u(),title:u(),content:u().optional(),favIconUrl:u().optional()});const JH=f({name:u(),isGranted:V(),isOptional:V()}),B5=f({id:u(),type:z(kI),status:z(_I),scopes:A(JH).nullish()}),QH=f({connections:A(B5)}),kEe=f({connection:B5,loginUrl:u()}),XH=f({encrypted:f({keyName:u(),blob:u()}),unencryptedMetadata:f({url:u(),blacklisted:V().optional(),dateLastUsedWindowsEpochMicros:k().optional(),passwordIssues:Rn(u(),b9()).optional(),type:k()}),encryptedNotesBackup:f({keyName:u(),blob:u()}).optional()});f({passwords:A(XH),count:k(),hasMore:V().optional()});const PEe=f({sessionKey:u()}),ez=fe("author",[Ig,Eg,Tg]),MEe=fe("author",[Ig,Eg,Tg,jH]),tz=fe("eventName",[f({eventName:v("auth0.accountAdded")}),f({eventName:v("auth0.accountRemoved")})]),nz=["imagegeneration","f1","school","msn","bing","newdeviceuserpromotion"],Is={OPENED:0,RECENT:1,HISTORY:2},oz=f({messages:A(ez),conversationTitle:u()}),sz={ocid:"OCID",OCID:"OCID",msclkid:"msclkid",gclid:"gclid",rdt_cid:"rdtCid",fbclid:"fbclid",ttclid:"ttclid",li_fat_id:"liFatId",vmcid:"vmcid",ttd_clk:"ttdClk"},ky={gclid:"Google",msclkid:"Bing",rdt_cid:"Reddit",fbclid:"Meta",ttclid:"TikTok",li_fat_id:"LinkedIn",vmcid:"Yahoo",ttd_clk:"TradeDesk"};let V5=null;function Pt(e){return typeof window>"u"?null:new URLSearchParams(window.location.search).get(e)}function Qo(e){H5([e])}function H5(e){const t=new URL(window.location.href),n=e.filter(o=>t.searchParams.has(o));if(n.length!==0){for(const o of n)t.searchParams.delete(o);window.history.replaceState(null,"",t)}}function az(){return Object.entries(sz).reduce((e,[t,n])=>{const o=Pt(t);return o?{...e,[n]:o}:e},{})}function z5(){H5(["ocid","OCID","msclkid","gclid","rdt_cid","fbclid","ttclid","li_fat_id","vmcid","ttd_clk"])}function rz(){const e=Pt("form");if(e)return Qo("form"),e;const t=Pt("FORM");return t&&Qo("FORM"),t}function G5(){const e=Pt("ocid");return e||Pt("OCID")}function iz(){return Pt("alias")}function cz(){const e=Pt("chat-mode");return e&&Qo("chat-mode"),e}function REe(){const e=Pt("audiomode");return e&&Qo("audiomode"),e}function lz(){const e=Pt("q");return e&&Qo("q"),e}function uz(){const e=Pt("prompt");return e&&Qo("prompt"),e}function dz(){const e=Pt("sandbox");return e&&Qo("sandbox"),e==="1"}function mz(){if(typeof window>"u")return!1;const e=Pt("disable-all-features");return e!==null&&e!=="0"&&e!=="false"}function NEe(){return Pt("payflow-correlationId")}function LEe(){return Pt("entry-point")??""}function pz(){const e=Pt("windows");return e&&Qo("windows"),e==="1"}function W5(){return Pt("charid")}const fz=[["payflowCorrelationId","pfcid"],["payflowFrom","pff"],["payflowAuthHint","pfah"],["payflowEntry","pfe"],["payflowRequiresPremium","pfrp"]];function DEe(){const e={payflowCorrelationId:"",payflowFrom:"",payflowAuthHint:"",payflowEntry:"",payflowRequiresPremium:""};for(const[t,n]of fz){const o=Pt(n);o&&(e[t]=o)}return e}function hz(){const e=Pt("intent");return V5??=e,e}function gz(){return V5}function vz(e){const t=e.toLowerCase();return nz.includes(t)}const yz=["text","queryParam"];function Cz(e){return yz.includes(e)}function Sz(){const e=Pt("input-method");return e?(Qo("input-method"),Cz(e)?e:"queryParam"):"queryParam"}function OEe(){return[]}function UEe(){return[]}function Ns(e){const t=typeof navigator<"u"?navigator.userAgent:null;return t?e.test(t):!1}function bz(){return Ns(/BingSapphire/gi)}function Iz(){return Ns(/NewsSapphire/gi)}function wg(){return typeof navigator>"u"?!1:!!(navigator.userAgent.match(/Mac/)&&navigator.maxTouchPoints&&navigator.maxTouchPoints>2||/Macintosh/i.test(navigator.userAgent)&&"ontouchend"in document)}function ld(){return wg()||Ns(/iPad|iPhone|Android|iPod/gi)}function Ez(){return Ns(/macintosh|mac os x/gi)&&!wg()&&!Ag()}function $5(){return Ns(/Android/gi)}function Ag(){return wg()||Ns(/iPhone|iPad|iPod/gi)}function q5(){return Ns(/Windows|Win32|WOW64/i)}function Tz(){return Ns(/CopilotNative.*macOS/gi)}const ud=_(!1),wz=V().optional(),Sr=Kt({key:$M,schema:wz,initialValue:void 0}),Az=V().optional(),jm=Kt({key:qM,schema:Az,initialValue:void 0});function B(e){return ke().get(e)}function xz(){return B(ud)&&!!B(Sr)}function K5(){return typeof window>"u"||window.isStudioServer?"studio":"snr"}const _z={"thumbs-up":"thumbsUp","thumbs-down":"thumbsDown",report:"reportMessage"},Py="homepage";function kz(){return{instrumentationKey:"be6e4c19699f4fdf9f8c0ec9f9b398ef-25d58bb9-9926-4df7-8e36-bc7afb4b2c34-7563",channelConfiguration:{eventsLimitInMem:5e3,autoFlushEventsLimit:5},propertyConfiguration:{populateBrowserInfo:!0},disableCookiesUsage:!0,extensionConfig:{PostChannel:{maxBatchInterval:1e4,maxBatchCount:20,immediateEventLimit:100}}}}class Pz{analytics=null;features=void 0;picassoId=null;anid=null;formCode=null;landingPage=Py;trafficAlias=null;settings=null;isAADUser=null;isNewUser=null;isCopilotMode=null;accountType=null;referrer=null;ocid=null;deviceInfo=null;anaheimId=null;wcpId=null;chromiumFlightIds=null;chromiumPayloadId=null;deviceInfoId=null;sqmId=null;windowsFlightIds=null;pluginProvider=null;pluginCache=null;publisherInfo=null;isInitializing=!1;pendingEvents=[];pendingUserReadyEvents=[];initRetryCount=0;maxRetries;maxPendingEvents;delay;onInitializeError;initializationPromise=null;constructor(t={}){this.maxRetries=t.maxRetries??3,this.maxPendingEvents=t.maxPendingEvents??1e3,this.delay=t.delay??0,this.onInitializeError=t.onInitializeError}getSurface(){return this.getPlatformSurface("cmc")}getAppName(){return`CopilotN-${this.currentEnv}-web-${this.getSurface()}`}ensureInitialized(t){!this.isInitialized&&!this.isInitializing&&(this.pluginProvider=t,this.isInitializing=!0,this.initialize())}get plugin(){return this.pluginCache===null&&this.pluginProvider!==null&&this.analytics!==null&&(this.pluginCache=this.pluginProvider(),this.pluginCache&&this.analytics.addNotificationListener(this.pluginCache)),this.pluginCache}get isInitialized(){return this.analytics!==null&&this.analytics.isInitialized()}get currentEnv(){return"prod"}get initializationFailed(){return this.initRetryCount>=this.maxRetries}setChromiumFlightIds(t){this.chromiumFlightIds=t}setDeviceInfoId(t){this.deviceInfoId=t}setSqmId(t){this.sqmId=t}setWindowsFlightIds(t){this.windowsFlightIds=t}setFeatures(t){this.features=t.join(",")}setAnid(t){this.anid=t}getAnid(){return this.anid}setIsNewUser(t){this.isNewUser??=t}setIsAad(t){this.isAADUser=t}setCopilotMode(t){this.isCopilotMode=t}setSettings(t){this.settings={...this.settings,...t}}getPicassoId(){return this.picassoId}setPicassoId(t){const n=this.picassoId===null;this.picassoId=t,n&&t!==null&&this.flushPendingUserReadyEvents()}setFormCode(t){this.formCode=t}getFormCode(){return this.formCode}setDeviceInfo(t){this.deviceInfo=t}setLandingPage(t){this.landingPage===Py&&(this.landingPage=t)}getLandingPage(){return this.landingPage}isValidLowercaseUserAccountType(t){return["msa","aad","apple","google"].includes(t)}setUserAccountType(t){if(!t){this.accountType=null;return}const n=t.toLowerCase();this.isValidLowercaseUserAccountType(n)?this.accountType=n:this.accountType=null}getUserAccountType(){return this.accountType}processFormCode(){const t=rz();this.formCode=t}processAlias(){const t=iz();t&&(this.trafficAlias=t)}processReferrer(){this.referrer===null&&typeof document<"u"&&(this.referrer=document.referrer)}processOcid(){this.ocid===null&&typeof window<"u"&&(this.ocid=G5())}getXClientDataHeaderFromHTML(){try{const t=document.querySelector("meta[name='x-client-data']");if(!t)return null;const n=t.getAttribute("content");if(!n)return null;const o=atob(n),s=JSON.parse(o);if(typeof s!="object"||s===null)return null;const a=s,r="4"in a&&typeof a[4]=="string"?a[4]:null,i="7"in a&&typeof a[7]=="string"?a[7]:null;return{clientId:r,payloadId:i}}catch{return null}}processXClientDataHeaderFields(){const t=this.getXClientDataHeaderFromHTML();t?.clientId&&(this.getSurface()==="wchromium"?this.wcpId=t.clientId:this.anaheimId=t.clientId),t?.payloadId&&(this.chromiumPayloadId=t.payloadId)}initialize(){this.isInitialized||(this.processFormCode(),this.processAlias(),this.processReferrer(),this.processOcid(),this.processXClientDataHeaderFields(),this.processPublisherFromUrl(),this.initializationPromise=this.dynamicInitialization(),this.initializationPromise.catch(()=>{}))}async dynamicInitialization(){this.delay>0&&await new Promise(n=>{setTimeout(n,this.delay)});const t=await N(()=>import("./1ds-analytics-js-BQ_ODquZ.js"),[]).catch(n=>n instanceof Error?n:new Error(`Failed to load @microsoft/1ds-analytics-js: ${n}`));if(t instanceof Error)this.onInitializeError?.(t),this.initRetryCount+=1,this.initRetryCount>=this.maxRetries&&(this.onInitializeError?.(new Error("ApplicationInsights initialization: Max retries reached")),this.pendingEvents.length=0);else{const{ApplicationInsights:n}=t;this.analytics=new n;const o=kz();this.analytics.initialize(o,[]),this.flushPendingEvents()}this.isInitializing=!1}flushPendingEvents(){for(let t=0,n=this.pendingEvents.length;t<n;t+=1){const o=this.pendingEvents[t];o&&this.trackEventInternal(o)}this.pendingEvents.length=0}flushPendingUserReadyEvents(){for(let t=0,n=this.pendingUserReadyEvents.length;t<n;t+=1){const o=this.pendingUserReadyEvents[t];o&&this.trackEventInternal(o)}this.pendingUserReadyEvents.length=0}getPlatformSurface(t){if(t==="pageseditor"){if($5())return"android";if(Ag())return"ios";if(Tz())return"mac"}return t}getAppFlavor(){return xz()?{eventInfo_appFlavor:"beta"}:null}processPublisherFromUrl(){const t=new URLSearchParams(window.location.search),n=Object.keys(ky).find(o=>t.has(o));n&&(this.publisherInfo={publisher:ky[n]})}getFixEventProperties(){return{appName:this.getAppName(),appVersion:Xu(),surface:this.getSurface(),server:K5(),surfaceVersion:LR(navigator.userAgent),accountType:this.accountType,userMuid:Yo("MUID"),aliasMuid:Yo("MUID",1),userAnid:this.anid,userPicassoId:this.picassoId,userFlightIds:this.features,trafficAlias:this.trafficAlias,eventInfo_entryPoint:this.formCode,eventInfo_surfaceVisible:document.visibilityState==="visible",eventInfo_isCopilotMode:this.isCopilotMode,isAADUser:this.isAADUser,isNewUser:this.isNewUser,pathname:window.location.pathname,referrer:this.referrer,ocid:this.ocid,...this.anaheimId!==null?{anaheimId:this.anaheimId}:{},...this.wcpId!==null?{wcpId:this.wcpId}:{},...this.chromiumFlightIds!==null?{chromiumFlightIds:this.chromiumFlightIds}:{},...this.chromiumPayloadId!==null?{chromiumPayloadId:this.chromiumPayloadId}:{},...this.deviceInfoId!==null?{DeviceInfo_Id:this.deviceInfoId}:{},...this.sqmId!==null?{DeviceInfo_sqmId:this.sqmId}:{},...this.windowsFlightIds!==null?{eventInfo_windowsFlightIds:this.windowsFlightIds}:{},renderingType:$u(),"UserInfo.Id":this.picassoId,...Gi.getTraceIdAnalytics(),...this.settings,...this.deviceInfo,...this.getAppFlavor(),...this.publisherInfo}}trackEvent(t){if(!this.initializationFailed){if(this.pendingEvents.length>=this.maxPendingEvents){console.warn(`Analytics pending events queue is full (${this.maxPendingEvents}). Dropping event: ${JSON.stringify(t)}`);return}if(this.ensureInitialized(this.pluginProvider),this.isInitializing||!this.isInitialized){this.pendingEvents.push(t);return}this.trackEventInternal(t)}}async trackEventAsyncAfterInit(t){this.isInitialized?this.trackEvent(t):this.initializationPromise&&await this.initializationPromise}trackEventAfterUserReady(t){if(this.getPicassoId()===null){if(this.pendingUserReadyEvents.length>=this.maxPendingEvents){console.warn(`Analytics pending user-ready events queue is full (${this.maxPendingEvents}). Dropping event: ${JSON.stringify(t)}`);return}this.pendingUserReadyEvents.push(t)}else this.trackEvent(t)}flush(){this.isInitialized&&this.analytics&&this.analytics.flush()}trackEventInternal(t){const n=this.getFixEventProperties(),o=Ia(),s=yI(),a=this.plugin?.generateClientEventId(t)??void 0;if(!this.analytics){console.error("Failed to initialize AnalyticsService.");return}const r={name:t.name,data:{...n,eventInfo_clientEventId:a,...t.data},ext:{web:{consentDetails:JSON.stringify({Required:!0,Analytics:o.analytics,SocialMedia:o.socialMedia,Advertising:o.advertising,GPC_DataSharingOptIn:s})}}};(t.data.eventName==="copilotCompose"||t.data.eventName==="copilotAudioInput")&&Ce.emit("composer:send-query",{isNewUser:this.isNewUser,event:t.data}),this.plugin?.onBeforeTrackEvent(r),this.analytics.track(r)}}const R=new Pz({maxRetries:3,maxPendingEvents:1e3,delay:200,onInitializeError:e=>{console.error("AnalyticsService initialization error:",e)}}),Mz=.03,Rz=.1;function Nz(){return J.instance().config().sentryDsnOverride??"https://323dd84fb4f632ccd95493debe9312e0@o4508134825000960.ingest.us.sentry.io/4508799962644480"}let Bm,Ya;async function Lz(e,t){const n=await xg();n&&n.captureReactException(e,t)}async function xg(){return Bm||Ya||(Ya=(async()=>{try{const e=await N(()=>import("./index-CqM2fyUO.js"),__vite__mapDeps([3,1]));Bm=e;const t=[e.browserTracingIntegration({enableLongAnimationFrame:!0}),e.tanstackRouterBrowserTracingIntegration(Nn())],n=hy?[e.browserProfilingIntegration()]:[],o={surface:"cmc",isMobile:ld()?"1":"0",server:K5(),renderingType:$u()};return e.init({dsn:Nz(),release:NR(),sampleRate:Rz,environment:"production",integrations:[...t,...n],tracesSampleRate:Mz,profilesSampleRate:hy?.1:0,replaysSessionSampleRate:0,replaysOnErrorSampleRate:0,beforeSendSpan(s){return s.data.surface=o.surface,s.data.isMobile=o.isMobile,s.data.server=o.server,o.renderingType&&(s.data.renderingType=o.renderingType),s}}),e.setTag("surface",o.surface),e.setTag("isMobile",o.isMobile),e.setTag("server",o.server),o.renderingType&&e.setTag("renderingType",o.renderingType),Ya=void 0,e}catch{Ya=void 0;return}})(),Ya)}async function Dz(e){const t=await xg();t!==void 0&&t.setUser(e?{id:e}:null)}function Y5(e,t){const n=PR(e);R.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"ErrorBoundary",eventInfo_errorName:e.name,eventInfo_errorMessage:e.message,eventInfo_errorStack:e.stack??"",eventInfo_componentStack:t.componentStack??"",...n&&{eventInfo_apiRoute:n},...e instanceof Ju&&{eventInfo_statusCode:e.statusCode}}}),Lz(e,t)}function Oz(e){return e instanceof Fi?I9(e):e instanceof Error?e.message:String(e)}function dr(e,t,n=!1){const o=Oz(e);R.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"APIResponseParseError",eventInfo_apiUrl:t,eventInfo_errors:o,eventInfo_safe:n}})}async function My(e){const t=await kR(e.promise);R.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"UnhandledRejection",eventInfo_reason:`${e.reason}`,eventInfo_customData:t}})}function Uz(e,t,n){try{new URL(Qu(e)).hostname}catch(o){R.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"invalidCitationURL",eventInfo_url:e,eventInfo_errorMessage:o instanceof Error?o.message:"",eventInfo_conversationId:t,eventInfo_messageId:n}})}}function Z5(e){R.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"PlaybackApiError",eventInfo_errorMessage:e instanceof Error?e.message:"",eventInfo_details:"An error occurred during media playback tracking api call."}})}function Fz(e,t,n){R.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"InvalidJsonResponse",eventInfo_apiUrl:n,eventInfo_errorMessage:e.message,eventInfo_errorCode:t.statusText,eventInfo_details:JSON.stringify(Object.fromEntries(t.headers.entries()))}})}const jz=25,Bz=25,Vz=6e3,Hz=12,J5=["mica","aqua","erin"];function Q5(e){switch(e){case"mica":case"aqua":case"erin":return e;default:return null}}function zz(e,t){switch(e){case"mica":return t("characterAnimation.characterNameMica");case"aqua":return t("characterAnimation.characterNameAqua");case"erin":return t("characterAnimation.characterNameErin");default:return""}}function Gz(e,t){return(n,o)=>{R.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"CharacterError",eventInfo_details:`animatingMessageId: ${e}, characterId: ${t}, name: ${n.name}, info: ${o.componentStack}`,eventInfo_errorMessage:n.message}}),Y5(n,o)}}function Wz(e,t){try{const n=e?.updatedAt;if(!t||!n)return;const o=new Date(n),s=new Date(t);(o.getTime()-s.getTime())/1e3/60>1&&R.trackEvent({name:"system",data:{eventName:"historyUpdatedAtDiscrepancy",eventInfo_conversationId:e.id,eventInfo_conversationUpdatedAt:n,eventInfo_lastMessageCreatedAt:t}})}catch{}}function X5(e){return e?e.history.some(t=>t.author==="ai"&&t.streamingState==="streaming"):!1}const _g=_(!1);function dd(e){const{children:t}=e;return Ra()?t:null}function Ra(){return M(_g)}function eT(){return B(_g)}const tT=_([]),Ry=new Map,$z=_(!0),qz=["sidebar-narrow","sidebar-settings","smart-mode-default"],Lr=e=>{if(!eT()&&qz.includes(e))return $z;let t=Ry.get(e);return t||(t=_(n=>n(tT).includes(e)),Ry.set(e,t),t)};function q(e){return M(Lr(e))}function W(e){return ke().get(Lr(e))}function Pc(e,t="all"){const n=l.useRef(e),o=l.useMemo(()=>{const s=n.current.map(Lr);return _(a=>t==="all"?s.every(r=>a(r)):s.some(r=>a(r)))},[t]);return M(o)}function Mc(e,t="all"){return t==="all"?e.every(n=>W(n)):e.some(n=>W(n))}const Ft=()=>Mc(["smart-mode-default","remove-qr"],"any")?"smart":"chat";function Kz(e){return e.author==="human"}function Yz(e){const t=e.filter(Kz);return t.length===0?void 0:t[t.length-1]?.mode??null}function Zz(e){const t=Yz(e);return t===void 0?"undetermined":t===null?"unknown":t==="coco"?"coco":"non-coco"}function Jz(e,t){if(t==="undetermined")return e;const n=t==="unknown",o=t==="coco",s=e==="coco";return o?"coco":s?Ft():e}E9();const Na=_(!1),nT=_(!1),Qz=_(!1),Xz=_(!1),md=_(void 0),bt=_(new Map),Te=_(void 0),tf=_(null),Vm=_(void 0),oT=_(e=>e(Vm),(e,t,n)=>{const o=e(Vm);o!==n&&(t(bt,s=>{const a=new Map(s);return o&&a.delete(o),a}),t(Vm,n))}),sT=_(null),Rt=_(e=>{const t=e(Te);if(t)return e(bt).get(t)}),Rc=Ru(Rt,e=>e?X5(e):!1,(e,t)=>e===t),FEe=e=>Ru(bt,t=>{const n=t.get(e);return n?X5(n):!1},(t,n)=>t===n),Fl=_(!1),Ls=_(new Map),jEe=_([]);_([]);const La=_(e=>e(Rt)?.history??[]),eG=_(e=>{const t=e(Rt);return t?Zz(t.history):"undetermined"}),kg=_(e=>{const t=e(bt);for(const n of t.values())if(!n.title&&!n.history.length&&n.isNew)return n.id}),tG=Ru(bt,e=>{if(!(e instanceof Map))return!1;for(const t of e.values()){const{history:n}=t;if(Array.isArray(n)&&n.length>0)return!0}return!1},(e,t)=>e===t),pd=_(new Map),nG=_(new Map),gi=_(void 0),Nc=_([]),Pg=_([]),aT=_(e=>Q5(e(Rt)?.characterId)),ra=_("idle"),rT=_(!1),ss=_(null),Ny=_("idle"),Qs=_("checking-availability"),cn=_("inactive"),oG=_(null),iT=_([]),ma=_(null),fd=_(null),Mg=_([]),sG=_([]),aG=_(null),cT=_(null),lT=_(e=>e(ma)===0),Rg=_(null),Ng=_(null),rG=_(null),ia=_(!1),iG=_(!1),uT=_(!1),dT=_(PI),br=_(void 0),cG=_(!1),lG=_(!0),uG=_(null),BEe=_(e=>!!e(uG));_(null);const Ir=_(void 0),Lg=_(void 0),dG=_(void 0),VEe=_(void 0),HEe=_(null),zEe=_(!1),mG=_(!1),pG=_(void 0),GEe=_(void 0);_(null);const WEe=gc({}),fG=_(null),mT=_(!1),pT=_({}),Dg=_(!1),fT=_({data:void 0,isLoading:!1}),hG=_(e=>e(fT).data),hT=_(e=>e(fT).isLoading),jl=_(!1),gT=_(null);_(e=>e(gT)?.lcp??null);const gG=_(null);_({status:"idle"});const $Ee=_(null),vG=_(null),nf=Kt({key:zM,schema:Rn(u(),u()),initialValue:{}}),yG=_(null),qEe=_(!1),KEe=_(!1),YEe=_(!1),Er=_([]),vT=_(null),CG=_(null),SG=_(null),bG=_(null),ZEe=_(!1),IG=_(null),yT=_(!1),JEe=_("fre"),QEe=_(!0);async function EG(e){const t=e.body?.getReader();if(!t)return 0;let n=0;try{const o=performance.now();for(;performance.now()-o<2e3;){const{value:s,done:a}=await t.read();if(a)break;n+=s.byteLength}return n}catch{return 0}}const TG=1e3;function en(e){R.trackEvent({name:"interaction",data:{eventName:"copilotClick",eventInfo_clickSource:e.source,eventInfo_clickScenario:e.scenario,eventInfo_clickDestination:e.destination,eventInfo_conversationId:e.conversationId,eventInfo_podcastId:e.podcastId,eventInfo_messageId:e.messageId,eventInfo_mode:e.chatMode,eventInfo_messageType:e.messageType,eventInfo_cardType:e.cardType,eventInfo_merchantPlatform:e.merchantPlatform,eventInfo_additionalData:e.additionalData?JSON.stringify(e.additionalData):void 0}})}function de(e){R.trackEvent({name:"interaction",data:{eventName:"copilotClick",eventInfo_pageName:e.pageName,eventInfo_sectionName:e.sectionName,eventInfo_clickSource:e.source,eventInfo_clickScenario:e.scenario,eventInfo_clickDestination:e.destination,eventInfo_conversationId:e.conversationId,eventInfo_messageId:e.messageId,eventInfo_customData:e.customData}})}const wG=30*60*1e3;function XEe(e){const t=Date.now(),n={eventInfo_pageName:e.pageName,eventInfo_sectionName:e.sectionName,eventInfo_clickSource:e.source,eventInfo_clickScenario:e.scenario,eventInfo_clickDestination:e.destination,eventInfo_conversationId:e.conversationId,eventInfo_messageId:e.messageId,eventInfo_correlationId:`${e.conversationId}-${t}`};R.trackEvent({name:"interaction",data:{eventName:"copilotClick",eventInfo_customData:e.customData,...n}});let o=!1,s=null;const a=()=>{s!==null&&(window.clearTimeout(s),s=null),document.removeEventListener("visibilitychange",r)},r=()=>{if(document.visibilityState==="visible"&&!o){o=!0;const i=Math.floor((Date.now()-t)/1e3);R.trackEvent({name:"interaction",data:{eventName:"copilotClickDwellTime",eventInfo_dwellTime:i,...n}}),a()}};document.addEventListener("visibilitychange",r),s=window.setTimeout(()=>{a()},wG)}function Lt(e){R.trackEvent({name:"system",data:{eventName:"copilotImpression",eventInfo_impressionScenario:e.scenario,eventInfo_impressionPage:e.page,eventInfo_impressionElement:e.element,eventInfo_status:e.status,eventInfo_duration:e.duration,eventInfo_customData:e.customData}})}function _o(e){R.trackEvent({name:"health",data:{eventName:"copilotFeatureSuccess",eventInfo_feature:e.feature,eventInfo_scenario:e.scenario,eventInfo_duration:e.duration,eventInfo_customData:e.customData}})}function Je(e){R.trackEvent({name:"health",data:{eventName:"copilotError",eventInfo_feature:e.feature,eventInfo_scenario:e.scenario,eventInfo_errorType:e.errorType,eventInfo_errorMessage:e.errorMessage,eventInfo_exception:e.exception,eventInfo_customData:e.customData}})}function Og(e){R.trackEvent({name:"interaction",data:{eventName:"copilotSettingChange",eventInfo_settingName:e.settingName,eventInfo_settingOldValue:e.oldValue,eventInfo_settingNewValue:e.newValue}})}function e5e(e,t=TG){let n;function o(){n=window.setTimeout(()=>{e()},t)}function s(){window.clearTimeout(n)}return{onHoverStart:o,onHoverEnd:s}}function CT(e,t,n,o){setTimeout(async()=>{try{const{status:s}=o,a=await EG(o),r=o.headers.get("x-ceto-ref")??"";R.trackEvent({name:"apiresponse",data:{eventName:"copilotApiResponse",eventInfo_path:e,eventInfo_method:t,eventInfo_status:s,eventInfo_duration:n,eventInfo_responseContentLength:a,eventInfo_cetoRef:r}})}catch{}},0)}function Ly(){performance.mark("userSession-end",{startTime:performance.now()});const{duration:e}=performance.measure("userSession-duration","startupTime-begin","userSession-end");R.trackEvent({name:"system",data:{eventName:"copilotExitEvent",eventInfo_duration:e}})}function AG(e,t,n){R.trackEvent({name:"interaction",data:{eventName:"copilotComposerInput",eventInfo_conversationId:e,eventInfo_inputMethod:t,eventInfo_customData:n}})}function xG(e){R.trackEvent({name:"interaction",data:{eventName:"copilotScroll",eventInfo_ScrollSource:e.scrollSource,eventInfo_ScrollStartX:e.scrollStartX,eventInfo_ScrollStartY:e.scrollStartY,eventInfo_ScrollEndX:e.scrollEndX,eventInfo_ScrollEndY:e.scrollEndY,eventInfo_ScrollDuration:e.scrollDuration,eventInfo_userInitiated:e.userInitiated,eventInfo_customData:e.customData}})}const Ug="free";function pa(e){return e instanceof Error?{errorCode:e.toString(),errorDetails:e.message}:{errorCode:"unknown",errorDetails:String(e)}}function ST(e){R.trackEvent({name:"interaction",data:{eventName:"payflowEnter",eventInfo_payflowEntryPoint:e.payflowEntryPoint,eventInfo_upsellReason:e.upsellReason,eventInfo_loginProvider:e.loginProvider,eventInfo_payflowType:e.payflowType??"DIME",eventInfo_payflowInstanceId:e.payflowInstanceId,eventInfo_curatedSubscription:e.curatedSubscription,eventInfo_correlationId:e.correlationId,eventInfo_upsellEntryStyle:e.upsellEntryStyle}})}function t5e(e){R.trackEvent({name:"interaction",data:{eventName:"payflowLoginClick",eventInfo_payflowEntryPoint:e.payflowEntryPoint,eventInfo_upsellReason:e.upsellReason,eventInfo_loginProvider:e.loginProvider,eventInfo_payflowType:"DIME",eventInfo_payflowInstanceId:e.payflowInstanceId,eventInfo_correlationId:e.correlationId}})}function _G(e){R.trackEvent({name:"interaction",data:{eventName:"dimeCheckoutRendering",eventInfo_payflowEntryPoint:e.payflowEntryPoint,eventInfo_upsellReason:e.upsellReason,eventInfo_loginProvider:e.loginProvider,eventInfo_payflowType:"DIME",eventInfo_payflowInstanceId:e.payflowInstanceId,eventInfo_curatedSubscription:e.curatedSubscription,eventInfo_correlationId:e.correlationId,eventInfo_dimeMarket:e.dimeMarket,eventInfo_campaignId:e.campaignId,eventInfo_dimeExperienceId:e.dimeExperienceId}})}function kG(e){R.trackEvent({name:"interaction",data:{eventName:"dimeCheckoutSuccess",eventInfo_payflowEntryPoint:e.payflowEntryPoint,eventInfo_upsellReason:e.upsellReason,eventInfo_loginProvider:e.loginProvider,eventInfo_payflowType:"DIME",eventInfo_payflowInstanceId:e.payflowInstanceId,eventInfo_curatedSubscription:e.curatedSubscription,eventInfo_correlationId:e.correlationId,eventInfo_dimeMarket:e.dimeMarket,eventInfo_campaignId:e.campaignId,eventInfo_dimeExperienceId:e.dimeExperienceId}})}function PG(e){R.trackEvent({name:"interaction",data:{eventName:"dimeCheckoutClosed",eventInfo_payflowEntryPoint:e.payflowEntryPoint,eventInfo_upsellReason:e.upsellReason,eventInfo_loginProvider:e.loginProvider,eventInfo_payflowType:"DIME",eventInfo_payflowInstanceId:e.payflowInstanceId,eventInfo_curatedSubscription:e.curatedSubscription,eventInfo_correlationId:e.correlationId,eventInfo_dimeMarket:e.dimeMarket,eventInfo_campaignId:e.campaignId,eventInfo_dimeExperienceId:e.dimeExperienceId}})}function MG(e){R.trackEvent({name:"interaction",data:{eventName:"dimeCheckoutError",eventInfo_payflowEntryPoint:e.payflowEntryPoint,eventInfo_upsellReason:e.upsellReason,eventInfo_loginProvider:e.loginProvider,eventInfo_payflowType:"DIME",eventInfo_payflowInstanceId:e.payflowInstanceId,eventInfo_curatedSubscription:e.curatedSubscription,eventInfo_correlationId:e.correlationId,eventInfo_dimeMarket:e.dimeMarket,eventInfo_campaignId:e.campaignId,eventInfo_errorCode:e.errorCode,eventInfo_errorDetails:e.errorDetails,eventInfo_dimeExperienceId:e.dimeExperienceId}})}function n5e(e){R.trackEvent({name:"interaction",data:{eventName:"manageSubPageActionClick",eventInfo_loginProvider:e.loginProvider,eventInfo_curatedSubscription:e.curatedSubscription,eventInfo_actionTarget:e.actionTarget}})}function o5e(e){R.trackEvent({name:"interaction",data:{eventName:"manageSubFREShown",eventInfo_loginProvider:e.loginProvider,eventInfo_curatedSubscription:e.curatedSubscription}})}function s5e(e){R.trackEvent({name:"interaction",data:{eventName:"manageSubPageLoaded",eventInfo_loginProvider:e.loginProvider,eventInfo_curatedSubscription:e.curatedSubscription,eventInfo_willShowFre:e.willShowFre,eventInfo_willShowProDeprecation:e.willShowProDeprecation,eventInfo_upgradeButtonShown:e.upgradeButtonShown,eventInfo_upgradeButtonTarget:e.upgradeButtonTarget,eventInfo_manageButtonShown:e.manageButtonShown,eventInfo_manageButtonTarget:e.manageButtonTarget,eventInfo_cancelButtonShown:e.cancelButtonShown,eventInfo_cancelButtonTarget:e.cancelButtonTarget,eventInfo_proAutoRenewOn:e.proAutoRenewOn}})}function $n({scenario:e,duration:t=0,customData:n}){_o({feature:"subscriptions",scenario:e,duration:t,customData:n?JSON.stringify(n):void 0})}function no({errorCode:e,errorDetails:t,scenario:n,customData:o}){Je({feature:"subscriptions",scenario:n,errorType:e,errorMessage:t,customData:o?JSON.stringify(o):void 0})}function RG(e){const{correlationId:t,payflowInstanceId:n}=e;R.trackEvent({name:"system",data:{eventName:"payflowUserMismatched",eventInfo_correlationId:t,eventInfo_payflowInstanceId:n}})}function a5e(e){const{payflowEntryPoint:t,upsellReason:n,loginProvider:o,disabledReason:s,curatedSubscription:a}=e;R.trackEvent({name:"interaction",data:{eventName:"payflowEntryDisabled",eventInfo_payflowEntryPoint:t,eventInfo_upsellReason:n,eventInfo_loginProvider:o,eventInfo_disabledReason:s,eventInfo_curatedSubscription:a}})}function NG(e){const{upsellEntryStyle:t,actionButton:n,payflowEntryPoint:o,upsellReason:s="",loginProvider:a,payflowType:r,curatedSubscription:i}=e,d=crypto.randomUUID();return R.trackEvent({name:"interaction",data:{eventName:"payflowEntryImpression",eventInfo_upsellEntryStyle:t,eventInfo_actionButton:n,eventInfo_payflowEntryPoint:o,eventInfo_upsellReason:s,eventInfo_loginProvider:a,eventInfo_payflowType:r,eventInfo_curatedSubscription:i,eventInfo_payflowEntryImpressionId:d}}),d}function LG(e){const{payflowEntryImpressionId:t,payflowInstanceId:n,upsellEntryStyle:o,actionButton:s,payflowEntryPoint:a,upsellReason:r,loginProvider:i,payflowType:d}=e;R.trackEvent({name:"interaction",data:{eventName:"payflowEntryClick",eventInfo_payflowEntryImpressionId:t,eventInfo_payflowInstanceId:n,eventInfo_upsellEntryStyle:o,eventInfo_actionButton:s,eventInfo_payflowEntryPoint:a,eventInfo_upsellReason:r,eventInfo_loginProvider:i,eventInfo_payflowType:d}})}function Hm(e){const{entryPoint:t,featureName:n}=e;R.trackEvent({name:"interaction",data:{eventName:"featureQuotaRunningOutShown",eventInfo_entryPoint:t,eventInfo_featureName:n}})}function zm(e){const{entryPoint:t,featureName:n}=e;R.trackEvent({name:"interaction",data:{eventName:"featureQuotaRunningOutOptionClick",eventInfo_entryPoint:t,eventInfo_featureName:n}})}function r5e(e){const{upsellEntryStyle:t,actionButton:n,payflowEntryPoint:o,upsellReason:s,loginProvider:a,payflowType:r,curatedSubscription:i,payflowInstanceId:d,correlationId:m,duration:p}=e;R.trackEvent({name:"interaction",data:{eventName:"upgradeBenefitDialogLoad",eventInfo_upsellEntryStyle:t,eventInfo_actionButton:n,eventInfo_payflowEntryPoint:o,eventInfo_upsellReason:s,eventInfo_loginProvider:a,eventInfo_payflowType:r,eventInfo_curatedSubscription:i,eventInfo_payflowInstanceId:d,eventInfo_correlationId:m,eventInfo_duration:p}})}function i5e(e){const{upsellEntryStyle:t,actionButton:n,payflowEntryPoint:o,upsellReason:s,loginProvider:a,payflowType:r,curatedSubscription:i,payflowInstanceId:d,correlationId:m}=e;R.trackEvent({name:"interaction",data:{eventName:"upgradeBenefitDialogContinue",eventInfo_upsellEntryStyle:t,eventInfo_actionButton:n,eventInfo_payflowEntryPoint:o,eventInfo_upsellReason:s,eventInfo_loginProvider:a,eventInfo_payflowType:r,eventInfo_curatedSubscription:i,eventInfo_payflowInstanceId:d,eventInfo_correlationId:m}})}function c5e(e){const{payflowEntryPoint:t,upsellEntryStyle:n,pageName:o,clickSource:s,entryPoint:a}=e;R.trackEvent({name:"interaction",data:{eventName:"copilotClick",eventInfo_payflowEntryPoint:t,eventInfo_upsellEntryStyle:n,eventInfo_pageName:o,eventInfo_clickSource:s,eventInfo_entryPoint:a}})}function it(e){return M(Lr(e))}function ot(e){return ke().get(Lr(e))}const bT=["UpsellProToPremium","UpsellProToPremium-FromWinNative","UpsellProToPremium-FromWinChromium","ActionsLimit","ActionsLimit-FromWinNative","ActionsLimit-FromWinChromium","ActionsLimit-FromEdgeCopilotMode","DeepResearchLimit","DeepResearchLimit-FromWinNative","DeepResearchLimit-FromWinChromium","DeepResearchLimit-FromEdgeCopilotMode","VisionLimit","VisionLimit-FromWinNative","VisionLimit-FromWinChromium","VisionLimit-FromEdge","VisionLimit-FromEdgeCopilotMode","PodcastLimit","PodcastLimit-FromWinNative","PodcastLimit-FromWinChromium","PodcastLimit-FromEdgeCopilotMode","Management","Management-FromWinNative","Management-FromWinChromium","Management-FromEdge","Management-FromEdgeCopilotMode","Settings","Settings-FromWinNative","Settings-FromWinChromium","ProfileUpdateRequired","VideoGenLimit","VideoGenLimit-FromWinNative","VideoGenLimit-FromWinChromium","VideoGenLimit-FromEdgeCopilotMode","UpsellPFToPremium","UpsellPFToPremium-FromWinNative","UpsellPFToPremium-FromWinChromium","UpsellFreeInSidePane","UpsellFreeInSidePane-FromWinChromium","Unknown"],l5e={Pageseditor:"pageseditor-supported-features"},DG=["m365-family-classic-guest","m365-family-guest","m365-premium-guest"],u5e="App Store",d5e="Google Play",OG=["m365-personal","m365-family-admin"],IT=["m365-family-guest","m365-premium-guest","m365-premium-admin"],ET=["m365-personal","m365-family-admin"],UG=["m365-personal","m365-family-admin"];function Fg(e){const t=ot("kill-subs-pro-to-premium"),n=e.some(r=>r.tier==="pro"),o=e.some(r=>UG.includes(r.tier)),s=e.some(r=>r.channel!=="direct");return{isEligible:!t&&n&&!s&&(e.length===1||o&&e.length===2),hasM365Transition:o}}const TT=["m365-personal-classic","m365-premium-guest","m365-family-guest","m365-family-classic-admin","m365-family-classic-guest","m365-basic"],m5e=["m365-personal-classic","m365-family-classic-admin","m365-basic"],wT=["m365-family-admin","m365-personal"],hd=["m365-premium-admin","pro"],Dy=[...hd,...wT,...TT];function FG(e,t=!1){if(e.length===0)return t?"buypremium":"buym365";if(e.some(n=>n.tier==="pro")){if(ot("kill-subs-pro-to-premium"))return null;const{isEligible:n,hasM365Transition:o}=Fg(e);return n?o?"switchpremiumm365dual":"switchpremiumsolo":"buypremium"}return e.some(n=>IT.includes(n.tier))?null:e.some(n=>ET.includes(n.tier))||t?"upgradepremium":"upgradem365"}function jG(e,t=[]){return t.length===0?null:e.length===0?t.includes("m365-personal")?"buym365":t.includes("m365-premium")?"buypremium":null:t.includes("m365-personal")?e.some(n=>TT.includes(n.tier))?"upgradem365":null:t.includes("m365-premium")?e.some(n=>hd.includes(n.tier))?null:"upgradepremium":null}function p5e(e){return["m365-personal","m365-family-admin","m365-premium-admin"].find(n=>n===e)??null}function f5e(e){return e.length>0&&AT(e)[0]?.tier!=="pro"}function h5e(e){return e.some(t=>OG.includes(t.tier))&&!e.some(t=>hd.includes(t.tier))}function AT(e){return e.slice().sort((t,n)=>Dy.indexOf(t.tier)-Dy.indexOf(n.tier))}function g5e(e){return e.find(n=>n.tier==="pro")?.isAutoRenew??!1}function BG(e){const t=e?.tier,n=e?.channel,o=t!==void 0&&!DG.includes(t)&&(n==="apple"||n==="google");return{shouldRedirectMobile:o,redirectMobileSource:o?n:null}}function v5e({isPro:e,subscriptions:t}){if(t.length===0&&!e)return!0;if(e){const{isEligible:n}=Fg(t);return n}return!1}function VG(e){return e.toLowerCase()==="zh-hant"?"zh-TW":e}function y5e(e,t){const n=t?`${e}-From${t}`:e;return bT.find(o=>o.toLowerCase()===n.toLowerCase())??"Unknown"}function C5e(e){if(!e)return"settings.accountPlan.freePlan";switch(e.tier){case"pro":return"settings.accountPlan.proPlan";case"m365-premium-admin":return"settings.accountPlan.premiumPlan";case"m365-family-admin":return"settings.accountPlan.familyPlan";case"m365-personal":return"settings.accountPlan.personalPlan";case"m365-basic":case"m365-family-classic-admin":case"m365-personal-classic":return"settings.accountPlan.freePlan";default:return null}}function HG(e){return e.toLowerCase().includes("-from")}function S5e(e){return["OneMonthTrialToMonthly","OneMonthTrialToYearly"].includes(e)}function b5e(e){return["OneMonthTrialToMonthly","Monthly"].includes(e)?"monthly":"yearly"}function I5e(e,t){return Math.round(e*100+t*100)/100}const Da="ellie",xT=[Da],Oy=Q([z(xT),rb()]),zG=f({model:v("vasa"),eyesOpenRatio:A(k()).min(1),eyesPose:A(k()).min(6),jawPose:A(k()).length(3),neckPose:A(k()).length(3),rotation:A(k()).length(3),translation:A(k()).length(3),viseme:A(k()).min(10)}),GG=f({model:v("spda2e"),poseDiffusion:A(k())}),WG=Q([v("throttled"),v("error"),v("time-expired"),v("inactivity")]),$G=f({type:v("summary"),text:u()}),qG=f({type:v("topicList"),id:u(),topics:A(f({text:u()})).nullable(),selectedIndex:k().nullable()}),KG=fe("type",[qG,$G]).nullable(),_T=v("shell"),kT=v("commandResult"),PT=v("requestBrowserInteraction"),YG=f({type:_T,shell:u(),command:u(),purpose:u()}),Uy=f({url:u(),iconUrl:u()}),ZG=f({type:PT,taskId:u(),reason:u(),instruction:u().nullish(),environment:fe("type",[Uy.extend({type:v("localBrowser"),id:k()}),Uy.extend({type:v("remoteBrowser"),shouldShowRememberData:V()})]).nullish()}),JG=fe("type",[YG,ZG]),xi={Completed:"Completed",Cancelled:"Cancelled",TimedOut:"TimedOut"},MT=z([xi.Completed,xi.Cancelled,xi.TimedOut]);f({partId:u(),output:u(),status:MT.default(xi.Completed),exitCode:k().int().optional()});const QG=f({type:_T,output:u(),status:MT.default(xi.Completed),exitCode:k().int().optional()}),XG=f({type:PT,accepted:V()}),eW=fe("type",[QG,XG]);f({type:kT,commandMessageId:u(),commandPartId:u(),result:eW});const tW=Q([u(),k(),V(),_r()]),qi=va(()=>Q([tW,A(qi),Rn(u(),qi)])),nW=f({op:v("add"),path:u(),value:qi}),oW=f({op:v("remove"),path:u()}),sW=f({op:v("replace"),path:u(),value:qi}),aW=f({op:v("move"),from:u(),path:u()}),rW=f({op:v("copy"),from:u(),path:u()}),iW=f({op:v("test"),path:u(),value:qi}),cW=fe("op",[nW,oW,sW,aW,rW,iW]),vi=A(cW),lW=jo.object({type:jo.literal("browserPageContext")}),uW=jo.discriminatedUnion("type",[lW]),dW=jo.object({type:jo.string()}),mW=uW.or(dW),pW=jo.object({event:jo.literal("toolExecuting"),id:jo.string(),messageId:jo.string(),tool:mW}),fW=Q([v("event-not-recognized"),v("over-turn-limit"),v("unknown-error"),v("message-too-large"),v("invalid-event"),v("empty-message"),v("empty-text"),v("text-too-long"),v("multiple-text-parts"),v("multiple-image-parts"),v("too-many-messages"),v("over-lifetime-task-quota"),v("over-task-quota"),v("page-content-length-exceeded"),v("page-count-exceeded"),v("character-out-of-capacity"),u()]),hW=Q([v("blocked"),v("not-signed-in"),v("failed"),u()]),RT=Q([v("quiz"),v("generative-ui"),v("flashcard"),v("composeEmail")]),NT=Q([v("throttled"),v("throttled-non-pro"),v("time-expired"),v("time-expired-non-pro"),v("not-in-flight"),v("error"),v("signed-out"),v("region-not-available"),v("time-expired-month"),v("time-expired-month-non-pro"),v("missing-consent"),v("chat-service-unavailable")]),gW=z(["human","ai"]),vW=f({voice:u().optional(),speed:k().min(50).max(200).optional(),initiator:gW.optional()}).partial(),Fy=k().min(0).max(200).prefault(100),jy=Q([v("standard"),v("character"),v("tv"),v("portrait"),v("edge-vision"),v("windows-vision")]),yW=z(["research","planning-agent"]),LT=Mu().nullable(),CW=z(["session-duration"]),SW=f({type:v("patch"),patches:vi}),By=fe("event",[nn,pW,f({event:v("pong"),id:u()}),f({event:v("connected"),id:u(),requestId:u()}),f({event:v("received"),conversationId:u(),messageId:u(),createdAt:u()}),f({event:v("newMessage"),id:u(),conversationId:u(),message:O5}),f({event:v("emojiReaction"),messageId:u(),emoji:u()}),f({event:v("startMessage"),conversationId:u(),messageId:u(),createdAt:u()}),f({event:v("appendText"),messageId:u(),text:u(),partId:u(),parentPartId:u().optional()}),f({event:v("replaceText"),messageId:u(),text:u(),partId:u()}),f({event:v("titleUpdate"),conversationId:u(),title:u()}),f({event:v("generatingImage"),messageId:u(),prompt:u(),partId:u(),progressionText:u().nullable().optional()}),f({id:u(),event:v("generatingImages"),messageId:u(),partIds:A(u()),prompt:u()}),f({event:v("imageGenerated"),messageId:u(),url:u(),partId:u()}),f({event:v("partialImageGenerated"),messageId:u(),url:u(),partId:u(),content:u()}),f({event:v("page"),messageId:u(),partId:u(),page:f({id:u(),conversationId:u(),title:u().nullish()})}),f({event:v("challenge"),method:Q([v("copilot"),v("hashcash"),v("cloudflare")]).nullish(),parameter:u().nullish()}),f({event:v("imageGenerationFailed"),messageId:u(),errorCode:hW,partId:u()}),f({id:u(),event:v("generatingCard"),messageId:u(),partId:u(),type:RT}),f({id:u(),event:v("cardGenerationFailed"),messageId:u(),partId:u()}),f({event:v("transcriptEvent"),text:u()}),f({event:v("audioStart"),conversationId:u()}),f({event:v("audio"),audio:u()}),f({event:v("audioStartFailed"),reason:NT}),f({event:v("audioTimeRemaining"),seconds:k()}),f({event:v("callTerminated"),reason:WG}),f({event:v("audioEnd")}),f({event:v("callEnded"),id:u()}),f({event:v("audioConfig"),options:vW}),f({event:v("interruptAudio")}),f({event:v("speechEndDetected")}),f({event:v("speechStartDetected")}),f({event:v("citation"),messageId:u(),url:u(),title:u(),partId:u(),iconUrl:u().nullable(),publisher:u().nullable(),snippet:u().nullish(),label:u().nullish()}),f({event:v("modelStatement"),messageId:u(),partId:u(),correlationPartId:u(),modelName:u(),id:u().optional()}),f({event:v("chainOfThought"),messageId:u(),partId:u(),text:u()}),f({event:v("turnLimitReached"),id:u()}),f({event:v("done"),messageId:u()}),f({event:v("error"),errorCode:fW}),f({event:v("card"),messageId:u(),partId:u(),card:WE}),f({event:v("document"),messageId:u(),partId:u(),attachmentId:u(),fileName:u(),contentType:Sc}),f({event:v("callUI"),id:u(),callUI:KG}),f({event:v("callUIUpdate"),id:u(),update:vi}),f({event:v("banned"),expiresAt:u()}),f({event:v("taskStart"),id:u(),messageId:u(),partId:u(),task:S5}),f({event:v("taskUpdate"),id:u().nullish(),taskId:u(),update:vi}),f({event:v("startSuggestion"),id:u(),pageId:u(),suggestionId:u(),editTargets:A(f({startIndex:k(),endIndex:k()}))}),f({event:v("appendSuggestion"),id:u(),pageId:u(),suggestionId:u(),text:u()}),f({event:v("suggestionCompleted"),id:u(),pageId:u(),suggestionId:u()}),f({event:v("characterAnimation"),id:u(),offsetInMilliseconds:k().nullable().optional(),frame:fe("model",[zG,GG]).nullable().optional()}),f({event:v("characterAnimationEnd"),messageId:u()}),f({event:v("setCallType"),callType:jy}),f({event:v("callTypeChanged"),callType:jy}),f({event:v("activityStart"),activity:OI,id:u(),messageId:u(),partId:u()}),f({event:v("activityUpdate"),id:u(),messageId:u(),partId:u(),update:vi}),f({event:v("partUpdate"),messageId:u(),partId:u(),update:SW,id:u()}),f({event:v("memorySignal"),messageId:u(),partId:u(),text:u(),signalType:Q([v("remember"),v("forget"),v("remember-name"),v("forget-name")]).nullish()}),f({event:v("sideBySideComparison"),id:u(),conversationId:u(),sideBySideComparisonId:u(),defaultMessageId:u(),options:A(f({messageId:u(),position:Q([v("left"),v("right")])}))}),f({event:v("characterEmotion"),emotion:u(),bodyReaction:u()}),f({event:v("modeSelected"),id:u(),messageId:u(),mode:Q([v("chat"),v("reasoning")])}),f({event:v("partCompleted"),id:u(),messageId:u(),partId:u()}),f({event:v("partDeleted"),id:u(),messageId:u(),partId:u()}),f({event:v("characterAppearance"),body:f({primaryColor:u(),secondaryColor:u().nullable(),leftAccentColor:u().nullable(),rightAccentColor:u().nullable(),colorParticles:u().nullable().optional(),shape:u().nullable().optional()}),props:f({hat:u().nullable().optional(),glasses:u().nullable().optional(),accessory:u().nullable().optional()}).optional(),id:u()}),f({event:v("browserAutomate"),messageId:u(),partId:u(),tabIds:A(k()),activeTabId:k().optional()}),f({event:v("relatedSearchResultsAvailable"),messageId:u()}),f({event:v("participantUpdate"),conversationId:u(),participant:f({userId:u(),userDisplayName:u()}),updateType:Q([v("kicked"),v("joined"),v("left")]),id:u()}),f({event:v("suggestVision"),conversationId:u()}),f({id:u(),conversationId:u(),event:v("featureSuggestion"),feature:yW}),f({event:v("turnTelemetry"),messageId:u(),telemetry:LT}),f({event:v("consentRequired"),type:ug,version:u()}),f({event:v("nudge"),nudgeType:CW,id:u(),conversationId:u(),text:u()}),f({event:v("artifactStart"),messageId:u(),artifact:f({type:v("presentation"),id:u(),title:u(),status:z(["pending","generating","completed"]),slides:Rn(u(),f({status:z(["pending","generating","completed","editing"]),index:k(),html:u()}))}),id:u()}),f({event:v("artifactUpdate"),artifactId:u(),update:vi,id:u()}),f({event:v("partStart"),messageId:u(),part:fe("type",[f({partId:u(),type:v("uiComponent"),parentPartId:u().nullable(),component:Mu()}),f({partId:u(),type:v("text"),parentPartId:u().nullish(),text:u()}),f({partId:u(),type:v("command"),command:JG}),f({partId:u(),type:v("step"),parentPartId:u().nullish(),status:b5,title:u(),reaction:Qt.nullish()}),f({partId:u(),type:v("textFile"),parentPartId:u().nullish(),content:u(),contentType:u(),fileName:u(),reaction:Qt.nullish()}),f({partId:u(),type:v("webSearch"),parentPartId:u().nullish(),query:u(),results:A(f({title:u(),snippet:u().nullish(),iconUrl:u().nullish(),url:u()})),reaction:Qt.nullish()}),f({partId:u(),type:v("shellCommandExecution"),parentPartId:u().nullish(),shell:u(),command:u(),output:u().nullable(),reaction:Qt.nullish()}),f({partId:u(),type:v("computerUse"),parentPartId:u().nullish(),screenshotUrls:A(u()).nullish(),environment:fe("type",[f({type:v("localBrowser"),tabs:A(f({id:k(),url:u().optional(),title:u().optional()})).nullish()}),f({type:v("remoteBrowser"),tabs:A(f({url:u().optional(),iconUrl:u().optional()})).nullish()})]).nullish()})])})]);f({mode:u(),formCode:u().optional()});f({menu:v("plus")});f({source:u(),conversationId:u().optional(),fileData:u(),mimetype:u(),filename:u()});const jg={kNotPresent:0,kAccepted:1},E5e={kNoError:0,kUnknownError:1,kNoConsent:2,kBlockedByDlp:3,kNotSupportedError:4,kNetworkError:5,kNoVideoTranscript:6,kNoWebContents:7,kNoDocumentHelper:8},T5e={kNotYetDetermined:0,kWeb:1,kPdf:2,kGoogleDocs:3,kVideoTranscript:4};function w5e(e){return typeof e=="object"&&e!==null&&"eventName"in e&&"requestId"in e&&(!("isOutgoing"in e)||!e.isOutgoing)&&"args"in e}const vt=_(void 0),Dr=_(e=>e(vt)!==void 0),DT=Kt({key:SI,schema:u().optional(),initialValue:void 0}),OT=_(e=>{const t=e(vt),n=e(DT);return t===void 0?n:t.preferredName??t.firstName??t.givenName}),gd=_(e=>e(vt)?.id),Or=_(void 0),bW=_(e=>e(Nc).find(t=>t.id===e(Or))),Bg=_(""),A5e=_(e=>{const t=e(Nc),n=e(Or)??t[0]?.id;return t.find(o=>o.id===n)?.voicemails}),IW=Kt({key:uy,schema:Fy,initialValue:qt(uy,Fy)??yc}),io=Kt({key:ay,schema:Oy,initialValue:qt(ay,Oy)??void 0}),Vy=Kt({key:dy,schema:k().optional(),initialValue:qt(dy,k().optional())??void 0}),UT=_(e=>{const t=e(Vy);return t===void 0?!1:Date.now()-t<_R},(e,t,n)=>{t(Vy,n?Date.now():void 0)}),EW=Kt({key:OM,schema:V().optional(),initialValue:void 0}),TW=Kt({key:ry,schema:V(),initialValue:qt(ry,V())??!1}),FT=_(null),Lc=_(null),jT=_(e=>e(Mg).find(t=>t.id===e(Lc))),x5e=_(!1),_5e=_(jg.kNotPresent),k5e=_(jg.kAccepted),P5e=_(jg.kNotPresent),BT=_(void 0),Tr=_(!1),VT=_(void 0),wW=_(!1),of=_(void 0),AW=_(void 0),xW=_(!1),_W=_(!1),kW=_(!1),PW=_(void 0),MW=_(void 0),vd=_(null),yd=_(null),Cd=_(null),M5e=_(!1),R5e=_(!1),HT=_(e=>{const n=e(vt)?.subscriptions??[];return n.some(o=>o.tier==="pro")&&!n.some(o=>o.tier==="m365-premium-admin")}),N5e=_(e=>e(vt)?.isStudent);_(e=>e(vt)?.inEeaPlusRegion);const Bt=_(void 0),RW=_(!1);_(e=>{const t=e(Bt);return t&&SR.includes(t)});const zT=_(void 0),L5e=_(e=>e(vt)?.isEligibleForFreeTrial??!1),GT=_(void 0),Sd=_(e=>e(vt)?.ageGroup==="teen"),D5e=_(e=>e(vt)?.allowedToggles.computerUseActions),NW=_(e=>e(vt)?.allowedToggles.personalization),LW=_(e=>e(vt)?.allowedToggles.textTraining),DW=_(e=>e(vt)?.allowedToggles.voiceTraining),WT=_(!1),Vg=_(null),Ur=_(e=>e(vt)?.subscriptions?.filter(t=>l5.safeParse(t.tier).success)??[]),Oa=_(e=>{const t=e(Ur);return AT(t)[0]}),OW=_(e=>e(Oa)?.tier??Ug),Hg=_(null),UW=_(null),O5e=_(e=>e(vt)?.accountTier??null),FW=_(e=>{const t=e(Oa)?.tier;return t!==void 0&&wT.includes(t)}),jW=_(e=>{const t=e(Oa)?.tier;return t!==void 0&&hd.includes(t)}),bd=_(e=>{const t=e(FW),n=e(jW);return t||n}),BW=_(e=>e(Ur).length>0),VW=Kt({key:WM,schema:V(),initialValue:!0});f({url:u().optional()});function Ee(e,t){ke().set(e,t)}const yt=_(null);function HW(e){const t=B(yt);!t?.id||t.id!==e||Ee(yt,null)}f({enabled:V().optional()});function zW(){return!1}const GW="https://www.copilot.com",WW="https://www.copilot-stg.com";function $T(){return typeof window>"u"?!1:window.location.origin===GW||window.location.origin===WW}function qT(){return $T()?`${window.location.origin}/c/api`:"https://copilot.microsoft.com/c/api"}function zg(){return qt(Wp,V().nullable())===!0}function $W(){return qt($p,V().nullable())===!0}const ta={UNDEFINED:"0",CHILD:"1",ADULT:"3",NOT_ADULT:"4",CHILD_NO_PARENTAL_CONSENT_REQUIRED:"5"},qW=f({name:u(),email:u(),ageGroup:z([ta.UNDEFINED,ta.CHILD,ta.ADULT,ta.NOT_ADULT,ta.CHILD_NO_PARENTAL_CONSENT_REQUIRED]),sub:u()}),Vn={LOGIN_START:"auth0:loginStart",LOGIN_SUCCESS:"auth0:loginSuccess",LOGIN_FAILURE:"auth0:loginFailure",LOGOUT_SUCCESS:"auth0:logoutSuccess",LOGOUT_FAILURE:"auth0:logoutFailure",ACQUIRE_TOKEN_START:"auth0:acquireTokenStart",ACQUIRE_TOKEN_FAILURE:"auth0:acquireTokenFailure",REAUTH_START:"auth0:reauthStart",REAUTH_SUCCESS:"auth0:reauthSuccess",INITIALIZE_START:"auth0:initializeStart",INITIALIZE_END:"auth0:initializeEnd",ACQUIRE_TOKEN_OVERALL_SUCCESS:"auth0:acquireTokenOverallSuccess",ACQUIRE_TOKEN_OVERALL_FAILURE:"auth0:acquireTokenOverallFailure",ACQUIRE_TOKEN_TIMEOUT:"auth0:acquireTokenTimeout"},zo={ACQUIRE_TOKEN_OVERALL_SUCCESS:"msal:acquireTokenOverallSuccess",ACQUIRE_TOKEN_OVERALL_FAILURE:"msal:acquireTokenOverallFailure",ACQUIRE_TOKEN_TIMEOUT:"msal:acquireTokenTimeout",INTERACTION_IN_PROGRESS:"msal:interactionInProgress",REAUTH_POPUP_SHOW:"msal:reauthPopupShow",RETRIEVE_LOGIN_WITH_LOGIN_HINT_START:"msal:retrieveLoginWithLoginHintStart",RETRIEVE_LOGIN_WITH_LOGIN_HINT_SUCCESS:"msal:retrieveLoginWithLoginHintSuccess",EMPTY_ACCOUNT_ENVIRONMENT:"msal:emptyAccountEnvironment",SSO_SILENT_SUCCESS_AFTER_LOGIN:"msal:ssoSilentSuccessAfterLoginSuccess",SSO_SILENT_FAILURE_AFTER_LOGIN:"msal:ssoSilentFailureAfterLoginSuccess"},Tn={ACQUIRE_ASSERTION_TOKEN_START:"migration:acquireAssertionTokenStart",ACQUIRE_ASSERTION_TOKEN_SUCCESS:"migration:acquireAssertionTokenSuccess",ACQUIRE_ASSERTION_TOKEN_FAILURE:"migration:acquireAssertionTokenFailure",MIGRATION_START:"migration:start",MIGRATION_SUCCESS:"migration:success",MIGRATION_FAILURE:"migration:failure",SILENT_MIGRATION_START:"migration:silentMigrationStart",SILENT_MIGRATION_SUCCESS:"migration:silentMigrationSuccess",SILENT_MIGRATION_FAILURE:"migration:silentMigrationFailure",LINK_START:"migration:linkStart",LINK_SUCCESS:"migration:linkSuccess",LINK_FAILURE:"migration:linkFailure",NAME_INCONSISTENT:"migration:nameInconsistent"};function Id(){return zW()||!1}function Fr(){if(!Id())return"140e65af-45d1-4427-bf08-3e7295db6836/ChatAI.ReadWrite"}const Gg=typeof window<"u"?`${window.location.origin}/auth/silent-callback`:void 0,Hy={auth:{clientId:"14638111-3389-403d-b206-a6a71d9f8f16",authority:"https://login.microsoftonline.com/common",navigateToLoginRequestUrl:!1},system:{allowPlatformBroker:!1},cache:{cacheLocation:"localStorage"}},KW={scopes:[Fr()],extraQueryParameters:{lw:"1",coa:"1",nopa:"2",fl:"easi2_nowld",cobrandid:"8c0b039e-5a73-4399-9b56-7e237be2cd06"},prompt:"select_account",redirectUri:typeof window<"u"?window.location.origin:void 0},YW={scopes:[Fr()],prompt:"none",authority:"https://login.microsoftonline.com/consumers",redirectUri:Gg},ZW={scopes:[Fr()],prompt:"none",authority:"https://login.microsoftonline.com/consumers",redirectUri:Gg};function KT(){return{...YW,scopes:[Fr()]}}function Wg(){return{...KW,scopes:[Fr()]}}function JW(e){return{...ZW,scopes:[Fr()],httpMethod:"POST",authorizePostBodyParameters:{ssu:"1",id_provider:"copilot.com",fidp_idtoken:e}}}const zy={scopes:["User.Read"]},QW={scopes:["OneDrive.ReadWrite"],authority:"https://login.microsoftonline.com/consumers"},XW={scopes:["service::http://Passport.NET/purpose::PURPOSE_GETKEYDATA_ANAHEIM"],authority:"https://login.microsoftonline.com/consumers"},$g={graphMeApiSuffix:"/me",graphMeImageApiSuffix:"/me/photo/$value",graphMeLicenseDetails:"/me/licenseDetails"};function Gy(){return{appName:R.getAppName(),enableMATS:!0,appVersion:Xu()}}function e$(){return Id()?void 0:"IalDS3vRtEI5X0zvsmGG7zJP9UrHTcei"}function t$(){return Id()?void 0:"auth.copilot.microsoft.com"}function YT(){return Id()?void 0:"https://copilot.microsoft.com"}function n$(){return{clientId:e$(),domain:t$(),cacheLocation:"localstorage",useRefreshTokens:!0,useRefreshTokensFallback:!0}}const ZT="openid profile email offline_access ChatAI.ReadWrite",JT=typeof window<"u"?window.location.origin:void 0;function Ed(){return{authorizationParams:{audience:YT(),scope:ZT,redirect_uri:JT}}}function o$(){return{authorizationParams:{audience:YT(),scope:ZT,redirect_uri:JT,prompt:"select_account"}}}const Wy="cp-pro";function s$(e){switch(e){case"login":return Wg();case"graph":return zy;case"oneDrive":return QW;case"decryptionService":return XW;default:return zy}}const a$={actAsBroker:!0,preferredInteractionType:"redirect"},r$=1e4,i$=1e4,c$=1.8,l$=2.6,QT={initialDelayMs:100,maxDelayMs:500,backoffFactor:2,maxRetries:2};function Dc(){return!1}function u$(){return Dc()}function XT(e,t,n){return n!==void 0?n:Dc()?t:t&&!e}function Dt(){const e=M(zT),t=M(hc),n=!!M(ut);return XT(t,n,e)}function qg(){const e=ke(),t=e.get(zT),n=e.get(hc),o=!!e.get(ut);return XT(n,o,t)}const d$=z(["upgrade-subscription","mobile-cross-selling","mac-cross-selling"]),ew={connectorConsentFlowStartUrl:u(),hasComposerCoachmarkBeenShown:V(),loginHintRedirectPath:u(),parsedPayflowEntryPoint:z(bT),payflowAuthHint:u(),payflowCorrelationId:u(),payflowInstanceId:u(),payflowRequiresPremium:V(),processedConnectorCode:u(),redirectPathOnNextStart:u(),retrieveLoginWithLoginHintStartTime:u(),screenPickerRequestedOpenTime:k(),settingsPromoteContent:d$,shouldStartSubscription:V(),"sticky-conversation-mode":kc,turnTelemetry:Rn(u(),LT),urlCopilotRing:u()};function Bo(e,t){if(typeof sessionStorage>"u")return!1;try{return ew[e].parse(t),sessionStorage.setItem(e,JSON.stringify(t)),!0}catch{return!1}}function Pn(e){if(typeof sessionStorage>"u")return null;const t=sessionStorage.getItem(e);if(!t)return null;try{const n=JSON.parse(t);return ew[e].parse(n)}catch{return null}}function Io(e){typeof sessionStorage>"u"||sessionStorage.removeItem(e)}const sf="authInitStartTime";function tw(e,t){if(qg()){const s=ke().get(ut)?.accountType;Je({feature:"api",scenario:t,errorType:"missingToken",errorMessage:`User is authenticated but no token was available for ${t==="getWssAPIUrl"?"WebSocket connection":"API request"}`,customData:JSON.stringify({path:e,accountType:s})})}}function nw(e,t){const o=ke().get(ut),s=o?.accountType,a=o?.provider,r=o?.tenantId;s||Je({feature:"api",scenario:t,errorType:"emptyAccountTypeWithToken",errorMessage:`Can get the token but with no user account type ${t==="getWssAPIUrl"?"WebSocket connection":"API request"}`,customData:JSON.stringify({path:e,provider:a,tenantId:r})})}function ow(e){const{providerType:t,apiName:n,extraInfo:o}=e,s=Date.now().toString();Wi(sf,s),R.trackEvent({name:"health",data:{eventName:"copilotWebAuthSDKAPICall",eventInfo_apiName:n,eventInfo_success:!0,eventInfo_customData:JSON.stringify({eventInfo_providerType:t,...o})}})}function sw(e){const{providerType:t,apiName:n,extraInfo:o}=e,s=Date.now(),a=Cr(sf);if(a){const r=parseFloat(a),i=s-r;sessionStorage.removeItem(sf),R.trackEvent({name:"health",data:{eventName:"copilotWebAuthSDKAPICall",eventInfo_apiName:n,eventInfo_success:!0,eventInfo_duration:i,eventInfo_customData:JSON.stringify({eventInfo_providerType:t,...o})}})}}function aw(e){const{authWorkflowAccountType:t,interactionType:n,correlationId:o,prompt:s,redirectUri:a,apiName:r,extraInfo:i}=e,d=Date.now().toString();$t(zp,d),R.trackEvent({name:"health",data:{eventName:"copilotWebAuthSDKAPICall",eventInfo_apiName:r,eventInfo_success:!0,eventInfo_customData:JSON.stringify({eventInfo_authWorkflowAccountType:t??"unknown",eventInfo_interactionType:n??"",eventInfo_correlationId:o??"",eventInfo_prompt:s??"",eventInfo_redirectUri:a??"",...i})}})}function rw(e){const{authWorkflowAccountType:t,isMSA:n,authority:o,correlationId:s,interactionType:a,apiName:r,extraInfo:i}=e,d=Date.now(),m=kt(zp);let p;if(m){const h=parseFloat(m);p=d-h,mt(zp)}R.trackEvent({name:"health",data:{eventName:"copilotWebAuthSDKAPICall",eventInfo_apiName:r,eventInfo_success:!0,eventInfo_customData:JSON.stringify({eventInfo_authWorkflowAccountType:t??"unknown",eventInfo_interactionType:a,eventInfo_correlationId:s,eventInfo_authority:o,eventInfo_isMSA:n??!1,...i}),eventInfo_duration:p??0}})}function iw(e){const{providerType:t,apiName:n,extraInfo:o}=e;R.trackEvent({name:"health",data:{eventName:"copilotWebAuthSDKAPICall",eventInfo_success:!0,eventInfo_apiName:n,eventInfo_customData:JSON.stringify({eventInfo_providerType:t,...o})}})}function Wt(e){const{authWorkflowAccountType:t,apiName:n,duration:o,extraInfo:s}=e;R.trackEvent({name:"health",data:{eventName:"copilotWebAuthSDKAPICall",eventInfo_success:!0,eventInfo_apiName:n,eventInfo_duration:o??0,eventInfo_customData:JSON.stringify({eventInfo_authWorkflowAccountType:t??"unknown",eventInfo_wasInBackground:Yg(),...s})}})}function tn(e){const{authWorkflowAccountType:t,apiName:n,errorMessage:o,errorType:s,errorExtraInfo:a,errorCode:r,extraInfo:i}=e;R.trackEvent({name:"health",data:{eventName:"copilotWebAuthSDKAPICall",eventInfo_success:!1,eventInfo_apiName:n,eventInfo_errorType:s,eventInfo_errorMessage:o,eventInfo_errorCode:r,eventInfo_customData:JSON.stringify({eventInfo_authWorkflowAccountType:t??"unknown",eventInfo_wasInBackground:Yg(),...i,...a})}})}function m$(e){const{authWorkflowAccountType:t,apiName:n}=e;$t(Gp,"1"),R.trackEvent({name:"health",data:{eventName:"copilotWebAuthSDKAPICall",eventInfo_success:!0,eventInfo_apiName:n,eventInfo_customData:JSON.stringify({eventInfo_authWorkflowAccountType:t})}})}function p$(e){const{authWorkflowAccountType:t,apiName:n,duration:o}=e,s=kt(Gp);s==="1"&&mt(Gp),s==="1"&&R.trackEvent({name:"health",data:{eventName:"copilotWebAuthSDKAPICall",eventInfo_success:!0,eventInfo_apiName:n,eventInfo_duration:o??0,eventInfo_customData:JSON.stringify({eventInfo_authWorkflowAccountType:t})}})}function Kg(e,t,n,o,s){return{eventInfo_requestType:t,eventInfo_retryAttemptCount:e.attemptCount,eventInfo_retryStartTime:e.startTime,eventInfo_retryEndDelay:e.endTime,eventInfo_retryDelayTimings:e.delayTimings.join(","),eventInfo_allErrors:JSON.stringify(e.errors),eventInfo_wasInBackground:Yg(),eventInfo_localAccountId:n?.localAccountId,eventInfo_homeAccountId:n?.homeAccountId,eventInfo_redirectUri:o,eventInfo_interactionType:s}}function cw(e,t,n,o,s,a){Wt({authWorkflowAccountType:n,apiName:n==="microsoft"?zo.ACQUIRE_TOKEN_OVERALL_SUCCESS:Vn.ACQUIRE_TOKEN_OVERALL_SUCCESS,extraInfo:Kg(e,t,o,s,a)})}function lw(e,t,n,o,s,a){const r=Kg(e,t,o,s,a),i=e.errors[e.errors.length-1];tn({authWorkflowAccountType:n,apiName:n==="microsoft"?zo.ACQUIRE_TOKEN_OVERALL_FAILURE:Vn.ACQUIRE_TOKEN_OVERALL_FAILURE,errorType:i?.errorType??"unknown",errorMessage:i?.errorMessage??"unknown error",extraInfo:{...r,eventInfo_exitReason:e.exitReason}})}function uw(e,t,n,o,s,a){const r=Kg(e,t,o,s,a);tn({authWorkflowAccountType:n,apiName:n==="microsoft"?zo.ACQUIRE_TOKEN_TIMEOUT:Vn.ACQUIRE_TOKEN_TIMEOUT,errorType:"RequestTimeoutError",errorMessage:`Token acquisition timed out on attempt ${e.attemptCount}`,extraInfo:{...r,eventInfo_totalDuration:e.endTime-e.startTime}})}function U5e(e){const t=e instanceof Error?e.message:String(e);R.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"GraphAPITimeout",eventInfo_errorMessage:t,eventInfo_details:"Student status check failed or timed out"}})}function Yg(){return typeof document<"u"&&document.visibilityState==="hidden"}function f$(e){Wt({apiName:zo.REAUTH_POPUP_SHOW,authWorkflowAccountType:"microsoft",extraInfo:{eventInfo_errorMessage:e}})}function h$(){const e=Pn("retrieveLoginWithLoginHintStartTime"),t=Date.now();if(e){const n=t-parseInt(e,10);Bo("retrieveLoginWithLoginHintStartTime",""),Wt({apiName:zo.RETRIEVE_LOGIN_WITH_LOGIN_HINT_SUCCESS,authWorkflowAccountType:"microsoft",extraInfo:{eventInfo_duration:n}})}}class Ds{#e;#t=null;#n;#o=null;constructor(t,n){this.#e=t,this.#n=n}async get(t){return(this.#o===null||this.#n&&(!this.#t||this.#t<Date.now()-this.#n))&&(this.#o=this.#e(t),this.#t=Date.now()),this.#o}set(t){this.#o=t,this.#t=Date.now()}reset(){this.#o=null,this.#t=null}get isInstantiated(){return this.#o!==null}}const bo=new Ds(g$);async function g$(){ow({apiName:Vn.INITIALIZE_START,providerType:"auth0"});const e=await T9(n$());sw({apiName:Vn.INITIALIZE_END,providerType:"auth0"});const t=new Map([["on",null],["off",null],["cache-only",null]]);async function n(a,r){const i=performance.now();Wt({authWorkflowAccountType:r,apiName:Vn.ACQUIRE_TOKEN_START});try{const d={...QT,shouldRetry:h=>!(h instanceof wv&&h.error==="login_required"),onSuccess:h=>cw(h,"graph",r??"google"),onFailure:h=>lw(h,"graph",r??"google"),onTimeout:h=>uw(h,"graph",r??"google")},m=await ya((h=0)=>mb(()=>e.getTokenSilently(a),i$,h,l$),d),p=performance.now();return _o({feature:"auth0SdkUsage",scenario:"getAuth0AccessToken",duration:p-i,customData:JSON.stringify({cacheMode:a.cacheMode??"on"})}),m}catch(d){d instanceof wv?(s({options:a,startTime:i,authWorkflowAccountType:r,errorType:d.error,errorMessage:d.error_description,exception:d.stack}),d.error==="login_required"&&Ee(bs,{reason:"token-expired",provider:"auth0"})):d instanceof Error?s({options:a,startTime:i,authWorkflowAccountType:r,errorType:d.name,errorMessage:d.message,exception:d.stack}):s({options:a,startTime:i,authWorkflowAccountType:r,errorType:"unknown",errorMessage:`${d}`});return}}async function o(a){const r=await e.getUser();if(!r)return;const i=r.sub&&r.sub.startsWith("google")?"google":"apple",d=a.cacheMode??"on",m=t.get(d);if(!m){const p=n(a,i);t.set(d,p);const h=await p;return t.set(d,null),h}return m}function s(a){const{startTime:r,options:i,authWorkflowAccountType:d,errorType:m,errorMessage:p,exception:h}=a;tn({authWorkflowAccountType:d,apiName:Vn.ACQUIRE_TOKEN_FAILURE,errorType:m,errorMessage:p,errorExtraInfo:{eventInfo_providerType:"auth0",eventInfo_exception:h??"",cacheMode:i.cacheMode??"on",duration:performance.now()-r}})}return{auth0:e,getAuth0AccessToken:o}}function af(){Jo(gr,V(),!0),Zo(gr,"true",{expireDays:90})}function dw(){mt(gr),vr(gr)}function v$(){const e=qt(gr,V().nullable()),t=Yo(gr);return e===null&&t===void 0?!1:e===!0||t==="true"}class y${supportsNaa(){return!1}supportsPwBBroker(){return!1}hasHostAccount(){}async handleInteractionRequiredError(t,n,o,s){return Ee(bs,{reason:"token-expired",provider:"microsoft",loginHint:n.account?.username,errorMessage:o,correlationId:s}),new Promise(a=>{const r=i=>{Ce.off("auth:reauth-popup-success",r),a(i)};Ce.on("auth:reauth-popup-success",r)})}}class C$ extends y${supportsPwBBroker(){return J.instance().config().useMSALPwBApp??!1}async instantiateMsal(){const{PairwiseBrokerApplication:t,PublicClientApplication:n,EventType:o}=await ua(),s=this.supportsPwBBroker();ow({apiName:o.INITIALIZE_START,providerType:"microsoft",extraInfo:{eventInfo_isPwB:s}});let a;s?(a=new t(Hy,a$,Gy()),await a.initialize(),await a.initializeBrokering()):a=await n.createPublicClientApplication(Hy,Gy());const r=a.getActiveAccount();return sw({apiName:o.INITIALIZE_END,providerType:"microsoft",extraInfo:{eventInfo_isPwB:s,eventInfo_environment:r?.environment}}),a}}const Zg=new Ds(S$);async function S$(){return new C$}function b$(e,t,n){return!(e instanceof t||e instanceof n&&(e.errorMessage===LI||parseInt(e.errorCode,10)===zi))}const Ut=new Ds(I$);async function I$(){const e=await Zg.get(),t=await e.instantiateMsal(),n=new Map([["login",null],["graph",null],["oneDrive",null],["decryptionService",null]]);async function o(r,i){const d=s$(r),m={account:i,...d,redirectUri:Gg,extraQueryParameters:{sus:"1"},tokenQueryParameters:{sus:"1"}};try{i?.environment===""&&tn({apiName:zo.EMPTY_ACCOUNT_ENVIRONMENT,authWorkflowAccountType:"microsoft",errorType:"EmptyAccountEnvironment",errorMessage:"Account environment is empty string",extraInfo:{eventInfo_isPwB:e.supportsPwBBroker(),eventInfo_isNaa:e.supportsNaa(),eventInfo_redirectUri:m.redirectUri}});const{InteractionRequiredAuthError:p,AuthError:h}=await ua(),g={...QT,shouldRetry:b=>b$(b,p,h),onSuccess:b=>cw(b,r,"microsoft",{localAccountId:i?.localAccountId,homeAccountId:i?.homeAccountId},m.redirectUri,Am.Silent),onFailure:b=>lw(b,r,"microsoft",{localAccountId:i?.localAccountId,homeAccountId:i?.homeAccountId},m.redirectUri,Am.Silent),onTimeout:b=>uw(b,r,"microsoft",{localAccountId:i?.localAccountId,homeAccountId:i?.homeAccountId},m.redirectUri,Am.Silent)};return await ya(async(b=0)=>mb(async()=>({accessToken:(await t.acquireTokenSilent(m)).accessToken}),r$,b,c$),g)}catch(p){const{InteractionRequiredAuthError:h,AuthError:g}=await ua();if(p instanceof h)return R.trackEvent({name:"system",data:{eventName:"copilotWebAcquireTokenRedirect",eventInfo_requestType:r,eventInfo_traceId:p.traceId,eventInfo_errorMessage:p.errorMessage,eventInfo_errorCode:p.errorCode,eventInfo_correlationId:p.correlationId,eventInfo_timeSinceStartMs:performance.now()-window.appStart,eventInfo_localAccountId:i?.localAccountId,eventInfo_homeAccountId:i?.homeAccountId}}),e.handleInteractionRequiredError(t,m,p.errorMessage,p.correlationId);if(p instanceof g&&(p.errorMessage===LI||parseInt(p.errorCode,10)===zi))throw R.trackEvent({name:"system",data:{eventName:"copilotWebAcquireTokenUnderaged",eventInfo_requestType:r,eventInfo_errorMessage:p.errorMessage,eventInfo_errorCode:p.errorCode,eventInfo_correlationId:p.correlationId}}),new Error(Lh);return}}async function s(r,i){const d=await o(r,i);return d===void 0&&e.supportsNaa()&&e.hasHostAccount()&&R.trackEvent({name:"system",data:{eventName:"naaBridgeCallError",eventInfo_requestType:r,eventInfo_errorMessage:"Failed to acquire token silently with NAA"}}),d}return{msal:t,getMsalAccessToken:async r=>{const i=t.getActiveAccount();if(!i&&(!e.supportsNaa()||W("naa-has-active-account-check")&&e.hasHostAccount()===!1))return;const d=n.get(r);if(!d){const m=s(r,i??void 0);n.set(r,m);const p=await m;return n.set(r,null),p}return d}}}function E$(e){const t=e.payload?.scopes;return Array.isArray(t)?t.some(n=>typeof n!="string"?!1:n==="ConsumerStore.Purchase"||n.endsWith("purchase.create")):!1}const yo=new Map,T$=20;async function w$(e){const t=await Zg.get(),n=t.supportsPwBBroker(),o=t.supportsNaa(),s=E$(e),{EventType:a}=await ua();if(e.eventType===a.LOGIN_START||e.eventType===a.SSO_SILENT_START){const r=e.payload;aw({apiName:e.eventType,authWorkflowAccountType:"microsoft",interactionType:e.interactionType??void 0,correlationId:r.correlationId,prompt:r.prompt,redirectUri:r.redirectUri,extraInfo:{eventInfo_isBrokered:s,eventInfo_isPwB:n,eventInfo_isNaa:o}})}else if(e.eventType===a.LOGIN_SUCCESS||e.eventType===a.SSO_SILENT_SUCCESS){const r=e.payload&&"account"in e.payload?e.payload.account:null,i=r?!Vo(r.tenantId):void 0,d=e.payload;rw({apiName:e.eventType,authWorkflowAccountType:"microsoft",interactionType:e.interactionType??void 0,correlationId:d.correlationId,authority:d.authority,isMSA:i,extraInfo:{eventInfo_isBrokered:s,eventInfo_isPwB:n,eventInfo_isNaa:o,eventInfo_environment:d.account?.environment,eventInfo_redirectUri:d.redirectUri}})}else if(e.eventType===a.LOGOUT_SUCCESS)dw(),yo.clear(),iw({apiName:a.LOGOUT_SUCCESS,providerType:"microsoft",extraInfo:{eventInfo_isBrokered:s,eventInfo_isPwB:n,eventInfo_isNaa:o}});else if(e.eventType===a.ACQUIRE_TOKEN_START||e.eventType===a.ACQUIRE_TOKEN_NETWORK_START){Wi("msalAcquireTokenStartTime",Date.now().toString());const r=e.payload;if(r.correlationId&&r.redirectUri){if(yo.size>=T$){const i=yo.keys().next().value;i?yo.delete(i):yo.clear()}yo.set(r.correlationId,r.redirectUri)}Wt({authWorkflowAccountType:"microsoft",apiName:e.eventType,extraInfo:{eventInfo_interactionType:e.interactionType??void 0,eventInfo_correlationId:r.correlationId,eventInfo_redirectUri:r.redirectUri,eventInfo_cacheLookupPolicy:r.cacheLookupPolicy,eventInfo_prompt:r.prompt,eventInfo_isBrokered:s,eventInfo_isPwB:n,eventInfo_isNaa:o,eventInfo_environment:r.account?.environment,authority:r.authority,eventInfo_localAccountId:r.account?.localAccountId,eventInfo_homeAccountId:r.account?.homeAccountId}})}else if(e.eventType===a.ACQUIRE_TOKEN_SUCCESS){af();const r=Date.now()-parseInt(Cr("msalAcquireTokenStartTime")??"0",10);Wi("msalAcquireTokenStartTime","");const i=e.payload;let d;i.correlationId&&(d=yo.get(i.correlationId),yo.delete(i.correlationId)),Wt({authWorkflowAccountType:"microsoft",apiName:e.eventType,extraInfo:{eventInfo_interactionType:e.interactionType??void 0,eventInfo_correlationId:i.correlationId,eventInfo_expiresOn:i.expiresOn,eventInfo_extExpiresOn:i.extExpiresOn,eventInfo_refreshOn:i.refreshOn,eventInfo_duration:r,eventInfo_fromCache:i.fromCache,eventInfo_isBrokered:s,eventInfo_isPwB:n,eventInfo_isNaa:o,eventInfo_environment:i.account.environment,authority:i.authority,eventInfo_localAccountId:i.account.localAccountId,eventInfo_homeAccountId:i.account.homeAccountId,eventInfo_redirectUri:d}})}else if(e.eventType===a.LOGIN_FAILURE||e.eventType===a.ACQUIRE_TOKEN_FAILURE||e.eventType===a.SSO_SILENT_FAILURE||e.eventType===a.ACQUIRE_TOKEN_BY_CODE_FAILURE||e.eventType===a.LOGOUT_FAILURE){const{msal:r}=await Ut.get();let i;e.eventType===a.ACQUIRE_TOKEN_FAILURE&&(i=Date.now()-parseInt(Cr("msalAcquireTokenStartTime")??"0",10));const d=e.error;let m;d?.correlationId&&(m=yo.get(d.correlationId),yo.delete(d.correlationId));const p=r.getActiveAccount(),h=p?.localAccountId,g=p?.homeAccountId,y=r.getConfiguration().auth.authority;tn({authWorkflowAccountType:"microsoft",apiName:e.eventType,errorType:d?.name??"",errorMessage:d?.message??"",extraInfo:{eventInfo_isBrokered:s,eventInfo_isPwB:n,eventInfo_isNaa:o},errorExtraInfo:{eventInfo_correlationId:d?.correlationId,eventInfo_errorMessage:d?.errorMessage,eventInfo_errorCode:d?.errorCode,eventInfo_name:d?.name,eventInfo_interactionType:e.interactionType??void 0,eventInfo_subError:d?.subError,eventInfo_duration:i,eventInfo_environment:p?.environment,authority:y,eventInfo_localAccountId:h,eventInfo_homeAccountId:g,eventInfo_redirectUri:m}})}else Wt({authWorkflowAccountType:"microsoft",apiName:e.eventType,extraInfo:{eventInfo_interactionType:e.interactionType??void 0,eventInfo_isBrokered:s,eventInfo_isPwB:n,eventInfo_isNaa:o}})}function Vo(e){return e!==vR}function $y(e){Wt({apiName:"msal:silentSSOCustomSuccess",authWorkflowAccountType:"microsoft",duration:e.duration,extraInfo:{eventInfo_accountUpdate:e.accountUpdate,eventInfo_accountType:e.accountType,eventInfo_message:e.message,eventInfo_edgeHasAccount:e.edgeProfileData?.hasAccount,eventInfo_edgeAccountType:e.edgeProfileData?.accountType,eventInfo_edgeIsInGoodState:e.edgeProfileData?.isInGoodState}})}function qy(e){tn({apiName:"msal:silentSsoCustomError",authWorkflowAccountType:"microsoft",errorMessage:e.message,errorCode:e.errorCode,extraInfo:{eventInfo_edgeHasAccount:e.edgeProfileData?.hasAccount,eventInfo_edgeAccountType:e.edgeProfileData?.accountType,eventInfo_edgeIsInGoodState:e.edgeProfileData?.isInGoodState}})}function Jg(e){try{return new URL(e,window.location.origin).origin!==window.location.origin}catch{return!1}}function Qg(e){B(Na)&&Jg(e)?ke().set(Lg,e.toString()):window.location.href=e}function Os(){mw()}function mw(e){const{surfaceQueryParam:t}=J.instance().config(),n=new URL(window.location.href);if(e&&(n.pathname=e),t)for(const[o,s]of Object.entries(t.params))n.searchParams.delete(o),n.searchParams.append(o,s);Qg(n.href)}function Xg(e){const t=e.split(".")[1];if(t===void 0)return;const n=t.replace(/-/g,"+").replace(/_/g,"/"),o=decodeURIComponent(atob(n).split("").map(s=>`%${`00${s.charCodeAt(0).toString(16)}`.slice(-2)}`).join(""));try{const s=JSON.parse(o);return qW.parse(s)}catch{return}}async function A$(e,t){const{getAuth0AccessToken:n}=await bo.get(),{authorizationParams:o}=Ed(),s={...o,dob:e,ctry:t},a=await n({authorizationParams:s,cacheMode:"off"});if(!a)return;const r=Xg(a);if(r)return r}async function x$(){const{getAuth0AccessToken:e}=await bo.get(),t=await e(Ed());if(!t)return;const n=Xg(t);if(n){if(n.sub.startsWith("google"))return"Google";if(n.sub.startsWith("apple"))return"Apple"}}function _$(e){switch(e){case"apple":return"Apple";case"google":return"Google";case"msa":return"MSA";default:return}}async function e1(e=!0){const{msal:t}=await Ut.get(),n=t.getActiveAccount();await t.clearCache({account:n}),e&&Os()}const rf=new BroadcastChannel("cp.broadcast");class k${hasTrackedRedirectError=!1;CODE_RE=/[?&]code=[^&]+/;STATE_RE=/[?&]state=[^&]+/;ERROR_RE=/[?&]error=[^&]+/;async handleRedirectWithoutAccount(){try{const{auth0:t}=await bo.get();if(this.hasAuthParams()){const n=performance.now();await t.handleRedirectCallback();const o=performance.now();_o({feature:"auth0SdkUsage",scenario:"handleRedirect",duration:o-n});const s=await t.getUser();if(!s)return;const a=s.sub?this.getTokenType(s.sub):void 0;rw({apiName:Vn.LOGIN_SUCCESS,authWorkflowAccountType:a}),rf.postMessage({eventName:"auth0.accountAdded"})}}catch(t){this.trackRedirectErrorOncePerSession(t)}}async getCurrentActiveUserAccount(){const{auth0:t}=await bo.get(),n=await t.getUser();if(!n)return null;const{sub:o}=n;return o?{id:o,tenantId:crypto.randomUUID(),provider:"auth0",accountType:this.getAccountType(o)}:null}async logIn(t){const n=t?.connection;if(!n)throw new Error("connection in LoginOpts are required");const{auth0:o}=await bo.get();return aw({apiName:Vn.LOGIN_START,authWorkflowAccountType:t.connection??void 0}),mt(Ph),mt(qu),mt(ou),mt(su),mt(Hi),o.loginWithRedirect({authorizationParams:{...o$().authorizationParams,connection:this.getConnectionFromTokenType(n)}})}async logOut(){const{auth0:t}=await bo.get(),n=await t.getUser(),o=n&&n.sub?this.getTokenType(n.sub):void 0;try{await t.logout({logoutParams:{returnTo:window.location.origin}}),rf.postMessage({eventName:"auth0.accountRemoved"}),iw({apiName:Vn.LOGOUT_SUCCESS,providerType:"auth0"})}catch(s){tn({authWorkflowAccountType:o,apiName:Vn.LOGOUT_FAILURE,errorMessage:`${s}`,errorExtraInfo:{eventInfo_providerType:"auth0"}}),console.error("Auth0 logout failed:",s)}}async getAuthToken(t="login"){if(t!=="graph")try{const{auth0:n,getAuth0AccessToken:o}=await bo.get(),s=await o(Ed());if(!s)return;const a=await n.getUser();if(a){const r=a.sub,i=this.getTokenType(r);return{accessToken:s,tokenType:i}}}catch{return}}async getUserInfo(){const{auth0:t}=await bo.get(),n=await t.getUser();if(n)return zg()&&(n.picture&&$t(su,n.picture),n.given_name&&$t(Hi,n.given_name)),{mail:n.email??"",givenName:n.given_name??"",surname:n.surname??"",imgSrc:n.picture,isStudent:!1}}async getUserInfoFromToken(t){const n=Xg(t);if(!n)return;const{email:o,name:s}=n;return{mail:o,givenName:s.split(" ")[0]??"",surname:"",imgSrc:"",isStudent:!1}}supportsTokenType(t){return t==="apple"||t==="google"}getTokenType(t){return t.startsWith("google")?"google":"apple"}getAccountType(t){return t.startsWith("google")?"Google":"Apple"}getConnectionFromTokenType(t){return t==="apple"?"apple":"google-oauth2"}hasAuthParams(t=window.location.search){return(this.CODE_RE.test(t)||this.ERROR_RE.test(t))&&this.STATE_RE.test(t)}trackRedirectErrorOncePerSession(t){this.hasTrackedRedirectError||(R.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"auth0HandleRedirectPromise",eventInfo_details:"Error handling redirect promise",eventInfo_errorMessage:`${t}`}}),tn({apiName:Vn.LOGIN_FAILURE,errorExtraInfo:{eventInfo_providerType:"auth0"},errorMessage:`${t}`})),this.hasTrackedRedirectError=!0}}const P$=["CAREERCOACH_STUDENTS","EXCHANGESTANDARD_STUDENT","M365EDU_A3_STUDENT","M365EDU_A3_STUUSEBNFT","M365EDU_A3_STUUSEBNFT_RPA1","M365EDU_A5_STUDENT","M365EDU_A5_STUUSEBNFT","M365EDU_A5_NOPSTNCONF_STUUSEBNFT","OFFICESUBSCRIPTION_STUDENT","ATP_ENTERPRISE_STUDENT","ATP_ENTERPRISE_STUDENTS_USE_BENEFIT","POWER_BI_STANDARD_STUDENT","MCOEV_STUDENT","MEE_STUDENT","STANDARDWOFFPACK_STUDENT","STANDARDWOFFPACK_IW_STUDENT","ENTERPRISEPACKPLUS_STUDENT","ENTERPRISEPREMIUM_STUDENT","WIN10_ENT_A3_STU","MCO_TEAMS_EDU_HS_STUDENT","PROJECT_PROFESSIONAL_STUDENT","PROJECT_P1_STUDENT"];async function t1(e){const{Client:t}=await N(async()=>{const{Client:n}=await import("./index-CsddE2Rg.js");return{Client:n}},__vite__mapDeps([4,5,6]));return t.init({authProvider:n=>{n(null,e)}})}async function Gm(e,t){const n=performance.now(),o=await t;return R.trackEvent({name:"system",data:{eventName:"externalApiResponse",eventInfo_id:e,eventInfo_duration:performance.now()-n,eventInfo_service:"microsoft-graph"}}),o}async function M$(e){return(await t1(e)).api($g.graphMeApiSuffix).get()}async function R$(e){try{const n=await(await t1(e)).api($g.graphMeImageApiSuffix).get();return URL.createObjectURL(n)}catch{return}}async function N$(e){if(B(hc))try{const o=await(await t1(e)).api($g.graphMeLicenseDetails).get();return o&&o.value.some(a=>a.skuPartNumber&&P$.includes(a.skuPartNumber))}catch(n){return console.error("Error checking student status:",n),!1}else return!1}async function Ky(e){const[t,n,o]=await Promise.all([Gm("user",M$(e)),Gm("user_photo",R$(e)),Gm("is_student",N$(e))]);return{...t,imgSrc:n,isStudent:o}}class L${hasTrackedRedirectError=!1;isHandlingRedirect=!1;async handleRedirectWithoutAccount(){try{const{msal:t}=await Ut.get();this.isHandlingRedirect&&tn({authWorkflowAccountType:"microsoft",apiName:zo.INTERACTION_IN_PROGRESS,errorType:"interaction_in_progress",errorMessage:"Attempted to call handleRedirectPromise while already handling a redirect"}),this.isHandlingRedirect=!0;try{const n=await t.handleRedirectPromise();if(n){t.setActiveAccount(n.account);const o=Pn("loginHintRedirectPath");Io("loginHintRedirectPath"),o&&window.history.pushState({from:"/"},"",o),h$(),p$({authWorkflowAccountType:"microsoft",apiName:"msal:reauthSuccess"}),$W()&&this.testThirdPartyCookieSupport(n.account)}}finally{this.isHandlingRedirect=!1}}catch(t){this.trackRedirectErrorOncePerSession(t)}}async logIn(){const{msal:t}=await Ut.get(),n={...Wg()},o=this.buildRedirectUri();return o&&(n.redirectUri=o),af(),t.loginRedirect(n)}buildRedirectUri(){const{surfaceQueryParam:t}=J.instance().config(),n=new URLSearchParams;let o;if(t?.useForLoginRedirect)for(const[a,r]of Object.entries(t.params))n.set(a,r);const s=new URLSearchParams(window.location.search).get("back");return s&&n.set("back",s),n.toString()&&(o=`${window.location.origin}?${n}`),o}async logOut(){const{msal:t}=await Ut.get(),n=t.getActiveAccount();dw(),await t.logoutRedirect({account:n,onRedirectNavigate:()=>!1}),R.setPicassoId(null)}async getAuthToken(t="login"){const n=await(await Ut.get()).getMsalAccessToken(t);return n&&(v$()||R.trackEvent({name:"system",data:{eventName:"msalUnmarkedGetToken"}}),af()),n}async getUserInfo(){const t=await this.getAuthToken("graph");if(t)return Ky(t.accessToken)}async getUserInfoFromToken(t){return Ky(t)}supportsTokenType(t){return t===void 0}trackRedirectErrorOncePerSession(t){this.hasTrackedRedirectError||R.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"msalHandleRedirectPromise",eventInfo_details:"Error handling redirect promise",eventInfo_errorMessage:`${t}`}}),this.hasTrackedRedirectError=!0}async getAccount(){const{msal:t}=await Ut.get(),n=t.getAllAccounts(),o=t.getActiveAccount();if((n.length>1||n.length===1&&o?.homeAccountId!==n[0]?.homeAccountId)&&Wt({authWorkflowAccountType:"microsoft",apiName:"msal:getAllAccounts",extraInfo:{eventInfo_accountCount:n.length,eventInfo_accountTypes:n.map(s=>Vo(s.tenantId)?"AAD":"MSA")}}),n.length!==0){if(n.length===1)return n[0];if(n.length>1&&o)return o}}async tryActivateMigratedAccount(){const{msal:t}=await Ut.get(),n=t.getAllAccounts();if(!t.getActiveAccount()&&n.length>0&&n[0]){const s=n[0];return t.setActiveAccount(s),{id:s.idTokenClaims?.oid??"",tenantId:s.tenantId,provider:"microsoft",accountType:Vo(s.tenantId)?"AAD":"MSA"}}}async getCurrentActiveUserAccount(){const t=await this.getAccount();return t?{id:t.idTokenClaims?.oid??"",tenantId:t.tenantId,provider:"microsoft",accountType:Vo(t.tenantId)?"AAD":"MSA"}:null}async NAAGetTokenAndSetAccount(){const{msal:t}=await Ut.get(),n=await this.getAuthToken();if(n){const o=await this.getAccount();return o?(t.setActiveAccount(o),{userAccount:{id:o.idTokenClaims?.oid??"",tenantId:o.tenantId,provider:"microsoft",accountType:Vo(o.tenantId)?"AAD":"MSA"},authToken:n}):null}return null}async cleanCache(){const{msal:t}=await Ut.get(),n=await this.getAccount();await t.logoutRedirect({account:n,onRedirectNavigate:()=>!1})}async testThirdPartyCookieSupport(t){try{const{msal:n}=await Ut.get(),o={...KT(),account:t};await n.ssoSilent(o),Wt({authWorkflowAccountType:"microsoft",apiName:zo.SSO_SILENT_SUCCESS_AFTER_LOGIN,extraInfo:{eventInfo_localAccountId:t.localAccountId,eventInfo_homeAccountId:t.homeAccountId}})}catch(n){tn({authWorkflowAccountType:"microsoft",apiName:zo.SSO_SILENT_FAILURE_AFTER_LOGIN,errorType:n instanceof Error?n.name:"unknown",errorMessage:n instanceof Error?n.message:String(n),extraInfo:{eventInfo_localAccountId:t.localAccountId,eventInfo_homeAccountId:t.homeAccountId}})}}}class Fe{middlewares=[];add(t){this.middlewares.push(t)}async run(t){let n={...t};for(const o of this.middlewares)try{n=await o(n)}catch{continue}return n}}class Oc{handlers=[];add(t){this.handlers.push(t)}run(t){let n={...t};for(const o of this.handlers)try{n=o(n)}catch{continue}return n}}const pw=new Fe,D$=new Fe,Yy=new Fe,O$=new Fe,U$=new Fe,F$=new Fe,j$=new Fe,B$=new Fe,ar=new Fe,fw=new Oc,V$=new Oc,H$=new Fe,F5e=new Fe,j5e=new Fe,z$=new Fe,G$=new Fe,W$=new Fe,$$=new Fe,B5e=new Fe,Zy=new Fe,q$=new Fe,K$=new Fe,V5e=new Fe,H5e=new Fe,z5e=new Fe,Y$=new Fe,Z$=new Fe,G5e=new Fe,J$=new Fe,Q$=new Fe,X$=new Fe,hw=new Fe,eq=new Fe,tq=new Fe,n1=new Fe,W5e=new Oc,nq=new Fe,$5e={ContextualConsent:"ContextualConsent",ContextualSuggestionConsent:"ContextualSuggestionConsent",VideoTranscriptConsent:"VideoTranscriptConsent"},q5e=new Fe,K5e=new Fe,Y5e=new Fe,Z5e=new Fe,oq=new Oc,sq=new Fe,ci=new Fe,J5e=new Fe,aq=new Oc,Q5e=new Fe,rq=new Fe,X5e=new Fe,eTe=new Fe,tTe=new Fe,iq=new Fe,nTe=new Fe,cq=new Fe,lq=new Fe;async function uq(e,t){if(zg()&&(kt(ou)==="true"||kt(qu)==="true")){const o=await e.getCurrentActiveUserAccount(),s=await t.getCurrentActiveUserAccount();o&&s&&await e.cleanCache()}}class Mn{static#e=null;providers;constructor(){this.providers={microsoft:new L$,auth0:new k$}}getAadAccount(){return B(my)}getNonAadAccount(){return B(py)}getCurrentActiveAccount(){return B(ut)}setUserAccountWithMultiAccountSupport(t){t&&(t.accountType==="AAD"?Ee(my,t):Ee(py,t)),Ee(ut,t),R.setUserAccountType(t?.accountType)}switchToAadAccount(){const t=this.getAadAccount();return t?(Ee(ut,t),R.setUserAccountType(t.accountType),!0):!1}switchToNonAadAccount(){const t=this.getNonAadAccount();return t?(Ee(ut,t),R.setUserAccountType(t.accountType),!0):!1}hasBothAccountTypes(){return this.getAadAccount()!==null&&this.getNonAadAccount()!==null}async handleRedirectWithoutAccount(){await this.providers.microsoft.handleRedirectWithoutAccount(),J.instance().config().enableAuth0&&await this.providers.auth0.handleRedirectWithoutAccount()}async hasBothMsalAndAuth0Accounts(){const t=await this.providers.microsoft.getCurrentActiveUserAccount(),n=await this.providers.auth0.getCurrentActiveUserAccount();return!!(t&&n)}async getCurrentActiveUserAccountAndSetGlobalUserAccount(){if(await uq(this.providers.microsoft,this.providers.auth0),zg()&&await this.providers.auth0.getCurrentActiveUserAccount()){const a=await this.providers.microsoft.tryActivateMigratedAccount();if(a){this.setUserAccount(a);return}}const n=await this.providers.microsoft.getCurrentActiveUserAccount();if(n){this.setUserAccount(n);return}if(!J.instance().config().enableAuth0)return;const o=await this.providers.auth0.getCurrentActiveUserAccount();o&&this.setUserAccount(o)}static instance(){return Mn.#e||(Mn.#e=new Mn),Mn.#e}getCurrentProvider(){const t=B(ut);return t?this.providers[t.provider]:null}async getAccountFromProviders(){return this.getCurrentProvider()?.getCurrentActiveUserAccount()??null}setUserAccount(t){this.setUserAccountWithMultiAccountSupport(t)}async getAuthToken(t="login"){const n=await Yy.run({type:t});if(n.isHandled){if(t==="login"&&n.authToken?.tokenType!==void 0){const s=_$(n.authToken.tokenType);R.setUserAccountType(s)}return n.authToken}const o=this.getCurrentProvider();if(!o&&t==="login"){if((await Zg.get()).supportsNaa()){const a=await this.providers.microsoft.NAAGetTokenAndSetAccount();if(a){const{authToken:r,userAccount:i}=a;return this.setUserAccount(i),r}}return}return o?.getAuthToken(t)}async getUserInfo(){const t=await Yy.run({type:"graph"});if(t.isHandled){if(!t.authToken)return;const{tokenType:o,accessToken:s}=t.authToken,a=o!=="msa"?o:void 0;if(this.providers.microsoft.supportsTokenType(a))return this.providers.microsoft.getUserInfoFromToken(s);if(this.providers.auth0.supportsTokenType(a)){const r=await this.providers.auth0.getUserInfoFromToken(s);if(r)return r}return}const n=this.getCurrentProvider();if(n)return n.getUserInfo()}logIn(t,n){return this.providers[t].logIn(n)}async logOut(){const t=this.getCurrentProvider();if(!t)return Promise.resolve();if(J.instance().config().enableAuth0&&W("3p-migration-phase-1")){const n=t===this.providers.microsoft?this.providers.auth0:this.providers.microsoft;await n.getCurrentActiveUserAccount()&&await n.logOut()}return await t.logOut(),this.setUserAccount(null),Promise.resolve()}async initAuthAccount(){await this.handleRedirectWithoutAccount(),await this.getCurrentActiveUserAccountAndSetGlobalUserAccount()}}function gw(){return null}function dq(){return null}function vw(){return null}function yw({featureOverrides:e,localFeatureOverrides:t,localFeaturesToDisable:n,serverFeatures:o,surfaceConfig:s}){const a=new Set([...o]);s.settingsOverrides?.shouldHideShopping&&a.delete("shopping-card"),s.startInVoice&&a.add("start-in-voice");for(const r of e)a.add(r);for(const r of t)a.add(r);for(const r of n)a.delete(r);return Array.from(a)}function Cw(){return[]}function Sw(){return[]}async function o1(){const{msal:e}=await Ut.get();return e.getActiveAccount()}async function s1(){const e=await o1();return e?Vo(e.tenantId):!1}async function oTe(){const e=await o1();if(!(!e||!Vo(e.tenantId)))return e}async function mq(){const e=await o1();if(!(!e||Vo(e.tenantId)))return e}async function pq(){return(await Ut.get()).getMsalAccessToken("oneDrive")}async function sTe(){if(!await s1())return;const{msal:e}=await Ut.get(),t=e.getActiveAccount();t&&e.clearCache({account:t})}const bw="urlFeatureOverrides";function fq(){return typeof window>"u"?null:sessionStorage.getItem(bw)}function Iw(){const e=fq();return e?e.split(",").map(n=>n):[]}function hq(){const e=Pt("features");return e?.trim()&&typeof window<"u"&&sessionStorage.setItem(bw,e.trim()),Iw()}const gq={VITE_API_URL:"copilot.microsoft.com/c/api"};async function Ew(e,t){try{return await e.json()}catch(n){throw(n instanceof SyntaxError||n instanceof TypeError||n instanceof DOMException)&&Fz(n,e,t),n}}function Tw(e={}){const{query:t={}}=e,n=new URLSearchParams;for(const[i,d]of Object.entries(t))n.append(i,d);const o=yw({featureOverrides:Iw(),localFeatureOverrides:Cw(),localFeaturesToDisable:Sw(),serverFeatures:[],surfaceConfig:J.instance().config()}).join(",");o&&(n.append("features",o),n.append("setflight",o));const s=gw();s&&(n.append("promptBranch",s),dq()&&n.append("useSxs","true"));const a=vw();a&&n.append("sxsFeature",a);const{surfaceQueryParam:r}=J.instance().config();if(r)for(const[i,d]of Object.entries(r.params))n.append(i,d);return n}function ww(e){return e!==void 0&&e.tokenType!==void 0&&e.tokenType!=="msa"}async function cf(e,t){const{VITE_API_URL:n}=gq;let o;if($T()?o=`${window.location.host}/c/api`:o=n,!o)throw new Error("Cannot initialize websocket because the required env vars are not set: VITE_API_URL");const s={...t,"api-version":"2"},a=await Mn.instance().getAuthToken(),r=await s1();a&&(!r||Dc())&&(s.accessToken=a.accessToken,ww(a)&&(s["X-UserIdentityType"]=a.tokenType)),a===void 0?tw(e,"getWssAPIUrl"):nw(e,"getWssAPIUrl"),B(Sr)&&(s.appFlavor="beta");const d=Tw({query:s});return`wss://${o}/${e}?${d}`}function vq(e,t){const n=[qT(),e],o=Tw({query:t});return o.toString()&&n.push("?",String(o)),n.join("")}function yq(e,t,n){if(e.attemptCount>1){const o=e.errors.filter(i=>i.errorType==="RequestTimeoutError").length,s=e.errors[e.errors.length-1],a=s?.errorType,r=s?.errorMessage;R.trackEvent({name:"system",data:{eventName:"copilotFeatureSuccess",eventInfo_feature:"apiRetry",eventInfo_scenario:t,eventInfo_duration:e.endTime-e.startTime,eventInfo_customData:JSON.stringify({attemptCount:e.attemptCount,errorCount:e.errors.length,timeoutErrorCount:o,delayTimings:e.delayTimings,lastErrorType:a,lastErrorMessage:r})}})}n?.(e)}function Cq(e,t,n){const o=e.exitReason==="requestTimeout",s={path:t,attemptCount:e.attemptCount,totalDuration:e.endTime-e.startTime,exitReason:e.exitReason,errorCount:e.errors.length,isTimeoutFailure:o,lastErrorType:e.errors[e.errors.length-1]?.errorType,lastErrorMessage:e.errors[e.errors.length-1]?.errorMessage,delayTimings:e.delayTimings};R.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"ApiRetryFailure",eventInfo_errorMessage:o?`API retry failed due to timeout after ${e.attemptCount} attempts`:`API retry failed after ${e.attemptCount} attempts. Exit reason: ${e.exitReason}`,eventInfo_details:JSON.stringify(s)}}),n?.(e)}function Sq(e,t,n){R.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"ApiRetryTimeout",eventInfo_errorMessage:`Request timed out after ${e.timeoutMs}ms (attempt ${e.attemptCount})`,eventInfo_details:JSON.stringify({timeoutMs:e.timeoutMs,attemptCount:e.attemptCount,errorCount:e.errors.length,delayTimings:e.delayTimings,scenario:t,duration:e.endTime-e.startTime})}}),n?.(e)}async function bq(e,t={}){return Aw(Iq,e,t)}async function Iq(e){const t=await xw(e);let n;return t.ok&&(n=await Ew(t,e.analytics?.anonymousPath??e.path)),{response:t,data:n}}async function Aw(e,t,n={}){const{options:o,query:s,analytics:a,retry:r,requestTimeoutMs:i}=n;if(r){const{onSuccess:d,onFailure:m,onTimeout:p,retryOn401:h}=r,g={...r,onSuccess:b=>{yq(b,a?.anonymousPath??t,d)},onFailure:b=>{Cq(b,a?.anonymousPath??t,m)},onTimeout:b=>{Sq({...b,timeoutMs:i??-1},a?.anonymousPath??t,p)}};return ya(i?()=>a7(b=>e({path:t,options:o,query:s,analytics:a,abortController:b,retryOn401:h}),i):()=>e({path:t,options:o,query:s,analytics:a,retryOn401:h}),g)}return e({path:t,options:o,query:s,analytics:a})}async function ko(e,t={}){return Aw(xw,e,t)}async function xw(e){const{path:t,options:n,query:o,analytics:s,abortController:a,retryOn401:r}=e,i=new Headers(n?.headers);st.resolvedLanguage?i.set("X-Search-UILang",st.resolvedLanguage.toLowerCase()):st.language&&i.set("X-Search-UILang",st.language.toLowerCase());const d=await Mn.instance().getAuthToken(),m=await s1();d&&(!m||Dc())&&(i.set("Authorization",`Bearer ${d.accessToken}`),ww(d)&&i.set("X-UserIdentityType",d.tokenType)),d===void 0?tw(t,"fetchApi"):nw(t,"fetchApi"),B(Sr)&&i.set("X-Copilot-App-Flavor","beta");const h=performance.now(),g=await fetch(vq(t,o),{signal:a?.signal,...n,credentials:"include",headers:i}),y=performance.now();if(CT(s?.anonymousPath??t,n?.method??"GET",y-h,g.clone()),Gi.trackLatestApiAssignment(g.headers),r&&g.status===401)throw new Ju(`401 Unauthorized: ${t}`,{statusCode:401,route:t});return g}async function Nt({path:e,args:t={}}){const n={method:"POST",...t.options,headers:{"Content-Type":"application/json",...t.options?.headers},body:t.body?JSON.stringify(t.body):void 0};return ko(e,{...t,options:n})}async function pt(e,t,n={}){const{analytics:o,onFailedRequest:s}=n,a=o?.anonymousPath??e;let r,i;if(n.returnResponseWithData){const y=await bq(e,n);r=y.response,i=y.data}else r=await ko(e,n);let d=!0;if(!r.ok&&s&&(d=!!s(r)),!d)return{data:void 0,response:{ok:r.ok,status:r.status,headers:r.headers},zodError:void 0};const m=n.returnResponseWithData?i:await Ew(r,a);let p,h;const{safe:g}=n.parseOptions??{};if(g)try{const y=t.safeParse(m);y.error&&dr(y.error,a,!0),p=m,h=y.error}catch(y){dr(y,a,!0),p=m}else try{p=t.parse(m)}catch(y){throw y instanceof Fi&&dr(y,a,!1),y}return{data:p,response:{ok:r.ok,status:r.status,headers:r.headers},zodError:h}}class Eq{generateClientEventId(t){if(this.shouldLogForEventName(t.data.eventName))return crypto.randomUUID()}onBeforeTrackEvent(t){this.logEventIfNeededNonBlocking(t,"prepared")}eventsSent(t){for(const n of t)this.logEventIfNeededNonBlocking(n,"success")}eventsDiscarded(t,n){for(const o of t)this.logEventIfNeededNonBlocking(o,this.getStatusFromDiscardedReason(n))}logEventIfNeededNonBlocking(t,n){this.logEventIfNeeded(t,n).catch(()=>{})}async logEventIfNeeded(t,n){this.shouldLogForEventName(t.data?.eventName)&&await ko("/client-telemetry",{options:{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({eventId:t.data?.eventInfo_clientEventId,eventName:t.data?.eventName,status:n,retryCount:"sendAttempt"in t?t.sendAttempt:0,appInfoName:t.data?.appName,userId:t.data?.userPicassoId,userMuid:t.data?.userMuid,conversationId:t.data?.eventInfo_conversationId,messageId:t.data?.eventInfo_messageId,isSdkInitialized:!0,clientTimestamp:t.time??new Date().toISOString()})}})}getStatusFromDiscardedReason(t){switch(t){case 1:return"nonRetryableStatus";case 2:return"invalidEvent";case 3:return"sizeLimitExceeded";case 4:return"killSwitch";case 5:return"queueFull";default:return"unknown"}}shouldLogForEventName(t){switch(t){case"copilotCompose":case"copilotResponseRender":case"copilotStart":return!0;default:return!1}}}const Jy={global:["https://ad.doubleclick.net/ddm/activity/src=8406097;type=ofco;cat=lrn_uni;u1={REGION};u2={LANG_LOCALE};u6=CMC;u50=submit_message;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;ord=1;num={CACHE_BUSTER}"],us:["https://px.ads.linkedin.com/collect/?fmt=gif&pid=7850&url=copilot.microsoft.com/ChatSend","https://secure.adnxs.com/px?id=1869141&t=2","https://servedby.flashtalking.com/spot/1/5155;147512;16638/?spotName=USA_FY25H2_Copilot_Consumer_Chat_Send_button_FT_2_7_25&cachebuster={CACHE_BUSTER}","https://alb.reddit.com/rp.gif?id=a2_gi5vc4m557wn&event=Custom&m.customEventName=COPChatSend&integration=noscript","https://analytics.tiktok.com/api/v2/pixel_event_track?pixel_code=CUUELO3C77U6K9SI3QSG&event=SendMessage&event_id={CACHE_BUSTER}","https://tr.snapchat.com/p?pid=68db1ef4-2290-4224-a91a-df01d273a994&ev=START_CHECKOUT&v=2.3&rand={CACHE_BUSTER}&pl=https://copilot.microsoft.com/","https://tr.snapchat.com/cm/s?pnid=140","https://www.facebook.com/tr?id=1770559986549030&ev=COPChatSend&noscript=1","https://insight.adsrvr.org/track/pxl/?adv=tq5ketp&ct=0:e8n8utj&fmt=3&td1={td1}&td2={td2}&td3={td3}&td4={td4}&td5={td5}&td6={td6}"],gb:["https://secure.adnxs.com/px?id=1869542&t=2&seg=39793132&consent={CONSENT}","https://px.ads.linkedin.com/collect/?fmt=gif&pid=7850&url=copilot.microsoft.com/ChatSend","https://servedby.flashtalking.com/spot/1/3360;147492;16970/?spotName=GBR_FY25H2_Copilot_Consumer_Chat_Send_FT_2_7_25&cachebuster={CACHE_BUSTER}","https://analytics.tiktok.com/api/v2/pixel_event_track?pixel_code=CUUELO3C77U6K9SI3QSG&event=SendMessage&event_id={CACHE_BUSTER}","https://www.facebook.com/tr?id=1770559986549030&ev=COPChatSend&noscript=1","https://tr.snapchat.com/p?pid=68db1ef4-2290-4224-a91a-df01d273a994&ev=START_CHECKOUT&v=2.3&rand={CACHE_BUSTER}&pl=https://copilot.microsoft.com/","https://tr.snapchat.com/cm/s?pnid=140","https://insight.adsrvr.org/track/pxl/?adv=csnj4o5&ct=0:7s8ltxf&fmt=3&td1={td1}&td2={td2}&td3={td3}&td4={td4}&td5={td5}&td6={td6}"],other:["https://www.facebook.com/tr?id=1770559986549030&ev=COPChatSend&noscript=1","https://analytics.tiktok.com/api/v2/pixel_event_track?pixel_code=CUUELO3C77U6K9SI3QSG&event=SendMessage&event_id={CACHE_BUSTER}"]},Bl={onPageLoad:{global:["https://ad.doubleclick.net/ddm/activity/src=8406097;type=ofco;cat=lp_uniq;u1={REGION};u2={LANG_LOCALE};u6=CMC;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;ord=1;num={CACHE_BUSTER}"],us:["https://www.facebook.com/tr?id=1770559986549030&ev=PageView&noscript=1","https://px.ads.linkedin.com/collect/?fmt=gif&pid=7850&url=copilot.microsoft.com/custom-pageload","https://secure.adnxs.com/px?id=1869069&t=2","https://servedby.flashtalking.com/spot/1/5155;147507;16638/?spotName=USA_FY25H2_Copilot_Consumer_Page_Load_FT_2_7_25&cachebuster={CACHE_BUSTER}","https://alb.reddit.com/rp.gif?id=a2_gi5vc4m557wn&event=PageVisit&integration=noscript","https://analytics.tiktok.com/api/v2/pixel_event_track?pixel_code=CUUELO3C77U6K9SI3QSG&event=ViewContent&event_id={CACHE_BUSTER}","https://tr.snapchat.com/p?pid=68db1ef4-2290-4224-a91a-df01d273a994&ev=PAGE_VIEW&v=2.3&rand={CACHE_BUSTER}&pl=https://copilot.microsoft.com","https://tr.snapchat.com/cm/s?pnid=140","https://insight.adsrvr.org/track/pxl/?adv=tq5ketp&ct=0:tzodkxv&fmt=3&td1={td1}&td2={td2}&td3={td3}&td4={td4}&td5={td5}&td6={td6}"],gb:["https://www.facebook.com/tr?id=1770559986549030&ev=PageView&noscript=1","https://px.ads.linkedin.com/collect/?fmt=gif&pid=7850&url=copilot.microsoft.com/custom-pageload","https://secure.adnxs.com/px?id=1869539&seg=39793125&t=2&consent={CONSENT}","https://servedby.flashtalking.com/spot/1/3360;147490;16970/?spotName=GBR_FY25H2_Copilot_Consumer_Page_Load_FT_2_7_25&cachebuster={CACHE_BUSTER}","https://analytics.tiktok.com/api/v2/pixel_event_track?pixel_code=CUUELO3C77U6K9SI3QSG&event=ViewContent&event_id={CACHE_BUSTER}","https://tr.snapchat.com/p?pid=68db1ef4-2290-4224-a91a-df01d273a994&ev=PAGE_VIEW&v=2.3&rand={CACHE_BUSTER}&pl=https://copilot.microsoft.com","https://tr.snapchat.com/cm/s?pnid=140","https://insight.adsrvr.org/track/pxl/?adv=csnj4o5&ct=0:2slc99p&fmt=3&td1={td1}&td2={td2}&td3={td3}&td4={td4}&td5={td5}&td6={td6}"],other:["https://www.facebook.com/tr?id=1770559986549030&ev=PageView&noscript=1","https://analytics.tiktok.com/api/v2/pixel_event_track?pixel_code=CUUELO3C77U6K9SI3QSG&event=ViewContent&event_id={CACHE_BUSTER}"]},onMessageSend:Jy,onStartVoiceChat:Jy,onSuggestionChipClicked:{global:[],us:[],gb:[],other:[]},onDiscoverCardClicked:{global:[],us:[],gb:[],other:[]},onQueryParamSubmit:{global:[],us:[],gb:[],other:[]}},Tq={onPageLoad:{behavior:20,Content:{Id:"CMCChatLoaded",cN:"CMC Chat Loaded"}},onMessageSend:{behavior:63,Content:{Id:"ChatManualMessage",cN:"Chat Manual Message"}},onStartVoiceChat:{behavior:300,Content:{Id:"VoiceMessageClick",cN:"Voice Message Click"}},onSuggestionChipClicked:{behavior:60,Content:{Id:"SuggestionChipClicked",cN:"Suggestion Chip Clicked"}},onDiscoverCardClicked:{behavior:144,Content:{Id:"DiscoverCardClicked",cN:"Discover Card Clicked"}},onQueryParamSubmit:{behavior:141,Content:{Id:"QueryParamMessageSubmit",cN:"Query Param Message Submit"}}};function wq(e,t){return t==="US"?Bl[e].us:t==="GB"?Bl[e].gb:t&&["AU","CA","DE","FR","JP"].includes(t)?Bl[e].other:[]}function Aq(e){if(!W("ads-pixels"))return;const t=ke().get(Bt),n=st.language,o=Date.now().toString(),s=Bl[e].global,a=wq(e,t),{set:r}=ke();r(pT,i=>{for(const d of s.concat(a))i[d]??={url:d.replace("{CACHE_BUSTER}",o).replace("{REGION}",t??"").replace("{LANG_LOCALE}",n).replace("{CONSENT}",kq(t)).replace("{td1}",t??"").replace("{td2}",n).replace("{td3}","CMC").replace("{td4}","").replace("{td5}","").replace("{td6}",Pq(e)),isMounted:!0,timestamp:Date.now()};return{...i}})}function xq(e){W("custom-1ds")&&(window.OneDsAzureAnalytics.capturePageAction(null,Tq[e]),z5())}function rr(e){try{Aq(e),xq(e)}catch{Je({feature:"sendIdeasTelemetry",customData:JSON.stringify({eventName:e})})}}function _q(e){rr(e==="suggestion"?"onSuggestionChipClicked":e==="discover"?"onDiscoverCardClicked":e==="queryParam"?"onQueryParamSubmit":"onMessageSend")}function kq(e){return(e&&Zu.includes(e))===!0?Ia().advertising?"1":"0":""}function Pq(e){switch(e){case"onPageLoad":return"page_load";case"onMessageSend":return"submit_message";case"onStartVoiceChat":return"voice_message";case"onSuggestionChipClicked":return"suggestion_chip";case"onDiscoverCardClicked":return"discover_card";case"onQueryParamSubmit":return"query_param_submit";default:return""}}function Mq(e){const t=M(Bt);l.useEffect(()=>{R.ensureInitialized(Rq()),e&&(window.appEnd=performance.now(),performance.getEntriesByName("startupTime-begin").length||performance.mark("startupTime-begin",{startTime:window.appStart}),performance.mark("startupTime-end",{startTime:window.appEnd}),performance.measure("startupTime","startupTime-begin","startupTime-end"))},[e]),l.useEffect(()=>{e&&t&&setTimeout(()=>{rr("onPageLoad")},1e3)},[e,t])}function Rq(){return()=>W("picasso-telemetry")?new Eq:null}function Nq({appInitialized:e}){const t=M(ut);l.useEffect(()=>{e&&xg().catch(console.error)},[e]),l.useEffect(()=>{e&&Dz(t?.id).catch(console.error)},[e,t])}function Lq(e){l.useEffect(()=>(document.addEventListener("visibilitychange",e),()=>{document.removeEventListener("visibilitychange",e)}),[e])}function Dq(){Lq(()=>{document.visibilityState==="visible"?R.trackEvent({name:"system",data:{eventName:"copilotVisible",eventInfo_landingPage:R.getLandingPage()}}):R.trackEvent({name:"system",data:{eventName:"copilotBackground"}})})}const _w=_(!1),Oq=_(!1),Uq=Kt({key:jM,schema:V(),initialValue:!1}),kw=Kt({key:iy,schema:Iy,initialValue:qt(iy,Iy)??void 0}),aTe=Kt({key:CI,schema:V(),initialValue:!1}),a1=Kt({key:UM,schema:V(),initialValue:!1}),Fq=_(!1),jq=_(!1),Bq=Kt({key:FM,schema:V(),initialValue:!1}),rTe=_(!1),iTe=Kt({key:BM,schema:V(),initialValue:!1}),Pw=_(!1),Vq=Kt({key:VM,schema:V(),initialValue:!1}),cTe=Kt({key:HM,schema:A(u()),initialValue:[]}),lTe=_(""),Qy=_(!1),uTe=_(!1),Hq=e=>J5.includes(e);function zq(){const e=W5(),t=G(Lc),n=G(_w);l.useEffect(()=>{e&&Hq(e)&&(t(e),n(!0))},[e,t,n])}function Gq(e){const t=`[${e}]`;return{info:(...n)=>{},warn:(...n)=>{},error:(...n)=>{console.error(t,...n)}}}const Xy=Gq("ChatStream");class Wq{subscriptions=[];subscribe(t,n,o,s){const a={featureName:t,discriminator:n,process:r=>{const i=o.safeParse(r);if(!i.success){Xy.warn(`${t} schema validation failed:`,i.error);return}s(i.data)}};return this.subscriptions.push(a),()=>{const r=this.subscriptions.indexOf(a);r!==-1&&this.subscriptions.splice(r,1)}}unsubscribeAll(t){this.subscriptions.filter(n=>n.featureName===t).length,this.subscriptions=this.subscriptions.filter(n=>n.featureName!==t)}dispatch(t){for(const n of this.subscriptions)try{if(!n.discriminator(t))continue;n.process(t)}catch(o){Xy.error(`Error in ${n.featureName} subscriber:`,o)}}_reset(){this.subscriptions=[]}}const $q=new Wq,r1=_(void 0),Hn=_(void 0),qq=_(e=>e(Hn)?.showroomData,(e,t,n)=>{const o=e(Hn);if(o){const s=typeof n=="function"?n(o.showroomData):n;t(Hn,{...o,showroomData:s})}});_(!1);function Kq(e){ke().set(qq,t=>Xt(t,n=>{e(n)}))}const dTe="https://aka.ms/copilot-ads/ads-settings",mTe="https://aka.ms/copilot-ads/verification-program",pTe=["website-visits","interests","similar-audience"],fTe="data-ad-part",hTe={text:"textAd",multimedia:"multimediaAd",product:"productAd",propertyPromotion:"propertyPromotionAd",tourActivity:"tourActivityAd",miniShowroom:"miniShowroomAd",mainShowroom:"mainShowroomAd"},Yq=.05,gTe="focus:underline hover:underline group-focus/trackable-link:underline",Zq=128,Jq=128,Qq=147,Xq=95,vTe=59*60*1e3;function yTe(e,t,n){const o=t==="product"?Zq:Qq,s=t==="product"?Jq:Xq;if(n.length===0||!e)return{width:o,height:s,resize:"object-contain"};const{maxDeviation:a,averageAspectRatio:r,count:i}=Mw(n);return i===0||r===0?{width:o,height:s,resize:"object-contain"}:a>Yq?{width:o,height:eK(n,o,s),resize:"object-contain"}:{width:o,height:o/r,resize:"object-cover"}}function eK(e,t,n){const o=tK(e,t);return o===-1?n:Math.min(n,o)}function tK(e,t){const n=e.map(o=>{const s=o.type==="product"?o.offer.item.image:o.image;if(s.width&&s.height)return s.height/s.width*t}).filter(o=>typeof o=="number");return n.length>0?Math.max(...n):-1}function Mw(e){if(e.length===0)return{maxDeviation:0,averageAspectRatio:0,count:0};const t=[];for(const s of e){const a=s.type==="product"?s.offer.item.image:s.image;if(a.width&&a.height){const r=a.width/a.height;t.push(r)}}if(t.length===0)return{maxDeviation:0,averageAspectRatio:0,count:0};const n=t.reduce((s,a)=>s+a,0)/t.length;return{maxDeviation:t.reduce((s,a)=>{const r=Math.abs(a/n-1);return Math.max(s,r)},0),averageAspectRatio:n,count:t.length}}function nK(e){if(e.length===0)return{};const t=e.map(o=>{const s=o.type==="product"?o.offer.item.image:o.image;return{originalWidth:s.width,originalHeight:s.height}}),n=Mw(e);return{imageSizes:t.length>0?t:void 0,imageAspectRatioVariance:n}}function i1(){return!!M(Rt)?.group}function uu(){return!!ke().get(Rt)?.group}function oK(e){const t=[];for(const n of e){if(n.type!=="product"&&n.type!=="propertyPromotion"&&n.type!=="tourActivity")return null;if(!n.tags)continue;if(n.tags.length>1)return null;const o=n.tags[0];if(!(!o||!o.value))if(t.length===0)t.push(o);else{if(t[0]?.category!==o.category)return null;t.find(s=>s.value===o.value)||t.push(o)}}return t}function CTe(e,t){return e?.length?JSON.stringify({tagCategory:e[0]?.category,tagValue:t?.value??"recommended",tagPosition:t?e.indexOf(t)+1:null,tagCount:e.length}):""}function Rw(e){return e.every(t=>t.type==="product"||t.type==="propertyPromotion"||t.type==="tourActivity")}function STe(e,t,n){if(!Rw(e))return null;let o=e;return t?.length&&n?o=e.filter(s=>s.tags&&s.tags[0]?.value===n.value):t?.length&&!n&&(o=e.filter(s=>!s.tags)),o}class sK{messageStartTime=0;messageSentTime=0;timeToFirstToken=0;receivedFirstToken=!1;receivedLastToken=!1;currentAdditionalData;currentMessageId="";receivedMessageTime=0;startMessageTime=0;mostRecentTokenTime=0;queryId;lastResponseType;constructor(t,n){this.messageStartTime=t,this.messageSentTime=n}getCustomData(){return this.queryId?JSON.stringify({queryId:this.queryId}):void 0}resetMessageStartTime(t){this.messageStartTime=t}resetMessageSentTime(t){this.messageSentTime=t,this.timeToFirstToken=0}onBeforeSend(t){this.receivedFirstToken=!1,this.receivedLastToken=!1,this.queryId=t,this.lastResponseType=void 0}onSent(t){this.currentAdditionalData=t.additionalData,R.trackEvent({name:"system",data:{eventName:"copilotChatStartToSent",eventInfo_additionalData:this.currentAdditionalData,eventInfo_duration:this.messageSentTime-this.messageStartTime,eventInfo_conversationId:t.conversationId,eventInfo_messageId:this.currentMessageId,eventInfo_mode:t.chatMode,eventInfo_inputMethod:t.inputMethod,eventInfo_customData:this.getCustomData()}})}onReceived(t){this.receivedMessageTime=performance.now(),R.trackEvent({name:"system",data:{eventName:"copilotChatRequest",eventInfo_additionalData:this.currentAdditionalData,eventInfo_duration:this.receivedMessageTime-this.messageSentTime,eventInfo_conversationId:t.conversationId,eventInfo_messageId:this.currentMessageId,eventInfo_mode:t.chatMode,eventInfo_inputMethod:t.inputMethod,eventInfo_customData:this.getCustomData()}})}onStartMessage(t){this.startMessageTime=performance.now(),this.currentMessageId=t.messageId,this.receivedMessageTime||(this.receivedMessageTime=this.messageSentTime),R.trackEvent({name:"system",data:{eventName:"copilotChatReqToResp",eventInfo_duration:this.startMessageTime-this.receivedMessageTime,eventInfo_additionalData:this.currentAdditionalData,eventInfo_conversationId:t.conversationId,eventInfo_messageId:t.messageId,eventInfo_mode:t.chatMode,eventInfo_inputMethod:t.inputMethod,eventInfo_customData:this.getCustomData()}})}onFirstToken(t){if(!this.receivedFirstToken&&t.messageId===this.currentMessageId){const n=performance.now()-this.messageSentTime;this.timeToFirstToken=n,this.receivedFirstToken=!0,R.trackEvent({name:"system",data:{eventName:"copilotChatRespToReceived",eventInfo_additionalData:this.currentAdditionalData,eventInfo_conversationId:t.conversationId,eventInfo_duration:performance.now()-this.receivedMessageTime,eventInfo_messageId:t.messageId,eventInfo_mode:t.chatMode,eventInfo_inputMethod:t.inputMethod,eventInfo_customData:this.getCustomData()}}),R.trackEvent({name:"system",data:{eventName:"copilotFirstTokenReceived",eventInfo_conversationId:t.conversationId,eventInfo_messageId:t.messageId,eventInfo_duration:n,eventInfo_mode:t.chatMode,eventInfo_additionalData:this.currentAdditionalData,eventInfo_inputMethod:t.inputMethod,eventInfo_customData:this.getCustomData()}}),R.flush(),tq.run({duration:n})}this.mostRecentTokenTime=performance.now()}onLastToken(t){const{citationCount:n,imageCount:o,messageId:s,inputMethod:a,conversationId:r,chatMode:i,chainOfThoughtCount:d,guidedLinksCount:m,uploadImageCount:p,uploadFileCount:h}=t;if(!this.receivedLastToken&&s===this.currentMessageId){const g=this.mostRecentTokenTime-this.messageSentTime;this.receivedLastToken=!0,R.trackEvent({name:"system",data:{eventName:"copilotResponseRender",eventInfo_conversationId:r,eventInfo_messageId:s,eventInfo_numCitations:n,eventInfo_numImagesGenerated:o,eventInfo_numChainOfThoughts:d,eventInfo_numGuidedLinks:m,eventInfo_inputMethod:a,eventInfo_responseMethod:"text",eventInfo_mode:i,eventInfo_additionalData:this.currentAdditionalData,eventInfo_landingPage:R.getLandingPage(),eventInfo_firstToLastTokenDuration:g-this.timeToFirstToken,eventInfo_customData:JSON.stringify({eventInfo_numImagesUploaded:p,eventInfo_numDocumentsUploaded:h,eventInfo_isGroup:uu()?1:0,queryId:this.queryId})}}),R.trackEvent({name:"system",data:{eventName:"copilotLastTokenReceived",eventInfo_conversationId:r,eventInfo_messageId:s,eventInfo_duration:g,eventInfo_mode:i,eventInfo_inputMethod:a,eventInfo_additionalData:this.currentAdditionalData,eventInfo_customData:this.getCustomData()}}),R.trackEvent({name:"system",data:{eventName:"copilotChatE2E",eventInfo_conversationId:r,eventInfo_messageId:s,eventInfo_duration:performance.now()-this.messageSentTime,eventInfo_mode:i,eventInfo_additionalData:this.currentAdditionalData,eventInfo_inputMethod:a,eventInfo_customData:this.getCustomData()}}),R.flush(),this.currentAdditionalData=void 0,this.queryId=void 0,this.lastResponseType=void 0}}onAdsRender(t){const n=performance.now()-this.messageSentTime,{ads:o}=t,s=o?.find(y=>y.type==="miniShowroom"),a=s??(o&&o.length>0?o[0]:void 0),r=o&&Rw(o)?oK(o):[],i=o?.find(y=>y.type==="mainShowroom"),d=B(Hn),m=W("adsshowroombrandagent"),p=o&&o.length>0&&(a?.type==="product"||a?.type==="tourActivity"||a?.type==="propertyPromotion")?nK(o):{};let h;s?h={brandId:s.brandId??i?.brandId,miniShowroom:{messageId:t.messageId,rguid:t.requestId}}:i&&d&&(h={brandId:d.brandId,brandLogo:d.brandLogo,brandBackground:d.brandBackground,viewMode:d.viewMode,brandAgentScenario:m?"chat":void 0,triggeredAtRguid:d.lastUserMessageRguid??void 0,miniShowroom:{messageId:d.miniShowroomAd.messageId,adId:d.adId},activeCard:{adId:i.id,rguid:t.requestId},previousCard:{adId:d.adId,rguid:d.activeCardRguid}});const g=JSON.stringify({eventType:t.eventType,adTags:r?.length?r:void 0,showroom:h,...p});R.trackEvent({name:"system",data:{eventName:"copilotAdsSignal",eventInfo_scenario:"render",eventInfo_adType:a?.type,eventInfo_adCount:o?.length,eventInfo_rguid:t.requestId,eventInfo_messageId:t.messageId,eventInfo_conversationId:t.conversationId,eventInfo_duration:n,eventInfo_additionalData:g,eventInfo_customData:this.getCustomData()}})}onSubmitMessageBlocked(t,n,o){R.trackEvent({name:"interaction",data:{eventName:"copilotUserInputBlocked",eventInfo_inputMethod:n,eventInfo_mode:t,eventInfo_messageId:this.currentMessageId,eventInfo_conversationId:o,eventInfo_duration:performance.now()-this.messageSentTime,eventInfo_additionalData:this.currentAdditionalData}})}onImageGenerationStart(t){const{messageId:n,conversationId:o,chatMode:s}=t,r=performance.now()-this.messageSentTime;R.trackEvent({name:"system",data:{eventName:"copilotFeatureLatency",eventInfo_scenario:"ImageGenStarted",eventInfo_messageId:n,eventInfo_conversationId:o,eventInfo_mode:s,eventInfo_duration:r}})}onImageReceived(t){const{messageId:n,conversationId:o,chatMode:s}=t,a=performance.now()-this.messageSentTime;R.trackEvent({name:"system",data:{eventName:"copilotFeatureLatency",eventInfo_scenario:"ImageGenReceived",eventInfo_messageId:n,eventInfo_conversationId:o,eventInfo_mode:s,eventInfo_duration:a}})}onPartialImageReceived(t){const{messageId:n,imageGenPhase:o,conversationId:s,chatMode:a}=t,r=performance.now()-this.messageSentTime;R.trackEvent({name:"system",data:{eventName:"copilotFeatureLatency",eventInfo_scenario:"PartialImageGenReceived",eventInfo_messageId:n,eventInfo_conversationId:s,eventInfo_mode:a,eventInfo_duration:r,eventInfo_customData:`${o}`}})}onVideoGenerationStart(t){const{messageId:n,conversationId:o,chatMode:s,taskId:a}=t,r=performance.now(),i=r-this.messageSentTime;R.trackEvent({name:"system",data:{eventName:"copilotFeatureLatency",eventInfo_scenario:"VideoGenStarted",eventInfo_messageId:n,eventInfo_conversationId:o,eventInfo_mode:s,eventInfo_duration:i,eventInfo_customData:a?JSON.stringify({taskId:a,taskStartTimestamp:r}):void 0}})}onVideoGenerationReceived(t){const{messageId:n,conversationId:o,chatMode:s,taskId:a}=t,r=performance.now(),i=r-this.messageSentTime;R.trackEvent({name:"system",data:{eventName:"copilotFeatureLatency",eventInfo_scenario:"VideoGenReceived",eventInfo_messageId:n,eventInfo_conversationId:o,eventInfo_mode:s,eventInfo_duration:i,eventInfo_customData:a?JSON.stringify({taskId:a,taskEndTimestamp:r}):void 0}})}onMemorySignalReceived(t){const{messageId:n,conversationId:o}=t,a=performance.now()-this.messageSentTime;R.trackEvent({name:"system",data:{eventName:"copilotFeatureLatency",eventInfo_scenario:"MemorySignalReceived",eventInfo_messageId:n,eventInfo_conversationId:o,eventInfo_duration:a}})}onChainOfThoughtReceived(t){const{messageId:n,conversationId:o,chatMode:s}=t,a=performance.now()-this.messageSentTime;R.trackEvent({name:"system",data:{eventName:"copilotCoTFirstTokenReceived",eventInfo_messageId:n,eventInfo_conversationId:o,eventInfo_mode:s,eventInfo_duration:a,eventInfo_customData:this.getCustomData()}})}onMessageInbound(t,n,o,s){this.queryId&&this.lastResponseType!==t&&(this.lastResponseType=t,R.trackEvent({name:"system",data:{eventName:"copilotChatResponseReceived",eventInfo_inputMethod:n,eventInfo_mode:s,eventInfo_conversationId:o,eventInfo_customData:JSON.stringify({responseType:t,queryId:this.queryId})}}))}}function c1(e,t){let n=null;return(...o)=>{n!==null&&window.clearTimeout(n),n=window.setTimeout(()=>e(...o),t)}}const Nw=300,bTe=2e3,aK=new Map([["image","chat"],["podcast","chat"],["researchReport","research"],["quiz","chat"],["actions","computerUse"],["video","chat"],["page","chat"],["homeworkHelper","study"]]),rK=new Map([["image","smart"],["podcast","smart"],["researchReport","research"],["quiz","smart"],["actions","computerUse"],["video","smart"],["page","smart"],["homeworkHelper","study"]]);function Lw(e){return W("remove-qr")?rK.get(e):aK.get(e)}const Uc=ke(),iK=500;function cK(){let e="";if(typeof document<"u"){const t=document.querySelector(`#${Cc}`);t&&(e=t.value)}return e}let eC=!1;function lK(){let e="";eC||(e=cK(),eC=!0),w9([[Fc,e]])}const lf=_({userInput:"",autocompleteValue:""}),Fc=_(e=>e(lf).userInput,(e,t,n)=>{t(lf,{userInput:n,autocompleteValue:""})}),Dw=_("starter-prompts"),Ow=_(!0),Uw=_(!1),Wm=_(Ft()),wr=_(e=>e(Wm),(e,t,n)=>{const o=e(Wm);Bo("sticky-conversation-mode",n),o!==n&&t(Wm,n)}),uf=_(void 0),mr=_(null);function du(e){Uc.set(Fc,e)}function Fw(){return M(lf)}function Td(){Uc.set(Fc,"")}function yi(e){Uc.set(Dw,e)}function _i(e){Uc.set(Ow,e)}function jw(e){Ee(Ir,e)}function mu(e){Uc.set(Uw,e)}function hn(e,t){const n=B(wr);switch(B(uf)!==t&&Ee(uf,t),(n==="computerUse"||n==="research")&&Ee(mr,null),Ee(wr,e),e){case"computerUse":{Ee(mr,"actions");break}case"research":{Ee(mr,"researchReport");break}}}function Ar(e){if(Ee(mr,e),e===null)return;const t=Lw(e);t&&Ee(wr,t)}function Bw(){return M(Fc)}function uK(){return B(Fc)}function dK(){return M(Dw)}function mK(){return M(Ow)}function Zt(){return M(wr)}function co(){return B(wr)}function pK(){return M(Uw)}function l1(){return M(mr)}function fK(){return B(mr)}const hK=c1((e,t)=>{AG(B(Te),e,JSON.stringify({...t,isGroupChat:uu()?1:0}))},iK);function gK(e,t){hK(e,t)}async function vK(e){const n=new TextEncoder().encode(e),o=await crypto.subtle.digest("SHA-256",n);return new Uint8Array(o)}function yK({bytes:e,difficulty:t}){const n=Math.floor(t/8),o=t%8;for(let s=0;s<n;s+=1)if(e[s]!==0)return!1;if(o>0){const s=255<<8-o,a=e[n];if(a!==void 0&&(a&s)!==0)return!1}return!0}async function CK(e){const{token:t,difficulty:n,startNonce:o=0,batchSize:s=10}=e;let a=o,r=0;const i=async d=>{const m=t+d,p=await vK(m);return r+=1,yK({bytes:p,difficulty:n})?{found:!0,nonce:d}:{found:!1,nonce:0}};for(;;){const d=[];for(let p=0;p<s;p+=1){const h=a+p;d.push(i(h))}const m=await Promise.all(d);for(const p of m)if(p.found)return{nonce:p.nonce,totalHashes:r};a+=s,await new Promise(p=>{setTimeout(p,0)})}}const SK=10*1e3;function Vl({duration:e,success:t,errorMessage:n}){const{userAgent:o}=navigator;R.trackEvent({name:"system",data:{eventName:"webWorkerRegistrationEvent",eventInfo_name:"hashcash-worker",eventInfo_userAgent:o,eventInfo_duration:e,eventInfo_success:t,eventInfo_errorMessage:t?void 0:n??"Unknown error"}})}function tC({method:e,threads:t,duration:n,difficulty:o}){R.trackEvent({name:"system",data:{eventName:"hashcashComputeEvent",eventInfo_method:e,eventInfo_threads:t,eventInfo_duration:n,eventInfo_difficulty:o}})}async function bK(e,t){const{token:n,difficulty:o,startNonce:s=0,batchSize:a=10}=e,r=Math.floor(Number.MAX_SAFE_INTEGER/t),i=[],d=[],m=()=>{for(const h of i)h.terminate()};window.addEventListener("beforeunload",m,{once:!0});const p=h=>{const g=new Worker(new URL("/static/cmc/assets/hashcash.worker-DPHM8104.js",import.meta.url),{type:"module"});return i.push(g),new Promise((y,b)=>{const C=performance.now(),T=setTimeout(()=>{const E=performance.now()-C;Vl({duration:E,success:!1,errorMessage:"Registration timeout"}),g.terminate(),b(new Error(`Worker ${h} timeout`))},SK);g.onmessage=E=>{const{data:I}=E;if(I.type==="ready"){const x=performance.now()-C;Vl({duration:x,success:!0}),clearTimeout(T);return}if(I.type==="success"){for(const[x,w]of i.entries())x!==h&&(w.postMessage({type:"cancel"}),w.terminate());y({nonce:I.nonce,timeElapsed:I.timeElapsed,totalHashes:I.totalHashes})}I.type==="error"&&(clearTimeout(T),g.terminate(),b(new Error(I.error)))},g.onerror=E=>{const I=performance.now()-C;Vl({duration:I,success:!1,errorMessage:E.message||"Worker error"}),clearTimeout(T),g.terminate(),b(E)},g.postMessage({type:"register"});const S=s+h*r;g.postMessage({type:"start",token:n,difficulty:o,startNonce:S,batchSize:a})})};for(let h=0;h<t;h+=1)d.push(p(h));try{const h=await Promise.any(d);return window.removeEventListener("beforeunload",m),m(),h}catch(h){if(window.removeEventListener("beforeunload",m),m(),h instanceof AggregateError){const g=h.errors.map(y=>y instanceof Error?y.message:String(y)).join(", ");throw new Error(`All ${t} workers failed: ${g}`)}throw h}}async function IK(e,t){const{hardwareConcurrency:n}=navigator,o=Math.max(n-2,1),s=Date.now(),{webWorkerEnabled:a}=J.instance().config();try{if(!a)throw new Error(`Web Worker surface config is not enabled: ${a}`);const r=t??o,i=await bK(e,r);return tC({method:"webworker",threads:r,duration:i.timeElapsed,difficulty:e.difficulty}),{...i,numberOfWorkers:r,method:"webworker"}}catch(r){Vl({duration:Date.now()-s,success:!1,errorMessage:`Web worker registration failed or worker feature is disabled: ${r instanceof Error?r.message:String(r)}`});const i=await CK(e),d=Date.now()-s;return tC({method:"mainthread",threads:1,duration:d,difficulty:e.difficulty}),{...i,timeElapsed:d,method:"mainthread"}}}function EK(e,t,n){switch(e.type){case"research":return{type:"task",task:{id:e.id,type:e.type,contents:[],partialOutput:[],inlineCitations:[],status:"pending",prompt:e.prompt,progress:e.progress},partId:t};case"computerUse":return{type:"task",task:{id:e.id,conversationId:e.conversationId,type:e.type,status:"running",updatedAt:n},partId:t};case"podcast":return{type:"task",task:{id:e.id,type:e.type,status:e.status,podcast:e.podcast,updatedAt:e.updatedAt??n},partId:t};case"videoGeneration":return{type:"task",task:{id:e.id,type:e.type,status:e.status,result:e.result,updatedAt:e.updatedAt??n},partId:t};case"planning":return{type:"task",task:{id:e.id,type:e.type,status:e.status,agentConversationId:e.agentConversationId,updatedAt:e.updatedAt,reaction:e.reaction},partId:t};default:return null}}const Vw=["completed","failed","cancelled"];function TK(e){if(e.author==="ai")return e.content.find(t=>{if(t.type!=="task")return!1;const n=t.task?.status;return n&&!Vw.includes(n)})}function wK(e){for(let t=e.length-1;t>=0;t-=1){const n=e[t];if(n&&n.type==="task")return n}}function u1(e){for(const t of e){const n=TK(t);if(n)return{message:t,part:n}}return null}const AK=_(0),Hw=_(null),xK=_(null),_K=_(void 0),Yt=_(null),zw=_([]),jc=_(null),kK=_(null),PK=_(e=>{const t=e(La);return u1(t)?.part.task?.type==="research"}),MK=_(!1);_(new Map);const RK=_(!1),ITe=_(!1),Bc=_(null),Ua=_(!1),NK=_(!1),df=_(!1),LK=_(e=>e(Us).isOpen||e(DK)),Us=_({isOpen:!1,scenario:null}),DK=_(e=>{const t=e(ma);return t===null?!1:t===0||e(iT).includes(t)}),nC=ke();function OK(e){if(e.status!=="completed")return;const t=nC.get(Te);t&&e.agentConversationId===t||nC.set(yt,{title:F("agentMode.notification.taskCompleted"),subtitle:F("agentMode.notification.taskCompletedSubtitle"),dismissAfter:5e3})}async function qn({from:e,to:t,params:n,search:o,state:s}){t.startsWith("/chats/")||ke().set(tf,null),await ju(0),await Nn().navigate({to:t,params:n,state:a=>({...a,from:e,...s}),search:o})}function Fa(){return qn}const Gw=({title:e,titleId:t,...n})=>l.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M3.28034 2.21968C2.98745 1.92678 2.51257 1.92677 2.21968 2.21966C1.92678 2.51255 1.92677 2.98743 2.21966 3.28032L3.48326 4.54395C3.17684 5.03983 3 5.62426 3 6.25V17.75C3 19.5449 4.45507 21 6.25 21H17.75C18.3757 21 18.96 20.8232 19.4559 20.5169L20.7194 21.7805C21.0123 22.0734 21.4872 22.0734 21.7801 21.7805C22.073 21.4876 22.073 21.0127 21.7801 20.7198L3.28034 2.21968ZM11.1189 12.1797C10.8678 12.2864 10.6322 12.4409 10.4258 12.643L4.60326 18.3437C4.53643 18.1583 4.5 17.9584 4.5 17.75V6.25C4.5 6.0437 4.5357 5.84574 4.60125 5.66196L11.1189 12.1797ZM19.5 6.25V16.3183L20.9993 17.8176C20.9998 17.7951 21 17.7726 21 17.75V6.25C21 4.45507 19.5449 3 17.75 3H6.25C6.2275 3 6.20505 3.00023 6.18265 3.00068L7.68194 4.5H17.75C18.7165 4.5 19.5 5.2835 19.5 6.25ZM18.3305 19.4014C18.1489 19.4653 17.9535 19.5 17.75 19.5H6.25C6.04613 19.5 5.8504 19.4651 5.66845 19.4011L11.4752 13.7148L11.5588 13.644C11.8501 13.4316 12.2596 13.4553 12.5247 13.7148L18.3305 19.4014ZM15.2521 6.5C16.4959 6.5 17.5042 7.50831 17.5042 8.75212C17.5042 9.99592 16.4959 11.0042 15.2521 11.0042C14.0083 11.0042 13 9.99592 13 8.75212C13 7.50831 14.0083 6.5 15.2521 6.5ZM15.2521 8C14.8367 8 14.5 8.33673 14.5 8.75212C14.5 9.1675 14.8367 9.50423 15.2521 9.50423C15.6675 9.50423 16.0042 9.1675 16.0042 8.75212C16.0042 8.33673 15.6675 8 15.2521 8Z"})),ETe=Object.freeze(Object.defineProperty({__proto__:null,default:Gw},Symbol.toStringTag,{value:"Module"}));function UK(e,t=200,n=50){const[o,s]=l.useState(!1),[a,r]=l.useState(null);return l.useEffect(()=>{let i;if(!e)i=setTimeout(()=>{s(!0),r(Date.now())},t);else if(o){const d=a?Date.now()-a:1/0,m=n-d;m>0?i=setTimeout(()=>{s(!1),r(null)},m):(s(!1),r(null))}return()=>{clearTimeout(i)}},[e,t,n,o,a]),o}function Ww(e){var t,n,o="";if(typeof e=="string"||typeof e=="number")o+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(n=Ww(e[t]))&&(o&&(o+=" "),o+=n)}else for(n in e)e[n]&&(o&&(o+=" "),o+=n);return o}function Ae(){for(var e,t,n=0,o="",s=arguments.length;n<s;n++)(e=arguments[n])&&(t=Ww(e))&&(o&&(o+=" "),o+=t);return o}const Za=16,Hl=410,Uo=480,So=620,Sn=40,FK=600,$m=({opticalSize:e,fontWeight:t})=>({"font-variation-settings":`'opsz' ${e}, 'wght' ${t}`}),qm=e=>{if(e>=FK)return{"font-synthesis":"none"}},jK=e=>{if(e)return{"letter-spacing":`${e}em`}},ca=({fontSize:e,lineHeight:t,letterSpacing:n,opticalSize:o,fontWeight:s,isBoldOnly:a,isMediumOnly:r,sizeOverrides:i})=>{const d=`@apply text-[${e/Za}rem] leading-[${t/Za}rem]`,m={[d]:{}},p=i?.medium!==void 0?`@apply text-[${i.medium/Za}rem] leading-[${t/Za}rem]`:d,h=i?.bold!==void 0?`@apply text-[${i.bold/Za}rem] leading-[${t/Za}rem]`:d,g=jK(n),y=$m({opticalSize:o,fontWeight:s.regular}),b=$m({opticalSize:o,fontWeight:s.medium}),C=$m({opticalSize:o,fontWeight:s.bold}),T=qm(s.regular),S=qm(s.medium),E=qm(s.bold),I={...m,...g,...y,...T,bold:{fontWeight:`${s.bold}`,...C,...E},medium:{fontWeight:`${s.medium}`,...b,...S},strong:{fontWeight:`${s.bold}`,...C,...E}},x={[p]:{},fontWeight:`${s.medium}`,...g,...b,...S},w={[h]:{},fontWeight:`${s.bold}`,...g,...C,...E};return a?{...w,bold:I.bold,strong:I.strong}:r?{...x,bold:I.bold,strong:I.strong}:I},BK=[{name:"2xs",fontSize:10,lineHeight:14,opticalSize:Sn,fontWeight:{regular:600,medium:700,bold:800}},{name:"xs",fontSize:12,lineHeight:16,opticalSize:Sn,fontWeight:{regular:450,medium:Uo,bold:So}},{name:"sm",fontSize:14,lineHeight:20,opticalSize:Sn,fontWeight:{regular:Hl,medium:Uo,bold:So}},{name:"base",fontSize:16,lineHeight:26,opticalSize:Sn,fontWeight:{regular:Hl,medium:Uo,bold:So}},{name:"base-dense",fontSize:16,lineHeight:22,opticalSize:Sn,fontWeight:{regular:Hl,medium:Uo,bold:So}},{name:"base-plus",fontSize:18,lineHeight:26,letterSpacing:-.005,opticalSize:Sn,fontWeight:{regular:460,medium:Uo,bold:600}},{name:"md",fontSize:18,lineHeight:26,letterSpacing:-.005,opticalSize:Sn,fontWeight:{regular:460,medium:Uo,bold:600}},{name:"lg",fontSize:20,lineHeight:26,letterSpacing:-.01,opticalSize:Sn,fontWeight:{regular:460,medium:Uo,bold:600}},{name:"xl",fontSize:24,lineHeight:32,letterSpacing:-.01,opticalSize:Sn,fontWeight:{regular:440,medium:540,bold:So}},{name:"2xl",fontSize:28,lineHeight:32,letterSpacing:-.01,opticalSize:Sn,fontWeight:{regular:480,medium:520,bold:So}},{name:"3xl",fontSize:32,lineHeight:40,letterSpacing:-.02,opticalSize:Sn,fontWeight:{regular:480,medium:520,bold:So}},{name:"4xl",fontSize:38,lineHeight:40,letterSpacing:-.02,opticalSize:Sn,fontWeight:{regular:480,medium:520,bold:So}}],Vc=BK.reduce((e,{name:t,fontSize:n,lineHeight:o,letterSpacing:s,fontWeight:a,opticalSize:r})=>{const i=t==="base"||t==="base-dense"?{medium:16.01,bold:16.01}:void 0;return{...e,[`.text-${t}`]:ca({fontSize:n,lineHeight:o,letterSpacing:s,opticalSize:r,fontWeight:a,sizeOverrides:i}),[`.text-${t}-medium`]:ca({fontSize:n,lineHeight:o,letterSpacing:s,opticalSize:r,fontWeight:a,isMediumOnly:!0,sizeOverrides:i}),[`.text-${t}-strong`]:ca({fontSize:n,lineHeight:o,letterSpacing:s,opticalSize:r,fontWeight:a,isBoldOnly:!0,sizeOverrides:i})}},{}),$w={name:"sm-e",fontSize:15,lineHeight:22.8,opticalSize:Sn,fontWeight:{regular:Hl,medium:Uo,bold:So}},qw={name:"3xl-e",fontSize:32,lineHeight:36,letterSpacing:-.02,opticalSize:Sn,fontWeight:{regular:480,medium:Uo,bold:So}};Vc[".text-sm-e"]=ca($w);Vc[".text-sm-e-strong"]=ca({...$w,isBoldOnly:!0});Vc[".text-3xl-e"]=ca(qw);Vc[".text-3xl-e-strong"]=ca({...qw,isBoldOnly:!0});const VK=Object.keys(Vc).map(e=>e.replace(".text-","")),HK=A9({extend:{classGroups:{"font-size":[{text:VK}]}}});function O(...e){return HK(Ae(e))}const jr="overflow-hidden",Po="backdrop-blur-2xl backdrop-saturate-200",d1="bg-white/70 dark:bg-muted-200/70",lo=Ae(jr,Po,d1),zK=Ae(jr,Po),GK=Ae(Po,d1),Kw="bg-acrylic-default-fallback-light/[98] dark:bg-acrylic-default-fallback-dark/[98]",WK="dark:bg-white/70  bg-slate-800/70",$K=Ae(jr,Po,WK);Ae(Po,d1);const Yw="bg-accent-100/60 dark:bg-muted-200/50",qK="bg-accent-100/60 dark:bg-muted-200/70",KK=Ae(Po,Yw),oa=Ae(jr,Po,Yw),YK=Ae(jr,Po,qK),ZK="bg-acrylic-thin-fallback-light/95 dark:bg-acrylic-thin-fallback-dark/[92]",Zw="dark:bg-accent-900/60 bg-slate-800/50";Ae(Po,Zw);const JK=Ae(jr,Po,Zw);function QK(e={},t=!1){const[n,o]=l.useState(!1),[s,a]=l.useState(!1),{onFocus:r,onBlur:i,onPointerDown:d}=e;return[n,{onFocus:p=>{(!s||t)&&o(!0),r?.(p)},onBlur:p=>{o(!1),a(!1),i?.(p)},onPointerDown:p=>{a(!0),d?.(p)}}]}function XK(){return/^.*(EdgA|EdgiOS|Edg).*/i.test(navigator.userAgent)}const Jw="bg-background-300/20 dark:bg-background-650/5",TTe="border-black/10 dark:border-white/10";function eY(e,t){return e?e===!0?{animate:{...t}}:{animate:e}:{style:t}}function tY(e,t,n,o){const s=t?o:n;return e?{animate:s}:{style:s}}function m1(e){const{children:t,size:n="md",position:o="default",nested:s=!1,background:a="default",stroke:r,strokeChildren:i,className:d,containerRef:m,interactable:p=!1,label:h,animate:g,onFocus:y,onBlur:b,onPointerDown:C,onAnimationStart:T,onAnimationComplete:S,focusOnPointerDown:E,isSelected:I=!1,...x}=e,[w,P]=QK({onFocus:y,onBlur:b,onPointerDown:C},E),D=I||w,j=ba()&&XK(),$=s&&(a==="acrylic"||a==="acrylic-thin"),K=$?Km[`${n}-${o}`]:nY[`${n}-${o}`],X=$?Km[`${n}-${o}`]:oY[`${n}-${o}`],ne=$?Km[`${n}-${o}`]:sY[`${n}-${o}`],me={default:"bg-white/45 dark:bg-background-650/10",darker:Jw,acrylic:lo,"acrylic-fallback":Kw,"acrylic-thin":oa,"acrylic-thin-fallback":ZK,transparent:"bg-transparent"},Se=p?{"aria-label":h,role:"button",tabIndex:0,...P,onKeyDown:Pe=>{(Pe.key==="Enter"||Pe.key===" ")&&(Pe.preventDefault(),x.onClick?.(Pe))}}:{onFocus:y,onBlur:b,onPointerDown:C},ge=eY(g,K),ve=tY(g,D,X,ne);return c.jsxs(he.div,{className:O("relative isolate",me[a],d,$&&"outline-1 outline-offset-2",g&&j&&"transition-[clip-path]"),ref:m,onAnimationComplete:S,...ge,...Se,...x,children:[t,c.jsx(he.div,{className:O(D&&"before:border-foreground-750 dark:before:border-white",r&&!D&&"before:border-black/10 dark:before:border-white/10",a==="transparent"&&r&&!D&&"dark:before:border-white/18",!r&&!D&&"before:border-transparent",!$&&"before:border-[20px]",$&&r&&!D&&"before:border",$&&r&&D&&"before:border-2","pointer-events-none absolute inset-0 before:absolute before:inset-0 before:rounded-inherit",g&&j&&"transition-[clip-path]"),...ve,children:i})]})}const nY={"xs-default":{clipPath:"var(--clip-path-squircle-16)"},"sm-default":{clipPath:"var(--clip-path-squircle-24)"},"md-default":{clipPath:"var(--clip-path-squircle-36)"},"lg-default":{clipPath:"var(--clip-path-squircle-48)"},"xl-default":{clipPath:"var(--clip-path-squircle-60)"},"xs-top":{clipPath:"var(--clip-path-squircle-16-12)"},"sm-top":{clipPath:"var(--clip-path-squircle-24-16)"},"md-top":{clipPath:"var(--clip-path-squircle-36-24)"},"lg-top":{clipPath:"var(--clip-path-squircle-48-36)"},"xl-top":{clipPath:"var(--clip-path-squircle-60-48)"},"xs-bottom":{clipPath:"var(--clip-path-squircle-12-16)"},"sm-bottom":{clipPath:"var(--clip-path-squircle-16-24)"},"md-bottom":{clipPath:"var(--clip-path-squircle-24-36)"},"lg-bottom":{clipPath:"var(--clip-path-squircle-36-48)"},"xl-bottom":{clipPath:"var(--clip-path-squircle-48-60)"}},oY={"xs-default":{clipPath:"var(--clip-path-squircle-stroke-16)"},"sm-default":{clipPath:"var(--clip-path-squircle-stroke-24)"},"md-default":{clipPath:"var(--clip-path-squircle-stroke-36)"},"lg-default":{clipPath:"var(--clip-path-squircle-stroke-48)"},"xl-default":{clipPath:"var(--clip-path-squircle-stroke-60)"},"xs-top":{clipPath:"var(--clip-path-squircle-stroke-16-12)"},"sm-top":{clipPath:"var(--clip-path-squircle-stroke-24-16)"},"md-top":{clipPath:"var(--clip-path-squircle-stroke-36-24)"},"lg-top":{clipPath:"var(--clip-path-squircle-stroke-48-36)"},"xl-top":{clipPath:"var(--clip-path-squircle-stroke-60-48)"},"xs-bottom":{clipPath:"var(--clip-path-squircle-stroke-12-16)"},"sm-bottom":{clipPath:"var(--clip-path-squircle-stroke-16-24)"},"md-bottom":{clipPath:"var(--clip-path-squircle-stroke-24-36)"},"lg-bottom":{clipPath:"var(--clip-path-squircle-stroke-36-48)"},"xl-bottom":{clipPath:"var(--clip-path-squircle-stroke-48-60)"}},sY={"xs-default":{clipPath:"var(--clip-path-squircle-stroke-focused-16)"},"sm-default":{clipPath:"var(--clip-path-squircle-stroke-focused-24)"},"md-default":{clipPath:"var(--clip-path-squircle-stroke-focused-36)"},"lg-default":{clipPath:"var(--clip-path-squircle-stroke-focused-48)"},"xl-default":{clipPath:"var(--clip-path-squircle-stroke-focused-60)"},"xs-top":{clipPath:"var(--clip-path-squircle-stroke-focused-16-12)"},"sm-top":{clipPath:"var(--clip-path-squircle-stroke-focused-24-16)"},"md-top":{clipPath:"var(--clip-path-squircle-stroke-focused-36-24)"},"lg-top":{clipPath:"var(--clip-path-squircle-stroke-focused-48-36)"},"xl-top":{clipPath:"var(--clip-path-squircle-stroke-focused-60-48)"},"xs-bottom":{clipPath:"var(--clip-path-squircle-stroke-focused-12-16)"},"sm-bottom":{clipPath:"var(--clip-path-squircle-stroke-focused-16-24)"},"md-bottom":{clipPath:"var(--clip-path-squircle-stroke-focused-24-36)"},"lg-bottom":{clipPath:"var(--clip-path-squircle-stroke-focused-36-48)"},"xl-bottom":{clipPath:"var(--clip-path-squircle-stroke-focused-48-60)"}},Km={"xs-default":{borderTopLeftRadius:16,borderTopRightRadius:16,borderBottomLeftRadius:16,borderBottomRightRadius:16},"sm-default":{borderTopLeftRadius:24,borderTopRightRadius:24,borderBottomLeftRadius:24,borderBottomRightRadius:24},"md-default":{borderTopLeftRadius:36,borderTopRightRadius:36,borderBottomLeftRadius:36,borderBottomRightRadius:36},"lg-default":{borderTopLeftRadius:48,borderTopRightRadius:48,borderBottomLeftRadius:48,borderBottomRightRadius:48},"xl-default":{borderTopLeftRadius:60,borderTopRightRadius:60,borderBottomLeftRadius:60,borderBottomRightRadius:60},"xs-top":{borderTopLeftRadius:16,borderTopRightRadius:16,borderBottomLeftRadius:12,borderBottomRightRadius:12},"sm-top":{borderTopLeftRadius:24,borderTopRightRadius:24,borderBottomLeftRadius:16,borderBottomRightRadius:16},"md-top":{borderTopLeftRadius:36,borderTopRightRadius:36,borderBottomLeftRadius:24,borderBottomRightRadius:24},"lg-top":{borderTopLeftRadius:48,borderTopRightRadius:48,borderBottomLeftRadius:36,borderBottomRightRadius:36},"xl-top":{borderTopLeftRadius:60,borderTopRightRadius:60,borderBottomLeftRadius:48,borderBottomRightRadius:48},"xs-bottom":{borderTopLeftRadius:12,borderTopRightRadius:12,borderBottomLeftRadius:16,borderBottomRightRadius:16},"sm-bottom":{borderTopLeftRadius:16,borderTopRightRadius:16,borderBottomLeftRadius:24,borderBottomRightRadius:24},"md-bottom":{borderTopLeftRadius:24,borderTopRightRadius:24,borderBottomLeftRadius:36,borderBottomRightRadius:36},"lg-bottom":{borderTopLeftRadius:36,borderTopRightRadius:36,borderBottomLeftRadius:48,borderBottomRightRadius:48},"xl-bottom":{borderTopLeftRadius:48,borderTopRightRadius:48,borderBottomLeftRadius:60,borderBottomRightRadius:60}},aY="(hover: hover) and (pointer: fine)";function rY(){return typeof window<"u"&&typeof window.matchMedia=="function"}function Ym(){return rY()?window.matchMedia(aY):null}function iY(){let e=Ym();const t=()=>(e??=Ym(),e?.matches??!1),n=()=>!1,o=s=>{e??=Ym();const a=e;return a?(a.addEventListener("change",s),()=>a.removeEventListener("change",s)):()=>{}};return l.useSyncExternalStore(o,t,n)}const cY=40,lY=40;function uY(e={}){const{defaultOpen:t=!1,placement:n="top",gap:o=6,open:s,onOpenChange:a,openDelay:r=cY,closeDelay:i=lY,disabled:d=!1,disableOnTouch:m=!0,closeOnTrigger:p=!0}=e,[h,g]=l.useState(t),y=s??h,b=l.useCallback($=>{a?a($):g($)},[a]),C=l.useMemo(()=>[nc(o),oc({crossAxis:n.includes("-"),fallbackAxisSideDirection:"start",padding:o}),sc({padding:o})],[n,o]),T=ac({placement:n,open:d?!1:y,onOpenChange:d?void 0:b,whileElementsMounted:kr,middleware:C}),{context:S}=T,E=iY(),I=!d&&s===void 0&&(!m||E),x=x9(S,{move:!1,enabled:I,restMs:r,delay:{open:r,close:i}}),w=_9(S,{enabled:I}),P=E?p:!1,D=rc(S,{enabled:!d,escapeKey:!0,referencePress:P!==!1,referencePressEvent:typeof P=="string"?P:"pointerdown"}),L=Lu(S,{role:"tooltip",enabled:!d}),j=Du([x,w,D,L]),U=l.useId();return l.useMemo(()=>({open:d?!1:y,setOpen:b,labelId:U,disabled:d,...j,...T}),[y,d,b,U,j,T])}const Qw=l.createContext(null),Xw=()=>{const e=l.useContext(Qw);if(e===null)throw new Error("Tooltip components must be wrapped in <Tooltip />");return e};function eA(e){const{children:t,...n}=e,o=uY(n);return c.jsx(Qw.Provider,{value:o,children:t})}const p1=l.forwardRef((e,t)=>{const{children:n,asChild:o=!1,...s}=e,a=Xw(),r=l.isValidElement(n)&&n.props!==null&&typeof n.props=="object"&&"ref"in n.props?n.props.ref:void 0,i=Ap([a.refs.setReference,t,r]),d=Ap([y=>a.refs.setReference(y),t]),m={...s,...a.disabled?{}:{"aria-describedby":a.open?a.labelId:void 0}};let p;a.disabled?p=m:o&&l.isValidElement(n)?p=a.getReferenceProps({...m,...n.props,ref:i}):p=a.getReferenceProps(m);const h={...p,onBlur:y=>{p.onBlur?.(y),a.setOpen(!1)}},g=()=>{if(!a.disabled)return a.open?"open":"closed"};if(o&&l.isValidElement(n)){const y=n;return l.cloneElement(y,{ref:i,...h,"data-tooltip-state":g()})}return c.jsx("button",{ref:d,type:"button",...h,"data-tooltip-state":g(),children:n})});p1.displayName="TooltipTrigger";const f1=l.forwardRef((e,t)=>{const{style:n,className:o,...s}=e,a=Xw(),r=Ap([a.refs.setFloating,t]);if(!(a.open&&!a.disabled))return null;const d=a.getFloatingProps({id:a.labelId,role:"tooltip",...s});return c.jsx(Nu,{children:c.jsx("div",{ref:r,className:O("pointer-events-none w-max rounded-lg border border-white/20 bg-background-100 px-2 py-1 text-foreground-800 shadow-lg text-xs",at.tooltip,o),style:{...a.floatingStyles,...n},...d,"data-tooltip-state":"open"})})});f1.displayName="TooltipContent";function dY(e){const{sourceImages:t,maxItems:n=2,imageHeight:o="h-12",className:s}=e,{t:a}=Z();if(t.length===0)return null;const r=t.slice(0,n);return c.jsx("div",{className:O("flex gap-2",s),children:r.map((i,d)=>c.jsxs(eA,{placement:"top",openDelay:300,children:[c.jsx(p1,{asChild:!0,children:c.jsx("div",{className:O(o,"cursor-pointer overflow-hidden rounded-md border-2 border-white shadow-lg"),children:c.jsx("img",{src:i.thumbnailUrl,alt:a("gallery.imageAlt"),className:"h-full w-auto object-cover"})})}),c.jsx(f1,{className:"overflow-hidden rounded-lg border-0 bg-transparent p-0 shadow-xl",children:c.jsx("img",{src:i.url||i.thumbnailUrl,alt:a("gallery.imageAlt"),className:"max-h-60 w-auto rounded-lg object-contain"})})]},d))})}function mY(e){const{onError:t,onLoad:n,loadingPlaceholder:o,"aria-hidden":s,alt:a,errorClass:r,className:i,src:d,fallbackSrc:m,stableKey:p,sourceImages:h,...g}=e,[y,b]=l.useState(!1),[C,T]=l.useState(!1),[S,E]=l.useState(!1),I=UK(C);if(l.useEffect(()=>{b(!1),T(!1),E(!1)},[d]),y)return c.jsx(pY,{className:r});const x=S&&m?m:d;return c.jsxs(c.Fragment,{children:[I&&o?.(),l.createElement("img",{...g,alt:a,"aria-hidden":s,key:p??x,src:x,className:O(i,!C&&o&&"absolute size-px opacity-0"),onLoad:w=>{T(!0),n?.(w)},onError:w=>{m&&!S?E(!0):b(!0),t?.(w)}}),h&&h.length>0&&c.jsx("div",{className:"absolute bottom-3 start-3",children:c.jsx(dY,{sourceImages:h,maxItems:2,imageHeight:"h-14"})})]})}function pY(e){const{className:t}=e;return c.jsx("div",{className:O("flex size-full items-center justify-center",Jw,t),children:c.jsx(Gw,{className:"size-6"})})}function fY(e){const{path:t,args:n,onLoad:o,alt:s,...a}=e,{data:r,isPending:i}=ts({queryKey:["apiImg",t],queryFn:async()=>{const p=await(await ko(t,n)).blob();return URL.createObjectURL(p)}});l.useEffect(()=>{!i&&o&&o()},[i,o]);const d=()=>c.jsx("div",{...a});return c.jsx(mY,{...a,alt:s,className:a.className,errorClass:a.className,loadingPlaceholder:i?d:void 0,src:i?void 0:r})}const oC=ke();function hY(e){if(e.status!=="completed")return;const t=oC.get(Te);Nn().latestLocation.pathname.startsWith("/chats")&&t&&e.conversationId===t||oC.set(yt,{iconProvider:()=>c.jsx(fY,{path:`/podcasts/user/${e.podcast?.id}/Files/${e.podcast?.thumbnail?.name}`,className:"rounded-xl object-cover"}),title:F("podcasts.generationNotification.title"),subtitle:e.podcast?.title??"",action:()=>{qn({from:window.location.pathname,to:`/podcasts/user/${e.podcast?.id}`})},trackingArgs:{scenario:"podcastGenerationNotification",customData:JSON.stringify({podcastId:e.podcast?.id})},dismissAfter:3e4})}const wTe=_(!1),ATe=_(void 0),xTe=_(!1),gY=_(void 0);function vY(e,t){if(!t)return e;const[n,o,s]=e.slice(-3);if(!(fa(s)&&fa(o)&&n?.author==="human"))return e;const r={left:s.sideBySideConfig.position==="left"?s:o,right:s.sideBySideConfig.position==="right"?s:o,createdAt:s.createdAt,id:t};return[n,r]}function yY(e){return tA(e)||fa(e)}function tA(e){return"left"in e&&"right"in e}function fa(e){return!e||e.author!=="ai"?!1:!!e.sideBySideConfig}const ja=ke();function nt({history:e,messageId:t}){const n=e.find(({id:o})=>o===t);if(n?.author==="ai")return n}function CY(e,t){const n=e.find(({author:o})=>o==="human");if(n?.id===t&&n.author==="human")return n}function SY(e){if(!e)return;const t=ja.get(bt).get(e);if(!t)return;const{history:n}=t,o=n.find(({author:s})=>s==="human");if(o?.author==="human")return o}function pr(e){const t=e.at(-1);if(t?.author==="ai")return t}function bn(e,t){return e.find(n=>n.partId===t)}function sC(e){for(let t=e.length-1;t>=0;t-=1){const n=e[t];if(n&&n.type==="text")return n}}function _Te(e){return e.filter(t=>t.author==="ai").map(t=>({...t,content:t.content.filter(n=>n.type==="image")})).filter(t=>t.content.length>0)}function nA(e){if(!e)return null;const t=ja.get(bt).get(e);if(!t)return null;const{history:n}=t;return u1(n)}function Ne(e,t){ja.set(bt,n=>Xt(n,o=>{const s=o.get(e);if(s){t(s.history);const a=s.history.at(-1);if(a){const r=new Date(s.updatedAt),i=new Date(a.createdAt);r<i&&(s.updatedAt=a.createdAt)}}}))}function kTe(e,t,n,o){Ne(e,s=>{const a=s.find(r=>r.id===t);if(a?.author==="ai"){const r=bn(a.content,n);r&&o(r)}})}function h1(e,t){ja.set(Ls,n=>Xt(n,o=>{const s=o.get(e);s&&t(s)}))}function g1(e,t){ja.set(bt,n=>Xt(n,o=>{const s=o.get(e);s&&t(s)}))}function Xs(e,t){ja.set(pd,n=>Xt(n,o=>{if(!t)return;const s=o.get(e);s?s.add(t):o.set(e,new Set([t]))}))}function bY(e){ja.set(nG,t=>Xt(t,n=>{e&&n.set(e,!0)}))}function IY(e){hn(e)}function zl(e,t){const n={type:"error",text:e,partId:"0"},o=Math.random().toString(),s={id:o,createdAt:new Date().toISOString(),author:"ai",content:[n],mode:Ft(),streamingState:"idle"};Xs(t,o),Ne(t,a=>{a.push(s)})}function EY(e){for(const t of e.content)t.type==="activity"&&t.activity.status==="running"&&(t.activity.status="completed")}function oA(e){g1(e,t=>{t.sideBySideComparisonId=void 0})}function sA(e,t){const n=!t;Ne(e,o=>{const[s,a]=o.slice(-2);if(!(fa(a)&&fa(s)))return;const i=n?!a.sideBySideConfig.isDefault:a.id!==t,d=n?!s.sideBySideConfig.isDefault:s.id!==t;i?o.splice(o.length-1,1):d&&o.splice(o.length-2,1)})}function TY(e,t){sA(e,t),oA(e)}function v1(e){sA(e,void 0),oA(e)}function wY(e,t){const n=`indicator-ai-response-${Math.random().toString()}`;return Ne(e,o=>{const s=pr(o);s&&s.content.push({type:"indicator-ai-response",partId:n,state:"loading",text:t})}),n}function aC(e,t,n){t&&Ne(e,o=>{const s=pr(o);if(!s)return;const a=bn(s.content,t);!a||a.type!=="indicator-ai-response"||a.state!==n&&(s.content=s.content.map(r=>r.type==="indicator-ai-response"&&t===r.partId?{...r,state:n}:r))})}const Zm=ke();function AY(e,t){const n=Zm.get(Te);if(e.status!=="completed"||!Vw.includes(e.status)||(IY(Ft()),!n||n===t))return;const o=e.id,s={title:F("research.generationNotification.title"),subtitle:F("research.generationNotification.subTitle"),link:F("research.generationNotification.subTitleLink"),action:()=>{qn({from:window.location.pathname,to:`/chats/${t}`})},onClick:()=>{Zm.set(gY,o)},dismissable:!0,trackingArgs:{scenario:"researchCompletionNotification",customData:JSON.stringify({researchId:e.id,sourceConversationId:t})}};Zm.set(yt,s)}function aA(){const e=M(Ls),t=M(Te);return l.useMemo(()=>{if(t){for(const n of e.values())if(n.conversationId===t)return n}},[t,e])}function xY(){const e=ke(),t=e.get(Ls),n=e.get(Te);if(n){for(const o of t.values())if(o.conversationId===n)return o}}async function rA(e){const{conversationId:t=B(Te),talkType:n,location:o}=e;t&&await qn({to:`/chats/$conversationId${n?`/${n}`:""}`,params:{conversationId:t},from:o.pathname,search:o.search})}async function to(e={}){await rA({conversationId:e.conversationId,talkType:e.talkType,location:Nn().state.location})}function iA(){const e=Ou(),{location:t}=e.state;return l.useCallback(async(n={})=>rA({conversationId:n.conversationId,talkType:n.talkType,location:{pathname:t.pathname,search:t.search}}),[t.search,t.pathname])}const pu=_(null);function y1(e){e===null&&B(pu)?.onClose?.(),Ee(pu,e)}function _Y(){return M(pu)}function cA(){return B(pu)}function wd(e){const{id:t,shouldNavigateToChat:n=!0,shouldClearParentConversation:o=!0}=e;o&&B(Te)!==B(tf)&&Ee(tf,null),y1(null),Ee(Te,t),Ee(Ir,void 0),Ee(bt,r=>Xt(r,i=>{const d=i.get(t);if(d?.history.length&&(d.isNew=!1),d?.history.some(m=>m.author!=="system"&&m.content.some(p=>p.type==="card"&&p.card.type==="ads"))){for(const m of d.history)if(m.author==="ai"&&m.content.some(p=>p.type==="card"&&p.card.type==="ads")){const p=m.content.filter(h=>h.type!=="card"||h.card.type!=="ads");m.content=p}}}));const s=B(kg);s&&s!==t&&Ee(bt,r=>Xt(r,i=>{i.delete(s)}));const a=nA(t)?.part.task?.type==="research";hn(a?"research":Ft()),n&&to({conversationId:t})}function kY(){return e=>wd(e)}function PY(e){const{tasks:t,conversationId:n,includeTaskTypes:o}=e;for(const s of t.values())if(s.conversationId===n){if(o&&!o.includes(s.type))continue;return s.id}return""}const ki=ke(),MY="MissingUrlFromApi",PTe="https://aka.ms/copilot-actions-faq";function RY(e,t){const n=ki.get(Ls).get(e);return n?.type==="computerUse"&&!n.lastUserCommand&&NY(n)&&t.some(s=>s.op==="replace"&&s.path==="/status"&&s.value==="paused")?mf(t,["userTakeControl","pauseByClick"]):!1}function C1(e){return e==="paused"||e==="running"||e==="pending"}function NY(e){return e.status==="paused"&&(e.statusChange?.reason==="safetyRiskDetected"||e.statusChange?.reason==="askUserInput")}function lA(e){return e.status==="paused"&&e.statusChange?.reason==="safetyRiskDetected"}function LY(e){return e.status==="paused"&&e.statusChange?.reason==="userTakeControl"&&e.lastUserCommand==="takeTaskControl"}function Jm(e,t=!1){return e.map(n=>({type:"chainOfThought",text:n.text,screenshotUrl:t?MY:null,reaction:null,partId:Math.random().toString()}))}function mf(e,t){return e.some(n=>{if(n.op==="replace"&&n.path==="/statusChange"){const{value:o}=n;if(typeof o=="object"&&o!==null&&"reason"in o){const{reason:s}=o;if(typeof s=="string"){const a=QI.safeParse(s);return a.success&&t.includes(a.data)}}}return!1})}function DY(e,t){const n=ki.get(Ls).get(e);if(n?.type==="computerUse"){const{conversationId:o,status:s,statusChange:a}=n;if(!o)return;if(s==="cancelled"&&Ne(o,h=>{const g=rC(e,"cancelTask");h.push(g)}),mf(t,["giveBackControl"])?Ne(o,h=>{const g=rC(e,"takeTaskControl");h.push(g)}):a?.reason==="giveBackControl"&&iC(e),mf(t,["taskCompleted"])&&Ne(o,h=>{const g={id:Math.random().toString(),createdAt:new Date().toISOString(),author:"ai",streamingState:"idle",content:[{type:"card",partId:Math.random().toString(),card:{type:"computerUseFeedback"}}]};h.push(g)}),a)switch(a.reason){case"askUserInput":case"safetyRiskDetected":{s==="paused"?(a.reason==="askUserInput"&&_o({feature:"computerUse",scenario:"askUserInput",customData:JSON.stringify({id:n.id,conversationId:n.conversationId})}),o===ki.get(Te)||ki.set(yt,{title:n.title&&n.title!==""?F("actions.alertTitleTemplate",{conversationName:n.title}):F("actions.defaultAlertTitle"),subtitle:a.reason==="safetyRiskDetected"?F("actions.safetyRiskAlertSubTitle"):F("actions.askUserInputAlertSubTitle"),action:()=>wd({id:o}),dismissAfter:30*1e3,dismissable:!0}),h1(e,g=>{"lastUserCommand"in g&&(g.lastUserCommand=void 0)})):iC(e);break}}const d=t.filter(h=>h.op==="add"&&h.path==="/chainOfThought/-").map(h=>({text:"value"in h?h.value:""}));d.length>0&&Ne(o,h=>{if(h.length===0)return;const g=cC(h);if(g)g.push(...Jm(d));else{const y={id:Math.random().toString(),createdAt:new Date().toISOString(),author:"ai",streamingState:"idle",content:Jm(d)};h.push(y)}}),t.filter(h=>h.op==="replace"&&h.path==="/computerAction").length>0&&Ne(o,h=>{const g=cC(h);g&&g.push(...Jm([{text:n.computerAction??""}],!0))}),t.filter(h=>h.op==="replace"&&h.path==="/formStructure").length>0}}function OY(e,t,n){switch(t){case"sendFormData":return{type:t,taskId:e,fields:n??[]};default:return{type:t,taskId:e}}}function rC(e,t,...n){const o=n[0],s=OY(e,t,o);return{id:Math.random().toString(),createdAt:new Date().toISOString(),author:"human",content:[{type:"command",command:s}],mode:null}}function iC(e){h1(e,t=>{"statusChange"in t&&(t.statusChange=void 0)})}function cC(e){const t=e.at(-1);if(t&&t.author==="ai"&&t.content.find(n=>n.type==="chainOfThought"))return t.content}function MTe(e){const t=xY();return t?.type==="computerUse"?t.status!=="running"&&!t.replay?.isRunning?!0:!e:!0}function RTe(e){return!!(W("labs-actions-replay")&&e&&e.type==="computerUse"&&!C1(e.status))}function NTe(e){return{cancelTask:"copilotActionsCancelTask",takeTaskControl:"copilotActionsTakeControl",sendFormData:"copilotActionsSendFormData",startTask:void 0,pauseTask:void 0,resumeTask:void 0,releaseTaskControl:void 0}[e]}function LTe(e){return PY({tasks:ki.get(Ls),conversationId:e,includeTaskTypes:["computerUse"]})}function uA(e){const{errorType:t,errorMessage:n,messageId:o,conversationId:s,customData:a}=e;R.trackEvent({name:"health",data:{eventName:"copilotError",eventInfo_feature:"videoGen",eventInfo_scenario:"generateVideo",eventInfo_errorType:t,eventInfo_errorMessage:n,eventInfo_messageId:o,eventInfo_conversationId:s??B(Te),eventInfo_customData:a?JSON.stringify(a):void 0}})}function UY(e){uA({errorType:"Unknown",errorMessage:"Video generation feature is disabled",conversationId:e.conversationId,customData:{taskId:e.id}})}function FY(e){const t=e.result?.type==="error"?e.result.errorCode:"Failed";uA({errorType:t,errorMessage:`Video generation task did not complete successfully: ${t}`,conversationId:e.conversationId,customData:{taskId:e.id,status:e.status,errorCode:t,hasResult:!!e.result,resultType:e.result?.type}})}function S1(e,t,n){const{source:o,isFromShareLink:s,conversationId:a,isPlayer:r}=n,i={source:o,isFromShareLink:s};r!==void 0&&(i.isPlayer=r),R.trackEvent({name:"interaction",data:{eventName:"copilotClick",eventInfo_clickSource:e,eventInfo_clickScenario:t,eventInfo_conversationId:a??B(Te),eventInfo_customData:JSON.stringify(i)}})}function DTe(e){S1("videoGenMessage","playGenVideo",e)}function OTe(e){S1("videoRecreateButton","recreateGenVideo",e)}function UTe(e){S1("videoDownloadButton","downloadGenVideo",e)}const jY=ke();function BY(e){if(!W("video-gen")){UY(e);return}if(e.status!=="completed"||!e.conversationId||!e.result||e.result.type!=="success"||!e.result.videoUrl){FY(e);return}const{conversationId:t,result:n}=e,o=!J.instance().config().disableLibrary&&W("library-video"),s=F("video.generationNotification.title"),a=o?F("video.generationNotification.subtitle"):F("video.generationNotification.subtitleToChat");R.trackEvent({name:"interaction",data:{eventName:"copilotClick",eventInfo_clickScenario:"videoGenComplete",eventInfo_clickSource:o?"composerNotification":"chatNotification"}});const r=()=>{o?qn({from:window.location.pathname,to:"/library",search:{type:"video"}}):wd({id:t})};jY.set(yt,{iconProvider:()=>c.jsx("img",{src:n.thumbnailUrl??"",alt:n.thumbnailUrl??"",className:"rounded-xl object-cover"}),title:s,subtitle:a,action:r,trackingArgs:{scenario:"videoGenerationNotification",customData:JSON.stringify({thumbnailUrl:n.thumbnailUrl??"",videoUrl:n.videoUrl})},dismissAfter:3e4})}function VY(e){return e?!e.slotAds||e.slotAds.length===0?!0:e.slotAds.every(t=>!!t.ad.layout):!1}function HY(e,t){const n=W("adsshowroombrandagent"),o=B(Hn),s=!!o;if(s){if(e)return{isValid:!1,detailedInfoObj:{hasEntryAd:!0,isShowroomOpened:s}};if(n){const a=!!(t?.logo??o?.brandLogo),r=VY(t);return{isValid:!!(r&&a),detailedInfoObj:{noBrandLogo:!a,noValidMainAd:!r,isShowroomAgentEnabled:!0,isShowroomOpened:s}}}return{isValid:!1,detailedInfoObj:{isShowroomAgentEnabled:!1,isShowroomMvpEnabled:!1,isShowroomOpened:s}}}return e?n?{isValid:!!(e.brandId&&!t),detailedInfoObj:{noBrandId:!e.brandId,hasMainAd:!!t,isShowroomAgentEnabled:!0,isShowroomOpened:s}}:{isValid:!1,detailedInfoObj:{isShowroomAgentEnabled:!1,isShowroomMvpEnabled:!1,isShowroomOpened:s}}:{isValid:!1,detailedInfoObj:{noEntryAd:!0,isShowroomOpened:s}}}function zY({entryAd:e,mainAd:t,messageId:n,partId:o,conversationId:s}){const{isValid:a,detailedInfoObj:r}=HY(e,t);return a||R.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"AdsError",eventInfo_details:JSON.stringify({messageId:n,partId:o,conversationId:s,...r}),eventInfo_errorMessage:"Unexpected showroom data received"}}),a}function GY(e,t){const n=e?.find(a=>a.type==="mainShowroom"),o=e?.find(a=>a.type==="miniShowroom");return o??n?zY({entryAd:o,mainAd:n,messageId:t.messageId,partId:t.partId,conversationId:t.conversationId}):(e&&e.length>0?e[0]:void 0)?!0:(R.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"AdsError",eventInfo_details:JSON.stringify({messageId:t.messageId,partId:t.partId,conversationId:t.conversationId}),eventInfo_errorMessage:"Unexpected data found in ads card"}}),!1)}function WY({card:e,messageId:t,partId:n,conversationState:o,conversationId:s}){const{ads:a}=e,r=B(Hn);if(GY(a,{messageId:t,partId:n,conversationId:s})){if(o.timing.onAdsRender({requestId:e.requestId,messageId:t,conversationId:s,eventType:"card",ads:a}),r){const i=a?.filter(d=>d.type==="mainShowroom");if(i){Kq(d=>d?.push({key:t,requestId:e.requestId,ads:i,instrumentation:e.instrumentation}));return}}Ne(s,i=>{const d=nt({history:i,messageId:t});d&&d.content.push({type:"card",partId:n,card:{...e,createdAt:Date.now()}})})}}const $Y=e=>e;function Ad(e=$Y){const t=l.useRef(null);return l.useEffect(()=>{const o=(typeof document<"u"?document:void 0)?.defaultView;if(!o)return()=>{};const s=k9(o,{autoRoot:{}});return t.current=e(s),()=>{P9(s),t.current=null}},[e]),t}const fu=e=>{Ad();const t=M9(e,!0);return l.useMemo(()=>({[R9]:t}),[t])},qY="data-tabster-never-hide",KY=e=>e.hasAttribute(qY);function YY(e){N9(e,void 0,KY),L9(e)}const dA=(e={})=>{const{trapFocus:t,alwaysFocusable:n,legacyTrapFocus:o}=e;Ad(YY);const s=l.useId(),a=e.id??`modal-${s}`,r=fu({restorer:{type:Av.Source},...t&&{modalizer:{id:a,isOthersAccessible:!t,isAlwaysAccessible:n,isTrapped:!!o&&!!t}}}),i=fu({restorer:{type:Av.Target}});return{modalAttributes:r,triggerAttributes:i}};function ZY(e,t){const{children:n,id:o,eleId:s,labelById:a,role:r,className:i,mode:d="wait",duration:m=Wn.default,exitDuration:p=Wn.default,exitDelay:h=0,delay:g=0,delayChildren:y=0,onAnimationComplete:b,"data-testid":C,initial:T="initial",tabsterNavigationAttrs:S}=e;return c.jsx(It,{mode:d,children:n&&c.jsx(he.div,{id:s,"aria-labelledby":a,animate:"animate",exit:"exit",ref:t,role:r,initial:T,variants:{initial:je,animate:rt,exit:{...je,transition:{duration:p,delay:h}}},transition:{duration:m,ease:"easeInOut",delay:g,delayChildren:y},className:i,onAnimationComplete:b,"data-testid":C,"data-tabster":S?.["data-tabster"],children:n},o)})}const jt=l.forwardRef(ZY);function Xo({onOutsideEvent:e,elements:t,shouldAttachListeners:n=!0,includeScroll:o=!0,invokeOnce:s=!0,includeFocus:a=!0,includeClick:r=!1}){l.useEffect(()=>{const i=d=>{const m=d.target,p=t.some(g=>g.current?.contains(m)),h=m instanceof Element&&m.closest("[data-outside-events-ignore]")!==null;!p&&!h&&e()};return n&&(document.addEventListener("mousedown",i,{once:s}),r&&document.addEventListener("click",i,{once:s}),o&&document.addEventListener("scroll",i,!0),a&&document.addEventListener("focusin",i,!0)),()=>{document.removeEventListener("mousedown",i),r&&document.removeEventListener("click",i),o&&document.removeEventListener("scroll",i,!0),a&&document.removeEventListener("focusin",i,!0)}},[n,o,t,s,a,e,r])}function mA(e){const{onClose:t,children:n,className:o}=e,{t:s}=Z(),a=l.useRef(null);return Xo({onOutsideEvent:()=>{t(a)},elements:[a],invokeOnce:!1,includeScroll:!1,includeFocus:!1}),ch.createPortal(c.jsx(jt,{mode:"sync",className:O("relative",at.modal),children:c.jsx("div",{className:"fixed inset-0 flex items-end justify-center bg-black/20",children:c.jsxs("div",{className:"flex max-h-[90%] w-full shrink-0 flex-col rounded-t-4xl border border-white/100 bg-stone-150 backdrop-blur-xl dark:border-white/5 dark:bg-midnight-800","aria-label":s("common.bottomSheetDialog"),children:[c.jsx("div",{className:"relative flex w-full items-center justify-center py-3",children:c.jsx("div",{className:"h-[6px] w-12 rounded-full bg-black/25 dark:bg-white/25"})}),c.jsx("div",{className:O("no-scrollbar w-full overflow-y-auto px-4 pb-4",o),ref:a,children:n})]})})}),document.body)}const on=({title:e,titleId:t,...n})=>l.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M4.39705 4.55379L4.46967 4.46967C4.73594 4.2034 5.1526 4.1792 5.44621 4.39705L5.53033 4.46967L12 10.939L18.4697 4.46967C18.7626 4.17678 19.2374 4.17678 19.5303 4.46967C19.8232 4.76256 19.8232 5.23744 19.5303 5.53033L13.061 12L19.5303 18.4697C19.7966 18.7359 19.8208 19.1526 19.6029 19.4462L19.5303 19.5303C19.2641 19.7966 18.8474 19.8208 18.5538 19.6029L18.4697 19.5303L12 13.061L5.53033 19.5303C5.23744 19.8232 4.76256 19.8232 4.46967 19.5303C4.17678 19.2374 4.17678 18.7626 4.46967 18.4697L10.939 12L4.46967 5.53033C4.2034 5.26406 4.1792 4.8474 4.39705 4.55379L4.46967 4.46967L4.39705 4.55379Z"})),FTe=Object.freeze(Object.defineProperty({__proto__:null,default:on},Symbol.toStringTag,{value:"Module"}));function JY(){return it("kill-domain-referrer")?"noopener noreferrer":"noopener"}function QY(e){return e==="."||e==="!"||e==="?"}function XY(e){return e===" "||e===`
`||e==="	"}function eZ(e){let t=e.length-1;for(;t>=0&&XY(e[t]);)t-=1;return[e.slice(0,t+1),e.slice(t+1)]}function tZ(e,t,n){return e.slice(0,n)+t+e.slice(n)}const nZ=/^(?:(?:https?):\/\/)?(?:(?:[A-Za-z0-9](?:[A-Za-z0-9-]*[A-Za-z0-9])?\.))+[a-z]{2,}(?:\/[\w%._~:@!$&'()*+,;=-]*)*\/?(?:\?[^\s#]*)?(?:#[^\s]*)?$/,oZ=/\b((https?:\/\/|www\.)?([a-zA-Z0-9-]+\.)+[a-zA-Z]{2,})([/?#][\w\-._~:/?#@!$&'()*+,;=%]*)?(?=[\s<>()"'.,!?)}\]]|$)/gi;function xd(e){return nZ.test(e)}function sZ(e){return e.startsWith("/attachments/onedrive/")}function pA(e){return e.startsWith("/attachments")||e.startsWith("/sharing")||e.startsWith("/conversations/")&&e.includes("/attachments/")}function jTe(e){return!!(sZ(e)||pA(e))}function BTe(e){const[t,n]=eZ(e),o=QY(t[t.length-1]),s=o?t.slice(0,-1):t;if(xd(s)){const a=o?t[t.length-1]:"";return{url:Qu(s),word:s,suffix:`${a}${n}`}}return{word:e}}function aZ(e){let t="";try{t=new URL(e).hostname}catch{}return t}function rZ(e){const t=aZ(e),n=t.match(/^(?:https?:\/\/)?(?:www\.)?([^/]+)/i);return n&&n[1]?n[1]:t}function fA(e,t,n){const{overwrite:o}=n??{};try{const s=new URL(e);for(const[a,r]of Object.entries(t))o&&s.searchParams.delete(a),s.searchParams.append(a,r);return s.toString()}catch{}return e}function pf(e){const{formCodeParamOnLinks:t}=J.instance().config();return t?fA(e,{form:t}):e}function iZ(e){return e.replace(/[.,!?]+$/,"")}function cZ(e,t){return!e||t<=0?!1:e[t-1]==="@"||/[\w.-]+@/.test(e.slice(Math.max(0,t-20),t+1))}function VTe(e){const t=[];if(!e)return t;for(const n of e.matchAll(oZ)){const o=n[0],{index:s}=n;if(s<0||cZ(e,s))continue;const a=iZ(o),r=Qu(a),i=s+a.length;t.push({url:r,from:s,to:i})}return t}function HTe(e){return xd(e)?e:qT()+e}function zTe(e){const t=e.match(/^(?:https?:\/\/)?(?:www\.)?(.+)/i);return(t&&t[1]?t[1]:e).replace(/\/$/,"")}function GTe(e){return e?xd(e)?e.replace(/\/$/,"").replace(/\//g,"").replace("","//").replace(//g,"  "):e:""}function lZ(e){try{const t=new URL(e);return["http:","https:"].includes(t.protocol)}catch{return!1}}const uZ="copilot.com";function hA(e,t=uZ){const n=e.toString(),o=typeof window<"u"&&(window.location.pathname.startsWith("/pages")||window.location.pathname.startsWith("/shares/pages"));if(!W("add-utm-source")||o||!Jg(e)||!lZ(n))return n;try{if(new URL(n).searchParams.has("utm_source"))return n}catch(s){return R.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"UtmSourceAppendError",eventInfo_errorMessage:s instanceof Error?s.message:String(s),eventInfo_details:n}}),n}return fA(n,{utm_source:t})}function WTe(e,t){try{return new URL(e).hostname}catch{return t}}const Go=l.forwardRef((e,t)=>{const{children:n,href:o,className:s,title:a,"aria-controls":r,"aria-expanded":i,"aria-haspopup":d,"aria-label":m,tabIndex:p,id:h,target:g,role:y,onClick:b,onPointerDown:C,onKeyDown:T,onFocus:S,"data-spatial-focus-key":E,"data-spatial-navigation-autofocus":I,"data-testid":x,"data-ad-part":w}=e,P=JY();return c.jsx("a",{id:h,ref:t,"aria-controls":r,"aria-expanded":i,"aria-haspopup":d,"aria-label":m,tabIndex:p,className:s,title:a,href:o&&hA(pf(o)),target:g??"_blank",role:y,rel:P,onClick:b,onPointerDown:C,onKeyDown:T,onFocus:S,"data-spatial-focus-key":E,"data-spatial-navigation-autofocus":I,"data-testid":x,"data-ad-part":w,children:n})});Go.displayName="Link";const gA=l.forwardRef((e,t)=>{const{children:n,...o}=e;return c.jsx(D9,{ref:t,...o,children:n})});gA.displayName="RouterLink";const dZ="SN:ROOT",mZ=l.createContext(null);function _d(){return l.useContext(mZ)}const vA=l.createContext(dZ);vA.displayName="FocusContext";function pZ(){return l.useContext(vA)}function li(){}function fZ({focusable:e=!0,saveLastFocusedChild:t=!0,trackChildren:n=!1,autoRestoreFocus:o=!0,forceFocus:s=!1,isFocusBoundary:a=!1,focusBoundaryDirections:r,focusKey:i,preferredChildFocusKey:d,onEnterPress:m=li,onEnterRelease:p=li,onArrowPress:h=()=>!0,onArrowRelease:g=li,onFocus:y=li,onBlur:b=li}){const C=_d(),T=l.useCallback(ne=>{ne&&m(ne)},[m]),S=l.useCallback(()=>{p()},[p]),E=l.useCallback((ne,me)=>h(ne,me),[h]),I=l.useCallback(ne=>{g(ne)},[g]),x=l.useCallback((ne,me)=>{y(ne,me)},[y]),w=l.useCallback((ne,me)=>{b(ne,me)},[b]),P=l.useRef(null),[D,L]=l.useState(!1),[j,U]=l.useState(!1),$=pZ(),K=l.useMemo(()=>C?i??crypto.randomUUID():void 0,[i,C]),X=l.useCallback((ne={})=>{K&&C?.setFocus(K,ne)},[K,C]);return l.useEffect(()=>{const ne=P.current;return ne&&K&&C?.addFocusable({focusKey:K,node:ne,parentFocusKey:$,preferredChildFocusKey:d,onEnterPress:T,onEnterRelease:S,onArrowPress:E,onArrowRelease:I,onFocus:x,onBlur:w,onUpdateFocus:(me=!1)=>L(me),onUpdateHasFocusedChild:(me=!1)=>U(me),saveLastFocusedChild:t,trackChildren:n,isFocusBoundary:a,focusBoundaryDirections:r,autoRestoreFocus:o,forceFocus:s,focusable:e}),()=>{K&&C?.removeFocusable({focusKey:K})}},[]),l.useEffect(()=>{const ne=P.current;ne&&K&&C?.updateFocusable(K,{node:ne,preferredChildFocusKey:d,focusable:e,isFocusBoundary:a,focusBoundaryDirections:r,onEnterPress:T,onEnterRelease:S,onArrowPress:E,onArrowRelease:I,onFocus:x,onBlur:w})},[K,d,e,a,r,T,S,E,I,x,w,C]),{ref:P,focusSelf:X,focused:D,hasFocusedChild:j,focusKey:K}}function yA(...e){return t=>{for(const n of e)n&&(typeof n=="function"?n(t):n.current=t)}}function kd(e,...t){const n=fZ({onEnterPress:()=>{n.ref.current?.click()},onFocus:()=>{n.ref.current?.focus(),e.scrollIntoViewOnFocus&&n.ref.current?.scrollIntoView({block:"nearest"})},onBlur:()=>{n.ref.current?.blur()},...e}),o=yA(...t,n.ref);return{focusable:n,refCallback:o}}const ff="relative flex items-center",Jn="text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650",lC="text-neutral-200 fill-neutral-200 active:text-neutral-300 active:fill-neutral-300 dark:text-neutral-800 dark:fill-neutral-800 dark:active:text-neutral-600 dark:active:fill-neutral-600",hZ="text-foreground-250 fill-foreground-250 active:text-foreground-350 active:fill-foreground-350 dark:text-foreground-750 dark:fill-foreground-750 dark:active:text-foreground-650 dark:active:fill-foreground-650",gZ="text-accent-550 fill-accent-550 active:text-accent-450/80 active:fill-accent-450/80 dark:text-accent-850 dark:fill-accent-850 dark:active:text-accent-700 dark:active:fill-accent-700",vZ="text-foreground-550 active:text-foreground-350 dark:text-foreground-650 active:dark:text-foreground-600",Ja="shadow-sm",uC="shadow-with-highlight-sm",yZ="text-muted-550 safe-hover:text-accent-450 dark:text-foreground-700 dark:active:text-foreground-800",CZ="bg-white/70 safe-hover:bg-accent-200 active:bg-accent-200/20 dark:bg-muted-550/30 dark:safe-hover:bg-background-100 dark:active:bg-background-200/20",SZ="border-[0.5px] border-transparent safe-hover:border-accent-400 dark:safe-hover:border-accent-650",bZ="text-accent-600 fill-accent-600 active:text-accent-400 active:fill-accent-400 dark:text-foreground-800 dark:fill-text-foreground-800 dark:active:text-foreground-900 dark:active:fill-foreground-900",IZ="bg-accent-200 safe-hover:bg-accent-250 active:bg-accent-250 dark:bg-muted-350 dark:safe-hover:bg-muted-300 dark:active:bg-muted-300",EZ="text-stone-200 fill-stone-200 active:text-stone-300 active:fill-stone-300",TZ="bg-stone-800 safe-hover:bg-stone-700 active:bg-stone-750",gl="bg-transparent safe-hover:bg-white/50 active:bg-white/35 dark:safe-hover:bg-black/30 dark:active:bg-black/20",hu={default:`${Jn} ${uC} bg-white/70 safe-hover:bg-white active:bg-white/60 dark:bg-muted-550/30 dark:safe-hover:bg-muted-550/40 dark:active:bg-muted-550/20`,strong:`${hZ} ${Ja} bg-background-800 safe-hover:bg-black active:bg-background-750 dark:bg-muted-400 dark:safe-hover:bg-muted-450 dark:active:bg-muted-400/80`,accent:`${gZ} bg-accent-250 safe-hover:bg-accent-300 active:bg-accent-200 dark:bg-accent-550 dark:safe-hover:bg-accent-450 dark:active:bg-accent-600/80`,"overlay-bright":`${Jn} bg-white/40 safe-hover:bg-white/70 active:bg-white/30 dark:bg-white/8 dark:safe-hover:bg-white/10 dark:active:bg-white/5`,"overlay-bright-inverted":`${Jn} bg-white/40 safe-hover:bg-white/70 active:bg-white/30 dark:bg-black/35 dark:safe-hover:bg-black/60 dark:active:bg-black/25`,"overlay-dimmed":`${Jn} bg-black/8 safe-hover:bg-black/10 active:bg-black/5 dark:bg-black/35 dark:safe-hover:bg-black/60 dark:active:bg-black/25`,"overlay-dimmed-inverted":`${Jn} bg-black/8 safe-hover:bg-black/10 active:bg-black/5 dark:bg-white/8 dark:safe-hover:bg-white/10 dark:active:bg-white/5`,"subtle-bright":`${Jn} bg-transparent safe-hover:bg-white/50 active:bg-white/35 dark:safe-hover:bg-white/8 dark:active:bg-white/5`,"subtle-bright-inverted":`${Jn} ${gl}`,"subtle-dimmed":`${Jn} bg-transparent safe-hover:bg-black/5 active:bg-black/3 dark:safe-hover:bg-black/30 dark:active:bg-black/20`,"subtle-dimmed-inverted":`${Jn} bg-transparent safe-hover:bg-black/5 active:bg-black/3 dark:safe-hover:bg-white/8 dark:active:bg-white/5`,acrylic:`${Jn} ${Ja} ${gl}`,"acrylic-inverted":`${lC} ${Ja} bg-transparent dark:safe-hover:bg-white/50 dark:active:bg-white/35 safe-hover:bg-black/30 active:bg-black/20`,"acrylic-thin":`${Jn} ${Ja} ${gl}`,"acrylic-thin-hub":`${vZ} ${Ja} ${gl}`,"acrylic-thin-inverted":`${lC} ${Ja} bg-transparent dark:safe-hover:bg-white/50 dark:active:bg-white/35 safe-hover:bg-black/30 active:bg-black/20`,chip:`${yZ} ${CZ} ${uC} ${SZ}`,alert:"bg-system-red-600 safe-hover:bg-system-red-650 active:bg-system-red-550","composer-selected":`${bZ} ${IZ}`,"shopping-feedback":`${EZ} ${TZ}`},CA={acrylic:lo,"acrylic-inverted":$K,"acrylic-thin":oa,"acrylic-thin-hub":YK,"acrylic-thin-inverted":JK};function wZ(e){return e in CA}const AZ={start:"justify-start",center:"justify-center",end:"justify-end"},SA={"28-xxs":"text-sm","32-xs":"text-sm","36-sm":"text-sm","40-base":"text-sm","48-lg":"text-base","56-xl":"text-base","64-xxl":"text-base"},ys={"28-xxs":"gap-x-1.5","32-xs":"gap-x-1.5","36-sm":"gap-x-1.5","40-base":"gap-x-2","48-lg":"gap-x-3","56-xl":"gap-x-3","64-xxl":"gap-x-3"},bA={"28-xxs":`min-h-7 min-w-8 px-3 py-1 ${ys["28-xxs"]}`,"32-xs":`min-h-8 min-w-8 px-2.5 py-1 ${ys["32-xs"]}`,"36-sm":`min-h-9 min-w-9 px-2.5 py-1 ${ys["36-sm"]}`,"40-base":`min-h-10 min-w-10 px-3 py-2 ${ys["40-base"]}`,"48-lg":`min-h-12 min-w-12 px-3 py-2.5 ${ys["48-lg"]}`,"56-xl":`min-h-14 min-w-14 px-4 py-3.5 ${ys["56-xl"]}`,"64-xxl":`min-h-16 min-w-16 p-4 ${ys["64-xxl"]}`},xZ={"28-xxs":"size-7","32-xs":"size-8","36-sm":"size-9","40-base":"size-10","48-lg":"size-12","56-xl":"size-14","64-xxl":"size-16"},hf={"28-xxs":"rounded-lg after:rounded-lg","32-xs":"rounded-lg after:rounded-lg","36-sm":"rounded-xl after:rounded-xl","40-base":"rounded-xl after:rounded-xl","48-lg":"rounded-2xl after:rounded-2xl","56-xl":"rounded-3xl after:rounded-3xl","64-xxl":"rounded-3xl after:rounded-3xl"},_Z={none:"",weak:"after:border after:border-black/10 dark:after:border-white/10",regular:"after:border after:border-black/30 dark:after:border-white/30",strong:"after:border after:border-2 after:border-black/30 dark:after:border-white/30"},dC="rounded-full after:rounded-full",IA="opacity-40 pointer-events-none",EA="after:absolute after:inset-0 after:pointer-events-none after:border after:border-transparent after:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900",kZ=O("safe-hover:bg-background-800 dark:safe-hover:bg-white","focus-visible:bg-background-800 dark:focus-visible:bg-white","safe-hover:text-foreground-200 safe-hover:fill-foreground-200 dark:safe-hover:text-foreground-200 dark:safe-hover:fill-foreground-200","focus-visible:text-foreground-200 focus-visible:fill-foreground-200 dark:focus-visible:text-foreground-200 dark:focus-visible:fill-foreground-200","safe-hover:after:border-transparent dark:safe-hover:after:border-transparent","focus-visible:after:border-transparent dark:focus-visible:after:border-transparent","safe-hover:outline-transparent safe-hover:dark:outline-transparent","focus-visible:outline-transparent focus-visible:dark:outline-transparent","group/button-stronger-focus"),PZ=O("group-hover/button-stronger-focus:fill-foreground-200 group-hover/button-stronger-focus:text-foreground-200","group-focus-visible/button-stronger-focus:fill-foreground-200 group-focus-visible/button-stronger-focus:text-foreground-200");function ee(e){const{ref:t,children:n,onFocus:o,onBlur:s,onKeyDown:a,onKeyUp:r,onMouseEnter:i,onMouseLeave:d,onContextMenu:m,className:p,title:h,variant:g="rect",alignment:y="center",color:b="default",outline:C="none",size:T="40-base",id:S,role:E,testId:I,tabIndex:x,tooltip:w,strongerFocusColors:P,spatialNavigationAutofocus:D=!1,"aria-controls":L,"aria-expanded":j,"aria-haspopup":U,"aria-pressed":$,"aria-checked":K,"aria-label":X,"aria-labelledby":ne,"aria-selected":me,"aria-describedby":Se,"aria-current":ge,"aria-disabled":ve}=e,Pe="disabled"in e&&e.disabled,Me=typeof P=="boolean"?P:J.instance().config().uiOverrides?.enableStrongerFocusButtons??!1,ye=g==="circle"||g==="square",Ie=g==="circle"||g==="pill",He=O(ff,hu[b],SA[T],AZ[y],ye?xZ[T]:bA[T],Ie?dC:hf[T],EA,Pe&&IA,_Z[C],Me&&kZ,p);let Ze=n;if(wZ(b)){const _e=O(CA[b],Ie?dC:hf[T]);Ze=c.jsxs(c.Fragment,{children:[c.jsx("div",{className:O("absolute inset-0",_e,Me&&"group-hover/button-stronger-focus:hidden group-focus-visible/button-stronger-focus:hidden")}),c.jsx("div",{className:O(ff,ys[T]),children:n})]})}const{refCallback:Be,focusable:be}=kd({autoRestoreFocus:!0,forceFocus:!0},t??null),re=!!w,te=typeof w=="boolean"?void 0:w,H=re?void 0:h;let Y=X;re&&!X?.trim()&&(Y=h);let ue;if("href"in e){const{href:_e,target:ze,onClick:We,onPointerDown:Oe}=e;ue=c.jsx(Go,{id:S,onPointerDown:Oe,"aria-controls":L,"aria-describedby":Se,"aria-expanded":j,"aria-haspopup":U,"aria-label":Y,"aria-selected":me,href:_e,target:ze,role:E,ref:be.ref,onClick:We,title:H,className:He,"data-testid":I,children:Ze})}else if("to"in e){const{to:_e,params:ze,search:We,hash:Oe,preload:qe,resetScroll:se,onClick:ie,onPointerDown:we}=e;ue=c.jsx(gA,{id:S,ref:be.ref,onPointerDown:we,"aria-controls":L,"aria-describedby":Se,"aria-expanded":j,"aria-haspopup":U,"aria-label":Y,"aria-selected":me,to:_e,params:ze,search:We,hash:Oe,preload:qe,resetScroll:se,disabled:Pe,onClick:ie,title:H,className:He,"data-testid":I,children:Ze})}else{const{onClick:_e,onPointerDown:ze}=e;ue=c.jsx("button",{onPointerDown:ze,ref:Be,id:S,"aria-controls":L,"aria-describedby":Se,"aria-expanded":j,"aria-haspopup":U,"aria-label":Y,"aria-labelledby":ne,"aria-pressed":$,"aria-checked":K,"aria-selected":me,type:"button",className:He,title:H,role:E,disabled:Pe,onClick:_e,onFocus:o,onBlur:s,onKeyDown:a,onKeyUp:r,onMouseEnter:i,onContextMenu:m,onMouseLeave:d,"data-testid":I,"data-spatial-navigation-autofocus":D,"data-spatial-focus-key":be.focusKey,tabIndex:x,"aria-current":ge,"aria-disabled":ve,children:Ze})}if(!re)return ue;const{tooltipContentProps:oe,...De}=te??{};return c.jsxs(eA,{...De,children:[c.jsx(p1,{asChild:!0,children:ue}),c.jsx(f1,{...oe,children:h})]})}ee.displayName="Button";const MZ=100,$Te=300,gu=_([]);function TA(){const e=M(gu),[t,n]=l.useState(!1),o=l.useRef(null);l.useEffect(()=>(o.current=setTimeout(()=>n(!0),MZ),()=>{o.current&&clearTimeout(o.current)}),[]);const s=t?e:[];return c.jsxs("div",{className:"sr-only",children:[c.jsx(mC,{messages:s.filter(a=>a.type==="polite"),type:"polite"}),c.jsx(mC,{messages:s.filter(a=>a.type==="assertive"),type:"assertive"})]})}function mC({messages:e,type:t}){return c.jsx("div",{"aria-live":t,"aria-atomic":"true",children:e.map(n=>c.jsx("div",{"aria-label":n.msg,children:n.msg},n.id))})}function _s(e){const t=l.useRef(null),{isOpen:n,dialogName:o,headerText:s,headerIcon:a,headerTextClassName:r,headerTextSuffix:i,fullBleed:d,children:m,onClose:p,className:h,bottomSheetClassName:g,closeButtonTestId:y,centerHeader:b=!1,backdropOpacity:C="default",fadeInDuration:T=Wn.default,bottomSheetOnSmall:S,customScrollBar:E,"aria-labeledby":I,hideDismissButton:x=!1,preventClose:w=!1}=e,P=l.useRef(null),{t:D}=Z(),L=gt({breakpoint:"sm"}),j=l.useId(),U=S&&L,$=C==="none"?"backdrop:bg-transparent":"backdrop:bg-background-850/30 dark:backdrop:bg-background-150/70",K=n&&!U&&p!==void 0&&!w;Xo({onOutsideEvent:K?p:()=>{},elements:K?[P]:[],includeScroll:!1,includeFocus:!1});const{modalAttributes:X}=dA({trapFocus:!0,legacyTrapFocus:!0,alwaysFocusable:!0});if(l.useEffect(()=>{n?t.current?.showModal():t.current?.close()},[n]),l.useEffect(()=>{const ne=t.current;if(!ne)return()=>{};const me=ge=>{ge.key==="Escape"&&w&&ge.preventDefault()},Se=ge=>{w&&ge.preventDefault(),p?.()};return ne.addEventListener("keydown",me),ne.addEventListener("cancel",Se),()=>{ne.removeEventListener("keydown",me),ne.removeEventListener("cancel",Se)}},[n,p,w]),U&&n){const ne=!d&&s;return c.jsxs(mA,{onClose:p,className:g,children:[ne&&c.jsx("h2",{id:j,className:"py-6 text-center text-foreground-850 text-2xl",children:s}),m]})}return c.jsx(he.dialog,{className:O("fixed inset-0 m-auto rounded-4xl border border-white/10 bg-background-150 text-foreground-800 shadow-xl dark:bg-background-250",$,E&&"t-custom-scrollbar"),animate:n?"animate":"initial",initial:"initial",exit:"exit",variants:{initial:je,animate:rt},transition:{duration:T,ease:"easeInOut"},ref:t,role:"dialog","aria-modal":"true","aria-labelledby":s?j:I,"aria-label":s?void 0:o,...n?X:{},children:n&&c.jsxs("div",{"data-modal-overlay":"true",className:O("flex min-h-[150px] flex-col gap-3",!d&&"p-6",h),ref:P,children:[c.jsx(TA,{}),!d&&c.jsxs("div",{className:O("flex items-center justify-between gap-2",{"justify-center":b}),children:[s&&c.jsxs("div",{children:[a,c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("h2",{id:j,className:O("text-foreground-800 text-lg-strong",r),children:s}),i]})]}),p&&!x&&c.jsx(ee,{variant:"square",color:"subtle-dimmed-inverted",size:"32-xs",title:D("common.closeText"),"aria-label":D("common.closeText"),onClick:p,testId:y,children:c.jsx(on,{className:"size-5"})})]}),m]})})}function RZ(e){const{key:t,initialValue:n}=e;return Pu(t,n,{getItem:()=>Pn(t)??n,setItem:(s,a)=>{a===void 0?Io(t):Bo(t,a)},removeItem:()=>Io(t)},{getOnInit:!0})}l.lazy(async()=>{const[{default:e},{monokaiTheme:t}]=await Promise.all([N(()=>import("./index-BSt8OmGF.js"),__vite__mapDeps([7,1,2])),N(()=>import("./monokai-bKOQMHTz.js"),[])]);return{default:function({value:o,collapsed:s=1}){return c.jsxs(e,{value:o,collapsed:s,style:t,displayDataTypes:!1,displayObjectSize:!1,indentWidth:15,shortenTextAfterLength:20,enableClipboard:!0,children:[c.jsx(e.Null,{render:()=>c.jsx("span",{style:{color:"#FA2672"},children:"null"})}),c.jsx(e.Undefined,{render:()=>c.jsx("span",{style:{color:"#FD971F"},children:"undefined"})})]})}}});RZ({key:"turnTelemetry",initialValue:{}});function wA(e){Ee(bt,t=>Xt(t,n=>{const o=n.get(e.id);o&&(e.title!==void 0&&(o.title=e.title),o.updatedAt=e.updatedAt,o.continuedAt=e.continuedAt,e.characterId!==void 0&&(o.characterId=e.characterId),e.group!==void 0&&(o.group=e.group))}))}async function NZ(e){const t=await pt(`/conversations/${e}`,mg,{options:{method:"GET"},parseOptions:{safe:!0},analytics:{anonymousPath:"/conversations/*"}}).then(n=>n.data);wA(t)}function qTe(e,t){const{data:n,isLoading:o,error:s,refetch:a}=ts({queryKey:["conversationMetadata",e],queryFn:async()=>await pt(`/conversations/${e}`,mg,{options:{method:"GET"},parseOptions:{safe:!0},analytics:{anonymousPath:"/conversations/*"}}).then(i=>i.data),enabled:!!e,...t});return l.useEffect(()=>{n&&wA(n)},[n,e]),{data:n,isLoading:o,error:s,refetch:l.useCallback(()=>{a()},[a])}}function sn(){return ib({select:t=>t.pathname})}const gf="enable-temporary-conversation";function Ba(){const e=sn(),t=W(gf);return e===Dh&&t}function Pd(e){const t=e?.length?e.includes(gf):W(gf);return window.location.pathname===Dh&&t}function AA(e,t){const n=J.instance().config();return e&&!n.settingsOverrides?.shouldHideMultipleCharacters&&!t}function Br(){const e=q("multiplecharacters"),t=Ba();return AA(e,t)}function vf(){const e=W("multiplecharacters"),t=Pd();return AA(e,t)}const LZ=nn.extend({actionName:v("edge_get_page_content"),parameters:A(f({tabId:k(),windowId:k(),pageUrl:u().nullish(),pageTitle:u().nullish(),pageType:u().nullish(),lastAccessedTime:k().nullish()}))}),DZ=nn.extend({actionName:v("edge_get_tabs_list"),parameters:f({maxCount:k().optional()})}),OZ=nn.extend({actionName:v("browser_search"),parameters:f({queries:A(u()),startTime:u().nullish(),endTime:u().nullish(),maxResults:Ho().positive().prefault(10),states:A(u()).prefault(["history"])})}),UZ=f({state:u(),title:u(),url:u(),pageSummary:u().nullish(),lastAccessed:hr().nullish()});f({results:A(UZ)});const FZ=f({type:v("click"),x:k(),y:k(),button:Q([v("left"),v("right"),v("wheel"),v("back"),v("forward")]),keys:u().array().optional()}),jZ=f({type:v("doubleClick"),x:k(),y:k(),keys:u().array().optional()}),BZ=f({x:k(),y:k()}),VZ=f({type:v("drag"),path:BZ.array(),keys:u().array().optional()}),HZ=f({type:v("scroll"),x:k(),y:k(),scrollX:k(),scrollY:k(),keys:u().array().optional()}),zZ=f({type:v("type"),text:u()}),GZ=f({type:v("keyPress"),keys:u().array()}),WZ=f({type:v("wait"),seconds:k()}),$Z=f({type:v("move"),x:k(),y:k(),keys:u().array().optional()}),qZ=fe("type",[FZ,jZ,VZ,HZ,zZ,GZ,WZ,$Z]),KZ=f({type:v("domClick"),nodeId:u()}),YZ=f({type:v("domDoubleClick"),nodeId:u()}),ZZ=f({type:v("domScroll"),nodeId:u().optional(),scrollX:k(),scrollY:k()}),JZ=f({type:v("domType"),text:u(),commit:Q([v("change"),v("enter")])}),QZ=f({type:v("domKeyPress"),keys:u().array()}),XZ=f({type:v("domWait"),seconds:k()}),eJ=f({type:v("domForward")}),tJ=f({type:v("domBack")}),nJ=f({type:v("domRefresh")}),oJ=fe("type",[KZ,YZ,ZZ,JZ,QZ,XZ,eJ,tJ,nJ]),sJ=Q([v("dom"),v("screenshot"),v("domain-info"),v("computer-initialize-state"),v("browser-state"),v("tabs")]),aJ=f({type:v("get")}),rJ=f({type:v("createTabs"),urls:u().array(),foreground:V()}),iJ=fe("type",[...qZ.options,...oJ.options,aJ,rJ]),cJ=gn.extend({actionName:v("computer_use_v2"),parameters:f({selectedTab:k().optional(),tabIds:A(k()).optional(),actions:A(iJ),responseFields:sJ.array(),origin:u(),given:DI})}),lJ=gn.extend({actionName:v("edge_navigate_to"),parameters:f({tabId:k().optional(),url:u(),foregroundRun:V().optional()})}),uJ=gn.extend({actionName:v("edge_switch_tab"),parameters:f({tabId:k()})}),dJ=gn.extend({actionName:v("edge_close_tabs"),parameters:f({tabIds:A(k())})}),mJ=gn.extend({actionName:v("edge_find_browser_tab_groups"),parameters:f({queries:u().array()})}),pJ=gn.extend({actionName:v("edge_group_open_browser_tabs"),parameters:f({tabGroups:f({title:u(),tabIds:A(k()),color:Q([v("red"),v("green"),v("blue")]),collapsed:V()}).array()})}),fJ=gn.extend({actionName:v("edge_ungroup_open_browser_tabs"),parameters:f({tabGroupIds:k().array()})}),hJ=gn.extend({actionName:v("edge_media_controls"),parameters:f({action:Q([v("play"),v("pause")])})}),gJ=gn.extend({actionName:v("edge_go_back_forward"),parameters:f({direction:Q([v("back"),v("forward")]),tabId:k().optional()})}),vJ=gn.extend({actionName:v("windows_search_files"),parameters:f({keyword:u(),fileType:u().nullish(),startAt:hr().nullish(),endAt:hr().nullish(),fullPath:u().nullish(),resultCountLimit:k().nullish()})}),yJ=Q([lJ,dJ,mJ,pJ,fJ,hJ,uJ,gJ,vJ]),CJ=f({type:v("screenshot")}),SJ=f({type:v("click"),x:k(),y:k(),button:Q([v("back"),v("forward"),v("left"),v("right"),v("middle")])}),bJ=f({type:v("scroll"),x:k(),y:k(),scrollX:k(),scrollY:k()}),IJ=f({type:v("doubleClick"),x:k(),y:k()}),EJ=f({type:v("moveMouse"),x:k(),y:k()}),TJ=f({type:v("keyPress"),keys:u().array()}),wJ=f({type:v("drag"),path:f({x:k(),y:k()}).array()}),AJ=f({type:v("type"),text:u()}),xJ=f({type:v("wait"),seconds:k()}),_J=fe("type",[CJ,SJ,IJ,EJ,TJ,wJ,bJ,AJ,xJ]),kJ=gn.extend({actionName:v("computer_use"),parameters:f({tabId:k(),callId:u(),given:DI,action:_J})}),PJ=Q([...yJ.options,kJ,cJ]),MJ=f({pageId:u(),conversationId:u().optional()}),RJ=nn.extend({actionName:v("windows_collaborator_start"),parameters:MJ}),NJ=f({pageId:u().optional(),conversationId:u().optional()}),LJ=nn.extend({actionName:v("windows_collaborator_undo"),parameters:NJ}),DJ=f({pageId:u(),suggestionId:u(),conversationId:u().optional()}),OJ=nn.extend({actionName:v("windows_collaborator_suggestion_complete"),parameters:DJ}),UJ=fe("actionName",[RJ,LJ,OJ]),FJ=f({Prefill:u(),Position:k(),Phrase:u()}),jJ=nn.extend({actionName:v("guided_conversation"),actionType:u(),id:u(),parameters:FJ}),BJ=gn.extend({actionName:v("windows_get_known_directories"),parameters:f({args:u()})}),VJ=gn.extend({actionName:v("windows_copy_files"),parameters:f({inputFiles:A(u()),targetFiles:A(u())})}),HJ=gn.extend({actionName:v("windows_move_files"),parameters:f({inputFiles:A(u()),targetFiles:A(u())})}),zJ=gn.extend({actionName:v("windows_create_directories"),parameters:f({directories:A(u())})}),GJ=Q([BJ,VJ,HJ,zJ]),Vr=f({lat:k(),lon:k()}),WJ=f({north:k(),south:k(),east:k(),west:k()}),$J=f({coordinate:Vr,label:u().nullish()}),qJ=f({coordinate:Vr,label:u(),view_radius:k()}),xA=f({type:v("point"),id:k(),coordinate:Vr,label:u().nullish(),style:u().nullish(),citation_id:k().nullish()}),_A=f({type:v("polyline"),id:k(),coordinates:A(Vr),label:u().nullish(),style:u().nullish(),citation_id:k().nullish()}),kA=f({type:v("polygon"),id:k(),coordinates:A(Vr),label:u().nullish(),style:u().nullish(),citation_id:k().nullish()}),KJ=f({type:v("route"),id:k(),waypoints:A($J),mode:z(["walking","driving"]),label:u(),citation_id:k().nullish()}),YJ=f({type:v("flyover"),id:k(),waypoints:A(qJ),label:u().nullish(),citation_id:k().nullish()}),ZJ=fe("type",[xA,_A,kA]),JJ=f({type:v("geometry_layer"),id:k(),label:u(),geometries:A(ZJ),citation_id:k().nullish()}),QJ=fe("type",[xA,_A,kA,KJ,YJ,JJ]),XJ=nn.extend({actionName:v("map_add"),parameters:f({items:A(QJ)})}),eQ=nn.extend({actionName:v("map_remove"),parameters:f({ids:A(k())})}),tQ=Q([v("symbolic_2d"),v("photorealistic_3d")]),nQ=nn.extend({actionName:v("map_set_view"),parameters:f({show:V().optional(),label:u().optional(),center:Vr.optional(),bounds:WJ.optional(),zoom:k().optional(),bearing:k().optional(),pitch:k().optional(),map_type:tQ.optional(),custom_style:u().optional()})}),PA=fe("actionName",[XJ,eQ,nQ]),oQ=f({id:u()}),sQ=nn.extend({actionName:v("windows_notify_highlight_started"),parameters:oQ}),aQ=f({id:u(),area:f({x:k(),y:k(),width:k(),height:k()}),message:u().optional()}),rQ=nn.extend({actionName:v("windows_highlight_screen"),parameters:aQ}),iQ=f({id:u(),errorCode:u()}),cQ=nn.extend({actionName:v("windows_notify_highlight_failed"),parameters:iQ}),lQ=fe("actionName",[sQ,rQ,cQ]),uQ=fe("actionName",[DZ,LZ,OZ,qD,jJ,...PJ.options,...UJ.options,...lQ.options,...PA.options,...GJ.options]);class Pi{config=null;static singleton=null;static instance(){return Pi.singleton??=new Pi,Pi.singleton}getConfig(){return this.config}setConfig(t){this.config=t}}class Ke{static singleton=null;activeListeners=[];static instance(){return Ke.singleton??=new Ke,Ke.singleton}push(t,n,o){return t.init(o),this.activeListeners.push(t),n&&n(),t.result===null?Promise.resolve(null):t.result.then(s=>(this.pop(t),s)).catch(()=>(this.pop(t),null))}pop(t){const n=this.activeListeners.indexOf(t);n>-1&&this.activeListeners.splice(n,1)}findAndHandleListener(t){for(const n of[...this.activeListeners].sort((o,s)=>o.createdDate<s.createdDate?-1:1))if(n.maybeHandleEvent(t))break}}class ht{static cancelled(){const t=new ht;return t.cancel(),t}static create(t){const n=new ht;return t&&t.then(()=>n.cancel()),n}static delay(t){return this.create(new Promise(n=>{setTimeout(()=>n(null),t)}))}constructor(){this.token=new Promise(t=>{this.resolve=t}),this.isCancelled=!1}resolve=null;isCancelled;token;cancelled(){return this.isCancelled}cancel(){return!this.isCancelled&&this.resolve&&this.resolve(this),this.isCancelled=!0,this.isCancelled}dispose(){this.cancel()}}const dQ=["edge://discover-chat-v2","edge://discover-chat-v2.top-chrome","edge://copilot-ntp"];let Qm;function mQ(){if(Qm===void 0){const e=window.location.ancestorOrigins[0]??"";if(!dQ.includes(e))throw new Error(`Unexpected browser origin: ${e}.`);Qm=e}return Qm}const pC="chrome.copilotAuthPrivate.continueSignInWithAgeInfo",fC="chrome.copilotAuthPrivate.startSignIn",hC="chrome.copilotAuthPrivate.startSignOut",gC="chrome.copilotAuthPrivate.onAgeVerificationRequiredForSignIn",vC="chrome.copilotAuthPrivate.openWorkCopilot",yC="chrome.copilotAuthPrivate.isNativeWorkCopilotInstalled",pQ="Edge.Chat.OnRestoreButtonShown",fQ="Edge.Chat.RestoreTabs",hQ="82864fa0-ed49-4711-8395-a0e6003dca1f",CC="Edge.Context.Pref",gQ="Edge.Context.OnPref",vQ="Edge.Context.GetDocumentBody",yQ="Edge.Context.OnGetDocumentBody",KTe=32e3,CQ=48e3,SC=64e3,SQ=128e3,bQ="Edge.Chat.Ready",IQ="Edge.Studio.TTVR",EQ="Edge.Chat.IsVisionCapable",TQ="Edge.Chat.OnIsVisionCapable",wQ="Edge.Chat.VisionLaunch",AQ="Edge.Chat.OnVisionLaunch",xQ="Edge.Vision.OnPushLaunchResponse",_Q="Edge.Vision.ToggleVisionContext",kQ="Edge.Vision.ToggleScreenPicker",PQ="Edge.Vision.OnToggleScreenPicker",MQ="Edge.Vision.GetContext",RQ="Edge.Vision.OnGetContext",NQ="Edge.Vision.DrawHighlight",LQ="Edge.Vision.EndSession",DQ="Edge.Vision.ChangeSessionMode",OQ="Edge.Vision.FindInPage",UQ="Edge.Window.ResizeWindow",FQ="Edge.Chat.Screenshot",jQ="Edge.Chat.OnScreenshot",BQ="Edge.Chat.HistorySearch",VQ="Edge.Chat.OnHistorySearch",HQ="Edge.RealnameAuth.GetStatus",zQ="Edge.RealnameAuth.OnGetStatus",GQ="Edge.RealnameAuth.Start",WQ="Edge.RealnameAuth.OnStart",$Q="chrome.tabs.create",bC="chrome.tabs.onActivated",IC="chrome.tabs.onUpdated",qQ="chrome.tabs.reload",KQ="chrome.tabs.query",YQ="chrome.tabs.update",EC="chrome.authPrivate.onSignInStateChanged",TC="chrome.authPrivate.getPrimaryAccountInfo",ZQ="chrome.metricsPrivate.recordMediumTime",JQ="chrome.authPrivate.acquireAccessTokenWithUserInteraction",QQ="chrome.authPrivate.acquireAccessTokenSilently",wC="chrome.authPrivate.startEdgeSignIn",AC="chrome.windows.getCurrent",XQ="Edge.Chat.ActivateRebates",eX="Edge.Chat.OnActivateRebates",tX="Edge.Chat.SignInToRebates",nX="Edge.Files.SearchLocalFiles",oX="Edge.Files.OnSearchLocalFiles",sX="Edge.Chat.OpenLinkInExternalBrowser",aX="Edge.Chat.AgentMessage",rX="Edge.Chat.OnAgentMessage",iX="Edge.Auth.NaaRequest",cX="Edge.Auth.NaaResponse",lX="Edge.Auth.ConnectorRequest",uX="Edge.Notify.Conv",dX="Edge.Notify.User",mX="Edge.Notify.Features",pX="Edge.Notify.MessageSent",fX="Edge.Notify.OnUserClosedChatSettings",hX="Edge.Notify.HeaderCommand.ClosePane",gX="Edge.Notify.HeaderCommand.SendFeedback",vX="Edge.Notify.HeaderCommand.TogglePinState",yX="Edge.Notify.Error",CX="Edge.Notify.OpenSidepane.WithConversation",SX="Edge.Notify.ContentSize",bX="Edge.Chat.GetCopilotMode",IX="Edge.IsFeatureEnabled",EX="Edge.OnIsFeatureEnabled",xC="Edge.BrowserContext.LoadTimeData",TX="Edge.CopilotTips.GetData",wX="Edge.CopilotTips.OnDataReceived",AX="Edge.NTP.QueryQuickLinks",xX="Edge.NTP.UpdateQuickLink",_X="Edge.NTP.RemoveQuickLink",kX="Edge.NTP.OnReceivedQuickLinks",PX="Edge.Journeys.GetData",MX="Edge.Journeys.HideCard",RX="Edge.Journeys.ClickCard",NX="Edge.Journeys.OnDataReceived",_C="Edge.ToolAction",LX="Edge.ShowTabs",DX="Edge.LockTabs",OX="Edge.ReleaseTabs",UX="Edge.AllowActionForUrl",FX="Edge.Searchbox.QueryAutocomplete",jX="Edge.Searchbox.OpenAutocompleteMatch",BX="Edge.Searchbox.ReportComposerChat",VX="Edge.Searchbox.ShouldSendOnlyChatSuggestions",HX="Edge.TextServices.GetText",zX="Edge.TextServices.GetTextResponse",GX="Edge.TextServices.SetText",WX="Edge.TextServices.SetTextResponse",YTe="isCopilotToolsSupported",ZTe="isShowCopilotButtonSupported",$X="Edge.Chat.SetVideoCurrentTime",qX="Edge.WCP.Notify.DraggableRegions",KX="Edge.WCP.Notify.OpenCopilotSettings",YX="Edge.WCP.Notify.OpenCreditsPage",ZX="Edge.Files.GetRecentFiles",JX="Edge.Files.OnGetRecentFiles",QX="Edge.Files.GetRecentFileContent",XX="Edge.Files.OnGetRecentFileContent",eee="Edge.Files.OpenFile",tee="Edge.Files.OnOpenFile",nee="Edge.WCP.Notify.ShellCommand",oee="Edge.WCP.On.ShellCommandResponse",see="Copilot.Tabs.Query",kC="Edge.WCP.AgentEnvironment.AreAgentEnvironmentsAvailable",PC="Edge.WCP.AgentEnvironment.Initialize",MC="Edge.WCP.AgentEnvironment.Shutdown",RC="Edge.WCP.AgentEnvironment.GetOrCreateEnvironment",NC="Edge.WCP.AgentEnvironment.DeleteEnvironment",LC="Edge.WCP.AgentEnvironment.GetAllEnvironmentIds",DC="Edge.WCP.AgentEnvironment.RenameEnvironment",OC="Edge.WCP.AgentEnvironment.LaunchSettingsAppToAgentsSetting",UC="Edge.WCP.AgentEnvironment.SetPathAccess",FC="Edge.WCP.AgentEnvironment.PerformModelAction",JTe="edge_tools.enabled";class aee{innerResult=null;priority="Normal";createdDate=new Date;id;resolveListener;eventName;canResolve;options;get result(){return this.innerResult}set result(t){this.innerResult=t}constructor(t,n="",o,s,a){this.eventName=t,this.id=a?.ignoreRequestId?"-1":n,o?.then(()=>this.cancel()),this.canResolve=s,this.options=a}init(t){!t||this.options?.autoRemoveWhenResolveListenerReturnTrue?this.result=new Promise((o,s)=>{t?this.resolveListener=a=>{if(a===null)return;const r=t(a);Promise.resolve(r).then(i=>{i&&o(a)}).catch(s)}:this.resolveListener=o}):this.resolveListener=t}maybeHandleEvent(t){if(!this.resolveListener)throw new Error("PostMessageListener is not initialized");const{eventName:n,requestId:o}=t;return!this.options?.ignoreRequestId&&o!==this.id?!1:n===this.eventName?this.canResolve&&!this.canResolve(t)?!1:(this.resolveListener(t),!this.options?.ignoreRequestId):!1}cancel(){if(!this.resolveListener)throw new Error("PostMessageListener is not initialized");return this.result&&this.resolveListener(null),!0}}class Qe extends aee{listenerKey=Qe.name}class ree{notifySidepaneOpened(t){const n={conversationId:t};this.postMessageToBrowser(CX,n)}notifyConversationId(t){const n={convId:t};this.postMessageToBrowser(uX,n)}notifyBrowserOnHeaderCommand(t,n){let o;switch(t){case"sendFeedback":o=gX;break;case"closePane":o=hX;break;case"togglePinState":o=vX;break;default:return}this.postMessageToBrowser(o,n??{})}notifyErrorPageState(t){const n={type:t};this.postMessageToBrowser(yX,n)}notifyContentSize(t){const n={height:t};this.postMessageToBrowser(SX,n)}notifyDraggableRegions(t){this.postMessageToBrowser(qX,t)}notifyMessageSent(t){const n={isOrganic:t};this.postMessageToBrowser(pX,n)}notifyUserClosedSettings(){this.postMessageToBrowser(fX,{})}notifyOpenCopilotSettings(){this.postMessageToBrowser(KX,{})}notifyOpenCreditsPage(){this.postMessageToBrowser(YX,{})}notifyUserId(t){const n={picassoId:t};this.postMessageToBrowser(dX,n)}notifyFeatures(t){const n={flights:t};this.postMessageToBrowser(mX,n)}notifyEdgeChatReady(){this.postMessageToBrowser(bQ,{})}notifyEdgeTTVR(t){const n={...t,timestamp:performance.now()};this.postMessageToBrowser(IQ,n)}createTab(t){const n={url:t};this.postMessageToBrowser($Q,n)}lockTabs(t,n){const o={activityId:t,tabIds:n};this.postMessageToBrowser(DX,o)}releaseTabs(t,n){const o={activityId:t,tabIds:n};this.postMessageToBrowser(OX,o)}showTabs(t){this.postMessageToBrowser(LX,t)}async getTabs(t,n,o){const s=crypto.randomUUID(),r=Pi.instance().getConfig()?.shouldPassConversationIdWithTabQuery??!1,i=n&&r,d=i?see:KQ,m=i?t:(({conversationId:p,...h})=>h)(t);return Ke.instance().push(new Qe(d,s,ht.create(o).token),()=>{this.postMessageToBrowser(d,m,s)})}reloadTab(t){this.postMessageToBrowser(qQ,t)}updateTab(t){const n={url:t};this.postMessageToBrowser(YQ,n)}async onTabsActivated(t,n){const o=crypto.randomUUID();return Ke.instance().push(new Qe(bC,o,ht.create(t).token),()=>{this.postMessageToBrowser(bC,{},o)},n)}async onTabsUpdated(t,n,o=crypto.randomUUID(),s=void 0){const a=s?{autoRemoveWhenResolveListenerReturnTrue:s}:void 0;return Ke.instance().push(new Qe(IC,o,ht.create(t).token,void 0,a),()=>{this.postMessageToBrowser(IC,{},o)},n)}onRestoreButtonShown(){this.postMessageToBrowser(pQ,{})}restoreTabs(){this.postMessageToBrowser(fQ,{})}async getQuickLinks(t,n){const o=crypto.randomUUID(),s={count:t};return Ke.instance().push(new Qe(kX,o,ht.create(n).token),()=>{this.postMessageToBrowser(AX,s,o)})}updateQuickLink(t,n,o){const s={rid:n??-1,url:o??"",title:t};this.postMessageToBrowser(xX,s)}removeQuickLink(t){const n={rid:t};this.postMessageToBrowser(_X,n)}async getCopilotTips(t){const n=crypto.randomUUID();return Ke.instance().push(new Qe(wX,n,ht.create(t).token),()=>{this.postMessageToBrowser(TX,{},n)})}async getJourneys(t){const n=crypto.randomUUID();return Ke.instance().push(new Qe(NX,n,ht.create(t).token),()=>{this.postMessageToBrowser(PX,{},n)})}hideJourneysCard(t){this.postMessageToBrowser(MX,t)}clickJourneysCard(t){this.postMessageToBrowser(RX,t)}async isVisionCapable(t){const n=crypto.randomUUID();return Ke.instance().push(new Qe(TQ,n,ht.create(t).token),()=>{this.postMessageToBrowser(EQ,{},n)})}async launchVision(t,n){const o=crypto.randomUUID(),s={formCode:t};return Ke.instance().push(new Qe(AQ,o,ht.create(n).token),()=>{this.postMessageToBrowser(wQ,s,o)})}async toggleScreenPicker(t,n,o,s){const a=await this.postMessageAndListenForResponse(kQ,PQ,{open:t,triggerCoordinate:o??null,shareFilter:s??null},n);return a?.args?a.args:null}async getVisionContext(t){const n=await this.postMessageAndListenForResponse(MQ,RQ,void 0,t);return n?.args?n.args:null}drawHighlight(t,n=null,o=null){return this.postMessageToBrowser(NQ,{action:t,highlight:n,message:o})}changeVisionSessionMode(t){this.postMessageToBrowser(DQ,{mode:t})}endVisionSession(){this.postMessageToBrowser(LQ,void 0)}resizeWindow(t){this.postMessageToBrowser(UQ,t)}async listenPreference(t,n,o,s){const a=crypto.randomUUID(),r={key:t,notifyOnChange:!0};await Ke.instance().push(new Qe(gQ,void 0,ht.create(s).token,n,{ignoreRequestId:!0}),()=>{this.postMessageToBrowser(CC,r,a)},o)}setPreference(t,n){const o={key:t,value:n};this.postMessageToBrowser(CC,o)}async startListeningForSignedInStateChanges(t,n){const o=crypto.randomUUID();return Ke.instance().push(new Qe(EC,o,ht.create(t).token),()=>{this.postMessageToBrowser(EC,{},o)},n)}async getPrimaryAccount(){const t=crypto.randomUUID(),n=await Ke.instance().push(new Qe(TC,t),()=>{this.postMessageToBrowser(TC,void 0,t)});return n?.args?n.args:null}async acquireToken(t,n,o){const s=crypto.randomUUID(),a={account_id:n.account_id,account_type:n.account_type,client_id:hQ,scope_or_resource:o??"",use_msa_v2_api:!0},r=t?JQ:QQ,i=await Ke.instance().push(new Qe(r,s),()=>{this.postMessageToBrowser(r,a,s)});return i?.args?i.args:null}async startEdgeSignIn(){const t=crypto.randomUUID(),n=await Ke.instance().push(new Qe(wC,t),()=>{this.postMessageToBrowser(wC,void 0,t)});return n?.args?n.args:null}async startCopilotSignIn(t){const n=crypto.randomUUID(),o=await Ke.instance().push(new Qe(fC,n),()=>{this.postMessageToBrowser(fC,t,n)});return o?.args?o.args:null}async startCopilotSignOut(){const t=crypto.randomUUID(),n=await Ke.instance().push(new Qe(hC,t),()=>{this.postMessageToBrowser(hC,void 0,t)});return n?.args?n.args:null}async getIsNativeWorkCopilotInstalled(){const t=crypto.randomUUID(),n=await Ke.instance().push(new Qe(yC,t),()=>{this.postMessageToBrowser(yC,void 0,t)});return n?.args?n.args.installed:!1}async openWorkCopilot(t){const n=crypto.randomUUID();await Ke.instance().push(new Qe(vC,n),()=>{this.postMessageToBrowser(vC,t,n)})}async continueSignInWithAgeInfo(t,n){const o=crypto.randomUUID(),s=await Ke.instance().push(new Qe(pC,o),()=>{this.postMessageToBrowser(pC,{date_of_birth:t,country_code:n},o)});return s?.args?s.args:null}async startListeningForAgeVerificationRequiredForSignIn(t){const n=crypto.randomUUID();return Ke.instance().push(new Qe(gC,n),()=>{this.postMessageToBrowser(gC,{},n)},t)}async getRealNameAuthStatus(t){const n=crypto.randomUUID(),o=ht.delay(t),s=await Ke.instance().push(new Qe(zQ,n,o.token),()=>{this.postMessageToBrowser(HQ,{},n)});return o.cancelled()?null:s?.args?s.args:null}async startRealNameAuth(){const t=crypto.randomUUID(),n=await Ke.instance().push(new Qe(WQ,t),()=>{this.postMessageToBrowser(GQ,{},t)});return n?.args?n.args:null}queryAutocomplete(t,n){const o={query:t,preventInlineAutocomplete:n};this.postMessageToBrowser(FX,o)}openAutocompleteMatch(t,n,o,s,a){const r={line:t,url:n,areMatchesShowing:!0,mouseButton:o,altKey:!1,ctrlKey:s,metaKey:!1,shiftKey:a};this.postMessageToBrowser(jX,r)}sendFindInPageAction(t){this.postMessageToBrowser(OQ,t)}sendVisionLaunchResult(t){this.postMessageToBrowser(xQ,t)}sendToggleVisionContext(t){this.postMessageToBrowser(_Q,t)}reportInlineChat(t,n){const o={line:t,areMatchesShowing:n};this.postMessageToBrowser(BX,o)}shouldSendOnlyChatSuggestions(t){const n={shouldSendOnlyChatSuggestions:t};this.postMessageToBrowser(VX,n)}fetchIsCopilotMode(){this.postMessageToBrowser(bX,{})}setVideoTime(t){const n={selector:"video",time:t};this.postMessageToBrowser($X,n)}async isFeatureEnabled(t){const n={featureNames:t},o=crypto.randomUUID(),s=1e3;return Ke.instance().push(new Qe(EX,o,ht.delay(s).token),()=>{this.postMessageToBrowser(IX,n,o)})}async getLoadTimeData(){const t=crypto.randomUUID(),n=1e4,o=await Ke.instance().push(new Qe(xC,t,ht.delay(n).token),()=>{this.postMessageToBrowser(xC,{},t)});return typeof o?.args=="object"&&"supportedPrefKeys"in o.args?o.args:null}async searchHistory(t,n){const o=crypto.randomUUID();return Ke.instance().push(new Qe(VQ,o,ht.create(n).token),()=>{this.postMessageToBrowser(BQ,t,o)})}openLinkInExternalBrowser(t){const n={url:t};this.postMessageToBrowser(sX,n)}async executeBrowserAction(t){const n=crypto.randomUUID();return Ke.instance().push(new Qe(_C,n),()=>{this.postMessageToBrowser(_C,t,n)})}allowActionForUrl(t){const n=crypto.randomUUID();this.postMessageToBrowser(UX,t,n)}async getText(){const t=crypto.randomUUID(),n=await this.postMessageAndListenForResponse(HX,zX,{},void 0,t);return n?.args?n.args:null}async setText(t){const n=crypto.randomUUID(),o=await this.postMessageAndListenForResponse(GX,WX,t,void 0,n);return o?.args?o.args:null}recordMediumTimeMetric(t,n){const o={eventName:t,value:Math.round(n)};this.postMessageToBrowser(ZQ,o)}async takeScreenshot(t){const n=crypto.randomUUID(),o=await Ke.instance().push(new Qe(jQ,n),()=>{this.postMessageToBrowser(FQ,t,n)});return o?.args?o.args:null}async getComputerUse(t,n,o){const s=Date.now().toString(),a={eventType:t,requestId:s,sessionId:n},r=ht.create(o),i=await Ke.instance().push(new Qe(rX,s,r.token),()=>{this.postMessageToBrowser(aX,a,s)});return r.cancelled()?!1:(i?.args?i.args:null)?.result??!1}async makeNaaRequest(t,n){const o=crypto.randomUUID();return Ke.instance().push(new Qe(cX,o,ht.create(n).token),()=>{this.postMessageToBrowser(iX,t,o)})}openConnectorAuth(t){const n=crypto.randomUUID();this.postMessageToBrowser(lX,t,n)}async getDocumentBody(t,n,o,s,a,r){const i={cleanBody:!0,maxChars:n,domSelector:"",frameName:"",retry:1,...s,fetchVideoTranscript:o};return Ke.instance().push(new Qe(yQ,t,ht.create(r).token,a),()=>{this.postMessageToBrowser(vQ,i,t)})}async getCurrentWindow(t){const n=crypto.randomUUID(),o=ht.create(t),s=await Ke.instance().push(new Qe(AC,n,o.token),()=>{this.postMessageToBrowser(AC,{},n)});return o.cancelled()?null:s?.args?s.args:null}async activateCashback(){const t=crypto.randomUUID(),n={},o=1e4,s=await Ke.instance().push(new Qe(eX,t,ht.delay(o).token),()=>{this.postMessageToBrowser(XQ,n,t)});return s?s.args.result:!1}signInAndActivateCashback(){this.postMessageToBrowser(tX,{})}async getLocalFileSearchResults(t,n,o,s,a,r){const i=await this.postMessageAndListenForResponse(nX,oX,{keyword:t,fileType:n??"",startAt:o?o.getTime():0,endAt:s?s.getTime():0,maxResults:a??5},r);return i?.args?i.args:null}postMessageToBrowser(t,n,o=crypto.randomUUID()){const s={eventName:t,requestId:o,isOutgoing:!0,args:n};window.parent.postMessage(s,mQ())}async postMessageAndListenForResponse(t,n,o,s,a=crypto.randomUUID()){return Ke.instance().push(new Qe(n,a,ht.create(s).token),()=>{this.postMessageToBrowser(t,o,a)})}async executeShellCommands(t){const n={commands:t.commands},o=t.commands.length*2e4,s=await this.postMessageAndListenForResponse(nee,oee,n,ht.delay(o).token);return!s?.args||!Array.isArray(s.args)?null:s.args}async getRecentFiles(t){const n=crypto.randomUUID();return Ke.instance().push(new Qe(JX,n,ht.create(t).token),()=>{this.postMessageToBrowser(ZX,{},n)})}async getRecentFileContent(t,n){const o=crypto.randomUUID(),s={filePath:t};return await this.postMessageAndListenForResponse(QX,XX,s,n,o)}async openRecentFile(t,n){const o=crypto.randomUUID(),s={filePath:t};return await this.postMessageAndListenForResponse(eee,tee,s,n,o)}async areAgentEnvironmentsAvailable(t,n){const o=await this.postMessageAndListenForResponse(kC,kC,{requestedVersion:t},n);return o?.args?o.args:null}async initializeEnvironment(t){const n=await this.postMessageAndListenForResponse(PC,PC,{},t);return n?.args?n.args:null}async shutdownEnvironment(t){const n=await this.postMessageAndListenForResponse(MC,MC,{},t);return n?.args?n.args:null}async getOrCreateEnvironment(t,n){const o=await this.postMessageAndListenForResponse(RC,RC,{environmentId:t},n);return o?.args?o.args:null}async deleteEnvironment(t,n){const o=await this.postMessageAndListenForResponse(NC,NC,{environmentId:t},n);return o?.args?o.args:null}async getAllEnvironmentIds(t){const n=await this.postMessageAndListenForResponse(LC,LC,{},t);return n?.args?n.args:null}async renameEnvironment(t,n,o){const s=await this.postMessageAndListenForResponse(DC,DC,{environmentId:t,newEnvironmentId:n},o);return s?.args?s.args:null}async launchSettings(t){const n=await this.postMessageAndListenForResponse(OC,OC,{},t);return n?.args?n.args:null}async setPathAccess(t,n,o,s){const a=await this.postMessageAndListenForResponse(UC,UC,{environmentId:t,path:n,writeAccess:o},s);return a?.args?a.args:null}async performAction(t,n,o){const s=await this.postMessageAndListenForResponse(FC,FC,{environmentId:t,action:n},o);return s?.args?s.args:null}}const iee=new ree;class cee{isFeatureAvailableApiSupported;enabledFeatures=new Map;constructor(){this.isFeatureAvailableApiSupported=this.getFeatureAvailableApiSupported()}async isFeatureEnabled(t){return this.enabledFeatures.has(t)||await this.retrieveEnabledFeatures([t]),this.enabledFeatures.get(t)??!1}updateFeatureEnabledForTest(t,n){this.enabledFeatures.set(t,n)}async retrieveEnabledFeatures(t){if(!this.isFeatureAvailableApiSupported)return;await this.waitForNativeBridgeConnected();const n=await iee.isFeatureEnabled(t);if(n){const o=n.args;for(const s of t){const a=o.featureNames.includes(s);this.enabledFeatures.set(s,a)}}}getFeatureAvailableApiSupported(){if(typeof navigator>"u")return!1;const t=132;for(const n of navigator.userAgent.split(" "))if(n.startsWith("Edg/")){const o=n.split("/")[1];if(o!==void 0){const s=o.split(".")[0];if(s!==void 0)return parseInt(s,10)>=t}}return!1}waitForNativeBridgeConnected(){const t=ke();return t.get(jl)?Promise.resolve():new Promise(n=>{const o=t.sub(jl,()=>{t.get(jl)&&(o(),n())})})}}const QTe=new cee;function lee(e){return e!=null&&typeof e=="object"&&"id"in e&&typeof e.id=="number"&&"windowId"in e&&typeof e.windowId=="number"&&"url"in e&&typeof e.url=="string"}function uee(e){return Array.isArray(e)&&e.every(t=>lee(t))}function XTe(e=SC){return W("edge-long-doc-128k")?SQ:W("edge-long-doc-64k")?SC:W("edge-long-doc-48k")?CQ:e}function jC(e){const t=new Date(e).getTime();if(!Number.isNaN(t))return t}const dee={OPENED:Is.OPENED,RECENT:Is.RECENT,RECENTLY_CLOSED_TAB:Is.RECENT,HISTORY:Is.HISTORY};function mee(e){return e.map(t=>{const n=t.toUpperCase();return dee[n]??Is.HISTORY})}const pee=ke();function fee(e){pee.set(bt,t=>Xt(t,n=>{for(const{title:o,id:s,updatedAt:a,continuedAt:r,group:i,conversationType:d}of e){const m=n.get(s);m?(m.title=o,m.id=s,m.updatedAt=a,m.continuedAt=r,m.group=i??null,d&&(m.conversationType=d)):n.set(s,{id:s,title:o,updatedAt:a,history:[],continuedAt:r,group:i??null,conversationType:d})}}))}const hee=ke();function gee(e,t,n){yee(e.map(o=>vee(o,t,n)).filter(o=>o!==void 0))}function vee(e,t,n){switch(e.type){case"research":return{id:e.id,conversationId:t,type:e.type,status:e.status,updatedAt:""};case"computerUse":return{id:e.id,conversationId:e.conversationId??"",type:e.type,status:e.status,updatedAt:e.updatedAt??"",title:e.title??"",lastScreenshot:e.lastScreenshot};case"podcast":return{id:e.id,conversationId:t,status:e.status==="completed"?"completed":"running",type:e.type,podcast:e.podcast,updatedAt:e.updatedAt??n};case"videoGeneration":return{id:e.id,conversationId:t,status:e.status,type:e.type,result:e.result,updatedAt:e.updatedAt??n};case"planning":return{id:e.id,conversationId:t,status:e.status,type:e.type,title:e.title??"",agentConversationId:e.agentConversationId,updatedAt:e.updatedAt};default:return}}function yee(e){hee.set(Ls,n=>Xt(n,o=>{for(const s of e){const a=o.get(s.id);if(a)a.title=s.title,a.conversationId=s.conversationId,a.updatedAt=s.updatedAt,a.status=s.status,a.type=s.type,a.type==="computerUse"&&s.type==="computerUse"&&(a.lastScreenshot=s.lastScreenshot),a.type==="planning"&&s.type==="planning"&&(a.agentConversationId=s.agentConversationId);else if(s.type==="planning")o.set(s.id,{id:s.id,title:s.title,conversationId:s.conversationId,updatedAt:s.updatedAt,status:s.status,type:s.type,agentConversationId:s.agentConversationId});else if(s.type==="threeDGeneration")o.set(s.id,{id:s.id,title:s.title,conversationId:s.conversationId,updatedAt:s.updatedAt,status:s.status,type:s.type,result:s.result,attachmentId:s.attachmentId,style:s.style,reaction:s.reaction});else{const r={id:s.id,title:s.title,conversationId:s.conversationId,updatedAt:s.updatedAt,status:s.status,type:s.type};r.type==="computerUse"&&s.type==="computerUse"&&(r.chainOfThought=[],r.lastScreenshot=s.lastScreenshot),s.type==="podcast"&&r.type==="podcast"&&(r.podcast=s.podcast),s.type==="videoGeneration"&&r.type==="videoGeneration"&&(r.result=s.result),o.set(s.id,r)}}}));const t=e.filter(n=>n.type==="computerUse"&&n.conversationId).map(n=>{const{conversationId:o,title:s,updatedAt:a}=n;return{id:o??"",title:s,updatedAt:a,continuedAt:null,history:[]}});fee(t)}const b1={type:"spring",mass:.5,stiffness:450,damping:35},Cee={type:"spring",mass:.5,stiffness:450,damping:35},See={type:"spring",mass:1.8,stiffness:440,damping:40},bee={type:"spring",mass:1.4,stiffness:320,damping:40},Iee={type:"spring",mass:1,stiffness:1200,damping:40},ewe={type:"spring",mass:1.8,stiffness:640,damping:40},Eee={type:"spring",mass:3.2,stiffness:640,damping:40},zn={type:"spring",mass:.5,stiffness:450,damping:35},BC={duration:1.2,ease:"easeInOut",repeat:3,repeatType:"reverse",type:"tween"},MA=.2,Tee=.25,Hr=({title:e,titleId:t,...n})=>l.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M4.20889 10.7327C3.9232 11.0326 3.93475 11.5074 4.23467 11.7931C4.5346 12.0788 5.00933 12.0672 5.29502 11.7673L11.2495 5.516V20.25C11.2495 20.6642 11.5853 21 11.9995 21C12.4137 21 12.7495 20.6642 12.7495 20.25V5.51565L18.7043 11.7673C18.99 12.0672 19.4648 12.0788 19.7647 11.7931C20.0646 11.5074 20.0762 11.0326 19.7905 10.7327L12.7238 3.31379C12.5627 3.14474 12.3573 3.04477 12.1438 3.01386C12.0971 3.00477 12.0489 3 11.9995 3C11.9498 3 11.9012 3.00483 11.8543 3.01406C11.6412 3.04518 11.4363 3.14509 11.2756 3.31379L4.20889 10.7327Z"})),twe=Object.freeze(Object.defineProperty({__proto__:null,default:Hr},Symbol.toStringTag,{value:"Module"}));function I1(e,t=!0,n=!1){l.useEffect(()=>{t&&e.current?.focus({preventScroll:n})},[e,t,n])}function wee(){const e=l.useRef(null);return{captureFocus:()=>{document.activeElement instanceof HTMLElement&&(e.current=document.activeElement)},restoreFocus:()=>{e.current&&e.current.focus()}}}function Hc(){const{i18n:e}=Z();return e.dir(e.language)==="rtl"}const Xm=Wn.default,Md=l.forwardRef((e,t)=>{const{isOpen:n,onBack:o,headerText:s,children:a,onClose:r,className:i,disableCloseOutside:d,headerTextClassName:m,headerClassName:p,trapFocus:h=!1,variant:g="modal",hideCloseButton:y=!1}=e,{t:b}=Z(),C=l.useId(),{modalAttributes:T}=dA({trapFocus:h,legacyTrapFocus:h,alwaysFocusable:h}),S=h?T:{},E=Hc()?-1:1,I=l.useRef(null),{captureFocus:x,restoreFocus:w}=wee();l.useEffect(()=>{n?x():w()},[n,x,w]),I1(I,n),l.useEffect(()=>{const U=$=>{$.key==="Escape"&&n&&r&&($.stopPropagation(),$.preventDefault(),r())};return n&&document.addEventListener("keydown",U),()=>{document.removeEventListener("keydown",U)}},[n,r]);const P=U=>{(d??!r)||U.target===U.currentTarget&&r()},D=U=>{U.stopPropagation()},L=g==="drawer",j=L?{initial:{x:`${E*100}%`},animate:{x:0,transition:bee},exit:{x:`${E*100}%`,transition:{duration:Xm}}}:void 0;return c.jsx(jt,{id:String(n),mode:"sync",duration:Xm,exitDuration:Xm,className:O("fixed inset-0",at.modal),children:n&&c.jsxs("div",{...S,role:"dialog","aria-modal":"true","aria-labelledby":s?C:void 0,children:[c.jsx("div",{className:O("fixed inset-0 bg-background-850/30 dark:bg-background-150/70",at.modalBackground)}),c.jsx("div",{className:O("fixed inset-0 flex",L?"items-start justify-end":"items-center justify-center",at.modal),onClick:P,children:c.jsxs(he.div,{...j,className:O("t-custom-scrollbar flex flex-col gap-3 border border-white/10 bg-background-150 p-6 shadow-xl dark:bg-background-250",L?"h-full w-96":"min-h-[150px] rounded-4xl",i),onClick:D,tabIndex:-1,ref:U=>{I.current!==U&&(I.current=U),typeof t=="function"?t(U):t&&(t.current=U)},children:[c.jsxs("div",{className:O("flex items-center justify-between gap-2",p),children:[o&&c.jsx(ee,{variant:"square",color:"subtle-dimmed-inverted",size:"32-xs",title:b("common.backText"),"aria-label":b("common.backText"),onClick:o,children:c.jsx(Hr,{className:"size-5 -rotate-90"})}),s&&c.jsx("h2",{id:C,className:O("text-foreground-800 text-lg-strong",m),children:s}),r&&!y&&c.jsx(ee,{className:!o&&!s?"ms-auto":"",variant:"square",color:"subtle-dimmed-inverted",size:"32-xs",title:b("common.closeText"),"aria-label":b("common.closeText"),onClick:r,children:c.jsx(on,{className:"size-5"})})]}),a]})})]})})});Md.displayName="Modal";const RA="cf-turnstile",Aee=`#${RA}`;function nwe(){const e=M(ia),t=M(ss);return it("kill-cf-turnstile")?null:c.jsx(Md,{isOpen:e,className:"w-3/4 sm:w-[350px]",children:c.jsx("div",{id:RA,className:"flex flex-1 items-center justify-center","data-theme":t})})}const xee=new Ds(()=>new Promise((e,t)=>{const n=setTimeout(()=>{t(new Error("CF Turnstile script took too long to load"))},15e3),o=document.createElement("script");o.type="text/javascript",o.defer=!0,o.src="https://challenges.cloudflare.com/turnstile/v0/api.js",o.onload=()=>{clearTimeout(n),e()},o.onerror=()=>{clearTimeout(n),t(new Error("Failed to load turnstile script"))},document.body.appendChild(o)}));async function NA(e){const{onToken:t,onFinish:n}=e;if(ot("kill-cf-turnstile")||B(ia))return;const s=ke();R.trackEvent({name:"system",data:{eventName:"copilotTurnstileEvent",eventInfo_stage:"attempt"}}),ch.flushSync(()=>{s.set(ia,!0),s.set(iG,!0)});try{await xee.get()}catch{s.set(br,"cf-turnstile"),n?.();return}try{window.turnstile?.render(Aee,{sitekey:"0x4AAAAAAAg146IpY3lPNWte",callback:async a=>{t(a),Ce.emit("challenge:success"),window.turnstile?.remove(),s.set(ia,!1),R.trackEvent({name:"system",data:{eventName:"copilotTurnstileEvent",eventInfo_stage:"success"}})},"error-callback":a=>{Ce.emit("challenge:error",a),R.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"turnstileRenderErrorCallback",eventInfo_details:"Error rendering CF Turnstile.",eventInfo_errorMessage:a}})}})}catch(a){Ce.emit("challenge:error",a),R.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"turnstileRender",eventInfo_details:"Error rendering CF Turnstile",eventInfo_errorMessage:a instanceof Error?a.message:""}}),s.set(br,"cf-turnstile")}finally{n?.()}}function _ee(e){const t=e.match(/^\*\*(.*?)\*\*\n\n$/);if(t){const[,n]=t;return{title:n?.trim()??"",text:""}}return{title:"",text:e}}function yf(e){if(window.clarity)for(const[t,n]of Object.entries(e))window.clarity("set",t,n)}function VC(e){if(window.clarity)for(const t of e)window.clarity("event",t)}function LA(){typeof document<"u"&&document.body.setAttribute("data-clarity-mask","true")}function DA(){typeof document<"u"&&document.body.removeAttribute("data-clarity-mask")}function kee(e,t){const n=B(Te);de({source:"collaboratorSuggestion",scenario:"collaboratorComplete",conversationId:n??void 0,customData:JSON.stringify({pageId:e,...t&&{suggestionId:t}})})}const Ki=_(new Set),vu=_(new Map);function Pee(e){const t=B(Ki),n=new Set(t);n.add(e),Ee(Ki,n)}function Mee(e){const t=B(Ki),n=new Set(t);n.delete(e),Ee(Ki,n)}function ep(e){return B(Ki).has(e)}function Ree(e){const{pageId:t,suggestionId:n}=e,o=B(vu),s=new Map(o),a={id:`${t}_${n}`,suggestionId:n,state:"generating"};s.set(t,a),Ee(vu,s)}function HC(e){const t=B(vu),n=t.get(e);if(n&&n.state!=="stopped"){const o=new Map(t);o.set(e,{...n,state:"completed"}),Ee(vu,o),kee(e,n.suggestionId)}}const Cf=gc(new Map),Sf=ke();function Nee(e,t,n){(W("shell-command-execution")||n.type==="requestBrowserInteraction")&&Lee(e,t,n)}function Lee(e,t,n){Sf.set(Cf,o=>{const s=o.get(e)??[];o.set(e,[...s,{partId:t,command:n}])})}async function owe(e){return e.length===0?[]:(await iq.run({commands:e})).results??[]}function Dee(e){const t=e.results.map(n=>({type:kT.value,commandMessageId:e.messageId,commandPartId:n.partId,result:n.resultContent}));return{event:"send",conversationId:e.conversationId,content:t,mode:"chat"}}function Oee(e){const{conversationId:t,messageId:n}=e,s=Sf.get(Cf).get(n)??[];s.length>0&&(Ne(t,a=>{const r=nt({history:a,messageId:n});if(r){r.content=r.content.filter(d=>!(d.type==="card"&&d.card.type==="command"));const i=s.map(d=>d.command.type==="shell"?{type:"shell",shell:d.command.shell,command:d.command.command,description:d.command.purpose||"",partId:d.partId}:{type:"requestBrowserInteraction",partId:d.partId,taskId:d.command.taskId,reason:d.command.reason,instruction:d.command.instruction,environment:d.command.environment??null});r.content.push({type:"card",partId:n,card:{type:"command",commands:i,conversationId:t,status:"active"}})}}),Sf.set(Cf,a=>{a.delete(n)}))}function swe(e){const{conversationId:t,messageId:n,status:o}=e;Ne(t,s=>{const a=nt({history:s,messageId:n});if(a){for(const r of a.content)if(r.type==="card"&&r.card.type==="command"){r.card.status=o;break}}})}const Uee=Q([v(!0),v(!1)]);f({enabled:Uee.optional()});function OA(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}function UA(e){const t=Object.entries(e).filter(([,n])=>n!==null).map(([n,o])=>[n,FA(o)]);return Object.fromEntries(t)}function Fee(e){return e.map(FA)}function FA(e){return e==null?e:Array.isArray(e)?Fee(e):OA(e)?UA(e):e}function jee(e){return UA(e)}function bf(e,t){if(!OA(e))return null;const{type:n,...o}=e,s=jee(o),a={type:n,props:s},r=t.safeParse(a);return r.success?r.data:null}function Rd(e,t){let n=e;for(const o of t){if(!n||!("children"in n))return;n=n.children[o]}return n}class yu{static createRootTree(t,n){const o=bf(n,ad);return o===null?{success:!1,error:{errorType:"parseRootNodeFailed",errorMessage:"Failed to parse root node from component"}}:{success:!0,value:{type:"generativeUI",partId:t,rootNode:o,partIdToPath:{[t]:[]},completed:!1}}}static addChildNode(t,n,o,s){const a=s??bf(o,lg);if(a===null)return{success:!1,error:{errorType:"parseChildNodeFailed",errorMessage:"Failed to parse child node from component"}};const r=t.rootNode&&t.partIdToPath[n]&&Rd(t.rootNode,t.partIdToPath[n]);if(!r)return{success:!1,error:{errorType:"addChildInvalidParentPath",errorMessage:`addNodeAsChild with invalid parentPartId path: ${n}`}};if(!("children"in r))return{success:!1,error:{errorType:"addChildParentCannotHaveChildren",errorMessage:"addNodeAsChild attempted on parent node that cannot have children"}};const i=this.addNodeToParent(r,a);return i.success?{success:!0,value:{path:(t.partIdToPath[n]??[]).concat(r.children.length-1)}}:i}static addNodeToParent(t,n){return t.type==="Basic"?(t.children.push(n),{success:!0,value:void 0}):t.type==="ListView"?Ty(n)?(t.children.push(n),{success:!0,value:void 0}):{success:!1,error:{errorType:"addChildRootNodeAsChild",errorMessage:"ListView can only accept ListViewItem as children"}}:pB(n)||Ty(n)?{success:!1,error:{errorType:"addChildRootNodeAsChild",errorMessage:"addNodeAsChild: incompatible child node type"}}:(t.children.push(n),{success:!0,value:void 0})}}function En(e){const{errorType:t,errorMessage:n,messageId:o}=e,a={eventName:"copilotError",eventInfo_conversationId:B(Te)??"",eventInfo_messageId:o??"",eventInfo_feature:"generativeUI",eventInfo_scenario:"GenUIRender",eventInfo_errorType:t,eventInfo_errorMessage:n};R.trackEvent({name:"health",data:a})}function Bee(e,t,n){const{messageId:o}=t,{partId:s,parentPartId:a,component:r}=n;Ne(e,i=>{const d=nt({history:i,messageId:o});if(d){if(a===null){const p=yu.createRootTree(s,r);if(!p.success){En({...p.error,messageId:o});return}p.value.startTime=performance.now(),d.content.push(p.value);return}const m=Nd(d.content,a);if(!m){En({errorType:"partStartUnknownParentPartId",errorMessage:"partStart event with unknown parentPartId",messageId:o});return}if(m.completed){En({errorType:"partStartItemAlreadyCompleted",errorMessage:"partStart event of uiComponent for generativeUI item that is already completed",messageId:o});return}if(m.partIdToPath[a]!==void 0){const p=yu.addChildNode(m,a,r);p.success?m.partIdToPath[s]=p.value.path:En({...p.error,messageId:o})}else En({errorType:"partStartNotFound",errorMessage:"part start not found",messageId:o})}})}function Vee(e,t,n){const{messageId:o}=t,{partId:s,parentPartId:a,text:r}=n;a&&Ne(e,i=>{const d=nt({history:i,messageId:o});if(d){const m=Nd(d.content,a);if(!m){En({errorType:"textPartStartUnknownParentPartId",errorMessage:"text partStart event with unknown parentPartId",messageId:o});return}if(m.completed){En({errorType:"textPartStartItemAlreadyCompleted",errorMessage:"text partStart event for generativeUI item that is already completed",messageId:o});return}const p=m.rootNode&&m.partIdToPath[a]&&Rd(m.rootNode,m.partIdToPath[a]);if(!p){En({errorType:"textPartStartInvalidParentPath",errorMessage:"text partStart event with invalid parentPartId path",messageId:o});return}if(p.type!=="Text"&&p.type!=="Markdown"){En({errorType:"textPartStartNonTextParent",errorMessage:"text partStart event for non-Text parent node",messageId:o});return}p.props.value=r,m.partIdToPath[s]=m.partIdToPath[a]}})}function Hee(e,t){const{messageId:n,text:o,partId:s}=t;let a=!1;return Ne(e,r=>{const i=nt({history:r,messageId:n});if(i){const d=Nd(i.content,s);if(!d)return;if(a=!0,d.completed){En({errorType:"appendTextItemAlreadyCompleted",errorMessage:"appendText event for generativeUI item that is already completed",messageId:n});return}const m=d.partIdToPath[s];if(!m){En({errorType:"appendTextPartIdNotFound",errorMessage:"appendText event with partId not found in partIdToPath",messageId:n});return}const p=d.rootNode&&Rd(d.rootNode,m);if(!p){En({errorType:"appendTextInvalidPath",errorMessage:"appendText event with invalid path",messageId:n});return}if(p.type!=="Text"&&p.type!=="Markdown"){En({errorType:"appendTextNonTextNode",errorMessage:"appendText event for non-Text node",messageId:n});return}if(p.props.streaming===!1){En({errorType:"appendTextNonStreamingTextNode",errorMessage:"appendText event for non-streaming Text node",messageId:n});return}p.props.value+=o}}),a}function zee(e,t){const{messageId:n,text:o,partId:s}=t;let a=!1;return Ne(e,r=>{const i=nt({history:r,messageId:n});if(i){const d=Nd(i.content,s);if(!d)return;a=!0;const m=d.partIdToPath[s];if(!m)return;const p=d.rootNode&&Rd(d.rootNode,m);if(!p||p.type!=="Text")return;p.props.value=o}}),a}function Gee(e,t,n){if(e.completed=!0,e.startTime!==void 0){const o=Math.round(performance.now()-e.startTime);R.trackEvent({name:"system",data:{eventName:"copilotResponseRender",eventInfo_scenario:"GenUIRender",eventInfo_conversationId:t,eventInfo_messageId:n,eventInfo_duration:o}}),delete e.startTime}}function Wee(e,t,n){t.partId===n&&(e.content=e.content.filter(s=>s!==t))}function Nd(e,t){return e.find(n=>n.type==="generativeUI"&&(n.partId===t||n.partIdToPath[t]!==void 0))}function $ee(e){const{artifacts:t}=e;return t.find(n=>n.type==="browser")}function qee(e,t,n,o={text:"",atTimestamp:0,files:[]}){return n?t.length!==o.files.length?!0:!!!(e&&e.length>=n.minTextLength)||o.atTimestamp&&o.atTimestamp+n.debounceInMilliseconds>=Date.now()?!1:e&&o.text&&(e.includes(o.text)||o.text.includes(e))?Math.abs((e.length-o.text.length)/o.text.length)>=n.textDeltaPercent/100:!0:!1}function awe(e){let t,n;for(let o=e.length-1;o>=0;o-=1){const s=e[o];if(s?.author!=="system")if(!t)t=s;else{n=s;break}}return{lastNonSystemMessage:t,secondToLastNonSystemMessage:n}}_(null);const zC=_(new Map),jA=_(null),Kee=_(!1),Ts=_(null),zc=_(e=>{const t=e(Ts);return t?.type==="attachments"?t.uploadAttachments:[]},(e,t,n)=>{const o=e(Ts),s=e(zc),a=typeof n=="function"?n(s):n;a.length===0&&o?.type!=="attachments"||t(Ts,{type:"attachments",uploadAttachments:a})}),wo=_(e=>{const t=e(Ts);return t?.type==="tabs"?t.userAddedTabs:new Map},(e,t,n)=>{const o=e(Ts),s=e(wo),a=typeof n=="function"?n(s):n;a.size===0&&o?.type!=="tabs"||t(Ts,{type:"tabs",userAddedTabs:a})}),BA=_(e=>{const t=e(Ts);return t?.type==="attachments"&&t.uploadAttachments.length>0}),Yee=_(e=>{const t=e(Ts);if(t?.type!=="tabs"||t.userAddedTabs.size===0)return!1;for(const n of t.userAddedTabs.values())if(n.sourceType==="journeysNTP")return!1;return!0});function Zee(){const e=B(jT);if(e)return{character:{id:e.id,locationId:e.location?.id}}}const xr=_(null);function Jee(){if(cA()?.type!=="map")return;const t=B(xr);if(!t?.map)return;const{map:n,activeLayerId:o,layers:s}=t;try{const a=!t.isInitialMapContextSent,{center:r,zoom:i,bearing:d,pitch:m,bounds:p}=n.getView();return{center:r,zoom:i,bounds:p,bearing:d,pitch:m,isNewMap:a,activeLayerId:o,points:a?s[0]?.pushpins?.map(h=>({coordinate:{latitude:h.latitude,longitude:h.longitude},label:h.title})):void 0,label:a?s[0]?.name:void 0}}catch{return}}function Qee(){const e=B(xr);e&&Ee(xr,{...e,isInitialMapContextSent:!0})}function VA(){const e=Nh(bt),t=G(md);return l.useCallback((n,o)=>{e(s=>{const a=s.get(n);if(a){const{history:r}=a;o(r);const i=r.at(-1);if(i){const d=new Date(a.updatedAt),m=new Date(i.createdAt);d<m&&(a.updatedAt=i.createdAt)}r.length>2&&(a.isNew=!1,t(!0))}return s})},[e,t])}const Xee=ke();function HA(e,t){ke().set(bt,n=>Xt(n,o=>{const s=o.get(e);if(s){const{history:a}=s;t(a);const r=a.at(-1);if(r){const i=new Date(s.updatedAt),d=new Date(r.createdAt);i<d&&(s.updatedAt=r.createdAt)}a.length>2&&(s.isNew=!1,Xee.set(md,!0))}}))}function Ld(e){const t=q("force-cookie-banner-location");return(e&&Zu.includes(e))===!0||t}const ete=5e3,tte="largest-contentful-paint";function nte(e,t=ete){if(!ote())return If(e,t);try{return ate(e,t)}catch{return If(e,t)}}function ote(){return"PerformanceObserver"in window}function If(e,t){const n=setTimeout(e,t);return()=>clearTimeout(n)}function ste(e){typeof window.requestIdleCallback<"u"?window.requestIdleCallback(e):setTimeout(e,0)}function ate(e,t){let n=!1;const o=new PerformanceObserver(i=>{if(n)return;i.getEntries().length>0&&a()});try{o.observe({type:tte,buffered:!0})}catch{return If(e,t)}const s=setTimeout(()=>{n||a()},t);function a(){n=!0,o.disconnect(),ste(e)}function r(){n||(n=!0,o.disconnect(),clearTimeout(s))}return r}function rte(){const e=it("kill-bing-uet"),t=M(Bt),n=Ld(t);l.useEffect(()=>{const o=Ia(),s=!!kh(),a=n?s&&o.advertising:!0;if(e||!a||!t)return;const r=document.createElement("script");r.src="https://bat.bing.com/bat.js",r.defer=!0,r.onload=()=>{if(!window.UET)return;window.uetq=window.uetq??[];const m={ti:"355045625",enableAutoSpaTracking:!0};window.uetq=new window.UET(m),window.uetq.push("pageLoad")};const d=nte(()=>{document.querySelector('script[src="https://bat.bing.com/bat.js"]')||document.head.appendChild(r)});return()=>{d();try{const m=document.querySelector('script[src="https://bat.bing.com/bat.js"]');m&&document.head.removeChild(m)}catch{}}},[e,t,n])}let GC=!1;function ite(){GC||(GC=!0,window.uetq=window.uetq??[],window.uetq.push("event","outbound_click",{}))}const WC="/static/cmc/assets/smart-plus-C84sN6Eu.svg",cte="/static/cmc/assets/smart-nS7kuhS0.svg";function zA(e){return e?e.startsWith("!"):!1}function lte(){return W("smart-mode-52-dropdown")&&!W("smart-mode-52")}function GA(){let e=[...yg];const t=new Set;return lte()||t.add("smart-latest"),W("remove-qr")&&t.add("chat"),Dc()&&e.push("analyst"),e=e.filter(n=>!t.has(n)),e}function ute(e){return GA().includes(e)?e:null}function WA(){const e=Pn("sticky-conversation-mode");return e?ute(e):null}function Ef(e){const t=W("smart-mode-51"),n=W("smart-mode-52"),s=W("smart-mode-52-dropdown")&&!n,a=[{label:t?wR:TR,color:"neutral"}],r={label:AR,color:s?"accent":"neutral"},i={label:F("composer.chatModes.smart-latest.newTag"),color:"accent"};return n?{title:fy,tags:[r],description:F("composer.chatModes.smart-latest.description"),icon:WC}:e==="smart-latest"?{title:fy,tags:[r,i],description:F("composer.chatModes.smart-latest.description"),icon:WC}:{title:ER,tags:a,description:F("composer.chatModes.smart.description"),icon:cte}}function dte(e){return e==="smart"||e==="smart-latest"?Ef(e).title:F(`composer.chatModes.${e}.title`)}function mte(e){Lt({scenario:"sideBySideMessages",page:"chat",customData:JSON.stringify({eventInfo_event:"receivedSxsEvent",eventInfo_sideBySideComparisonId:e})})}function pte(e){const{sideBySideComparisonId:t,reason:n}=e;Lt({scenario:"sideBySideMessages",page:"chat",customData:JSON.stringify({eventInfo_event:"skippedSxsMessages",eventInfo_sideBySideComparisonId:t,eventInfo_skippedReason:n})})}function fte(e){const{sideBySideComparisonId:t,sideBySideConfig:n}=e,{position:o,isDefault:s}=n;de({pageName:"chat",sectionName:"sideBySideMessages",source:"selectedSxs",customData:JSON.stringify({eventInfo_sideBySideComparisonId:t,eventInfo_position:o,eventInfo_isControlMessage:s})})}function $A(e){const{sideBySideComparisonId:t,reason:n}=e;de({pageName:"chat",sectionName:"sideBySideMessages",source:"defaultedSxs",customData:JSON.stringify({eventInfo_sideBySideComparisonId:t,eventInfo_defaultReason:n})})}const Dd=24e3,qA=24e3,hte=1;function gte(e){const t=atob(e),n=t.length,o=new Uint8Array(n);for(let s=0;s<n;s+=1)o[s]=t.charCodeAt(s);return o.buffer}function vte(e){const t=gte(e),n=new Int16Array(t),o=new Float32Array(n.length);for(let s=0;s<n.length;s+=1)o[s]=n[s]/32768;return o}function yte(e){let t=0;for(const n of e){const o=n-128;t+=o*o}return Math.sqrt(t/e.length)}function KA(e){return e/yc}function rwe(e){return`${KA(e)}x`}function iwe(e,t){const n=document.createElement("a");n.href=e,n.download=t,document.body.appendChild(n),n.click(),document.body.removeChild(n)}function cwe(e){const t=Math.floor(e/60),n=e%60;return`${t}:${n.toString().padStart(2,"0")}`}function $C(e,t){Ce.emit(`voice:audio-${t}-volume-changed`,e)}function Od(){return/firefox/i.test(navigator.userAgent)}function Cte(e){let t="";const n=new Uint8Array(e),o=n.byteLength;for(let s=0;s<o;s+=1){const a=n[s];typeof a=="number"&&(t+=String.fromCharCode(a))}return btoa(t)}function Ste(e){const t=e<0?e*32768:e*32767;return Math.max(-32768,Math.min(32767,t))}function lwe(e){const t=new Float32Array(e.length);for(let n=0;n<e.length;n+=1){const o=e[n]??0;t[n]=o<0?o/32768:o/32767}return t}function bte(e,t,n){if(t===n)return e;const o=e.length,s=t/n,a=Math.ceil(o/s),r=new Float32Array(a);for(let i=0;i<a;i+=1){const d=i*s,m=Math.floor(d),p=m+1,h=e[m]??0,g=e[p]??0,y=d-m;r[i]=h*(1-y)+g*y}return r}const Ite=new URL("send-base64-processor-PybYkP9T.js",import.meta.url).href;function YA(e,t){t(e),W("voice-upload-diagnostic-audio")&&N(async()=>{const{AUDIO_RECORDER:o}=await Promise.resolve().then(()=>fr);return{AUDIO_RECORDER:o}},void 0).then(({AUDIO_RECORDER:o})=>{o.recordEvent({event:"userAudio",audio:e})})}function ZA(){let e=8192;return W("audio-buffer-size-4096")?e=4096:W("audio-buffer-size-2048")&&(e=2048),e}function Ete(e,t){const n=ZA(),o=e.createScriptProcessor(n,1,1);return o.onaudioprocess=s=>{let a=s.inputBuffer.getChannelData(0);Od()&&(a=bte(a,e.sampleRate,Dd));const r=new Int16Array(a.length);for(let d=0;d<a.length;d+=1){const m=a[d];typeof m=="number"&&(r[d]=Ste(m))}const i=Cte(r.buffer);YA(i,t)},{processor:o,cleanup:()=>{o.onaudioprocess=null}}}async function Tte(e,t){const n=ZA();try{await e.audioWorklet.addModule(Ite)}catch(r){throw Je({feature:"audio-capture-worklet",scenario:"addModule-failed",errorType:"WorkletModuleLoadError",errorMessage:r instanceof Error?r.message:"Unknown error"}),r}const o=new AudioWorkletNode(e,"send-base64-processor",{processorOptions:{bufferSize:n,shouldResampleAudio:Od(),inputSampleRate:e.sampleRate,targetSampleRate:Dd}}),s=new Worker(new URL("/static/cmc/assets/audio-base64.worker-C9NDBjTp.js",import.meta.url),{type:"module"});return s.onerror=r=>{Je({feature:"audio-capture-worklet",scenario:"worker-error",errorType:"WorkerError",errorMessage:r.message||"Audio worker error"})},o.port.onmessage=r=>{const i=r.data;s.postMessage(i,[i])},s.onmessage=r=>{const i=r.data;YA(i,t)},{processor:o,cleanup:()=>{o.port.onmessage=null,s.onmessage=null,s.onerror=null,s.terminate(),o.disconnect()}}}const wte="AUDIO_CANCELLED_ERROR";class JA extends Error{constructor(){super("Audio capture was cancelled"),this.name=wte}}async function Ate(e,t,n){const o=e&&await e(),s=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,voiceIsolation:!0,autoGainControl:!0,sampleRate:Od()?void 0:Dd,...o}});if(n?.()){for(const r of s.getTracks())r.stop();throw new JA}const a=s.getAudioTracks()[0];return a&&(a.onended=r=>{t?.(r)}),s}function xte(e,t){const n=typeof e=="string"?vte(e):e,o=t.createBuffer(1,n.length,qA);o.getChannelData(0).set(n);const s=t.createBufferSource();return s.buffer=o,s}async function _te(e,t,n,o,s,a){const r=await Ate(o,s,a),d=typeof t.audioWorklet<"u"&&W("enable-audio-capture-worklet");Lt({page:"audio-capture-stream",scenario:d?"worklet":"script-processor"});const m=d?await Tte(t,e):Ete(t,e),{processor:p,cleanup:h}=m,g=t.createMediaStreamSource(r);return g.connect(n),n.connect(p),p.connect(t.destination),{stream:r,cleanup:()=>{h(),g.disconnect(),n.disconnect(),p.disconnect()}}}async function qC(e,t){(await Promise.race([ju(t),new Promise(o=>{try{const s=new Audio(e);s.addEventListener("ended",()=>o(s),{once:!0}),s.play()}catch{}})]))?.remove()}function kte(e,t){switch(t){case"time-expired":return{title:e("voice.v2.timeExpiredProHeading"),subtitle:e("voice.v2.timeExpiredProSubheading")};case"throttled":return{title:e("voice.v2.throttledHeadingV2"),subtitle:e("voice.v2.throttledSubheadingV2")};case"error":default:return{title:e("voice.v2.errorHeading"),subtitle:e("voice.v2.errorSubheading")}}}function Pte(e){if(!e)return!0;switch(e.category){case"server-terminated":return!["time-expired","throttled","inactivity"].includes(e.detail);default:return!0}}async function QA(){try{return(await navigator.permissions.query({name:"microphone"})).state}catch{return"unsupported"}}async function Mte(){try{const e=await navigator.mediaDevices.getUserMedia({audio:!0});for(const t of e.getTracks())t.stop();return{state:"granted"}}catch(e){return e instanceof Error&&(e.name==="NotAllowedError"||e.name==="NotSupportedError")?{state:"denied",errorType:"no_permission",errorMessage:e.message}:e instanceof Error&&(e.name==="NotFoundError"||e.name==="OverconstrainedError")?{state:"denied",errorType:"no_microphone_found",errorMessage:e.message}:{state:"denied",errorType:"other_start_fail",errorMessage:e instanceof Error?e.message:String(e)}}}async function XA(e){switch(await QA()){case"granted":return{state:"granted"};case"denied":return{state:"denied",errorType:"no_permission",errorMessage:"Microphone permission denied."};case"prompt":case"unsupported":return e?.onPrompt&&e.onPrompt(),await Mte();default:return{state:"denied",errorType:"no_permission"}}}const ex="4";class Rte extends Error{constructor(){super("User subscription fields were not updated after retries"),this.name="USER_SUBSCRIPTION_FIELDS_NOT_UPDATED"}}class Nte extends Error{constructor(){super("User profile not valid"),this.name="USER_PROFILE_NOT_VALID"}}async function E1(){return pt("/user",u5,{parseOptions:{safe:!0},query:{"api-version":ex}}).then(e=>e.data)}function Lte(e,t){const n=!e||e.length===0,o=!t||t.length===0;if(n&&o)return!0;if(n||o)return!1;const s=(a,r)=>a.channel.localeCompare(r.channel)||a.tier.localeCompare(r.tier);return JSON.stringify([...e].sort(s))===JSON.stringify([...t].sort(s))}async function tx(e){R.setSettings({userConsentModelTraining:!e.optOutOfTraining,userConsentPersonalization:!e.optOutOfPersonalization,userSettingPhoneConnection:!e.optOutOfPhoneConnection,userSettingComputerUseActions:e.allowComputerUseActions,userSettingGenUI:!e.optInToGenerativeUI}),await Nt({path:"/user/settings",args:{options:{method:"PATCH"},query:{"api-version":"2"},body:{toggles:{training:e.optOutOfTraining!==void 0?!e.optOutOfTraining:void 0,personalization:e.optOutOfPersonalization!==void 0?!e.optOutOfPersonalization:void 0,"phone-connection":e.optOutOfPhoneConnection!==void 0?!e.optOutOfPhoneConnection:void 0,"voice-training":e.optInToVoiceTraining,"biometric-data-use":e.allowBiometricDataUse,"browser-cookies":e.allowBrowserCookies,"microsoft-profile-access":e.allowMicrosoftProfileAccess,"one-drive-access":e.allowOneDriveAccess,"computer-use-actions":e.allowComputerUseActions,allowOutlookAccess:e.allowOutlookAccess,allowEdgePasswordsAccess:e.allowEdgePasswordsAccess,optInToGenerativeUI:e.optInToGenerativeUI}}}})}function nx(e){const t=ke();t.set(vd,e.remainingUsage?.podcastGenerations??null),t.set(yd,e.remainingUsage?.researchCalls??null),t.set(Cd,e.remainingUsage?.videoGenerations??null)}async function Dte(){const e=await E1();nx(e)}const Ote=6,Ute=2e3,Fte=.1;async function jte(e={}){const{maxRetries:t=Ote,retryDelayMs:n=Ute,jitterFactor:o=Fte}=e,s=B(vt);if(!s)throw new Nte;const a=await ya(async()=>{const i=await E1();if(!!Lte(i.subscriptions,s.subscriptions))throw new Rte;return i},{maxRetries:t,initialDelayMs:n,maxDelayMs:n*(1+o),backoffFactor:1,jitterFactor:o});ke().set(vt,i=>i&&{...i,accountTier:a.accountTier??null,subscriptions:a.subscriptions??null}),nx(a),R.setSettings({accountTier:a.accountTier??"free",activeSubscriptions:a.subscriptions?.map(i=>i.tier).join(",")??""})}const Xn=_(null),KC=_(!1),vl=_("close"),Ci=_(!1),Bte=_(!1),uwe=_(null);class T1{static instance;sessionStartTime=0;firstContextTime=0;currentConversationId="";currentSessionId="";contextRequestCount=0;screenIdCount=0;static getInstance(){return this.instance??=new T1,this.instance}onBeforeStartSession(){this.sessionStartTime=performance.now()}onStartSession(t){this.currentConversationId=t,this.currentSessionId=crypto.randomUUID(),this.contextRequestCount=0,this.screenIdCount=0,this.firstContextTime=0,R.trackEvent({name:"system",data:{eventName:"visionSessionStart",eventInfo_conversationId:this.currentConversationId,eventInfo_duration:this.getDuration(this.sessionStartTime),eventInfo_customData:this.getCustomData()}})}onStartSessionFailed(t,n){R.trackEvent({name:"system",data:{eventName:"visionSessionStartFailed",eventInfo_conversationId:this.currentConversationId,eventInfo_reason:t,eventInfo_duration:this.getDuration(this.sessionStartTime),eventInfo_customData:this.getCustomData({shareType:n})}})}onContextRequested(){this.isSessionActive()&&(this.contextRequestCount+=1,R.trackEvent({name:"system",data:{eventName:"visionContextRequested",eventInfo_conversationId:this.currentConversationId,eventInfo_customData:this.getCustomData({requestCount:this.contextRequestCount})}}))}onContextReceived(t){this.isSessionActive()&&(this.screenIdCount=t,this.firstContextTime||(this.firstContextTime=performance.now(),R.trackEvent({name:"system",data:{eventName:"visionFirstContextReceived",eventInfo_conversationId:this.currentConversationId,eventInfo_duration:this.getDuration(this.sessionStartTime),eventInfo_customData:this.getCustomData({screenIdCount:t})}})),R.trackEvent({name:"system",data:{eventName:"visionContextReceived",eventInfo_conversationId:this.currentConversationId,eventInfo_customData:this.getCustomData({screenIdCount:t,requestCount:this.contextRequestCount})}}))}onContextCleared(t){this.isSessionActive()&&R.trackEvent({name:"system",data:{eventName:"visionContextCleared",eventInfo_conversationId:this.currentConversationId,eventInfo_customData:this.getCustomData({clearedScreenIdCount:t})}})}onStaleScreenIdsCleared(t){t!==0&&R.trackEvent({name:"system",data:{eventName:"visionStaleScreenIdsCleared",eventInfo_conversationId:this.currentConversationId,eventInfo_customData:this.getCustomData({staleCount:t})}})}onEndSession(){if(!this.currentSessionId)return;const t=this.getDuration(this.sessionStartTime);R.trackEvent({name:"system",data:{eventName:"visionSessionEnd",eventInfo_conversationId:this.currentConversationId,eventInfo_duration:t,eventInfo_customData:this.getCustomData({contextRequestCount:this.contextRequestCount,screenIdCount:this.screenIdCount,timeToFirstContext:this.firstContextTime?Math.round(this.firstContextTime-this.sessionStartTime):void 0})}}),this.currentSessionId="",this.sessionStartTime=0,this.firstContextTime=0,this.currentConversationId="",this.contextRequestCount=0,this.screenIdCount=0}onError(t,n){R.trackEvent({name:"system",data:{eventName:"visionSessionError",eventInfo_conversationId:this.currentConversationId,eventInfo_errorCode:t,eventInfo_errorMessage:n,eventInfo_duration:this.getDuration(this.sessionStartTime),eventInfo_customData:this.getCustomData()}})}getCurrentSessionId(){return this.currentSessionId}isSessionActive(){return B(Xn)!==null}getShareType(){return B(Xn)?.shareType??null}getDuration(t){if(!(!Number.isFinite(t)||t<0))return Math.round(performance.now()-t)}getCustomData(t){return JSON.stringify({visionSessionId:this.currentSessionId,shareType:this.getShareType(),...t})}}const ln=T1.getInstance();class Vte{screenIds=[];pendingStatePreviousPath=null;async enterPendingState(t){this.pendingStatePreviousPath??=Nn().state.location.pathname,t?(Ee(Ci,!0),Ee(Yt,"dismiss-audio-call-only"),await to({talkType:"vision"})):await to()}async exitPendingState(t={}){const{navigateBack:n=!1}=t,o=this.pendingStatePreviousPath;if(this.pendingStatePreviousPath=null,o&&Ee(Yt,null),n&&o){const s=Nn().state.location.pathname;try{await qn({to:o,from:s})}catch{}finally{Ee(Ci,!1)}}else Ee(Ci,!1)}async notifyBrowserSessionEnded(){try{(await ar.run({})).onEndSession?.()}catch{}}async onPermissionDenied(t){Ee(Xn,null),t&&await this.exitPendingState({navigateBack:!0}),await this.notifyBrowserSessionEnded()}async tryRequestMicrophonePermission(t){return(await XA()).state!=="granted"?(await this.onPermissionDenied(t),!1):!0}async checkAndRequestPermissionIfNeeded(t,n){if(!t)return{shouldContinue:!0,enteredPendingState:!1,browserNotified:!1};const o=await QA();let s=!1;switch(o){case"denied":return ln.onStartSessionFailed("permission_denied",n),await this.onPermissionDenied(s),{shouldContinue:!1,enteredPendingState:s,browserNotified:!0};case"prompt":if(s=!0,await this.enterPendingState(t),!await this.tryRequestMicrophonePermission(s))return ln.onStartSessionFailed("permission_not_granted",n),{shouldContinue:!1,enteredPendingState:s,browserNotified:!0};break;case"unsupported":if(!await this.tryRequestMicrophonePermission(s))return ln.onStartSessionFailed("permission_not_granted",n),{shouldContinue:!1,enteredPendingState:s,browserNotified:!0};break}return{shouldContinue:!0,enteredPendingState:s,browserNotified:!1}}async startSession(t){ln.onBeforeStartSession();const n=await zte(),o=n!==null&&n<=0;Ee(Xn,{screenName:t.screenName,shareType:t.shareType,screenIcon:t.screenIcon,limitReached:o});let s=!1;try{const a=await this.checkAndRequestPermissionIfNeeded(t.startWithVoice,t.shareType);if(s=a.enteredPendingState,!a.shouldContinue)return{success:!1,browserNotified:a.browserNotified};s?await this.exitPendingState():t.startWithVoice?await to({talkType:"vision"}):await to();const r=B(Te)??"";ln.onStartSession(r)}catch(a){Ee(Xn,null),s&&await this.exitPendingState({navigateBack:!0});const r=a instanceof Error?a.message:"Unknown error";return ln.onStartSessionFailed(r,t.shareType),{success:!1,browserNotified:!1}}return{success:!0,browserNotified:!1}}async getContext(){const t=B(Xn);if(t&&!t.limitReached){ln.onContextRequested();try{const o=await(await ar.run({})).getContext?.();if(o)return this.addClearContextPartsForStaleScreenIds(o),ln.onContextReceived(this.screenIds.length),o}catch(n){const o=n instanceof Error?n.message:"Unknown error";return ln.onError("GET_CONTEXT_FAILED",o),null}}return null}async endSession(t={}){const{notifyBrowser:n=!0,shouldNavigate:o=!0}=t,s=B(Xn);try{return t.reason?.category==="client-restarted"?!1:(n&&(await ar.run({})).onEndSession?.(),s?(ln.onEndSession(),await this.clearContext(),Ee(Xn,null),await this.exitPendingState(),o&&await to(),!0):(await this.exitPendingState(),!1))}catch(a){const r=a instanceof Error?a.message:"Unknown error";throw ln.onError("END_SESSION_FAILED",r),a}}async dropVisionToVoice(){try{await this.clearContext(),ln.onEndSession()}catch(t){const n=t instanceof Error?t.message:"Unknown error";throw ln.onError("VISION_DROPPED_TO_VOICE_FAILED",n),t}}async clearContext(){if(this.screenIds.length===0)return;const t=this.screenIds.length,n=await wn(),o=YC(this.screenIds);n.sendContext(o),this.screenIds=[],ln.onContextCleared(t)}addClearContextPartsForStaleScreenIds(t){const n=Hte(t),o=this.screenIds.filter(s=>!n.has(s));if(this.screenIds=Array.from(n),o.length>0){const s=YC(o);t.push(...s),ln.onStaleScreenIdsCleared(o.length)}}async forceCleanup_wchromiumOnly(){try{(await ar.run({})).onEndSession?.()}catch{}try{await this.clearContext()}catch{}this.screenIds=[],Ee(Xn,null),B(Yt)==="dismiss-audio-call-only"&&Ee(Yt,null),Ee(Ci,!1),this.pendingStatePreviousPath=null}}function YC(e){return e.map(t=>({type:"clearWindowContext",windowId:t}))}function Hte(e){const t=e.filter(n=>n.type==="appScreenshot").map(n=>n.windowId).filter(n=>n!==void 0);return new Set(t)}async function zte(){try{return(await E1()).remainingUsage?.visionCallSeconds??null}catch{return null}}const Si=new Vte,nr=ke(),ZC={};async function ox(e,t){const{text:n,filesWithAttachment:o=[],command:s}=e,a=co(),r=B(Te),i=typeof n=="string"?n:n?.plainText,{shouldDrop:d}=await Q$.run({chatMode:a,message:i??"",isSubmit:t}),m=o.length===0||o.every(({error:b,attachment:C})=>!!b||!C),p=W("discover-feed-v3");return{isSubmittable:!!r&&!(!n&&m&&!s&&!p),shouldDropAccordingToMiddleware:!!d}}async function sx(e,t=!1){const{text:n,filesWithAttachment:o=[],inputMethod:s,command:a,context:r,reference:i,galleryImageUrl:d}=e,m=Zee(),p=co(),h=B(Te),g=B(Hn),y=B(wo),b=W("adsshowroombrandagent");if(!h)throw new Error("No conversation ID found");const C=await Si.getContext();let T=0,S=0;const E=[];if(d){const U=Qte(d);E.push(U)}for(const U of o)U.attachment&&(U.attachment.item.type==="image"?(T+=1,U.attachment.item.fileName=U.file?.name??""):U.attachment.item.type==="document"&&(U.attachment.item.partId=`${S}`,S+=1),E.push(U));const I=[],x={id:"",createdAt:new Date().toISOString(),author:"human",content:[],inputMethod:s,mode:p,conversationId:h};g&&g.conversationId===h&&(x.brand=g);for(const{attachment:U}of E)U&&(x.content.push(U.item),I.push(U.content));if(y.size>0&&(B(jA)==="currentPage"?nr.set(wo,new Map):x.content.push({type:"browserTabs",tabs:Array.from(y.values()).map($=>({id:$.id,title:$.title,url:$.url,windowId:$.windowId,favIconUrl:$.favIconUrl}))})),n&&typeof n=="string"){x.content.push({type:"text",text:n});let{textToSend:U}=await X$.run({textToSend:n,chatMode:p});y.size>0&&!U.startsWith("/")&&(U=`${F("composer.multiTabs.multitabsprompt",{CountOfAddTabs:y.size})} ${U}`),I.push({type:"text",text:U})}n&&typeof n!="string"&&(I.push(...n.textWithReferences),x.content.push(...n.textWithReferences.map(U=>U.type==="text"?U:{type:"reference",content:U.reference}))),a&&(x.content.push({type:"command",command:a}),I.push({type:"command",command:a})),i&&I.push({type:"reference",reference:i}),!(a&&Q([rd,Ta,YI]).safeParse(a.type).success)&&!t&&HA(h,U=>{U.push(x)});const{sendData:P,additionalData:D}=await pw.run(x),L=Jee();return{sendMessageParams:{content:I,conversationId:h,data:P,mode:p,context:{...m,...r,ads:g?{showroom:{brandId:g.brandId,adId:g.adId??void 0,scenario:b?"chat":void 0}}:void 0,...L&&{map:L}}},newMessage:x,filesToSubmit:E,additionalData:D,imagesUploaded:T,documentsUploaded:S,visionContext:C}}async function Gte(e){const{text:t,inputMethod:n,scenario:o,customData:s,entryPoint:a,connectionType:r,messageStartTime:i=performance.now(),pingCheck:d}=e,m=co(),p=B(Te),h=B(Hn),g=B(wo),y=B(zC),{isSubmittable:b,shouldDropAccordingToMiddleware:C}=await ox(e,!0);if(C){m==="computerUse"&&hn(Ft());return}const T=performance.now();if(nr.set(sT,T),!b||!p)return;n1.run({inputMethod:n}),$A({sideBySideComparisonId:p,reason:"sentNewMessage"}),v1(p);const S=crypto.randomUUID(),E=await sx(e);await D$.run(E.newMessage),nr.set(Hn,P=>P&&{...P,lastUserMessageRguid:P.activeCardRguid});const I={eventName:"copilotCompose",eventInfo_conversationId:p,eventInfo_inputMethod:n,eventInfo_numImagesUploaded:E.imagesUploaded,eventInfo_numDocumentsUploaded:E.documentsUploaded,eventInfo_mode:m,eventInfo_landingPage:R.getLandingPage(),...E.filesToSubmit.length>0?{eventInfo_uploadFileSize:E.filesToSubmit[0]?.file?.size??0,eventInfo_uploadFileType:E.filesToSubmit[0]?.attachment?.type}:{}};if(I.eventInfo_uploadFilesInfo=JSON.stringify(E.filesToSubmit.map(({file:P,attachment:D,scenario:L})=>({scenario:L,type:D?.type??"",size:P?.size??""}))),E.additionalData&&(I.eventInfo_additionalData=E.additionalData),o&&(I.eventInfo_scenario=o),s){const P=JSON.parse(s);I.eventInfo_customData=JSON.stringify({...P,queryId:S,eventInfo_isGroup:uu()?1:0})}else I.eventInfo_customData=JSON.stringify({queryId:S,eventInfo_isGroup:uu()?1:0});h&&(I.eventInfo_adsContext=JSON.stringify({showroomBrandId:h.brandId,showroomBrandName:h.brandLogo?.businessName})),a&&(I.eventInfo_entryPoint=a),R.trackEvent({name:"interaction",data:I}),R.flush();const x=await wn({useMockConnection:zA(typeof t=="string"?t:t?.plainText),connectionType:r}),w=x.status();w.readyState!==WebSocket.OPEN&&R.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"WebSocketNotOpen",eventInfo_inputMethod:n,eventInfo_mode:m,eventInfo_details:JSON.stringify(w)}}),g.size>0&&nr.set(wo,new Map),y.size>0&&(nr.set(zC,new Map),nr.set(jA,null)),E.visionContext&&E.visionContext.length>0&&x.sendContext(E.visionContext,p),x.send(E.sendMessageParams),d&&x.sendPing(),E.sendMessageParams.context?.map?.isNewMap&&Qee(),x.resetConversationState(p,i,performance.now()),x.setChatModeForConversation(p,m),x.setInputMethodForConversation(p,n),x.setUploadCountsForConversation(p,E.imagesUploaded,E.documentsUploaded),x.callBeforeSendForConversation(p,S),x.callOnSentForConversation(p,E.additionalData),x.setUserMessageForConversation(p,E.sendMessageParams),ite(),_q(n),m==="computerUse"&&hn(Ft())}async function Wte(e){const t=B(Te);t&&(await wn({connectionType:e?.connectionType})).onSubmitMessageBlocked(t)}async function $te(e){const t=await wn({connectionType:e?.connectionType}),n=B(Te),o=nA(n)?.part.task?.id;n&&(v1(n),$A({sideBySideComparisonId:n,reason:"stoppedMessage"})),t.stop({conversationId:n,taskId:o})}async function qte(e){const{messageId:t,runHumanMessageSendDataMiddleware:n,connectionType:o}=e,s=performance.now(),a=B(Te);if(!a)return;HA(a,m=>{const p=pr(m);p&&p.id===t&&m.pop()});let r={...e};if(n){const m=SY(a);if(m){const{sendData:p}=await pw.run({id:m.id,createdAt:m.createdAt,author:m.author,content:m.content,mode:m.mode,conversationId:a});p&&(r={...r,...p})}}const i=crypto.randomUUID();R.trackEvent({name:"interaction",data:{eventName:"copilotRegenerate",eventInfo_conversationId:a,eventInfo_messageId:t,eventInfo_mode:r.mode,eventInfo_entryPoint:r.entry,eventInfo_customData:JSON.stringify({queryId:i})}}),R.flush();const d=await wn({connectionType:o});n1.run({inputMethod:"text"}),d.regenerate(r),d.resetConversationTiming(a,s,performance.now()),d.setChatModeForConversation(a,co()),d.callBeforeSendForConversation(a,i)}async function Kte(e){const{text:t,filesWithAttachment:n=[]}=e,o=B(Te),s=B(cT),{isSubmittable:a}=await ox(e,!1);if(!a||!o)return;const r=typeof t=="string"?t:t?.plainText;if(qee(r??"",n,s,ZC[o])){const d=await wn({useMockConnection:zA(r)}),m=await sx(e,!0);d.sendMessagePreview(m.sendMessageParams),ZC[o]={text:r??"",atTimestamp:Date.now(),files:n}}}async function Yte(e){(await wn()).selectSxSMessage(e)}async function Zte(e){const t=B(Te);if(!t)return;const{messageId:n,partId:o,connectionType:s,update:a}=e,r=await wn({connectionType:s}),i=co();let d;switch(a?.type){case"discardCalendarEvent":d={type:"discardCalendarEvent"};break;default:d={type:"consent",status:"rejected"};break}r.send({conversationId:t,mode:i,content:{type:"command",command:{type:"updateCard",messageId:n,partId:o,update:d}}})}async function Jte(e){await wn({connectionType:e?.connectionType})}const Wo={connect:Jte,submitMessage:Gte,stopMessage:$te,onSubmitMessageBlocked:Wte,regenerateMessage:qte,sendMessagePreview:Kte,selectSideBySideMessage:Yte,updateCardMessageCommand:Zte};function dwe(e,t){return e.find(n=>n.partId===t)}function Qte(e){return{attachment:{item:{type:"image",url:e},content:{type:"image",url:e},size:0,type:"image/webp"}}}const Xte=(e,t,n)=>{const o=e[t];return o?typeof o=="function"?o():Promise.resolve(o):new Promise((s,a)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(a.bind(null,new Error("Unknown variable dynamic import: "+t+(t.split("/").length!==n?". Note that variables only represent file names one level deep.":""))))})},{slice:ene,forEach:tne}=[];function nne(e){return tne.call(ene.call(arguments,1),t=>{if(t)for(const n in t)e[n]===void 0&&(e[n]=t[n])}),e}function one(e){return typeof e!="string"?!1:[/<\s*script.*?>/i,/<\s*\/\s*script\s*>/i,/<\s*img.*?on\w+\s*=/i,/<\s*\w+\s*on\w+\s*=.*?>/i,/javascript\s*:/i,/vbscript\s*:/i,/expression\s*\(/i,/eval\s*\(/i,/alert\s*\(/i,/document\.cookie/i,/document\.write\s*\(/i,/window\.location/i,/innerHTML/i].some(n=>n.test(e))}const JC=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,sne=function(e,t){const o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{path:"/"},s=encodeURIComponent(t);let a=`${e}=${s}`;if(o.maxAge>0){const r=o.maxAge-0;if(Number.isNaN(r))throw new Error("maxAge should be a Number");a+=`; Max-Age=${Math.floor(r)}`}if(o.domain){if(!JC.test(o.domain))throw new TypeError("option domain is invalid");a+=`; Domain=${o.domain}`}if(o.path){if(!JC.test(o.path))throw new TypeError("option path is invalid");a+=`; Path=${o.path}`}if(o.expires){if(typeof o.expires.toUTCString!="function")throw new TypeError("option expires is invalid");a+=`; Expires=${o.expires.toUTCString()}`}if(o.httpOnly&&(a+="; HttpOnly"),o.secure&&(a+="; Secure"),o.sameSite)switch(typeof o.sameSite=="string"?o.sameSite.toLowerCase():o.sameSite){case!0:a+="; SameSite=Strict";break;case"lax":a+="; SameSite=Lax";break;case"strict":a+="; SameSite=Strict";break;case"none":a+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return o.partitioned&&(a+="; Partitioned"),a},QC={create(e,t,n,o){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{path:"/",sameSite:"strict"};n&&(s.expires=new Date,s.expires.setTime(s.expires.getTime()+n*60*1e3)),o&&(s.domain=o),document.cookie=sne(e,t,s)},read(e){const t=`${e}=`,n=document.cookie.split(";");for(let o=0;o<n.length;o++){let s=n[o];for(;s.charAt(0)===" ";)s=s.substring(1,s.length);if(s.indexOf(t)===0)return s.substring(t.length,s.length)}return null},remove(e,t){this.create(e,"",-1,t)}};var ane={name:"cookie",lookup(e){let{lookupCookie:t}=e;if(t&&typeof document<"u")return QC.read(t)||void 0},cacheUserLanguage(e,t){let{lookupCookie:n,cookieMinutes:o,cookieDomain:s,cookieOptions:a}=t;n&&typeof document<"u"&&QC.create(n,e,o,s,a)}},rne={name:"querystring",lookup(e){let{lookupQuerystring:t}=e,n;if(typeof window<"u"){let{search:o}=window.location;!window.location.search&&window.location.hash?.indexOf("?")>-1&&(o=window.location.hash.substring(window.location.hash.indexOf("?")));const a=o.substring(1).split("&");for(let r=0;r<a.length;r++){const i=a[r].indexOf("=");i>0&&a[r].substring(0,i)===t&&(n=a[r].substring(i+1))}}return n}},ine={name:"hash",lookup(e){let{lookupHash:t,lookupFromHashIndex:n}=e,o;if(typeof window<"u"){const{hash:s}=window.location;if(s&&s.length>2){const a=s.substring(1);if(t){const r=a.split("&");for(let i=0;i<r.length;i++){const d=r[i].indexOf("=");d>0&&r[i].substring(0,d)===t&&(o=r[i].substring(d+1))}}if(o)return o;if(!o&&n>-1){const r=s.match(/\/([a-zA-Z-]*)/g);return Array.isArray(r)?r[typeof n=="number"?n:0]?.replace("/",""):void 0}}}return o}};let Qa=null;const XC=()=>{if(Qa!==null)return Qa;try{if(Qa=typeof window<"u"&&window.localStorage!==null,!Qa)return!1;const e="i18next.translate.boo";window.localStorage.setItem(e,"foo"),window.localStorage.removeItem(e)}catch{Qa=!1}return Qa};var cne={name:"localStorage",lookup(e){let{lookupLocalStorage:t}=e;if(t&&XC())return window.localStorage.getItem(t)||void 0},cacheUserLanguage(e,t){let{lookupLocalStorage:n}=t;n&&XC()&&window.localStorage.setItem(n,e)}};let Xa=null;const eS=()=>{if(Xa!==null)return Xa;try{if(Xa=typeof window<"u"&&window.sessionStorage!==null,!Xa)return!1;const e="i18next.translate.boo";window.sessionStorage.setItem(e,"foo"),window.sessionStorage.removeItem(e)}catch{Xa=!1}return Xa};var lne={name:"sessionStorage",lookup(e){let{lookupSessionStorage:t}=e;if(t&&eS())return window.sessionStorage.getItem(t)||void 0},cacheUserLanguage(e,t){let{lookupSessionStorage:n}=t;n&&eS()&&window.sessionStorage.setItem(n,e)}},une={name:"navigator",lookup(e){const t=[];if(typeof navigator<"u"){const{languages:n,userLanguage:o,language:s}=navigator;if(n)for(let a=0;a<n.length;a++)t.push(n[a]);o&&t.push(o),s&&t.push(s)}return t.length>0?t:void 0}},dne={name:"htmlTag",lookup(e){let{htmlTag:t}=e,n;const o=t||(typeof document<"u"?document.documentElement:null);return o&&typeof o.getAttribute=="function"&&(n=o.getAttribute("lang")),n}},mne={name:"path",lookup(e){let{lookupFromPathIndex:t}=e;if(typeof window>"u")return;const n=window.location.pathname.match(/\/([a-zA-Z-]*)/g);return Array.isArray(n)?n[typeof t=="number"?t:0]?.replace("/",""):void 0}},pne={name:"subdomain",lookup(e){let{lookupFromSubdomainIndex:t}=e;const n=typeof t=="number"?t+1:1,o=typeof window<"u"&&window.location?.hostname?.match(/^(\w{2,5})\.(([a-z0-9-]{1,63}\.[a-z]{2,6})|localhost)/i);if(o)return o[n]}};let ax=!1;try{document.cookie,ax=!0}catch{}const rx=["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"];ax||rx.splice(1,1);const fne=()=>({order:rx,lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"],convertDetectedLanguage:e=>e});class ix{constructor(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.type="languageDetector",this.detectors={},this.init(t,n)}init(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{languageUtils:{}},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.services=t,this.options=nne(n,this.options||{},fne()),typeof this.options.convertDetectedLanguage=="string"&&this.options.convertDetectedLanguage.indexOf("15897")>-1&&(this.options.convertDetectedLanguage=s=>s.replace("-","_")),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=o,this.addDetector(ane),this.addDetector(rne),this.addDetector(cne),this.addDetector(lne),this.addDetector(une),this.addDetector(dne),this.addDetector(mne),this.addDetector(pne),this.addDetector(ine)}addDetector(t){return this.detectors[t.name]=t,this}detect(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.options.order,n=[];return t.forEach(o=>{if(this.detectors[o]){let s=this.detectors[o].lookup(this.options);s&&typeof s=="string"&&(s=[s]),s&&(n=n.concat(s))}}),n=n.filter(o=>o!=null&&!one(o)).map(o=>this.options.convertDetectedLanguage(o)),this.services&&this.services.languageUtils&&this.services.languageUtils.getBestMatchFromCodes?n:n.length>0?n[0]:null}cacheUserLanguage(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.options.caches;n&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(t)>-1||n.forEach(o=>{this.detectors[o]&&this.detectors[o].cacheUserLanguage(t,this.options)}))}}ix.type="languageDetector";const cx="i18next";function hne(e){return xh(e)[0]??e}let yl=null;function lx(){return!!J.instance().config().useI18nHttpApi}async function ux(e={}){const t=lx();return yl&&!t||(yl=(async()=>{const n=st.use(ix).use(O9);t&&N(()=>import("./index-DejNz1LK.js"),__vite__mapDeps([8,1])).then(s=>{n.use(s.default)});const o=t?void 0:bM(CM,yM);return await n.init({lng:o?o.lng:void 0,resources:o?o.resources:void 0,supportedLngs:mI.map(({i18nCode:s})=>s),fallbackLng:xh,detection:o?void 0:{lookupLocalStorage:"BUST-LOCAL-STORAGE",lookupCookie:cx,caches:[],convertDetectedLanguage:hne,...e},interpolation:{escapeValue:!1}}),o?await gne(o.lng):(document.documentElement.dir=st.dir(st.language.toLowerCase()),document.documentElement.lang=st.language.toLowerCase(),await dx(st.language,!1)),st.on("languageChanged",s=>{typeof document<"u"&&(document.documentElement.dir=st.dir(s.toLowerCase()),document.documentElement.lang=s.toLowerCase())}),n.t})()),yl}async function dx(e,t=!0,n=!1){if(!e)return;await Promise.all(xh(e).map(async s=>{if(!(st.hasResourceBundle(s,"translation")&&!lx()&&!n))try{const a=await Xte(Object.assign({"../../../config/strings/af/strings.json":()=>N(()=>import("./strings-vycA5bWv.js"),[]),"../../../config/strings/am/strings.json":()=>N(()=>import("./strings-C1x2bqja.js"),[]),"../../../config/strings/ar/strings.json":()=>N(()=>import("./strings-oPc_JRhs.js"),[]),"../../../config/strings/as/strings.json":()=>N(()=>import("./strings-z0zz2xJt.js"),[]),"../../../config/strings/az/strings.json":()=>N(()=>import("./strings-Dr0zZOf7.js"),[]),"../../../config/strings/bg/strings.json":()=>N(()=>import("./strings-DuE5WM8C.js"),[]),"../../../config/strings/bn-IN/strings.json":()=>N(()=>import("./strings-D_-GL4Ne.js"),[]),"../../../config/strings/bs/strings.json":()=>N(()=>import("./strings-BoOJ6iHv.js"),[]),"../../../config/strings/ca-Es-VALENCIA/strings.json":()=>N(()=>import("./strings-B8RcgYJd.js"),[]),"../../../config/strings/ca/strings.json":()=>N(()=>import("./strings-jH4qNjXF.js"),[]),"../../../config/strings/cs/strings.json":()=>N(()=>import("./strings-C1jQ9kqB.js"),[]),"../../../config/strings/cy/strings.json":()=>N(()=>import("./strings-B_2uZGeF.js"),[]),"../../../config/strings/da/strings.json":()=>N(()=>import("./strings-CjRR0J2N.js"),[]),"../../../config/strings/de/strings.json":()=>N(()=>import("./strings-qWWLMmry.js"),[]),"../../../config/strings/el/strings.json":()=>N(()=>import("./strings-BSDNtHJj.js"),[]),"../../../config/strings/en-GB/strings.json":()=>N(()=>import("./strings-Dbxlb2VE.js"),[]),"../../../config/strings/en-US/strings.json":()=>N(()=>import("./strings-DSrN6cyQ.js"),[]),"../../../config/strings/es-MX/strings.json":()=>N(()=>import("./strings-CpMB34_v.js"),[]),"../../../config/strings/es/strings.json":()=>N(()=>import("./strings-DeUa5rAk.js"),[]),"../../../config/strings/et/strings.json":()=>N(()=>import("./strings--ApKRzbl.js"),[]),"../../../config/strings/eu/strings.json":()=>N(()=>import("./strings-m-06YBOq.js"),[]),"../../../config/strings/fa/strings.json":()=>N(()=>import("./strings-iwJg_-C4.js"),[]),"../../../config/strings/fi/strings.json":()=>N(()=>import("./strings-CKG9PImc.js"),[]),"../../../config/strings/fil/strings.json":()=>N(()=>import("./strings-B7sh1Abj.js"),[]),"../../../config/strings/fr-CA/strings.json":()=>N(()=>import("./strings-BB0Gu4jY.js"),[]),"../../../config/strings/fr/strings.json":()=>N(()=>import("./strings-CVrDjOX2.js"),[]),"../../../config/strings/ga/strings.json":()=>N(()=>import("./strings-B22-9gqV.js"),[]),"../../../config/strings/gd/strings.json":()=>N(()=>import("./strings-BThAYqAd.js"),[]),"../../../config/strings/gl/strings.json":()=>N(()=>import("./strings-B9Aja2QU.js"),[]),"../../../config/strings/gu/strings.json":()=>N(()=>import("./strings-jr9L3n2H.js"),[]),"../../../config/strings/he/strings.json":()=>N(()=>import("./strings-DucraepB.js"),[]),"../../../config/strings/hi/strings.json":()=>N(()=>import("./strings-DWO6a1Nh.js"),[]),"../../../config/strings/hr/strings.json":()=>N(()=>import("./strings-BqO5Otkh.js"),[]),"../../../config/strings/hu/strings.json":()=>N(()=>import("./strings-C8V3I7IF.js"),[]),"../../../config/strings/hy/strings.json":()=>N(()=>import("./strings-DHhFqa2l.js"),[]),"../../../config/strings/id/strings.json":()=>N(()=>import("./strings-Bi_Cih6J.js"),[]),"../../../config/strings/is/strings.json":()=>N(()=>import("./strings-Do0MiuZQ.js"),[]),"../../../config/strings/it/strings.json":()=>N(()=>import("./strings-Brb7EdMd.js"),[]),"../../../config/strings/ja/strings.json":()=>N(()=>import("./strings-DihVBFlH.js"),[]),"../../../config/strings/ka/strings.json":()=>N(()=>import("./strings-B2sUjUvH.js"),[]),"../../../config/strings/kk/strings.json":()=>N(()=>import("./strings-D5jOda0l.js"),[]),"../../../config/strings/km-KH/strings.json":()=>N(()=>import("./strings-BT4VOVMY.js"),[]),"../../../config/strings/kn/strings.json":()=>N(()=>import("./strings-BXbLSLpq.js"),[]),"../../../config/strings/ko/strings.json":()=>N(()=>import("./strings-DsGqoAhA.js"),[]),"../../../config/strings/kok/strings.json":()=>N(()=>import("./strings-BH2sP5cF.js"),[]),"../../../config/strings/lb/strings.json":()=>N(()=>import("./strings-Dr7-ibzj.js"),[]),"../../../config/strings/lo/strings.json":()=>N(()=>import("./strings-CBh3UoPc.js"),[]),"../../../config/strings/lt/strings.json":()=>N(()=>import("./strings-Byjqb-mE.js"),[]),"../../../config/strings/lv/strings.json":()=>N(()=>import("./strings-kCKdPmqH.js"),[]),"../../../config/strings/mi/strings.json":()=>N(()=>import("./strings-BAzrxIMC.js"),[]),"../../../config/strings/mk/strings.json":()=>N(()=>import("./strings-B47cFU3v.js"),[]),"../../../config/strings/ml/strings.json":()=>N(()=>import("./strings-C2gsg0KH.js"),[]),"../../../config/strings/mr/strings.json":()=>N(()=>import("./strings-BZvWhkqI.js"),[]),"../../../config/strings/ms/strings.json":()=>N(()=>import("./strings-BdMkJ1C7.js"),[]),"../../../config/strings/mt/strings.json":()=>N(()=>import("./strings-CKT8rsA-.js"),[]),"../../../config/strings/nb-NO/strings.json":()=>N(()=>import("./strings-DJiZAJqG.js"),[]),"../../../config/strings/ne/strings.json":()=>N(()=>import("./strings-Bi1lBrxb.js"),[]),"../../../config/strings/nl/strings.json":()=>N(()=>import("./strings-BgI_Tq--.js"),[]),"../../../config/strings/nn-NO/strings.json":()=>N(()=>import("./strings-DEtR1hIB.js"),[]),"../../../config/strings/or/strings.json":()=>N(()=>import("./strings-a15gTWPH.js"),[]),"../../../config/strings/pa/strings.json":()=>N(()=>import("./strings-B3spcNaz.js"),[]),"../../../config/strings/pl/strings.json":()=>N(()=>import("./strings-DYDUU32Q.js"),[]),"../../../config/strings/pt-BR/strings.json":()=>N(()=>import("./strings-CYc-kPUD.js"),[]),"../../../config/strings/pt-PT/strings.json":()=>N(()=>import("./strings-D1SUlBSF.js"),[]),"../../../config/strings/quz/strings.json":()=>N(()=>import("./strings-qoKsIP-1.js"),[]),"../../../config/strings/ro/strings.json":()=>N(()=>import("./strings-BGRNiI6i.js"),[]),"../../../config/strings/ru/strings.json":()=>N(()=>import("./strings-B3rE68ul.js"),[]),"../../../config/strings/sk/strings.json":()=>N(()=>import("./strings-qNO2PCgr.js"),[]),"../../../config/strings/sl/strings.json":()=>N(()=>import("./strings-D2bwJ4Q9.js"),[]),"../../../config/strings/sq/strings.json":()=>N(()=>import("./strings-BrtzTsB8.js"),[]),"../../../config/strings/sr-Cyrl-BA/strings.json":()=>N(()=>import("./strings-DOVo0atT.js"),[]),"../../../config/strings/sr-Cyrl-RS/strings.json":()=>N(()=>import("./strings-BCH4-udI.js"),[]),"../../../config/strings/sr-Latn-RS/strings.json":()=>N(()=>import("./strings-BITCRLQb.js"),[]),"../../../config/strings/sv/strings.json":()=>N(()=>import("./strings-DG4aic7t.js"),[]),"../../../config/strings/ta/strings.json":()=>N(()=>import("./strings-9ANTlyEV.js"),[]),"../../../config/strings/te/strings.json":()=>N(()=>import("./strings-CZKPPyfM.js"),[]),"../../../config/strings/th/strings.json":()=>N(()=>import("./strings-BQ500dPO.js"),[]),"../../../config/strings/tr/strings.json":()=>N(()=>import("./strings-DMclaWgX.js"),[]),"../../../config/strings/tt/strings.json":()=>N(()=>import("./strings-VIVtoJnM.js"),[]),"../../../config/strings/ug/strings.json":()=>N(()=>import("./strings-Vh37KoP9.js"),[]),"../../../config/strings/uk/strings.json":()=>N(()=>import("./strings-B6B1jT0B.js"),[]),"../../../config/strings/ur/strings.json":()=>N(()=>import("./strings-DoREabIS.js"),[]),"../../../config/strings/uz-Latn-UZ/strings.json":()=>N(()=>import("./strings-EWah7yVd.js"),[]),"../../../config/strings/vi/strings.json":()=>N(()=>import("./strings-BdUIhOj1.js"),[]),"../../../config/strings/zh-Hans/strings.json":()=>N(()=>import("./strings-Be1U6OW1.js"),[]),"../../../config/strings/zh-Hant/strings.json":()=>N(()=>import("./strings-BgMpfp6w.js"),[])}),`../../../config/strings/${s}/strings.json`,7);st.addResourceBundle(s,"translation",a,!0,!0)}catch{console.warn(`Translation file for '${s}' not found.`)}}));const o=!st.resolvedLanguage||st.resolvedLanguage!==e;(st.language!==e||o)&&await st.changeLanguage(e),t&&Zo(cx,e,{expireDays:365,secure:!1})}async function gne(e){await dx(e,!1,!0)}function mwe(){return st.resolvedLanguage?st.resolvedLanguage.split("-")[0]==="en":!1}const vne=100,yne=30,Cne=70,Sne=4,ha=ke(),Tf=_(null),mx=_("");let $o=null,bi=0;function bne(e){ha.set(mx,e)}function Cu(){return ha.get(mx)}function la(e){ha.set(Bc,e)}function px(){const e=ha.get(Tf);e&&(e.abort(),ha.set(Tf,null))}function Ine(){px();const e=new AbortController;return ha.set(Tf,e),e}function Ene(e,t){const n=new URL("https://www.bing.com/AS/Suggestions/V2?pt=page.chat"),o=st.resolvedLanguage,s=B(Bt);return n.searchParams.set("setlang",o?.toLowerCase()??"en"),n.searchParams.set("cc",s?.toLowerCase()??"us"),n.searchParams.set("qry",e.toLowerCase()),n.searchParams.set("cvid",t),W("encacsc")&&n.searchParams.set("ascopilot1","1"),W("enblsuggrndmzn")&&n.searchParams.set("ascopilot2","1"),W("encpsrchdata")&&n.searchParams.set("ascopilot3","1"),W("zi-autosuggest")&&n.searchParams.set("ascopilot4","1"),n.toString()}async function Tne(e){const{query:t,conversationId:n,abortController:o}=e,s={query:t.toLowerCase()};return(await pt(`/conversations/${n}/autosuggest`,HH,{query:s,options:{method:"GET",...o&&{signal:o.signal}}})).data}async function wne(e){const{query:t,conversationId:n,abortController:o}=e,s=Ene(t,n);return fetch(s,o?{signal:o.signal}:{}).then(a=>a.json())}async function fx(e){return W("autosuggest-picasso")?Tne(e):wne(e)}function Ane(e,t){const n=t.text??t.st??"",o=e.toLowerCase().split(/\s+/),s=n.toLowerCase().split(/\s+/);let a=0;for(let m=0;m<Math.min(o.length,s.length)&&o[m]===s[m];m+=1)a+=1;const r=n.split(/\s+/),i=r.slice(0,a).join(" "),d=r.slice(a).join(" ");return{original:n,sliced:d,prefill:i+(i?" ":"")}}function hx(e,t,n,o){const s="suggestions"in n?n.suggestions:n.s;let a=e;if("qc"in n&&typeof n.qc.q=="string"&&(a=n.qc.q),!s.length){la(null),Je({feature:"fetchChatAutoComplete",errorType:"NoSuggestions",customData:JSON.stringify({conversationId:t})});return}const r=s.filter(i=>"st"in i&&"t"in i?typeof i.st=="string"&&typeof i.t=="string":"text"in i&&"source"in i?typeof i.text=="string"&&typeof i.source=="string":!1).map(i=>Ane(a,i));if(!r.length){la(null),Je({feature:"fetchChatAutoComplete",errorType:"NoSuggestions",customData:JSON.stringify({conversationId:t})});return}la({originalQuery:e,conversationId:t,type:"BCT",suggestions:r.slice(0,Sne)}),_o({feature:"fetchChatAutoComplete",duration:performance.now()-o})}function gx(e,t){t&&e instanceof DOMException&&e.name==="AbortError"||R.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"autosuggest",eventInfo_errorMessage:String(e),eventInfo_details:"Autosuggest API error"}})}async function xne(e){const t=B(Te);if(t)try{const n=Ine(),o=performance.now(),s=await fx({query:e,conversationId:t,abortController:n});e===Cu()&&hx(e,t,s,o)}catch(n){gx(n,!0),e===Cu()&&la(null)}}function _ne(e){$o&&clearTimeout($o);const t=W("autosuggest-debounce")?yne:vne,n=W("autosuggest-no-cancellation")?kne:xne;$o=setTimeout(()=>{n(e)},t)}async function kne(e){const t=B(Te);if(!t)return;bi+=1;const n=bi;try{const o=performance.now(),s=await fx({query:e,conversationId:t});if(n!==bi||e!==Cu())return;hx(e,t,s,o)}catch(o){gx(o,!1),n===bi&&e===Cu()&&la(null)}}function wf(e){$o&&(clearTimeout($o),$o=null);let t=J.instance().config().landingPage?.regexForAutoSuggest;const n=W("zi-autosuggest");n&&(t=/\S*/);const o=W("autosuggest")||W("edge-autosuggest"),s=B(Te);if(!o||!t||!t.test(e)||e.length>=Cne){la(null);return}bne(e),!s||e===""&&!n?la(null):_ne(e)}let Af=!1;function Pne(){return Af?(Af=!1,!0):!1}function Yi(e=!1){e&&(Af=!0),$o&&(clearTimeout($o),$o=null),W("autosuggest-no-cancellation")?bi+=1:px(),ha.set(Bc,null)}function Mne(){const e=q("pages-anonymous"),t=Dt();return{canCreatePageForSignedOut:e,canCreatePage:t||e}}const Rne=2500,Nne=255,pwe=["pdf","docx"],Ud=gc(new Map),fwe=_(null),Lne=_(pR),Dne=_(Nne),One=_(Rne),Une=_([]),uo=_(e=>e(Une).filter(t=>t.uploadStatus==="success").length),vx=({title:e,titleId:t,...n})=>l.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M5.25 4H18.75C20.483 4 21.8992 5.35645 21.9949 7.06558L22 7.25V16.75C22 18.483 20.6435 19.8992 18.9344 19.9949L18.75 20H5.25C3.51697 20 2.10075 18.6435 2.00514 16.9344L2 16.75V7.25C2 5.51697 3.35645 4.10075 5.06558 4.00514L5.25 4H18.75H5.25ZM20.5 9.373L12.3493 13.6637C12.1619 13.7623 11.9431 13.7764 11.7468 13.706L11.6507 13.6637L3.5 9.374V16.75C3.5 17.6682 4.20711 18.4212 5.10647 18.4942L5.25 18.5H18.75C19.6682 18.5 20.4212 17.7929 20.4942 16.8935L20.5 16.75V9.373ZM18.75 5.5H5.25C4.33183 5.5 3.57881 6.20711 3.5058 7.10647L3.5 7.25V7.679L12 12.1525L20.5 7.678V7.25C20.5 6.33183 19.7929 5.57881 18.8935 5.5058L18.75 5.5Z"})),hwe=Object.freeze(Object.defineProperty({__proto__:null,default:vx},Symbol.toStringTag,{value:"Module"})),Fne=({title:e,titleId:t,...n})=>l.createElement("svg",{viewBox:"0 0 28 28",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M27.9994 14.0514C27.9994 6.29111 21.7315 0 13.9997 0C6.26795 0 0 6.29111 0 14.0514C0 20.641 4.52023 26.1705 10.6179 27.6892V18.3455H7.73121V14.0514H10.6179V12.2011C10.6179 7.41859 12.7745 5.20184 17.4526 5.20184C18.3396 5.20184 19.8701 5.37664 20.4962 5.55088V9.44312C20.1658 9.40828 19.5918 9.39085 18.8789 9.39085C16.5835 9.39085 15.6965 10.2637 15.6965 12.5328V14.0514H20.2694L19.4837 18.3455H15.6965V28C22.6286 27.1597 28 21.2356 28 14.0514H27.9994Z"})),jne=({title:e,titleId:t,...n})=>{const[o,s]=l.useState("");return l.useEffect(()=>{s(Math.random().toString(36).slice(2,10))},[]),l.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("g",{id:o+"-Linkedin"},l.createElement("path",{id:o+"-Shape",d:"M23.6999 2.75909C23.6999 1.39872 22.5971 0.295929 21.2368 0.295929H2.76308C1.40272 0.295929 0.299927 1.39872 0.299927 2.75909V21.2328C0.299927 22.5931 1.40272 23.6959 2.76308 23.6959H21.2368C22.5971 23.6959 23.6999 22.5931 23.6999 21.2328V2.75909ZM3.63848 9.12156H7.24935V20.6943H3.63848V9.12156ZM16.4313 8.83425C19.8921 8.83425 20.6797 10.9844 20.753 13.861L20.7589 14.3469V20.6942H17.1519L17.1517 14.9161C17.1477 13.5985 17.0603 11.9984 15.278 11.9984C13.4002 11.9984 13.1135 13.4611 13.1135 14.971V20.6942H9.51161V9.12143H12.9689V10.7028H13.0188L13.1052 10.5509C13.6314 9.68925 14.7739 8.83425 16.4313 8.83425ZM3.35125 5.45367C3.35125 4.30239 4.28565 3.36809 5.44404 3.36809C6.59732 3.36809 7.53556 4.30239 7.53556 5.45367C7.53556 6.60623 6.59732 7.54053 5.44404 7.54053C4.28565 7.54053 3.35125 6.60623 3.35125 5.45367Z",fill:"currentColor"})))},Bne=({title:e,titleId:t,...n})=>{const[o,s]=l.useState("");return l.useEffect(()=>{s(Math.random().toString(36).slice(2,10))},[]),l.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 28 28","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("g",{clipPath:`url(#${o}-clip0_9013_4638)`},l.createElement("path",{d:"M14 0C6.26828 0 0 6.26828 0 14C0 17.8664 1.56734 21.3664 4.10047 23.8995L1.43391 26.5661C0.904531 27.0955 1.27969 28 2.02781 28H14C21.7317 28 28 21.7317 28 14C28 6.26828 21.7317 0 14 0Z",className:"fill-foreground-650"}),l.createElement("path",{d:"M16.8481 6.60187C17.091 7.63109 18.0152 8.39781 19.1188 8.39781C20.4072 8.39781 21.4517 7.35328 21.4517 6.06484C21.4517 4.7764 20.4072 3.73187 19.1188 3.73187C17.9922 3.73187 17.0527 4.53031 16.8339 5.59234C14.9472 5.79469 13.4739 7.39484 13.4739 9.33406C13.4739 9.33843 13.4739 9.34172 13.4739 9.34609C11.4221 9.4325 9.54846 10.0166 8.06096 10.9386C7.50861 10.5109 6.81518 10.2561 6.06268 10.2561C4.25689 10.2561 2.79346 11.7195 2.79346 13.5253C2.79346 14.8356 3.56346 15.9644 4.6758 16.4861C4.78408 20.2814 8.91955 23.3341 14.0066 23.3341C19.0936 23.3341 23.2346 20.2781 23.3374 16.4795C24.441 15.9545 25.2044 14.8291 25.2044 13.5264C25.2044 11.7206 23.741 10.2572 21.9352 10.2572C21.186 10.2572 20.4958 10.5098 19.9446 10.9342C18.4439 10.0056 16.5496 9.42156 14.4769 9.3439C14.4769 9.34062 14.4769 9.33844 14.4769 9.33515C14.4769 7.94609 15.5094 6.79328 16.8481 6.60406V6.60187ZM7.92971 15.6002C7.98439 14.4145 8.77189 13.5045 9.68736 13.5045C10.6028 13.5045 11.3028 14.4659 11.2481 15.6516C11.1935 16.8372 10.5099 17.2681 9.5933 17.2681C8.67674 17.2681 7.87502 16.7858 7.92971 15.6002ZM18.3269 13.5045C19.2435 13.5045 20.031 14.4145 20.0846 15.6002C20.1392 16.7858 19.3364 17.2681 18.421 17.2681C17.5055 17.2681 16.8208 16.8383 16.7661 15.6516C16.7114 14.4659 17.4103 13.5045 18.3269 13.5045ZM17.2375 18.3433C17.4092 18.3608 17.5186 18.5391 17.4519 18.6987C16.8886 20.0452 15.5586 20.9912 14.0066 20.9912C12.4546 20.9912 11.1256 20.0452 10.5613 18.6987C10.4946 18.5391 10.6039 18.3608 10.7756 18.3433C11.7819 18.2416 12.8702 18.1858 14.0066 18.1858C15.143 18.1858 16.2302 18.2416 17.2375 18.3433Z",style:{fill:"rgb(var(--color-foreground-100))"}})),l.createElement("defs",null,l.createElement("clipPath",{id:o+"-clip0_9013_4638"},l.createElement("rect",{width:28,height:28,fill:"white"}))))},Vne=({title:e,titleId:t,...n})=>l.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 28 28",fill:"currentColor","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("g",null,l.createElement("path",{d:"M16.6638 11.85L27.0874 0H24.6174L15.5665 10.2892L8.33765 0H0L10.9315 15.5591L0 27.9856H2.47021L12.0281 17.1199L19.6623 27.9856H28L16.6632 11.85H16.6638ZM13.2805 15.6962L12.1729 14.1468L3.36026 1.81862H7.15435L14.2663 11.7679L15.3739 13.3172L24.6185 26.2497H20.8244L13.2805 15.6967V15.6962Z",fill:"currentColor"}))),Hne=({title:e,titleId:t,...n})=>l.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 28 28",fill:"currentColor","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M23.9202 4.06584C21.2885 1.44525 17.7882 0.00132957 14.0588 0C6.37397 0 0.119658 6.21909 0.116984 13.8635C0.115647 16.3072 0.758058 18.6925 1.97804 20.7946L0 27.9796L7.39072 26.0517C9.4269 27.1566 11.7198 27.7383 14.0528 27.739H14.0588C21.7423 27.739 27.9974 21.5192 28 13.8748C28.0013 10.17 26.5527 6.6871 23.9202 4.0665V4.06584ZM14.0588 25.3975H14.0541C11.9751 25.3969 9.93564 24.8411 8.15617 23.7914L7.73299 23.5415L3.34709 24.6856L4.5176 20.4329L4.24218 19.9968C3.08236 18.162 2.46937 16.0413 2.4707 13.8642C2.47338 7.51078 7.67149 2.34138 14.0635 2.34138C17.1586 2.34271 20.0678 3.54266 22.2557 5.72117C24.4437 7.89902 25.6476 10.7949 25.6463 13.8735C25.6436 20.2275 20.4455 25.3969 14.0588 25.3969V25.3975ZM20.4147 16.7673C20.0664 16.5938 18.3538 15.7561 18.0343 15.6405C17.7147 15.5248 17.4828 15.467 17.2508 15.814C17.0189 16.161 16.3511 16.9415 16.1478 17.1721C15.9446 17.4035 15.7414 17.4321 15.3931 17.2585C15.0449 17.085 13.9225 16.7194 12.5915 15.5394C11.5561 14.6206 10.8568 13.4866 10.6536 13.1395C10.4504 12.7925 10.6322 12.605 10.806 12.4329C10.9624 12.2773 11.1543 12.028 11.3287 11.8259C11.5033 11.6238 11.5607 11.4789 11.677 11.2482C11.7934 11.0168 11.7352 10.8148 11.6483 10.6412C11.5614 10.4677 10.8649 8.76253 10.574 8.06918C10.2912 7.39377 10.0039 7.48551 9.79059 7.47421C9.58736 7.46424 9.35542 7.46225 9.12279 7.46225C8.89016 7.46225 8.51309 7.54867 8.19358 7.89569C7.87407 8.24267 6.97426 9.08097 6.97426 10.7855C6.97426 12.49 8.22236 14.1381 8.39681 14.3694C8.57127 14.6008 10.8534 18.0995 14.3476 19.6006C15.1786 19.9576 15.8276 20.171 16.3336 20.3306C17.168 20.5945 17.9273 20.5573 18.5276 20.4682C19.1968 20.3685 20.5886 19.6299 20.8787 18.8208C21.1688 18.0117 21.1688 17.3177 21.0819 17.1734C20.995 17.0292 20.7624 16.9421 20.4141 16.7686L20.4147 16.7673Z"}));function zr(e,t={}){const{preventReferrer:n=!1}=t,o=hA(e),s=n?"noopener,noreferrer":"noopener";return window.open(o,"_blank",s)}const xf="../../assets/lottie";function zne(e){return e.startsWith(`${xf}/`)?e.slice(xf.length+1):e}function yx(){const e=Object.assign({"../../assets/lottie/chain-of-thought-dark.json":()=>N(()=>import("./chain-of-thought-dark-BPjK_j-x.js"),[]).then(n=>n.default),"../../assets/lottie/chain-of-thought-light.json":()=>N(()=>import("./chain-of-thought-light-D5erdeOr.js"),[]).then(n=>n.default),"../../assets/lottie/character-thinking-cloud-animation.json":()=>N(()=>import("./character-thinking-cloud-animation-Bu4j70Rh.js"),[]).then(n=>n.default),"../../assets/lottie/image-gen-dark.json":()=>N(()=>import("./image-gen-dark-DTw6tnD0.js"),[]).then(n=>n.default),"../../assets/lottie/image-gen-light.json":()=>N(()=>import("./image-gen-light-C_x12-59.js"),[]).then(n=>n.default),"../../assets/lottie/loader-gradient.json":()=>N(()=>import("./loader-gradient-7hu2fPzp.js"),[]).then(n=>n.default),"../../assets/lottie/loader-image-generating.json":()=>N(()=>import("./loader-image-generating-BZL4nXqF.js"),[]).then(n=>n.default),"../../assets/lottie/loader-reasoning-dark.json":()=>N(()=>import("./loader-reasoning-dark-Dh23ceSo.js"),[]).then(n=>n.default),"../../assets/lottie/loader-reasoning-light.json":()=>N(()=>import("./loader-reasoning-light-BmcsjTTD.js"),[]).then(n=>n.default),"../../assets/lottie/loader-spinner-dark.json":()=>N(()=>import("./loader-spinner-dark-D_zqJrW7.js"),[]).then(n=>n.default),"../../assets/lottie/loader-spinner-light.json":()=>N(()=>import("./loader-spinner-light-CUlAhBGz.js"),[]).then(n=>n.default),"../../assets/lottie/loader-spinner-white.json":()=>N(()=>import("./loader-spinner-white-B2mzTARL.js"),[]).then(n=>n.default),"../../assets/lottie/pages-welcome-dark.json":()=>N(()=>import("./pages-welcome-dark-BxeF7F8z.js"),[]).then(n=>n.default),"../../assets/lottie/pages-welcome-light.json":()=>N(()=>import("./pages-welcome-light-BFwITHsU.js"),[]).then(n=>n.default),"../../assets/lottie/study-trophy.json":()=>N(()=>import("./study-trophy-lRGPu10r.js"),[]).then(n=>n.default),"../../assets/lottie/voicemail-dark.json":()=>N(()=>import("./voicemail-dark-Bec3gjKS.js"),[]).then(n=>n.default),"../../assets/lottie/voicemail-light.json":()=>N(()=>import("./voicemail-light-DmBzGtqk.js"),[]).then(n=>n.default)});function t(n){return e[n]?n:`${xf}/${n}`}return{load:n=>{const o=t(n),s=e[o];return s?s():Promise.reject(new Error(`Lottie animation not found: ${n} (resolved: ${o})`))},exists:n=>{const o=t(n);return!!e[o]},getNames:()=>Object.keys(e).map(zne),getFullPath:n=>t(n)}}const Gne=l.lazy(()=>N(()=>import("./index.es-_st7_bnK.js"),__vite__mapDeps([9,1]))),Wne=yx();function xt(e){const{type:t,className:n,rendererSettings:o,colorTheme:s}=e,a=M(ss),r=s??a,[i,d]=l.useState(null),m=l.useMemo(()=>{switch(t){case"gradient":return"loader-gradient.json";case"reasoning":return r==="dark"?"loader-reasoning-dark.json":"loader-reasoning-light.json";case"chainOfThought":return r==="dark"?"chain-of-thought-dark.json":"chain-of-thought-light.json";case"spinnerWhite":return"loader-spinner-white.json";case"imageGen":return r==="dark"?"image-gen-dark.json":"image-gen-light.json";case"spinnerThemed":default:return r==="dark"?"loader-spinner-dark.json":"loader-spinner-light.json"}},[t,r]);return l.useEffect(()=>{Wne.load(m).then(d).catch(()=>d(null))},[m]),i?c.jsx(l.Suspense,{fallback:c.jsx("div",{}),children:c.jsx(Gne,{animationData:i,loop:!0,className:n,rendererSettings:o})}):c.jsx("div",{})}const Cx=Object.freeze(Object.defineProperty({__proto__:null,default:xt},Symbol.toStringTag,{value:"Module"})),gwe=["facebook","twitter","whatsapp","linkedin","reddit","email"],$ne={facebook:"senderToFacebook",twitter:"senderToX",linkedin:"senderToLinkedIn",whatsapp:"senderToWhatsApp",reddit:"senderToReddit",email:"senderToEmail"},Sx={facebook:{displayName:"Facebook",linkGenerator:e=>`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(e)}`,icon:c.jsx(Fne,{})},twitter:{displayName:"X",linkGenerator:(e,t)=>`https://twitter.com/intent/tweet?url=${encodeURIComponent(e)}&text=${encodeURIComponent(t)}`,icon:c.jsx(Vne,{})},whatsapp:{displayName:"WhatsApp",linkGenerator:(e,t)=>`https://api.whatsapp.com/send?text=${encodeURIComponent(`${t} ${e}`)}`,icon:c.jsx(Hne,{})},linkedin:{displayName:"LinkedIn",linkGenerator:(e,t)=>`https://www.linkedin.com/shareArticle?mini=true&url=${encodeURIComponent(e)}&text=${encodeURIComponent(t)}`,icon:c.jsx(jne,{})},reddit:{displayName:"Reddit",linkGenerator:(e,t)=>`https://www.reddit.com/submit?url=${encodeURIComponent(e)}&title=${encodeURIComponent(t)}`,icon:c.jsx(Bne,{})},email:{displayName:"Email",linkGenerator:(e,t)=>`mailto:?subject=${encodeURIComponent(t)}&body=${encodeURIComponent(e)}`,icon:c.jsx(vx,{})}};function vwe(e){const{socialMedia:t,className:n,loading:o,disabled:s,onClickSocialMedia:a,includeTitle:r,iconClassName:i="size-6"}=e,d=Sx[t],m=d.displayNameKey?F(d.displayNameKey):d.displayName,p=c.jsx("div",{className:i,children:d.icon}),h="56-xl",g="subtle-dimmed-inverted",y=O("flex-1 py-2",n);return c.jsxs(ee,{size:h,color:g,title:m,className:y,onClick:b=>a(t,b),disabled:s,children:[o?c.jsx(xt,{className:"size-8"}):p,r&&c.jsx("span",{className:"font-medium text-foreground-650 text-2xs",children:m})]})}function ywe(e,t,n,o){if(!t)return;let s;if(e==="email"){const a=o?`${o}

${t}`:t;s=`mailto:?subject=${encodeURIComponent(n)}&body=${encodeURIComponent(a)}`}else s=Sx[e].linkGenerator(t,o??n);zr(s)}function tS(e){const{scenario:t,pageName:n,sectionName:o,customData:s}=e;de({source:"shareMenu",scenario:t,pageName:n,sectionName:o,customData:s})}function Cwe(e){const{conversationId:t,messageId:n}=e;R.trackEvent({name:"system",data:{eventName:"copilotImpression",eventInfo_impressionPage:"sharePreview",eventInfo_impressionElement:"shareBlockedBanner",eventInfo_conversationId:t,eventInfo_messageId:n}})}function Swe(e){const{conversationId:t,messageId:n,uploadedFileType:o}=e;R.trackEvent({name:"system",data:{eventName:"copilotImpression",eventInfo_impressionPage:"sharePreview",eventInfo_conversationId:t,eventInfo_messageId:n,eventInfo_uploadFileType:o}})}function bwe(e){const{scenario:t,uploadedFileType:n,conversationId:o,customData:s,clickDestination:a="copyLink"}=e,r={eventName:"copilotClick",eventInfo_clickSource:"shareButton",eventInfo_clickScenario:t,eventInfo_uploadFileType:n,eventInfo_clickDestination:a,eventInfo_customData:s,eventInfo_conversationId:o};R.trackEvent({name:"interaction",data:r})}function Iwe(e){const{scenario:t,socialMedia:n,customData:o,conversationId:s}=e,a={eventName:"copilotClick",eventInfo_clickSource:"shareButton",eventInfo_clickDestination:$ne[n],eventInfo_clickScenario:t,eventInfo_customData:o,eventInfo_conversationId:s};R.trackEvent({name:"interaction",data:a})}function qne(e){const{shareId:t,sharedLevel:n,sharedDataType:o,impressionScenario:s}=e;R.trackEvent({name:"system",data:{eventName:"copilotImpression",eventInfo_impressionPage:"receivePreview",eventInfo_impressionScenario:s,eventInfo_customData:JSON.stringify({eventInfo_shareId:t,sharedLevel:n,sharedDataType:o})}})}function Ewe(){R.trackEvent({name:"interaction",data:{eventName:"copilotClick",eventInfo_clickSource:"talkToCopilot"}})}function Twe(e){const{cardType:t,messageId:n,conversationId:o,scenario:s}=e;en({source:"shareMenu",scenario:s,messageId:n,conversationId:o,cardType:t})}function Kne(e){const{conversationId:t,messageId:n,errorName:o,errorMessage:s,errorStack:a}=e;R.trackEvent({name:"system",data:{eventName:"shareMessagesFailed",eventInfo_conversationId:t,eventInfo_messageId:n??"",eventInfo_error:o,eventInfo_errorMessage:s,eventInfo_errorStack:a}})}function Yne(){de({source:"continueClicked"})}function Zne(e){const{shareId:t,error:n,conversationId:o}=e;Je({feature:"share",scenario:"continueClickFailed",errorType:n?.name,errorMessage:n?.message,customData:JSON.stringify({eventInfo_shareId:t,eventInfo_conversationId:o})})}function wwe(){de({source:"sharedLinkManagement"})}function Awe(e){de({source:"delete",scenario:"deleteSingleSharedLink",customData:JSON.stringify({eventInfo_shareId:e})})}function xwe(e){const{details:t,errorMessage:n}=e;R.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"CopyError",eventInfo_details:t,eventInfo_errorMessage:n}})}function _we(){de({pageName:"chatPage",sectionName:"chatResponse",source:"addToPage"})}function kwe(e){de({pageName:"addToPage",source:e})}function Jne(){de({sectionName:"actionMenu",source:"createNewPage"})}function Qne(e){de({pageName:e,source:"openPage"})}function Pwe(){de({pageName:"pages",sectionName:"editBar",source:"askCopilot"})}function Mwe(e){const{action:t,pageId:n,conversationId:o,messageId:s,suggestionId:a}=e;de({pageName:"pages",sectionName:"suggestions",source:t==="accept"?"applyRevision":"reject",conversationId:o,customData:JSON.stringify({eventInfo_pageId:n,eventInfo_messageId:s,eventInfo_suggestionId:a,eventInfo_sourcesCount:B(uo)})})}function Rwe(e){const{reaction:t,pageId:n,suggestionId:o,messageId:s,startIndex:a,endIndex:r,oldText:i,replacement:d,conversationId:m}=e;de({pageName:"pages",sectionName:"suggestions",source:"pagesFeedback",scenario:t,conversationId:m,customData:JSON.stringify({eventInfo_pageId:n,eventInfo_reaction:t,eventInfo_suggestionId:o,eventInfo_messageId:s,eventInfo_startIndex:a,eventInfo_endIndex:r,eventInfo_oldText:i,eventInfo_replacement:d})})}function Xne(e){Je({feature:"pages",...e})}const Nwe=["createPage","addToExistingPage","openPageOnChat","openPageOnHistory","openPageOnLibrary","copyPage","openPageOnProjectCreation"];function Lwe(e,t,n){_o({feature:"pages",scenario:e,duration:Math.round(t),customData:JSON.stringify({eventInfo_pageId:n})})}function Dwe(){de({pageName:"pages",source:"hyperlinkInPages"})}function Owe({sectionName:e,pageId:t}){de({sectionName:e,source:"deletePage",customData:JSON.stringify({eventInfo_pageId:t})})}function Uwe({sectionName:e,pageId:t}){de({sectionName:e,source:"renamePage",customData:JSON.stringify({eventInfo_pageId:t})})}function Fwe(e){R.trackEvent({name:"interaction",data:{eventName:"copilotPagesEdited",eventInfo_customData:JSON.stringify({eventInfo_pageId:e,eventInfo_sourcesCount:B(uo)})}})}function jwe(e){const{pageName:t,sectionName:n,pageId:o}=e;de({pageName:t,sectionName:n,source:"pagesSharing",customData:JSON.stringify({eventInfo_pageId:o})})}function Bwe(e){const{pageName:t,sectionName:n,pageId:o,source:s}=e;de({pageName:t,sectionName:n,source:s,customData:JSON.stringify({eventInfo_pageId:o})})}function Vwe(e){const{sectionName:t,pageId:n}=e;de({sectionName:t,source:"removePagesSharing",customData:JSON.stringify({eventInfo_pageId:n})})}const Hwe=["pagesHistory","direct"];function zwe(e,t){R.trackEvent({name:"system",data:{eventName:"copilotImpression",eventInfo_impressionPage:"pagesSharing",eventInfo_impressionScenario:e}}),qne({shareId:t,sharedLevel:"singleAr",sharedDataType:"page",impressionScenario:"pages"})}const Gwe=["responsePreviewedPage","chatCreateNewPage","chatAddToExistingPage","chatDirectToNewPage","pagesHistory","actionMenuCreateNewPage","featureDiscoveryCreateNewPage","libraryMenuCreateNewPage","makeACopyViewerPage","makeACopyOwnerPage","makeACopyViewOnly","makeACopyPagesHistory","libraryPageItem","chatWidgetCreatePage","projectPageCreationItem"];function Wwe(e,t){R.trackEvent({name:"system",data:{eventName:"copilotImpression",eventInfo_impressionPage:"pages",eventInfo_impressionScenario:t,eventInfo_customData:JSON.stringify({eventInfo_pageId:e,eventInfo_sourcesCount:B(uo)})}})}function $we(e){const{pageName:t,sectionName:n,pageId:o}=e;de({pageName:t,sectionName:n,source:"makePagesCopy",customData:JSON.stringify({eventInfo_pageId:o})})}function qwe(){de({pageName:"pages",source:"printPage"})}function eoe(e){R.trackEvent({name:"system",data:{eventName:"copilotImpression",eventInfo_impressionPage:"threePages",eventInfo_impressionScenario:e}})}function Kwe(e,t){de({pageName:"pages",sectionName:"titleBar",source:t,customData:JSON.stringify({eventInfo_pageId:e,eventInfo_sourcesCount:B(uo)})})}function Ywe(e){Lt({page:"sourcesManagement",scenario:"showSources",customData:JSON.stringify({eventInfo_pageId:e,eventInfo_sourcesCount:B(uo)})})}function Zwe(e,t){de({pageName:"pages",sectionName:"sourcesManagement",source:t,customData:JSON.stringify({eventInfo_pageId:e,eventInfo_sourcesCount:B(uo)})})}function bx({pageId:e,uploadStatus:t,format:n}){Lt({scenario:"uploadPageSourceFile",page:"sourcesManagement",element:"sourcesFileItem",customData:JSON.stringify({eventInfo_pageId:e,eventInfo_sourcesCount:B(uo),eventInfo_sourcesFileFormat:n,eventInfo_uploadStatus:t})})}function Jwe(e,t){_o({feature:"pages",scenario:"uploadSourceFile",customData:JSON.stringify({eventInfo_pageId:e,eventInfo_sourcesCount:B(uo)})}),bx({pageId:e,uploadStatus:"Success",format:t})}function Qwe(e){de({pageName:"pages",sectionName:"sourcesManagement",source:"deleteFile",customData:JSON.stringify({eventInfo_pageId:e,eventInfo_sourcesCount:B(uo)})})}function Xwe(e){de({pageName:"pages",sectionName:"sourcesFileDeleteModal",source:"confirmDeleteFile",customData:JSON.stringify({eventInfo_pageId:e,eventInfo_sourcesCount:B(uo)})})}function eAe({pageId:e,isSaving:t,errorMessage:n,exception:o,fileExtension:s}){Xne({scenario:"uploadSourceFile",errorType:t?"SavePageMappingFailed":"UploadSourceFileFailed",errorMessage:n,exception:o,customData:JSON.stringify({eventInfo_pageId:e,eventInfo_sourcesCount:B(uo)})}),bx({pageId:e,uploadStatus:t?"SavePageMappingFailed":"UploadSourceFileFailed",format:s})}async function Ix({pageId:e,pageType:t,closeSidebar:n,sourcePage:o,impressionScenario:s,featureLatencyInfo:a}){if(Qne(o),n&&ke().set(To,!1),t==="sharedPage"){await qn({to:"/shares/pages/$shareId",params:{shareId:e},from:Nn().state.location.pathname,state:{...a,impressionScenario:s}});return}await qn({to:"/pages/$pageId",params:{pageId:e},from:Nn().state.location.pathname,state:{...a,impressionScenario:s}})}function tAe(){return l.useCallback(async e=>{await Ix(e)},[])}const toe=ke();function Fo(e){e&&toe.set(yt,{title:e.title,subtitle:e.message,dismissable:!0,dismissAfter:10*1e3})}function Gc(){return!!J.instance().config().enableMultiAuthProviders}function noe(){const e=cb();return l.useCallback(n=>{n?e.removeQueries({queryKey:n}):e.clear()},[e])}const w1="shouldPerformUserMerge";function ooe(e){Wi(w1,String(e))}function soe(){DR(w1)}function aoe(){return Cr(w1)!=="false"}function nAe(){const e=M(tG),t=Dt(),[n,o]=Le(sR),s=!t&&e;return l.useEffect(()=>{ooe(n)},[n]),{shouldShowMergeCheckbox:s,shouldMerge:n,setShouldMerge:o}}function Ex(){mt(Bp),mt(yr),mt(Ku)}function roe(){mt(SI),mt(au),Ex()}function ioe(){Io("sticky-conversation-mode")}function coe(){ioe()}function oAe(e){const{key:t,name:n}=e;t&&Zo(fI,t,{expireDays:365}),n?Zo(jp,n,{expireDays:365}):vr(jp)}function loe(){vr(fI),vr(jp)}function Fd(){const e=noe(),t=async s=>{const{provider:a,scenario:r,opts:i={},onAuthComplete:d,onAuthError:m}=s;Ex(),await Mn.instance().logIn(a,i).catch(p=>{console.error(p),m?.()})},n=async(s=!0)=>{e(),roe(),coe(),loe(),soe(),await Mn.instance().logOut().then(async()=>{s&&mw("/")})};return{login:t,logout:n,switchAccount:async s=>{await n(),await t(s)}}}function uoe(e){const{provider:t="microsoft",scenario:n,loginScenario:o,from:s}=e,a=Gc(),r=Fa(),{login:i}=Fd();return l.useCallback(async()=>{if(n&&en({source:"signin",scenario:n}),a){await r({from:s,to:"/login",search:{back:window.location.href}});return}await i({provider:t,scenario:o})},[s,r,a,i,t,n,o])}const nS="/pages";async function oS(e,t){const n=await Nt({path:"/pages",args:{body:e,analytics:{anonymousPath:nS},options:{signal:t}}}),o=await n.json(),s=AB.safeParse(o);if(!n.ok&&s.success)throw new Error(s.data.errorCode);try{return SB.parse(o)}catch(a){throw a instanceof Fi&&dr(a,nS,!1),a}}async function doe(e,t,n,o,s){return oS(n==="conversationSummary"&&o!==void 0?{source:n,conversationId:o}:{title:e??"",content:t??""},s)}function moe(e){const{canCreatePage:t,canCreatePageForSignedOut:n}=Mne(),[o,s]=l.useState(!1),a=sn(),r=uoe({from:a,scenario:"sidebarActionCreatePage",loginScenario:"generalPageCreate"}),i=e?.autoNavigate??!0;return{creatingPage:o,createPage:t?async({title:m,content:p,sourcePage:h,impressionScenario:g,featureLatencyInfo:y,source:b,conversationId:C,abortSignal:T})=>{s(!0);try{return await Tx({sourcePage:h,impressionScenario:g,featureLatencyInfo:y,title:m,content:p,source:b,conversationId:C,abortSignal:T,autoNavigate:i,closeSidebar:!0})}catch(S){S instanceof Error&&S.message==="page-count-exceeded"&&n?(eoe(h),await r()):Fo({title:F("common.somethingWrong"),message:F("pages.errorCreatingMessage")});return}finally{s(!1)}}:null}}async function Tx({sourcePage:e,impressionScenario:t,featureLatencyInfo:n,title:o,content:s,source:a,conversationId:r,abortSignal:i,autoNavigate:d,closeSidebar:m=!0}){const{id:p}=await doe(o,s,a,r,i);return d!==!1&&await Ix({pageId:p,closeSidebar:m,sourcePage:e,impressionScenario:t,featureLatencyInfo:n}),{id:p}}async function poe({sourcePage:e,impressionScenario:t,featureLatencyInfo:n,title:o,content:s,source:a,conversationId:r,abortSignal:i,autoNavigate:d,closeSidebar:m=!0}){try{return await Tx({sourcePage:e,impressionScenario:t,featureLatencyInfo:n,title:o,content:s,source:a,conversationId:r,abortSignal:i,autoNavigate:d,closeSidebar:m})}catch{Fo({title:F("common.somethingWrong"),message:F("pages.errorCreatingMessage")});return}}const Fs=f({id:u(),conversationId:u().nullish(),messageId:u().nullish(),createdAt:u().nullish()}),foe=Fs.extend({type:v("image"),thumbnailBaseUrl:u()}),hoe=Fs.extend({type:v("page"),title:u().nullish(),updatedAt:u(),pageType:z(["page","sharedPage"]).optional(),previewContent:u().nullish()}),goe=Fs.extend({type:v("podcast"),podcastId:u(),title:u().nullish(),durationInSeconds:k(),thumbnail:f({name:u(),url:u(),foregroundColor:u(),backgroundColor:u(),altText:u()})}),voe=Fs.extend({type:v("research"),taskId:u(),title:u().nullish(),finalResponse:u().nullish()});Fs.extend({type:v("quiz")});const yoe=Fs.extend({type:v("video"),thumbnailUrl:u(),videoUrl:u()}),wx=fe("type",[foe,yoe,hoe,voe,goe]),sAe=wx.options.map(e=>e.shape.type.value),aAe=z(["image","video","page","research","podcast"]);f({type:u().optional()});const rAe=f({results:A(wx),next:u().nullable()}),iAe=f({id:u(),title:u()}),Coe=f({id:u(),title:u().nullish()}),Soe=f({id:u(),title:u().nullish()}),cAe=f({results:A(Soe),next:u().nullish()}),boe=z(["in-progress","ready","blocked","invalid-content","too-large","failed"]);z(["inProgress","failed","ready"]);const Ioe=f({attachmentId:u(),fileName:u(),contentType:u(),createdAt:u().optional(),status:boe.optional()}),lAe=f({results:A(Ioe),next:u().nullable()});z(["page","podcast"]);const Eoe=Fs.extend({type:v("page"),title:u().nullish(),pageId:u()}),Toe=Fs.extend({type:v("podcast"),podcastId:u(),title:u().nullish(),durationInSeconds:k(),thumbnail:f({name:u(),url:u(),foregroundColor:u(),backgroundColor:u(),altText:u()}).nullish()}),woe=fe("type",[Eoe,Toe]),uAe=f({results:A(woe),next:u().nullable()}),dAe=f({id:u()}),mAe=f({projectImpressionScenario:Q([v("projectChatHeader"),v("projectCreateModal"),v("projectHistoryItem"),v("projectSeeMoreItem")])}),Aoe="/projects";async function Ax(e){return(await pt(Aoe,Coe,{options:{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:e})}})).data}function pAe(){const e=Uu({mutationKey:["createProject"],mutationFn:n=>Ax(n)}),t=async n=>!!await xx(n,e.mutateAsync);return{isCreating:e.isPending,createProject:t}}async function xx(e,t){try{const{id:n}=t?await t(e):await Ax(e);return await qn({from:window.location.pathname,to:`/projects/${n}`,state:{projectImpressionScenario:"projectCreateModal"}}),await Ah.invalidateQueries({queryKey:["projects"]}),{id:n}}catch{Fo({title:F("common.somethingWrong"),message:F("projects.errors.errorCreatingMessage")});return}}const xoe=ke();function _x(e){xoe.set(ra,e)}function _oe(){const e=Br(),t=M(FT),[n,o]=Le(Lc);l.useEffect(()=>{e&&!n&&o(t)},[e,t,n,o])}function _f(){return typeof crypto<"u"&&typeof crypto.randomUUID=="function"?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=Math.floor(Math.random()*16);return(e==="x"?t:Math.floor(Math.random()*4+8)).toString(16)})}const kx=7e3;function Ao(e={}){return koe(e),null}function koe(e={}){const{msg:t,id:n,type:o="polite",timeout:s=kx}=e,a=G(gu),r=l.useRef(n??_f());l.useEffect(()=>{t&&a(i=>{if(i.some(m=>m.id===r.current&&m.msg===t&&m.type===o))return i;r.current=n??_f();const d={msg:t,id:r.current,type:o};return window.setTimeout(()=>{a(m=>m.filter(p=>p.id!==d.id))},s),[...i,d]})},[n,t,o,a,s])}function oo(e){const{msg:t,id:n,type:o="polite",timeout:s=kx}=e;if(!t)return;const a=ke();a.set(gu,r=>{const i={msg:t,id:n??_f(),type:o};return window.setTimeout(()=>{a.set(gu,d=>d.filter(m=>m.id!==i.id))},s),[...r,i]})}const Poe=10*1024*1024,Moe=5*1024*1024,Roe=50*1024*1024,Noe=3,Gn={"image/png":["png"],"image/jpeg":["jpg","jpeg"],"image/webp":["webp"],"image/svg+xml":["svg"],"application/pdf":["pdf"],"application/vnd.openxmlformats-officedocument.wordprocessingml.document":["docx"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":["xlsx"],"application/vnd.openxmlformats-officedocument.presentationml.presentation":["pptx"],"application/msword":["doc"],"application/vnd.ms-excel":["xls"],"application/vnd.ms-powerpoint":["ppt"],"application/json":["json"],"text/xml":["xml"],"application/x-sql":["sql"],"text/csv":["csv"],"text/markdown":["md"],"text/plain":["txt"],"text/html":["html","htm"],"text/javascript":["js"],"text/css":["css"],"application/xml":["xml"]},Loe={"image/png":["png"],"image/jpeg":["jpg","jpeg"]},Doe={"application/pdf":["pdf"],"application/vnd.openxmlformats-officedocument.wordprocessingml.document":["docx"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":["xlsx"],"application/vnd.openxmlformats-officedocument.presentationml.presentation":["pptx"],"application/json":["json"],"text/csv":["csv"],"text/markdown":["md"],"text/plain":["txt"]},sS=_(null),Px=_(e=>{const t=e(Lr("fileasyncprocessing"));return{maxFilesPerMessage:Noe,image:{maxBytes:Poe,mimeTypes:Loe},document:{maxBytes:t?Roe:Moe,mimeTypes:Doe}}}),Mo=_(e=>e(sS)??e(Px),(e,t,n)=>{t(sS,n)}),Va=_(e=>{const t=e(Mo);return{...t.image.mimeTypes,...t.document.mimeTypes}});function Wc(e){const t=B(Mo).document.mimeTypes;return e in t}function A1(e,t){if(!e)return!1;const n=xo(e);return Ooe(n,t)}function Ooe(e,t){if(!e||e==="")return!1;const n=B(Va),{supportedMimeTypes:o=n}=t??{};return e in o}function fAe(){const e=B(Va);return Object.keys(e).map(t=>t in Gn&&Gn[t]?[t,...Gn[t].map(n=>`.${n}`)]:[]).flat()}function hAe(){const e=B(Mo).document.mimeTypes;return Object.keys(e).map(t=>t in Gn&&Gn[t]?[t,...Gn[t].map(n=>`.${n}`)]:[]).flat()}function gAe(){const e=B(Mo).image.mimeTypes;return Object.keys(e).map(t=>t in Gn&&Gn[t]?[t,...Gn[t].map(n=>`.${n}`)]:[]).flat()}function jd(e){return Object.values(e).flat().map(t=>`.${t}`)}function Uoe(){const e=B(Mo).document.mimeTypes;return jd(e)}function Foe(){const e=B(Mo).image.mimeTypes;return jd(e)}function Mx(){const e=B(Mo);return{documentMaxSize:e.document.maxBytes,imageMaxSize:e.image.maxBytes}}function x1(e){const t=ese(e),n=B(Va),o=Object.entries(n).find(([,s])=>s.includes(t??""));return o?o[0]:""}function xo(e){return e?e.type!==""?e.type:x1(e.name):""}function Rx(e,t){const n=B(Va),{supportedMimeTypes:o=n,scenario:s}=t??{};let a,r=null;const i=Mx();if(!A1(e,{supportedMimeTypes:o}))a={title:F("composer.errors.unsupportedAttachmentTypeV2.title"),message:F("composer.errors.unsupportedAttachmentTypeV2.message")},r="fileType";else if(!Nx(e)){const d=xo(e);a={title:F("composer.errors.multi.attachmentTooLarge.title"),message:F("composer.errors.multi.attachmentTooLarge.message",{limit:Wc(d)?i.documentMaxSize/1024/1024:i.imageMaxSize/1024/1024})},r="fileSize"}return R.trackEvent({name:"system",data:{eventName:"clientFileValidation",eventInfo_errorType:r,eventInfo_fileType:xo(e),eventInfo_fileSize:e.size,eventInfo_customData:s?JSON.stringify({uploadFileScenario:s}):void 0}}),a}function joe(e){return e.type==="text/x-markdown"?new File([e],e.name,{type:"text/markdown"}):e}function Nx(e){const t=Mx(),n=xo(e),o=Wc(n)?t.documentMaxSize:t.imageMaxSize;return e.size<=o}function Boe(e){const t=e.clipboardData?.items;if(t)for(let n=0;n<t.length;n+=1){const o=t[n];if(o?.kind==="file"){const s=o.getAsFile();if(!A1(s))continue;const a=xo(s);if(s!==null)return Nx(s)?{file:s,error:void 0}:(R.trackEvent({name:"system",data:{eventName:"clientFileValidation",eventInfo_errorType:"fileType",eventInfo_fileSize:s.size,eventInfo_fileType:a,eventInfo_errorMessage:"File size too large in paste"}}),{file:void 0,error:{title:F("composer.errors.attachmentTooLargeV2.title"),message:F("composer.errors.attachmentTooLargeV2.message")}})}}return{file:void 0,error:void 0}}function Lx(e){switch(e){case"unsupported-content-type":return{title:F("composer.errors.unsupportedAttachmentTypeV2.title"),message:F("composer.errors.unsupportedAttachmentTypeV2.message")};case"attachment-too-large":return{title:F("composer.errors.attachmentTooLargeV2.title"),message:F("composer.errors.attachmentTooLargeV2.message")};case"empty-attachment":return{title:F("composer.errors.emptyAttachmentV2.title"),message:F("composer.errors.emptyAttachmentV2.message")};case"content-blocked":return{title:F("composer.errors.attachmentContentBlockedV2.title"),message:F("composer.errors.attachmentContentBlockedV2.message")};case"rate-limit-exceeded":return{title:F("composer.errors.attachmentRateLimitExceededV2.title"),message:F("composer.errors.attachmentRateLimitExceededV2.message")};default:return{title:F("composer.errors.attachmentDefault.title"),message:F("composer.errors.attachmentDefault.message")}}}function Dx(e,t){const n=window.URL.createObjectURL(e),o=document.createElement("a");o.style.display="none",o.href=n,o.download=t,document.body.appendChild(o),o.click(),window.URL.revokeObjectURL(n),o.remove()}function vAe(e,t,n){const o=new Blob([n],{type:t});Dx(o,e)}function Voe(e){const t=e.headers.get("Content-Disposition");if(!t)return;const n=t.match(/filename\*=UTF-8''([^;]+)/);if(n&&n[1])return decodeURIComponent(n[1]);const o=t.match(/filename=([^;]+)/);if(o&&o[1])return o[1].replace(/^"(.*)"$/,"$1")}async function Hoe(e){const{url:t,fileName:n,preferResponseFileName:o,args:s}=e,a=xd(t)?await fetch(t,s?.options):await ko(t,s);if(!a.ok)throw new Error(`Failed to fetch file: ${n} from ${t} (status: ${a.status})`);const r=await a.blob();let i=n;if(o){const d=Voe(a);d&&(i=d)}Dx(r,i)}function zoe({name:e,size:t,message:n,kind:o}){R.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"submitMessage",eventInfo_errorMessage:n,eventInfo_details:`Error uploading ${o} attachment`,eventInfo_uploadFileSize:t,eventInfo_uploadFileType:e,eventInfo_numDocumentsUploaded:1}})}function Goe(){return`file-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}function yAe(e,t){for(const n of e){const o=Rx(n,{supportedMimeTypes:t});if(o)return o}return null}function Woe(e){const t=Koe(e);return new File([e],t,{type:"text/plain"})}function $oe(e){return e.replace(/[\\/:*?"<>|]/g,"_").trim()}function qoe(e){return e.length>0&&!/^[_\s]+$/.test(e)}function Koe(e){const n=`${F("fileUpload.pastedTextDefaultFilename")}.txt`;if(!e||e.trim().length===0)return n;const s=e.split(`
`).find(r=>r.trim().length>0);if(!s)return n;let a=s.trim().slice(0,50);return a=$oe(a),qoe(a)?`${a}.txt`:n}const Yoe=2e3,Zoe=500*1024,Joe=1*1024*1024,Qoe=.05,Xoe=.15;function CAe(e){const{fileSizeBytes:t,minUploadFileTimeMs:n=Yoe,minUploadSpeedBytesPerSec:o=Zoe,maxUploadSpeedBytesPerSec:s=Joe,minBufferRatio:a=Qoe,maxBufferRatio:r=Xoe}=e,i=o+Math.random()*(s-o),d=t/i*1e3,m=n+d,p=a+Math.random()*(r-a),h=m*p;return m+h}function ese(e){return e?.split(".").pop()?.toLowerCase()}function _1(e){switch(e.kind){case"local-file":{const{file:t}=e;return{name:t.name,contentType:xo(t),size:t.size}}case"onedrive":{const{item:t}=e;return{name:t.name,contentType:x1(t.name),size:t.size}}default:{const t=e;throw new Error(`Unhandled upload kind: ${t}`)}}}function k1(e){return nu(e,Date.now())}function Su(e){const t=Eo(e);return t.setHours(0,0,0,0),t}function Gr(e,t){const n=Su(e),o=Su(t);return+n==+o}function P1(e){return Gr(e,k1(e))}function tse(e){return Gr(e,pc(k1(e),1))}function fn(e,t,n="en-US"){let o;if(e instanceof Date)o=e;else if(typeof e=="number")o=new Date(e<1e12?e*1e3:e);else if(typeof e=="string")o=new Date(e);else throw new Error(`Invalid date input: ${e}`);if(Number.isNaN(o.getTime()))throw new Error(`Invalid date: ${String(e)}`);switch(t){case"yyyyMMdd":{const s=o.getFullYear(),a=(o.getMonth()+1).toString().padStart(2,"0"),r=o.getDate().toString().padStart(2,"0");return`${s}${a}${r}`}case"yyyyMMdd_HHmmss":{const s=o.getFullYear(),a=(o.getMonth()+1).toString().padStart(2,"0"),r=o.getDate().toString().padStart(2,"0"),i=o.getHours().toString().padStart(2,"0"),d=o.getMinutes().toString().padStart(2,"0"),m=o.getSeconds().toString().padStart(2,"0");return`${s}${a}${r}_${i}${d}${m}`}case"h:mm aa":case"h:mm a":return new Intl.DateTimeFormat(n,{hour:"numeric",minute:"2-digit",hour12:!0}).format(o);case"h":return new Intl.DateTimeFormat(n,{hour:"numeric",hour12:!0}).formatToParts(o).find(r=>r.type==="hour")?.value??"";case"mm":return new Intl.DateTimeFormat(n,{minute:"2-digit"}).format(o).padStart(2,"0");case"a":return new Intl.DateTimeFormat(n,{hour:"numeric",hour12:!0}).formatToParts(o).find(r=>r.type==="dayPeriod")?.value??"";case"h a":return new Intl.DateTimeFormat(n,{hour:"numeric",hour12:!0}).format(o);case"PP":return new Intl.DateTimeFormat(n,{year:"numeric",month:"short",day:"numeric"}).format(o);case"EEEE":return new Intl.DateTimeFormat(n,{weekday:"long"}).format(o);case"eeee":return new Intl.DateTimeFormat(n,{weekday:"long"}).format(o);case"MMMM":return new Intl.DateTimeFormat(n,{month:"long"}).format(o);case"d":return o.getDate().toString();case"MM/dd":{const s=(o.getMonth()+1).toString().padStart(2,"0"),a=o.getDate().toString().padStart(2,"0");return`${s}/${a}`}case"MMM d":return new Intl.DateTimeFormat(n,{month:"short",day:"numeric"}).format(o);case"MMM":return new Intl.DateTimeFormat(n,{month:"short"}).format(o);case"eee, MMM d":return new Intl.DateTimeFormat(n,{weekday:"short",month:"short",day:"numeric"}).format(o);case"eee":return new Intl.DateTimeFormat(n,{weekday:"short"}).format(o);case"EE":return new Intl.DateTimeFormat(n,{weekday:"short"}).format(o);case"h:mma":return new Intl.DateTimeFormat(n,{hour:"numeric",minute:"2-digit",hour12:!0}).format(o).replace(" ","");case"haaa":return new Intl.DateTimeFormat(n,{hour:"numeric",hour12:!0}).format(o).replace(/\s+/g,"").toLowerCase();case"yyyy":return o.getFullYear().toString();case"MM":return(o.getMonth()+1).toString().padStart(2,"0");case"dd":return o.getDate().toString().padStart(2,"0");case"HH":return o.getHours().toString().padStart(2,"0");case"HH:mm":{const s=o.getHours().toString().padStart(2,"0"),a=o.getMinutes().toString().padStart(2,"0");return`${s}:${a}`}case"HH:mm:ss":{const s=o.getHours().toString().padStart(2,"0"),a=o.getMinutes().toString().padStart(2,"0"),r=o.getSeconds().toString().padStart(2,"0");return`${s}:${a}:${r}`}case"ss":return o.getSeconds().toString().padStart(2,"0");case"xD":{const a=Math.floor((new Date().getTime()-o.getTime())/(1e3*3600*24));return F("dates.time.dayAbbrCapitalized",{dayNumber:a})}case"xh":{const a=Math.floor((new Date().getTime()-o.getTime())/(1e3*3600));return F("dates.time.hourAbbr",{hourNumber:Math.max(1,a)})}case"xw":{const a=Math.floor((new Date().getTime()-o.getTime())/(1e3*3600*24*7));return F("dates.time.weekAbbr",{weekNumber:a})}case"yyyy-MM-dd":{const s=o.getFullYear(),a=(o.getMonth()+1).toString().padStart(2,"0"),r=o.getDate().toString().padStart(2,"0");return`${s}-${a}-${r}`}case"yyyy-MM-dd, h:mm aa":{const s=o.getFullYear(),a=(o.getMonth()+1).toString().padStart(2,"0"),r=o.getDate().toString().padStart(2,"0"),i=new Intl.DateTimeFormat(n,{hour:"numeric",minute:"2-digit",hour12:!0}).format(o);return`${s}-${a}-${r}, ${i}`}case"MMM d, yyyy":return new Intl.DateTimeFormat(n,{month:"short",day:"numeric",year:"numeric"}).format(o);default:return o.toLocaleString(n)}}function SAe(e,t="en-US"){const n=new Date(e),s=n.getMinutes()===0?fn(n,"h a",t):fn(n,"h:mm a",t);return P1(n)?F("dates.time.dayAtTimeFormat",{day:F("dates.time.today"),time:s}):tse(n)?F("dates.time.dayAtTimeFormat",{day:F("dates.time.tomorrow"),time:s}):F("dates.time.dayAtTimeFormat",{day:fn(e,"MMM d, yyyy",t),time:s})}function Ox(){return`Copilot_${fn(new Date,"yyyyMMdd_HHmmss")}`}function kf(e){e.target instanceof HTMLImageElement&&URL.revokeObjectURL(e.target.src)}async function nse(e,t=!1){try{const n=await ko(e,{analytics:{anonymousPath:"/attachments/*.png"}});return t&&n.status!==200?null:await n.blob()}catch{return null}}async function ose(e,t=!1){try{const n=await nse(e,t);return n?URL.createObjectURL(n):null}catch{return null}}const Ux={jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",webp:"image/webp"},tp="image";function sse(e){const{pathname:t}=new URL(e,"https://example.com");return t.split("/").pop()??"image.jpg"}function ase(e){const{pathname:t}=new URL(e,"https://example.com"),n=t.split("."),o=n.length>1?n.pop()?.toLowerCase()??"":"";return Object.keys(Ux).includes(o)?o:""}function rse(e){const t=ase(e);return Ux[t]??"image/jpeg"}const ise=async(e,t="image.jpg")=>{const o=await(await ko(e)).blob(),s=o.type||rse(e);return{file:new File([o],t,{type:s}),type:s}};function bAe(e){const t=e.naturalWidth/e.naturalHeight;return t>1.1?"landscape":t<.9?"portrait":"square"}async function cse({file:e,signal:t,pathBase:n="/attachments"}){try{const o=W("file-upload-card-v2");let s,a;if(o){const i=new FormData;e.type!==""?i.append("file",e):i.append("file",new File([e],e.name,{type:xo(e)}),e.name),s=i}else{const i=await e.arrayBuffer(),d=new Uint8Array(i);s=new Blob([d]),a={"Content-Type":xo(e)}}const r=await pt(n,gV,{options:{method:"POST",headers:a,body:s,signal:t}}).then(i=>i.data);if("errorCode"in r)throw new Error(r.errorCode);return r.url}catch(o){throw console.error("Error uploading image",o),o}}async function lse({file:e,signal:t,pathBase:n="/attachments"}){try{const o=new FormData;e.type!==""?o.append("file",e):o.append("file",new File([e],e.name,{type:xo(e)}),e.name);const s=await pt(n,vV,{options:{method:"POST",body:o,signal:t}}).then(a=>a.data);if("errorCode"in s)throw new Error(s.errorCode);return s.id}catch(o){throw console.error("Error uploading document",o),o}}async function Fx({id:e,connectorId:t,signal:n,type:o}){try{const s=await pt(`/connections/${t}/upload`,yV,{options:{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({externalIds:[e]}),signal:n}}).then(r=>r.data);if("errorCode"in s)throw new Error(s.errorCode);const a=s.results[0];if(!a||!a.isSuccessful)throw new Error("empty-attachment");return o==="image"?a.url??"":a.attachmentId}catch(s){throw console.error("Error uploading Cloud Drive file",s),s}}function jx(){const t=B(Er).find(n=>n.type==="one-drive");if(!t)throw new Error("OneDrive connector not found");return t.id}async function use(e,t,n="/attachments"){switch(e.kind){case"local-file":return lse({file:e.file,signal:t,pathBase:n});case"onedrive":return Fx({id:e.item.id,connectorId:jx(),signal:t,type:"document"});default:{const o=e;throw new Error(`Unhandled upload kind: ${o}`)}}}async function dse(e,t,n="/attachments"){switch(e.kind){case"local-file":return cse({file:e.file,signal:t,pathBase:n});case"onedrive":return Fx({id:e.item.id,connectorId:jx(),signal:t,type:"image"});default:{const o=e;throw new Error(`Unhandled upload kind: ${o}`)}}}async function mse(e){const{uploadTasks:t,signal:n,onSuccess:o,onError:s,onFinish:a}=e,r=t.map(async i=>{const d=i.upload,m=i.uploadEndpointOverride??"/attachments";try{if(i.type==="document"){const h={content:{type:"document",attachmentId:await use(i.upload,n,m)},item:{type:"document",partId:i.partId,fileName:i.metadata.name,contentType:i.metadata.contentType},size:i.metadata.size,type:i.metadata.contentType},g={id:i.id,file:i.upload.file,scenario:i.scenario,processing:!1,attachment:h,type:"file"};o(g)}else{const p=await dse(i.upload,n,m);let h;i.uploadEndpointOverride&&(h=URL.createObjectURL(i.upload.file));const g={content:{type:"image",url:p,fileName:i.metadata.name},item:{type:"image",url:p,fileName:i.metadata.name,localUrl:h},size:i.metadata.size,type:i.metadata.contentType},y={id:i.id,file:d.file,scenario:i.scenario,processing:!1,attachment:g,type:"image"};o(y)}}catch(p){s&&s(p,i)}finally{a()}return null});return Promise.all(r)}function IAe(e,t){const n=t.split(".").pop()??"";return`/attachments/${e}.${n}`}async function EAe(e){const{file:t,type:n}=await ise(e,sse(e));return{id:`file-${Date.now()}-${crypto.randomUUID()}`,file:t,processing:!1,attachment:{content:{type:tp,url:e},item:{type:tp,url:e},size:t.size,type:n},type:tp}}const Bx=ke();let Pf=0;const bu=new Set;function Mi(e){Bx.set(zc,e)}function Vx(e){return e instanceof Error&&e.message==="not-signed-in"}function pse(){Bx.set(Us,{isOpen:!0,scenario:null,reason:"fileUpload"})}async function Hx(e){const{uploads:t,scenario:n,onError:o,onSuccess:s,replaceExisting:a=!1,shouldUploadImageAsDocument:r,uploadEndpointOverride:i}=e;a&&Iu();const d=[],m=[];for(const h of t){const g=_1(h),y=Wc(g.contentType),b=Goe();if(y||r){const C=String(Pf);Pf+=1,d.push({id:b,upload:h,partId:C,metadata:g,type:"document",uploadEndpointOverride:i}),m.push({id:b,file:h.file,scenario:n,processing:!0,type:"file"})}else d.push({id:b,upload:h,metadata:g,type:"image",uploadEndpointOverride:i}),m.push({id:b,file:h.file,scenario:n,processing:!0,type:"image"})}Mi(h=>[...h,...m]);const p=new AbortController;bu.add(p),await mse({signal:p.signal,uploadTasks:d,onSuccess:h=>{Mi(g=>g.map(y=>y.id===h.id?h:y)),s?.(h)},onError:(h,g)=>{if(Vx(h))throw Iu(),pse(),h;const y={id:g.id,file:g.upload.file,scenario:n,processing:!1,error:h};Mi(b=>b.map(C=>C.id===g.id?y:C)),o&&o(h,g.upload)},onFinish:()=>{bu.delete(p)}}),Lt({scenario:n??"fileUpload",page:"uploadAttachmentVanilla"})}function Iu(){Mi([]),Gx(),Pf=0}function zx(e){Mi(t=>{const n=[...t];return n.splice(e,1),n})}function Gx(){for(const e of bu)e.abort();bu.clear()}function fse(){const[e,t]=Le(zc),{t:n}=Z();return l.useEffect(()=>()=>{Gx()},[]),{uploadedAttachments:e,isUploadingAttachments:e.some(o=>o.processing===!0),getUploadMetadata:_1,setUploadedAttachments:t,removeAttachmentByIndex:zx,clearAttachments:Iu,uploadAttachments:async({uploads:o,scenario:s,onError:a,onSuccess:r,replaceExisting:i,shouldUploadImageAsDocument:d,uploadEndpointOverride:m})=>Hx({uploads:o,scenario:s,onError:a,replaceExisting:i,shouldUploadImageAsDocument:d,uploadEndpointOverride:m,onSuccess:p=>{if(r)r(p);else if(p.attachment?.item){const{type:h}=p.attachment.item;oo({msg:n(h==="image"?"fileUpload.uploadedImage":"fileUpload.uploadedFile")})}}})}}function hse(e={}){return new Promise(t=>{const n=document.createElement("input");n.type="file",n.accept=e.accept??"*",n.multiple=e.multiple??!1,n.onchange=o=>{const{files:s}=o.target;t(s),n.remove()},n.oncancel=()=>{t(null),n.remove()},n.click()})}class gse{constructor(t,n,o,s){this.clearuploadedFile=t,this.onFileUpload=n,this.setSystemError=o,this.onRequiredSignIn=s}get uploadedAttachments(){return B(zc)}get ALL_ALLOWED_MIME_TYPES(){return B(Va)}get existingValidFiles(){return this.uploadedAttachments.filter(({error:t})=>!t)}get existingFileKeys(){return new Set(this.existingValidFiles.filter(({file:t})=>!!t).map(({file:t})=>`${t?.name}-${t?.size}-${t?.type}-${t?.lastModified}`))}get maxFilesPerMessage(){return B(Mo).maxFilesPerMessage}get existingFilesLength(){return this.existingValidFiles.length}async processUploadedFiles(t){const{uploads:n,scenario:o,supportedMimeTypes:s=this.ALL_ALLOWED_MIME_TYPES,uploadEndpointOverride:a}=t,r=n.filter(({file:i})=>!this.existingFileKeys.has(`${i.name}-${i.size}-${i.type}-${i.lastModified}`));if(r.length===0){this.clearuploadedFile();return}if(this.existingFilesLength+r.length>this.maxFilesPerMessage){this.setSystemError({title:st.t("composer.errors.multi.tooManyFiles.title",{maxFiles:this.maxFilesPerMessage}),message:st.t("composer.errors.multi.tooManyFiles.message")});return}for(const i of r){const d=Rx(i.file,{supportedMimeTypes:s,scenario:o});if(d){this.setSystemError(d),this.clearuploadedFile();return}}this.onFileUpload();try{await Hx({uploads:r,uploadEndpointOverride:a,scenario:o,onError:(i,d)=>{if(i instanceof Error){this.setSystemError(Lx(i.message));const{name:m,size:p}=_1(d);zoe({name:m,size:p,message:i.message,kind:d.kind})}else this.setSystemError({title:st.t("composer.errors.default.title"),message:st.t("composer.errors.default.message")})}})}catch(i){Vx(i)?this.onRequiredSignIn():this.setSystemError({title:st.t("composer.errors.default.title"),message:st.t("composer.errors.default.message")})}}async processUploadedLocalFiles(t){const{rawFiles:n,scenario:o,supportedMimeTypes:s=this.ALL_ALLOWED_MIME_TYPES,uploadEndpointOverride:a}=t;if(n.length===0)return;const r=[];for(const i of n)r.push({file:joe(i),kind:"local-file"});await this.processUploadedFiles({uploadEndpointOverride:a,uploads:r,scenario:o,supportedMimeTypes:s})}resetFileUpload(){Iu(),this.clearuploadedFile()}removeAttachment(t){this.uploadedAttachments.length===1?this.resetFileUpload():zx(t)}}function vse(e,t,n,o){const s=l.useRef(null);s.current??=new gse(n,e,t,o);const{isUploadingAttachments:a,uploadedAttachments:r}=fse(),i=s.current.processUploadedFiles.bind(s.current),d=s.current.processUploadedLocalFiles.bind(s.current),m=s.current.resetFileUpload.bind(s.current),p=s.current.removeAttachment.bind(s.current);return{processUploadedFiles:i,processUploadedLocalFiles:d,isUploadingAttachments:a,uploadedAttachments:r,resetFileUpload:m,removeAttachment:p}}async function yse(){const e=ke(),t=e.get(Va),n=jd(t),o=await hse({accept:n.join(","),multiple:!0});o&&o.length>0&&e.set(zw,Array.from(o))}function Vt(){return lb({select:t=>t.at(-1)?.pathname??"/"})}function Wx(e){const{deferred:t=!1}=e??{},n=ib(),[o,s]=Le(Ng),a=G(jc);l.useEffect(()=>{const d=uz();d&&s(d)},[n.search,s]);const r=l.useCallback(()=>{s(null)},[s]),i=l.useCallback(d=>{d&&a({source:"promptInUrl",prompt:d})},[a]);return l.useEffect(()=>{o&&!t&&i(o)},[t,i,o]),{prompt:o,handler:t?i:void 0,clear:r}}function Cse(){const e=q("prompt-pt-learn-partial"),t=q("prompt-pt-learn-full"),n=q("prompt-pt-learn-fill"),o=q("prompt-pt-advice-partial"),s=q("prompt-pt-advice-full"),a=q("prompt-pt-advice-fill"),r=q("prompt-pt-ideas-partial"),i=q("prompt-pt-ideas-full"),d=q("prompt-pt-ideas-fill"),m=q("prompt-pt-msn-answers"),p=q("prompt-pt-msn-headlines"),h=q("prompt-pt-msn-events"),g=q("prompt-pt-msn-answers-full"),y=q("prompt-pt-msn-headlines-full"),b=q("prompt-pt-msn-events-full"),C=R.getFormCode();let T=null,S=!1,E=!1,I=!1;switch(C){case"NTPCHB":{e||t||n?T="teach":o||s||a?T="advice":(r||i||d)&&(T="ideas"),S=e||o||r,E=t||s||i,I=n||a||d;break}case"MSNCHB":{m||g?T="answers":p||y?T="headlines":(h||b)&&(T="events"),E=g||y||b,I=m||p||h;break}default:T=null}let x=null;S?x="prefix":(E||I)&&(x="complete");let w=null;return S||I?w="partial":E&&(w="full"),{formCode:C,treatment:T,lengthVariant:x,passthroughType:w}}function $x(e){const[t,n]=l.useState(!1),o=M(jl),s=l.useRef(e);return l.useEffect(()=>{s.current=e},[e]),l.useEffect(()=>{async function a(){if(!o)return;await(s.current??(()=>Promise.resolve(!1)))()&&n(!0)}a().catch(()=>{})},[o]),t}function Sse(){return!1}function bse(){const e=Dt(),t=!!M(Sd),o=M(Bt)==="US";return M(cG)&&e&&!t&&o}function Ise(){return $x(J.instance().config().actions?.enableActionsModeDropdown)}function qx(){const e=Ise(),t=bse();return e&&t}function Ese(){return $x(J.instance().config().actions?.enableActionsV2Model)}function TAe(){return Ese()}function Kx(){const e=q("coco-mode"),t=M(vt)?.ageGroup==="adult";return e&&t}function Tse(e,t){const{isBrowserActionsModeEnabled:n=!1,isCocoModeEnabled:o=!1}=t??{};switch(e){case"td":return"reasoning";case"sm":return"smart";case"cs":return"search";case"st":return"study";case"co":return o?"coco":null;case"ba":return n?"browserAction":null;case"ac":return"computerUse";default:return null}}let Mf=null;function wse(){const e=G(nT),t=qx(),n=Kx();l.useEffect(()=>{const o=cz(),s=pz();Mf??=o;const a=o??Mf,r=a?Tse(a,{isBrowserActionsModeEnabled:t,isCocoModeEnabled:n}):null;r&&hn(r),s&&e(!0)},[t,n,e])}function Ase(){return Mf}function Yx(e){const{deferred:t=!1}=e??{},n=!!M(Te),o=M(Dr),[s,a]=Le(Rg),r=G(jc),i=sn(),d=i.startsWith("/chats")&&i!=="/chats/new",m=Ba();l.useEffect(()=>{const y=Ase()==="ac"||d?null:lz();if(y){const b=Sz();a({prompt:y,inputMethod:b}),r({source:"queryInUrl",prompt:y})}},[r,a,d]);const p=l.useCallback(()=>{a(null)},[a]),h=l.useCallback(g=>{g&&(r({source:"queryInUrl",prompt:g}),(async()=>{if(n&&o&&g){const b=performance.now(),C=s?.inputMethod??"queryParam";await to(),await Wo.submitMessage({text:g,inputMethod:C,messageStartTime:b,connectionType:m?"temporary":"regular"}),p()}})().catch(console.error))},[r,n,o,p,s,m]);return l.useEffect(()=>{!t&&s&&h(s.prompt)},[t,h,s]),{prompt:s?.prompt??null,handler:t?h:void 0,clear:p}}function Zx(){const e=xse(),t=_se();return e.prompt?e:t}function xse(){const{t:e}=Z(),{formCode:t,lengthVariant:n,treatment:o,passthroughType:s}=Cse();if(t&&n&&o){const a=e(`promptsByFormCode.${t}.${o}.${n}`,"");return{passthroughType:s,prompt:a,source:a?{type:"formCode",formCode:t}:void 0}}return{passthroughType:null}}function _se(){const{prompt:e}=Wx({deferred:!0}),{prompt:t}=Yx({deferred:!0});let n=null,o;return e?(n="partial",o=e):t&&(n="full",o=t),{passthroughType:n,prompt:o,source:o?{type:"query"}:void 0}}function M1(){const e=M(Rg),{passthroughType:t}=Zx();return!!e?.prompt&&t==="full"}const kse={study:"conversation-starter-study-and-learn"},Pse=_(0),Jx=_(void 0),Bd=_(!1),R1=_(e=>{const t=e(hG),n=e(hT),o=e(Jx),s=e(Bd);if(t)return t;if(!(s||n))return o}),Mse=_(e=>{const t=e(wr);return kse[t]}),Qx=_(e=>{const n=e(R1)?.widgets,o=e(Mse);if(o){const s=n?.find(a=>a.id===o);if(s)return{widget:s,isModeSpecific:!0}}return{widget:n?.[0],isModeSpecific:!1}}),Xx=_(e=>e(Qx).widget),Rse=_(e=>e(Qx).isModeSpecific),N1=_(e=>{const t=e(R1);return e(Bd)||!t?null:t.greetingOptions[0]?.text??null}),e_=_(!1),Nse=_(e=>e(R1)?.widgets?.find(o=>o.type==="banner")),wAe=[6,3,1],AAe=[20,10],xAe="_all",_Ae=6,kAe=20,PAe=1e4,MAe={ChartHeight:250,Colors:{stroke:"white",gray:"#999",highPrice:"#D8001D",mediumHighPrice:"#F85900",mediumPrice:"#F8B200",mediumLowPrice:"#B4B400",lowPrice:"#56A503",label:"rgb(var(--color-background-900))"},GradientStopIndex:{Low:0,MediumLow:1,Medium:2,MediumHigh:3,High:4},GradientStepMultipliers:[.8,.9,1,1.1,1.2],LabelPositionThreshold:.85},RAe={initial:{height:0,opacity:0,overflow:"hidden"},animate:{height:"auto",opacity:1,transition:{height:{duration:.4},opacity:{duration:.25,delay:.15}}},exit:{height:0,opacity:0,transition:{height:{duration:.4},opacity:{duration:.25}}}},NAe="https://www.microsoft.com/microsoft-copilot/learn/#faqs8",LAe="https://www.bing.com/rebates/history",DAe=30;function Lse(){return{hasMinimumMetadata:!1,hasRichMetadata:!1,canShowGenInsights:!1,breakdown:{hasProductTitle:!1,hasProductImage:!1,hasBuyingOptions:!1,hasReviews:!1,hasPriceHistory:!1,hasConversationStarters:!1,conversationStartersLength:0}}}const OAe={"lowest-price":{stringKey:"product.tags.lowestPrice",rank:1},"free-shipping":{stringKey:"product.tags.freeShipping",rank:2},"marketplace-free-shipping":{stringKey:"product.freeDelivery",rank:2}},Dse=_(void 0),UAe=_(!1),Ose=_(void 0),Use=_(Lse()),Fse=_(void 0),t_=_(!1);_(void 0);const jse=gc(new Map),FAe=_(e=>{const t=e(jse);return Array.from(t.values()).some(n=>n.isTracked)});_(void 0);const jAe=_(null),BAe=gc(void 0),VAe=_(null);_(LO.parse({}));const HAe=_(null),Bse=_(void 0);function Vse(e){const{offer:t}=e,n=Dt(),o=M(Bse)?.isRebatesActive===!0;return l.useMemo(()=>!t||!n?!1:t.type==="affiliate"?o:!n_(t),[t,n,o])}function n_(e){if(!e||!e.expiresAt)return!0;const t=new Date(e.expiresAt).getTime();return Number.isNaN(t)?!0:t<Date.now()}function Hse(e){const{cashbackOffers:t,shoppingInsights:n}=e,o=t??[],s=o.filter(d=>d.type==="productAd"||d.type==="storewideAd"),a=s.length>0?s.reduce((d,m)=>{const p=new Date(d.expiresAt);return new Date(m.expiresAt)>p?m:d}):null,r=o.find(d=>d.type==="affiliate")??null,i=a?!n_(a):!1;return n?.scenario==="cashback"?{selectedOffer:n.cashbackData.isAdOffer?a:r}:i?{selectedOffer:a}:r?{selectedOffer:r}:{selectedOffer:null}}function zse(e){const{cashbackOffers:t,shoppingInsights:n,hasProductMetaData:o}=e,{selectedOffer:s}=Hse({cashbackOffers:t,shoppingInsights:n}),a=q("edge-shopping-enable-product-ads-cashback"),r=t?.find(m=>m.type==="affiliate")??null;return{overriddenCashbackOffer:!o&&s?.type==="productAd"&&!a?r:s}}const Gse=[{offerType:"affiliate",isActivated:!0,isAuthenticated:!0,scenario:"affiliateActivated"},{offerType:"affiliate",isActivated:!1,isAuthenticated:!1,scenario:"affiliateUnauthenticated"},{offerType:"productAd",isActivated:!0,isAuthenticated:!0,scenario:"productAdsActivatedMultipleOffers"},{offerType:"storewideAd",isActivated:!0,isAuthenticated:!0,scenario:"storewideActivated"},{offerType:"storewideAd",isActivated:!1,isAuthenticated:!1,scenario:"storewideUnauthenticated"}];function Wse(e){const t=Gse.find(n=>n.offerType===e.offerType&&n.isActivated===e.isActivated&&n.isAuthenticated===e.isAuthenticated);return t?t.scenario:null}function $se(e){const{cashbackOffer:t}=e,n=Dt(),o=Vse({offer:t});return t?!!Wse({offerType:t.type,isActivated:o,isAuthenticated:n}):!1}function Wr(){const e=M(La),t=M(Rt);return e.length===0&&!!t?.isNew}function qse(e,t){const{hasMinimumMetadata:n}=e;if(n)return"shoppingCard";if(t)return"cashbackCard"}function Ha(){const e=M(t_),t=M(Use),n=M(Ose),o=M(Fse)?.offers,{overriddenCashbackOffer:s}=zse({cashbackOffers:o,shoppingInsights:n?.insights??void 0,hasProductMetaData:!!n}),a=Wr(),r=!it("kill-contextual-shopping"),i=a&&r&&(!!n||!!s),d=i?qse(t,!!s):void 0,m=i&&!!n?.insights,p=$se({cashbackOffer:s})&&d==="cashbackCard";return{isContextualShoppingCardExpanded:e,showShoppingCardInNewChat:i,shoppingScenario:d,cashbackOffer:s,shoppingProductMetadata:n,isCopilotOpenedViaEdgeCTAs:m,hasInsightsSummary:i&&(m||p)}}function Kse(e){if(!e.length)return;const t=Cr("greetingIndex"),n=e.length,o=t?(parseInt(t,10)+1)%n:0;return Wi("greetingIndex",o.toString()),e[o]}const L1=_(!1),Yse=_(!1),o_=ke(),Zse=["chat.launchMessage.authenticatedV3Type1","chat.launchMessage.authenticatedV3Type2","chat.launchMessage.authenticatedV3Type3"],Jse=["chat.launchMessage.unauthenticatedV3Type1","chat.launchMessage.unauthenticatedV3Type2","chat.launchMessage.unauthenticatedV3Type3"],np={study:["chat.launchMessage.studyModeLaunchMessage"],search:["chat.launchMessage.searchModeLaunchMessage"]};function Qse(){o_.set(L1,!0)}function Xse(){o_.set(L1,!1)}function s_(){const e=M(L1),t=M(OT),n=M(N1),o=Zt(),s=q("feature-discovery"),r=M(uf)==="banner",i=s&&r&&o in np,{showShoppingCardInNewChat:d,shoppingScenario:m}=Ha(),h=l.useCallback(()=>d?t?m==="cashbackCard"?["chat.launchMessage.authenticatedShoppingCashback"]:["chat.launchMessage.authenticatedShoppingType1"]:m==="cashbackCard"?["chat.launchMessage.unauthenticatedShoppingCashback"]:["chat.launchMessage.unauthenticatedShoppingType1"]:i&&np[o]?np[o]:t?Zse:Jse,[d,i,o,t,m])(),g=l.useMemo(()=>Kse(h),[h]),y=Number(Cr("greetingIndex"))||0;return{launchGreetingShown:e,greetingKey:g,widgetGreeting:n,greetingIndex:y,shouldAnimateGreeting:i}}function D1(){const e=hz()??gz();if(e&&vz(e))return e}function O1(){return!B(aT)}function eae(){const e=O1(),{showShoppingCardInNewChat:t}=Ha(),n=!gt({breakpoint:"sm"}),o=!!J.instance().config().landingPage?.enableCentralComposer;return e&&!(t&&n)&&o}function tae(e){const t=O1(),n=!!J.instance().config().landingPage?.enableStarterPrompts;return t&&e&&n}function nae(e){const t=O1(),n=W("appr-home");return t&&e&&n}function U1(e){const t=W("autosuggest"),n=W("edge-autosuggest"),o=t||n,s=!!J.instance().config().landingPage?.enableAutoSuggest;return o&&s&&e}function oae(){const{launchGreetingShown:e}=s_(),{hasInsightsSummary:t}=Ha(),n=M(Yse),o=M1();return!t&&!n&&!e&&!o}function za(){const t=Vt()==="/",n=nae(t),o=eae(),s=oae(),a=D1();return{isAutoSuggestEnabled:U1(t),isCentralComposerEnabled:o,isStarterPromptsEnabled:tae(t),isAppearanceOnHomeEnabled:n,isGreetingCentered:n||!a&&W("categorized-conversation-starter-widget"),showLaunchGreeting:s}}function a_(e,t){switch(e){case"image":return t("composer.create.image.prompt");case"podcast":return t("composer.create.podcast.prompt");case"researchReport":return t("composer.create.researchReport.prompt");case"quiz":return t("composer.create.quiz.prompt");case"actions":return t("composer.create.actions.prompt");case"video":return t("composer.create.video.prompt");case"page":return t("composer.create.page.prompt");case null:default:return""}}function zAe(e){Lt({page:"chat",scenario:e})}function sae(e){Lt({page:"chat",element:"mentionPopup",customData:JSON.stringify({conversationId:e})})}function aae(e,t){de({source:"mentionPopup",scenario:"selectMention",conversationId:e,customData:JSON.stringify({mentionedCopilot:t,mentionedUser:!t})})}function rae(e){const t=e.textWithReferences.filter(o=>o.type==="reference"&&o.reference.type==="copilot").length,n=e.textWithReferences.filter(o=>o.type==="reference"&&o.reference.type==="user").length;return t===0&&n===0?{}:{mentionedCopilot:t,mentionedUser:n}}const r_=ke(),F1=_(null),j1=_(null);function i_(e){r_.set(F1,e)}function c_(e){r_.set(j1,e)}function iae(e,t){const n={eventInfo_inputLength:typeof e=="string"?e.length:e.plainText.length};let o=n;const s=B(F1);if(s){const{source:r,type:i,prompt:d}=s;r==="widgets"?o={...n,widget:i,widgetPromptLength:d.length}:r==="guideLink"?o={...n,guideLinkLength:d.length,guideLinkText:d}:o={...n,pill:i,pillPromptLength:d.length}}const a=B(j1);return a&&(o={...o,autoCompleteLength:a.prompt.length}),t?.length!==0&&t?.[0]?.scenario&&(o={...o,uploadFileScenario:t[0].scenario}),typeof e!="string"&&(o={...o,...rae(e)}),JSON.stringify(o)}function cae(e){const t=B(F1),n=B(j1),o=t?.prompt.trim(),s=e.trim(),a=n?.prompt.trim(),r=n?.prefix.trim(),i=s.toLowerCase()===a?.toLowerCase();return!i&&!t?null:i?!o||!s.toLowerCase().includes(o.toLowerCase())?"autoComplete":r&&r.length>o.length?t?.source==="widgets"?"widgetWithTextAndAutoComplete":"pillWithTextAndAutoComplete":r?.length===o.length?t?.source==="widgets"?"widgetWithAutoComplete":"pillWithAutoComplete":"autoComplete":!o||!s.toLowerCase().includes(o.toLowerCase())?null:s.length>o.length?t?.source==="widgets"?"widgetWithText":t?.source==="guideLink"?"guideLinkWithText":"pillWithText":t?.source==="widgets"?"widget":t?.source==="guideLink"?"guideLink":"pill"}function lae(){i_(null),c_(null)}const l_=ke();function u_(e){const{text:t,attachments:n,inputMethod:o,isLandingRoute:s}=e,a=uK(),r=vf(),i=Gu({breakpoint:"sm"}),d=co(),m=B(Yt),p=!ot("kill-chat-message-preview"),h=d==="computerUse",g=W("long-term-memory"),y=W("conversation-drift-detection"),b=!h&&p&&(d==="smart"||g||y)&&eT(),T=U1(s)&&!m&&!h;if(t||yi("starter-prompts"),_i(a.length<=0||t.length===0),jw(void 0),l_.set(r1,void 0),gK(o??"user"),r&&_x("typing"),i&&Qse(),T&&wf(t),b)try{Wo.sendMessagePreview({text:t,inputMethod:"text",filesWithAttachment:n??[]})}catch{}}function Zi(e,t){const{prompt:n,prefillSource:o}=e;document.querySelector(`#${Cc}`)&&(Yi(),du(n),u_({text:n,inputMethod:o,isLandingRoute:t}),Rf("end"))}function Rf(e=null){const t=document.querySelector(`#${Cc}`);if(!t)return;requestAnimationFrame(()=>{if(t.focus(),e===null)return;const o=t.value.length;if(e==="selectAll"){t.setSelectionRange(0,o);return}let s;e==="start"?s=0:s=o,t.setSelectionRange(s,s)})}async function Eu(e,t){const{actionType:n,id:o,prompt:s,source:a,chatMode:r,composerCreateMode:i}=e;let d="starterPill";switch(a==="widgets"?d="widget":a==="guideLink"?d="guideLink":a==="banner"?d="featureDiscoveryBanner":a==="hub"&&(d="hub"),n){case"prefillComposer":{s&&(o&&i_({prompt:s,type:o,source:a}),Zi({prompt:s,prefillSource:d},t));break}case"sendMessage":{if(s)try{const m=performance.now();mu(!0),await to(),await Wo.submitMessage({text:s,inputMethod:"text",messageStartTime:m,connectionType:Pd()?"temporary":"regular"})}finally{mu(!1)}break}case"changeChatMode":{r&&hn(r,a);break}case"changeComposerCreateMode":{if(i){const m=a_(i,F);Zi({prompt:m,prefillSource:d},t),Ar(i)}break}case"tutoringCall":{await to({talkType:"talk"});break}case"createPage":{let m,p;a==="banner"?(m="createNewPage",p="featureDiscoveryCreateNewPage"):(m="chatPage",p="chatWidgetCreatePage"),await poe({sourcePage:m,impressionScenario:p,featureLatencyInfo:{scenario:"createPage",startTimestamp:Date.now()},autoNavigate:!0});break}case"createProject":{await xx();break}case"openHomeworkHelper":l_.set(yT,!0);break;case"uploadFile":await yse();break}}const uae="copilot-action://",d_={"composer-prefill":f({text:u().min(1)}),"composer-send":f({text:u().min(1)})};function dae(e){return e in d_}function m_(e){return e.startsWith(uae)}function mae(e,t){const o=d_[e].safeParse(Object.fromEntries(t));if(!o.success)throw new Error(`Invalid params for action '${e}': ${o.error.message}`);return o.data}function pae(e){try{if(!m_(e))throw new Error(`Not a conversation action link - ${e}`);const t=new URL(e),n=t.hostname;if(!dae(n))throw new Error(`Invalid conversation action type - ${n}`);if(!Nf(n))throw new Error(`Conversation action type is not enabled - ${n}`);const o=mae(n,t.searchParams);return{action:n,params:o}}catch{return null}}function Nf(e){if(ot("kill-conversation-actions"))return!1;switch(e){case"composer-prefill":return W("conversation-action-composer-prefill");case"composer-send":return W("conversation-action-composer-send");default:return!1}}async function GAe(e,t,n){const o=e.action;switch(de({source:"ConversationAction",scenario:o,messageId:n.messageId,conversationId:n.conversationId,customData:JSON.stringify({linkText:n.linkText,composerPrompt:e.params.text})}),o){case"composer-prefill":await Eu({actionType:"prefillComposer",source:"guideLink",prompt:e.params.text,id:"conversation-action-composer-prefill"},t);break;case"composer-send":{B(Rc)&&await Wo.stopMessage(),await Eu({actionType:"sendMessage",source:"guideLink",prompt:e.params.text,id:"conversation-action-composer-send"},t);break}}}const WAe=e=>{if(!(m_(e)&&!pae(e)))return e};function $Ae(e){const t=/\[([^\]]+)\]\(copilot-action:\/\/[^)]*\)/g;return e.replace(t,"$1")}const fae="guide://action",hae="prefill";function Gl(){return Mc(["guided-conversations-black","guided-conversations-cocoa","guided-conversations-caramel","edu-guided-conversations-black"],"any")}function gae(e){const{parameters:t}=e,{Prefill:n,Phrase:o}=t;return{prefill:n,targetText:o}}function qAe(e,t){const n=fn(e,"h:mm a",t);return P1(e)?n:`${fn(e,"MMM d",t)}, ${n}`}function vae(e){return e==="/tasks"||e==="/tasks/"}function yae(e){return/^\/tasks\/[^/]+\/?$/.test(e)}function Cae(e){return yae(e)||vae(e)}const p_={Badge:"1.2",Basic:"1.2",Box:"1.2",Button:"1.2",Card:"1.2",Caption:"1.2",Col:"1.2",DatePicker:"1.2",Divider:"1.2",Icon:"1.2",Image:"1.2",Label:"1.2",ListView:"1.2",ListViewItem:"1.2",RadioGroup:"1.2",Row:"1.2",Text:"1.2",Title:"1.2",Spacer:"1.2"};function Sae(){return W("media-spotlight-card")||W("media-spotlight-card-v2")}async function bae(){const e=!ot("kill-weather-cards"),t=!ot("kill-image-cards"),n=!ot("kill-local-cards"),o=!ot("kill-sports-cards"),s=!ot("kill-video-cards"),a=!ot("kill-searchhealthcareinfo"),r=!ot("kill-searchhealthcareprovider"),i=W("shopping-card"),d=W("shopping-curated"),m=Sae(),p=W("job-cards"),h=!ot("kill-safetycards"),g=!ot("kill-quiz-cards"),y=W("generateads"),b=W("generateadsint"),C=W("adsparity"),T=!ot("kill-finance-cards"),S=W("adstagsonline"),E=W("product-ads-dynamic-filter"),I=W("property-promotion-ads-dynamic-filter"),x=W("tour-activity-ads-dynamic-filter"),w=W("adsshowroombrandagent"),P=W("emoji-reactions"),D=!ot("kill-recipe-cards"),L=W("file-cards"),j=W("side-by-side-comparison"),U=W("inline-image"),$=W("inline-video"),{adsEnabled:K,adsShowroomEnabled:X,disableAnswerCards:ne,enforceAdsOptOutOfPersonalization:me,answerCardOverrides:Se}=J.instance().config(),ge=!!ke().get(BW),ve=(y||b||C)&&K&&!ge,Pe=W("ppt-generation"),Me=m&&Se?.shouldEnableMediaSpotlightCard,ye=W("news-card"),Ie=W("media-carousel-card"),He=!ot("kill-personal-data-card"),Ze=W("m365-cards"),Be=!ot("kill-nav-links"),be=!ot("kill-consent-card-v2"),re=!ot("kill-flash-cards"),te=W("person-cards"),H=Gl(),Y=Nf("composer-prefill"),ue=Nf("composer-send"),oe=W("connector-consent-v2"),De=W("connector-create-calendar"),_e=W("email-skill")||W("compose-email-tool"),ze=W("session-duration-nudge"),We=W("genuimvp"),Oe=W("homework-helper"),qe=W("windowslocalfilesearch"),se=[];ne||(e&&se.push("weather"),n&&se.push("local"),t&&se.push("image"),U&&se.push("inlineImage"),o&&se.push("sports"),s&&se.push("video"),$&&se.push("inlineVideo"),r&&se.push("healthcareEntity"),a&&se.push("healthcareInfo"),i&&se.push("shopping"),p&&se.push("job"),ve&&se.push("ads"),h&&se.push("safetyHelpline"),g&&se.push("quiz"),T&&se.push("finance"),d&&se.push("shoppingCurated"),D&&se.push("recipe"),L&&se.push("file"),Me&&se.push("mediaSpotlight"),ye&&se.push("newsCarousel"),Ie&&se.push("mediaCarousel"),He&&se.push("personalArtifacts"),Ze&&se.push("m365"),re&&se.push("flashcard"),Be&&se.push("navigation"),be&&se.push("consent"),te&&se.push("person"),Pe&&se.push("powerPointCreator"),oe&&se.push("consentV2"),_e&&se.push("composeEmail"),De&&se.push("createCalendarEvent"),Oe&&se.push("tapToReveal"),Cae(window.location.pathname)&&se.push("elicitation"),qe&&se.push("filesearch"));const ie={supportedTypes:["text","product","multimedia","tourActivity","propertyPromotion"]};me&&(ie.optOutOfPersonalization=!0),w&&K&&X&&ie.supportedTypes.push("showroom"),(E||S)&&(ie.product={tagsSupported:!0}),I&&(ie.propertyPromotion={tagsSupported:!0}),x&&(ie.tourActivity={tagsSupported:!0});const we=["partial-generated-images"];P&&we.push("emoji-reactions"),H&&we.push("guided-conversations"),Y&&we.push("conversation-action-composer-prefill"),ue&&we.push("conversation-action-composer-send");const $e=!Gu({breakpoint:"lg"});j&&$e&&we.push("side-by-side-comparison"),ze&&we.push("session-duration-nudge");const wt={supportedFeatures:we,supportedCards:se.length>0?se:void 0,supportedUIComponents:We?p_:void 0,ads:ve?ie:null};return await Z$.run(wt)}async function Iae(){return(await lq.run({})).grantedConsents??[]}function aS(e){W("groups-unread-indicator")&&g1(e,t=>{t.group&&(t.group.hasUnreadMessages=!0)})}async function Eae(e){try{const{success:t,data:n}=PA.safeParse(e);if(!t)return!1;const o=B(xr),s=o?.map;if(!s)return!1;switch(n.actionName){case"map_set_view":return await Tae(s,n.parameters);case"map_add":return await wae(s,n.parameters,o);case"map_remove":return await Aae(s,n.parameters,o);default:return!1}}catch{return!1}}async function Tae(e,t){const{center:n,zoom:o,bearing:s,pitch:a,bounds:r}=t,i={center:n?{latitude:n.lat,longitude:n.lon}:void 0,zoom:o,bearing:s,pitch:a,bounds:r};return await e.setView(i),!0}async function wae(e,t,n){const{items:o}=t,s=[];let a;for(const r of o)if(r.type==="geometry_layer"){const i=r.geometries.filter(d=>d.type==="point");if(i.length>0){const d=i.map(m=>({id:m.id,latitude:m.coordinate.lat,longitude:m.coordinate.lon,title:m.label??""}));await e.addGeometryLayerItem(r.id,d,!0,r.label),s.push({id:r.id,name:r.label,type:"geometry_layer",pushpins:d}),a=r.id}}else r.type==="route"&&(await e.addRouteItem(r.id,{waypoints:r.waypoints.map(i=>({label:i.label,coordinate:{latitude:i.coordinate.lat,longitude:i.coordinate.lon}})),mode:r.mode,label:r.label},!0),s.push({id:r.id,name:r.label,type:"route"}),a=r.id);if(s.length>0&&a!==void 0){const r=[...n.layers,...s];Ee(xr,{...n,layers:r,activeLayerId:a})}return!0}async function Aae(e,t,n){const{ids:o}=t;await e.removeItems(o);const s=new Set(o),a=n.layers.filter(i=>!s.has(i.id)).map(i=>({...i,pushpins:i.pushpins?.filter(d=>!s.has(d.id))})).filter(i=>i.type==="route"||(i.pushpins?.length??0)>0);if(a.length!==n.layers.length||a.some((i,d)=>i.pushpins?.length!==n.layers[d]?.pushpins?.length)){let i=n.activeLayerId;n.activeLayerId!==void 0&&!a.some(d=>d.id===n.activeLayerId)&&(i=a[a.length-1]?.id,i!==void 0&&e.setActiveItem(i,!0)),Ee(xr,{...n,layers:a,activeLayerId:i})}return!0}const f_="space-y-3 break-words",KAe="bg-accent-200 dark:bg-accent-250",YAe=`group/ai-message-item ${f_}`,B1="&#95;{{{CITATION{{{&#95;",Lf="{";function h_(e,t){return`[${B1}${e}${Lf}](${t})`}const xae=new RegExp(`\\[${B1}.*?\\)`,"g");function ZAe(e){return e.replace(xae,"")}const _ae=new RegExp(`\\[${B1}([^${Lf}]+)${Lf}\\]`,"g");function JAe(e,t,n){return e.replace(_ae,(o,s)=>{if(!n)return`  [${s}]`;const a=t.find(r=>r.index===s);return`  [${a?.publisher??(a?.url?rZ(a.url):s)}]`})}function kae(e){return e.type==="word"}function Pae(e){return kae(e)&&e.word.trim()==="."}function QAe(e,t){for(let n=t-1;n>=0;n-=1){if(e[n]?.type==="citation"){const o=n+1;return o<e.length&&Pae(e[o])?o+1:o}if(e[n]?.type==="word"&&e[n].word.includes(`
`))return n+1}return 0}function XAe(e,t,n){return t!==null&&n!==null&&e>=t&&e<n}const Mae=p_;function rS(e,t){if(!t||!e)return!0;const n=t[e];if(!n)return!0;const o=Mae[e];return o!==void 0&&Nae(o,n)}function Rae(e){return typeof e.author=="object"&&e.author.type==="ai"}function Nae(e,t){const n=e.split(".").map(Number),o=t.split(".").map(Number),s=n[0]??0,a=o[0]??0;if(s!==a)return!1;const r=n[1]??0,i=o[1]??0;return r>=i}function Lae(e){return e.map(t=>{if(!Rae(t))return t;const{content:n}=t;if(!n.some(h=>typeof h=="object"&&h.type==="uiComponent"))return t;const s=[],a=new Map,r=new Map,i=new Set,d=h=>a.has(h)?h:r.get(h)??null,m=h=>{const g=yu.createRootTree(h.partId,h.component);if(!g.success)return;const{rootNode:y}=g.value;if(!y||!rS(y.type,h.requiredComponents)){i.add(h.partId);return}g.value.completed=!0,r.set(h.partId,h.partId),a.set(h.partId,{generativeUI:g.value,requiredComponents:h.requiredComponents}),s.push(g.value)},p=h=>{if(!h.parentPartId)return;const g=d(h.parentPartId);if(!g||i.has(g))return;const y=a.get(g);if(!y)return;const b=bf(h.component,lg);if(!b||!rS(b.type,y.requiredComponents))return;const C=yu.addChildNode(y.generativeUI,h.parentPartId,h.component,b);C.success&&(y.generativeUI.partIdToPath[h.partId]=C.value.path,r.set(h.partId,g))};for(const h of n){if(h.type!=="uiComponent"){s.push(h);continue}if(!h.parentPartId){m(h);continue}p(h)}return{...t,content:s}})}function g_(e){const{author:t}=e;return t.type==="ai"?{...e,author:"ai",authorMetadata:t,streamingState:"idle"}:t.type==="human"?{...e,author:"human",authorMetadata:t}:{...e,author:"groupParticipant",authorMetadata:t}}function Dae(e){return(Oae(e)?Lae(e):e).map(g_)}function Oae(e){return W("genuimvp")?e.some(t=>t.author.type==="ai"&&Array.isArray(t.content)&&t.content.some(n=>"type"in n&&n.type==="uiComponent")):!1}function Uae(e){const{conversationId:t,id:n}=e;R.trackEvent({name:"system",data:{eventName:"receivedSessionDurationNudgeEvent",eventInfo_conversationId:t,eventInfo_messageId:n}})}function Fae(e){const{conversationId:t,id:n}=e;R.trackEvent({name:"system",data:{eventName:"copilotImpression",eventInfo_impressionElement:"sessionDurationNudgeToast",eventInfo_conversationId:t,eventInfo_messageId:n}})}function jae(e){const{conversationId:t,id:n}=e;R.trackEvent({name:"interaction",data:{eventName:"copilotClick",eventInfo_clickSource:"sessionDurationNudgeToast",eventInfo_clickScenario:"sessionDurationNudgeDismissal",eventInfo_conversationId:t,eventInfo_messageId:n}})}function Bae(e,t,n){return`${e}_${t}_${n}`}function Vae(e,t){ke().set(Ud,o=>{const s=o.get(e)??[],a=[];for(const r of t.editTargets){const i={id:Bae(t.id,r.startIndex,r.endIndex),pageSuggestionId:t.id,startIndex:r.startIndex,endIndex:r.endIndex,text:t.text};a.push(i)}o.set(e,[...s,...a])})}function exe(e,t){ke().set(Ud,o=>{const s=o.get(e);s&&o.set(e,s.filter(a=>a.id!==t))})}function txe(e){ke().set(Ud,n=>{n.delete(e)})}function Hae(e,t,n){ke().set(Ud,s=>{const a=s.get(e);if(a){const r=a.filter(i=>i.pageSuggestionId===t);for(const i of r)i.text??="",i.text+=n}})}function zae(e){const{text:t,conversationId:n,id:o}=e;Fae({conversationId:n,id:o}),Ee(yt,{title:F("durationNudge.title"),subtitle:t,dismissable:!0,onDismiss:()=>{jae({conversationId:n,id:o})}})}function Gae(e){const{card:t,messageId:n,conversationId:o}=e,s={eventName:"copilotImpression",eventInfo_impressionPage:"chat",eventInfo_impressionScenario:"answerCardReceived",eventInfo_answerCardType:t.type,eventInfo_messageId:n,eventInfo_conversationId:o};switch(t.type){case"image":s.eventInfo_answerCardContentLength=t.images.length;break;case"localEntity":s.eventInfo_answerCardContentLength=t.entities.length;break;case"financeChart":s.eventInfo_answerCardScenario=t.instrument.securityType;break}R.trackEvent({name:"system",data:s})}function Wae(e){const{card:t,messageId:n,conversationId:o}=e,s=performance.now(),a=B(sT);if(!a)return;const r={eventName:"copilotAnswerCardReceived",eventInfo_messageId:n,eventInfo_conversationId:o,eventInfo_cardType:t.type,eventInfo_duration:s-a};R.trackEvent({name:"system",data:r})}function $ae(e){const{message:t,conversationId:n}=e;for(const o of t.content)switch(o.type){case"card":Gae({card:o.card,messageId:t.id,conversationId:n}),Wae({card:o.card,messageId:t.id,conversationId:n});break}}function qae(e){return t=>{const o=(e?Math[e]:Math.trunc)(t);return o===0?0:o}}const nxe=6048e5,Kae=864e5,oxe=6e4,Yae=36e5,sxe=1e3,axe=43200,rxe=1440,ixe=60;function Zae(e,t){return+Eo(e)-+Eo(t)}function Jae(e,t,n){const o=Zae(e,t)/Yae;return qae(n?.roundingMethod)(o)}function V1(e){if(!e)return null;let t=null;const n=new Date(e).toISOString(),o=new Date().toISOString(),s=Jae(n,o,{roundingMethod:"ceil"});return s>24?t="permanent":s>1&&s<=24?t="24-hr":s>0&&s<=1&&(t="1-hr"),t}function H1(e,t,n){if(!e){mt(Vp);return}const o=ke();R.trackEvent({name:"system",data:{eventName:"copilotUserBan",eventInfo_banDuration:e,eventInfo_banSource:t,eventInfo_banExpiryTimestamp:n}}),o.set(GT,e),o.set(br,"user-banned")}const lt=ke();function iS(e,t){return{chatMode:Ft(),timing:new sK(e,t),citationCount:0,imageCount:0,chainOfThoughtCount:0,inputMethod:"text",pendingGuidedActions:[],processedGuidedLinksCount:0,uploadImageCount:0,uploadFileCount:0}}let cS=null;async function op(){return cS??=N(()=>import("./index-DS1hydBz.js"),[]).then(e=>e.applyPatch),cS}function Qae(e,t){for(const n of e.content)if(n.type==="image"&&n.localUrl){const o=n.url.startsWith("/")?n.url:`/${n.url}`;n.url=`/conversations/${t}/messages/${e.id}${o}`;const{localUrl:s}=n;n.localUrl=void 0,URL.revokeObjectURL(s)}}class Xae{ws;conversationMetadata=new Map;conversationIdByMessageId=new Map;messageIdByTaskId=new Map;latestMessagePartIdentifier=null;pendingSideBySideMessages=new Map;constructor(t){this.ws=t,this.send=this.send.bind(this),this.regenerate=this.regenerate.bind(this),this.sendChallengeResponse=this.sendChallengeResponse.bind(this),this.resetConversationState=this.resetConversationState.bind(this),this.resetConversationTiming=this.resetConversationTiming.bind(this),this.setConversationIdByMessageId=this.setConversationIdByMessageId.bind(this),this.setMessageIdByTaskId=this.setMessageIdByTaskId.bind(this),this.onSubmitMessageBlocked=this.onSubmitMessageBlocked.bind(this),this.callBeforeSendForConversation=this.callBeforeSendForConversation.bind(this),this.callOnSentForConversation=this.callOnSentForConversation.bind(this),this.setChatModeForConversation=this.setChatModeForConversation.bind(this),this.setInputMethodForConversation=this.setInputMethodForConversation.bind(this),this.setUploadCountsForConversation=this.setUploadCountsForConversation.bind(this),this.setUserMessageForConversation=this.setUserMessageForConversation.bind(this),this.processEvent=this.processEvent.bind(this),this.sendMessagePreview=this.sendMessagePreview.bind(this),this.sendActionResult=this.sendActionResult.bind(this),this.updateChatOptions=this.updateChatOptions.bind(this),this.reportLocalConsents=this.reportLocalConsents.bind(this),this.sendAudioClick=this.sendAudioClick.bind(this)}getConversationState(t){return this.conversationMetadata.has(t)||this.conversationMetadata.set(t,iS(performance.now(),performance.now())),this.conversationMetadata.get(t)}get latestMessagePartId(){return this.latestMessagePartIdentifier}resetConversationState(t,n,o){this.conversationMetadata.set(t,iS(n,o))}resetConversationTiming(t,n,o){const s=this.getConversationState(t);s.timing.resetMessageStartTime(n),s.timing.resetMessageSentTime(o)}setConversationIdByMessageId(t){const{messageId:n,conversationId:o}=t;this.conversationIdByMessageId.set(n,o)}setMessageIdByTaskId(t){const{taskId:n,messageId:o}=t;this.messageIdByTaskId.set(n,o)}onSubmitMessageBlocked(t){const{timing:n,chatMode:o,inputMethod:s}=this.getConversationState(t);n.onSubmitMessageBlocked(o,s,t)}callBeforeSendForConversation(t,n){this.getConversationState(t).timing.onBeforeSend(n)}callOnSentForConversation(t,n){const o=this.getConversationState(t);o.timing.onSent({additionalData:n,chatMode:o.chatMode,conversationId:t,inputMethod:o.inputMethod})}setChatModeForConversation(t,n){const o=this.getConversationState(t);o.chatMode=n}setInputMethodForConversation(t,n){const o=this.getConversationState(t);o.inputMethod=n}setUploadCountsForConversation(t,n,o){const s=this.getConversationState(t);s.uploadImageCount=n,s.uploadFileCount=o}setUserMessageForConversation(t,n){const o=this.getConversationState(t);o.lastUserMessage=n}send(t){const{content:n,conversationId:o,data:s,mode:a,context:r}=t,i={event:"send",conversationId:o,content:Array.isArray(n)?n:[n],mode:a,context:r,...s};this.ws.send(JSON.stringify(i))}sendChallengeResponse(t){this.ws.send(JSON.stringify({event:"challengeResponse",token:t.token,method:t.method}))}regenerate(t){const{messageId:n,mode:o,allowedConsents:s,context:a}=t,r={event:"regenerate",messageId:n,mode:o,...a?{context:a}:{},...s?.length?{allowedConsents:s}:{}};this.ws.send(JSON.stringify(r))}sendMessagePreview(t){const{content:n,conversationId:o,data:s,mode:a,context:r}=t,i={event:"messagePreview",conversationId:o,content:Array.isArray(n)?n:[n],mode:a,context:r,...s};this.ws.send(JSON.stringify(i))}sendActionResult(t){this.ws.send(JSON.stringify({event:"actionResult",actionId:t.actionId,result:t.result}))}sendAudioClick(t,n){if(!n)return;const{chatMode:o}=this.getConversationState(n);this.send({conversationId:n,content:[{type:"command",command:{type:"topicClick",topic:t}}],mode:o})}setCharacterAppearance(t,n){const o=lt.get(Rt)?.id;if(!o)return;const{chatMode:s}=this.getConversationState(o);this.send({conversationId:o,content:[{type:"command",command:{type:"setCharacterAppearance",body:t,accessories:n}}],mode:s})}sendCommandResults(t){const n=Dee(t);this.ws.send(JSON.stringify(n))}async updateChatOptions(){const n={event:"setOptions",...await bae()};this.ws.send(JSON.stringify(n))}async reportLocalConsents(){const t=await Iae();if(t.length===0)return;const n={event:"reportLocalConsents",grantedConsents:t};this.ws.send(JSON.stringify(n))}processEvent(t){switch("id"in t&&(this.latestMessagePartIdentifier=t.id??null),$q.dispatch(t),this.logInboundMessageTelemetry(t),t.event){case"received":this.handleReceived(t);break;case"newMessage":this.handleNewMessage(t);break;case"connected":this.handleConnected(t);break;case"emojiReaction":this.handleEmojiReaction(t);break;case"startMessage":this.handleStartMessage(t);break;case"appendText":this.handleAppendText(t);break;case"replaceText":this.handleReplaceText(t);break;case"invokeAction":this.handleInvokeAction(t);break;case"browserAutomate":this.handleBrowserAutomate(t);break;case"chainOfThought":this.handleChainOfThought(t);break;case"citation":this.handleCitation(t);break;case"modelStatement":this.handleModelStatement(t);break;case"generatingImage":this.handleGeneratingImage(t);break;case"imageGenerated":this.handleImageGenerated(t);break;case"partialImageGenerated":this.handlePartialImageGenerated(t);break;case"imageGenerationFailed":this.handleImageGenerationFailed(t);break;case"generatingCard":this.handleGeneratingCard(t);break;case"cardGenerationFailed":this.handleCardGenerationFailed(t);break;case"page":this.handlePage(t);break;case"titleUpdate":this.handleTitleUpdate(t);break;case"challenge":this.handleChallenge(t);break;case"card":this.handleCard(t);break;case"document":this.handleDocument(t);break;case"taskStart":this.handleTaskStart(t);break;case"taskUpdate":this.handleTaskUpdate(t);break;case"error":this.handleError(t);break;case"banned":this.handleBanned(t);break;case"done":this.handleDone(t);break;case"startSuggestion":this.handleStartSuggestion(t);break;case"appendSuggestion":this.handleAppendSuggestion(t);break;case"suggestionCompleted":this.handleSuggestionCompleted(t);break;case"activityStart":this.handleActivityStart(t);break;case"activityUpdate":this.handleActivityUpdate(t);break;case"memorySignal":this.handleMemorySignal(t);break;case"sideBySideComparison":this.handleSideBySideComparison(t);break;case"suggestVision":this.addSuggestionCard("suggestVision",t.conversationId);break;case"modeSelected":this.handleModeSelected(t);break;case"pong":break;case"audio":case"interruptAudio":case"speechEndDetected":case"callTerminated":case"characterAnimation":case"characterAnimationEnd":case"characterAppearance":case"characterEmotion":case"callUI":case"callUIUpdate":break;case"relatedSearchResultsAvailable":this.handleRelatedSearchResultsAvailable(t);break;case"participantUpdate":this.handleParticipantUpdate(t);break;case"featureSuggestion":this.handleFeatureSuggestion(t);break;case"turnTelemetry":break;case"nudge":this.handleNudge(t);break;case"partStart":this.handlePartStart(t);break;case"partCompleted":this.handlePartCompleted(t);break;case"partUpdate":this.handlePartUpdate(t);break;case"toolExecuting":this.handleToolExecuting(t);break;case"partDeleted":this.handlePartDeleted(t);break}}logInboundMessageTelemetry(t){let n;if("conversationId"in t?n=t.conversationId:"messageId"in t&&(n=this.conversationIdByMessageId.get(t.messageId)),n){const o=this.getConversationState(n);o.timing.onMessageInbound(t.event,o.inputMethod,n,o.chatMode)}}handlePartStart(t){const{messageId:n,part:o}=t,s=this.conversationIdByMessageId.get(n);if(!s){Je({feature:"activity",errorType:"handlePartStart",errorMessage:"conversationId not found for messageId",customData:JSON.stringify({messageId:n,partId:o.partId})});return}switch(o.type){case"uiComponent":W("genuimvp")&&Bee(s,t,o);break;case"text":W("genuimvp")&&Vee(s,t,o);break;case"command":Nee(n,o.partId,o.command);break;case"shellCommandExecution":case"webSearch":case"textFile":case"step":case"computerUse":Ne(s,a=>{const r=nt({history:a,messageId:n});r&&(Xs(s,r.id),r.content.push(o))});break}q$.run({event:t,conversationId:s})}handlePartCompleted(t){const{messageId:n,partId:o}=t,s=this.conversationIdByMessageId.get(n);if(!s){Je({feature:"activity",errorType:"handlePartCompleted",errorMessage:"conversationId not found for messageId",customData:JSON.stringify({messageId:n,partId:o})});return}Ne(s,a=>{const r=nt({history:a,messageId:n});if(r){const i=bn(r.content,o);if(!i)return;switch(i.type){case"generativeUI":W("genuimvp")&&Gee(i,s,n);break}}})}handlePartDeleted(t){const{messageId:n,partId:o}=t,s=this.conversationIdByMessageId.get(n);if(!s){Je({feature:"activity",errorType:"handlePartDeleted",errorMessage:"conversationId not found for messageId",customData:JSON.stringify({messageId:n,partId:o})});return}Ne(s,a=>{const r=nt({history:a,messageId:n});if(r){const i=bn(r.content,o);if(!i){Je({feature:"activity",errorType:"handlePartDeleted",errorMessage:"partDeleted event with unknown partId",customData:JSON.stringify({messageId:n,partId:o})});return}switch(i.type){case"generativeUI":W("genuimvp")&&Wee(r,i,o);break;default:Je({feature:"activity",errorType:"handlePartDeleted",errorMessage:`partDeleted event with partId that is not a supported item. Item is of type ${i.type}`,customData:JSON.stringify({messageId:n,partId:o})});break}}})}handleTurnTelemetry(t){}handleNudge(t){const{nudgeType:n,text:o,conversationId:s,id:a}=t;switch(Uae({conversationId:s,id:a}),n){case"session-duration":zae({conversationId:s,id:a,text:o});break}}handleMemorySignal(t){if(ot("kill-memory-edf-basic"))return;const{messageId:n,partId:o,text:s,signalType:a}=t,r=this.conversationIdByMessageId.get(n);if(!r)return;this.getConversationState(r).timing.onMemorySignalReceived({messageId:n,conversationId:r}),Ne(r,d=>{const m=nt({history:d,messageId:n});m&&m.content.push({type:"memorySignal",partId:o,text:s,signalType:a})})}handleSideBySideComparison(t){if(!W("side-by-side-comparison"))return;const{sideBySideComparisonId:n,conversationId:o,options:s,defaultMessageId:a}=t;mte(n),g1(o,r=>{r.sideBySideComparisonId=n});for(const{messageId:r,position:i}of s)this.pendingSideBySideMessages.set(r,{position:i,isDefault:r===a})}handleModeSelected(t){const{messageId:n,mode:o}=t,s=this.conversationIdByMessageId.get(n),a=co();s&&(R.trackEvent({name:"system",data:{eventName:"modeSelectedEvent",eventInfo_conversationId:s,eventInfo_messageId:n,eventInfo_customData:JSON.stringify({eventInfo_selectedMode:o})}}),a==="smart"&&o==="reasoning"&&Ne(s,r=>{const i=nt({history:r,messageId:n});i&&i.content.push({type:"chainOfThought",text:F("chat.reasoningLoading.emptyCoTText"),partId:"-1"})}))}clearAllStreamingStates(){const t=lt.get(bt);for(const n of t.values())Ne(n.id,o=>{for(const s of o)s.author==="ai"&&s.streamingState==="streaming"&&(s.streamingState="idle")})}handleReceived(t){const{messageId:n,conversationId:o}=t;this.conversationIdByMessageId.set(n,o);const s=this.getConversationState(o);s.timing.onReceived({messageId:n,conversationId:o,chatMode:s.chatMode,inputMethod:s.inputMethod}),VC([`humanMessage_${n}`,`conversation_${o}`]),lt.set(ma,a=>a&&!qg()?a-1:a),Ne(o,a=>{const r=a.at(-1);r?.author==="human"&&(r.id=n,Qae(r,o))})}handleNewMessage(t){const{message:n,conversationId:o}=t,s=g_(n);this.conversationIdByMessageId.set(s.id,o),Ne(o,a=>{a.push(s)}),aS(o)}handleConnected(t){Gi.trackLatestChatConnectedAssignment(t)}handleEmojiReaction(t){const{messageId:n,emoji:o}=t,s=this.conversationIdByMessageId.get(n);s&&Ne(s,a=>{const r=CY(a,n);r&&(r.emojiReaction=o)})}handleStartMessage(t){const{messageId:n,conversationId:o,createdAt:s}=t;this.conversationIdByMessageId.set(n,o);const a=this.getConversationState(o),{chatMode:r,inputMethod:i}=a;a.citationCount=0,a.processedGuidedLinksCount=0,a.timing.onStartMessage({messageId:n,conversationId:o,chatMode:r,inputMethod:i}),vf()&&lt.set(ra,"responding"),VC([`aiMesssage_${n}`,`conversation_${o}`]);const d=this.pendingSideBySideMessages.get(n),m={id:n,createdAt:s,author:"ai",content:[],mode:r,sideBySideConfig:d,streamingState:"streaming"};Ne(o,p=>{p.push(m)}),ci.run({conversationId:o,event:t.event})}handleAppendText(t){const{text:n,messageId:o,partId:s}=t,a=this.conversationIdByMessageId.get(o);if(!a||W("genuimvp")&&Hee(a,t))return;const r=this.getConversationState(a);r.timing.onFirstToken({messageId:o,conversationId:a,chatMode:r.chatMode,inputMethod:r.inputMethod}),Ne(a,i=>{const d=nt({history:i,messageId:o});if(d){Xs(a,d.id);let m=bn(d.content,s);if(!m)m={type:"text",text:"",partId:s},d.content.push(m);else if(m.type!=="text"){console.error(`appendText event with partId that is not a text item. Item is of type ${m.type}`,t);return}m.text=m.text.concat(n),EY(d)}}),V$.run(n),Gl()&&this.applyPendingGuidedActions(a)}handleReplaceText(t){const{text:n,messageId:o,partId:s}=t,a=this.conversationIdByMessageId.get(o);if(!a||W("genuimvp")&&zee(a,t))return;const i=lt.get(Rt)?.sideBySideComparisonId;i&&(pte({sideBySideComparisonId:i,reason:"replacedText"}),v1(a)),Ne(a,d=>{const m=nt({history:d,messageId:o});if(m){Xs(a,m.id);let p=bn(m.content,s);if(!p)p={type:"text",text:"",partId:s},m.content.push(p);else if(p.type!=="text"){console.error("replaceText event with partId that is not a text item",t);return}p.text=n,p.citations=void 0}})}handleCitation(t){const{title:n,url:o,messageId:s,publisher:a,iconUrl:r,snippet:i,label:d}=t,m=this.conversationIdByMessageId.get(s);if(!m)return;const p=this.getConversationState(m);Uz(o,m,s),Ne(m,h=>{const g=nt({history:h,messageId:s});if(g){Xs(m,g.id);const y=sC(g.content);if(y){y.citations??=[];const b=y.citations.find(T=>T.url===o);let C;if(b?C=b.index:(p.citationCount+=1,C=`${p.citationCount}`,y.citations.push({index:C,url:o,iconUrl:r,title:n,publisher:a,snippet:i,label:d})),y.text=y.text.concat(h_(C,o)),p.citationCount===1){const T=cA();T?.type==="citations"&&T.data.conversationId===m&&T.data.messageId!==s&&y1({type:"citations",data:{conversationId:m,messageId:s}})}}}}),o&&ci.run({url:o,conversationId:m})}handleModelStatement(t){const{partId:n,messageId:o,modelName:s,correlationPartId:a}=t,r=this.conversationIdByMessageId.get(o);r&&Ne(r,i=>{const d=nt({history:i,messageId:o});if(!d)return;let m=bn(d.content,n);m||(m={type:"modelStatement",models:[],partId:n},d.content.push(m)),m.type==="modelStatement"&&m.models.push({modelName:s,correlationPartId:a})})}handleGeneratingImage(t){const{prompt:n,messageId:o,partId:s,progressionText:a}=t,r=this.conversationIdByMessageId.get(o);if(!r)return;const i=this.getConversationState(r);i.timing.onImageGenerationStart({messageId:o,conversationId:r,chatMode:i.chatMode}),Ne(r,d=>{const m=nt({history:d,messageId:o});m&&m.content.push({type:"image",prompt:n,partId:s,partialGenerationStep:0,status:"generating",progressionText:a})})}handleImageGenerated(t){const{url:n,partId:o,messageId:s}=t,a=this.conversationIdByMessageId.get(s);if(!a)return;const r=this.getConversationState(a);r.imageCount+=1,r.timing.onImageReceived({messageId:s,conversationId:a,chatMode:r.chatMode}),Ne(a,i=>{const d=nt({history:i,messageId:s});if(d){const m=bn(d.content,o);m?.type==="image"&&(m.isPartiallyLoading=!1,m.url=n,m.partialGenerationStep=void 0,m.status="generated",m.progressionText=void 0)}})}handlePartialImageGenerated(t){const{content:n,messageId:o,partId:s}=t,a=this.conversationIdByMessageId.get(o);if(!a)return;const r=this.getConversationState(a);Ne(a,i=>{const d=nt({history:i,messageId:o});if(d){const m=bn(d.content,s);if(m?.type==="image"){m.isPartiallyLoading=!0,m.url=`data:image/png;base64,${n}`;const p=(m.partialGenerationStep??0)+1;m.partialGenerationStep=p,m.status="generating",r.timing.onPartialImageReceived({messageId:o,conversationId:a,chatMode:r.chatMode,imageGenPhase:p})}}})}getImageGenerationErrorMessage(t){switch(t){case"not-signed-in":return;case"throttled":return;case"blocked":return;default:return F("error.imageGenerationFailed")}}handleImageGenerationFailed(t){const{messageId:n,partId:o,errorCode:s}=t,a=this.conversationIdByMessageId.get(n);if(!a)return;Ne(a,i=>{const d=nt({history:i,messageId:n});d&&(d.content=d.content.filter(m=>m.type!=="image"||m.partId!==o))});const r=this.getImageGenerationErrorMessage(s);s==="not-signed-in"&&lt.set(Us,{isOpen:!0,scenario:null,reason:"imageGeneration"}),r&&zl(r,a)}handleCardGenerationFailed(t){const n=lt.get(gi);if(n&&this.isGeneratedCards(n)){lt.set(gi,void 0);const o=this.conversationIdByMessageId.get(t.messageId);if(!o)return;n==="quiz"&&zl(F("quizCard.generatedQuizFailed"),o)}}handleGeneratingCard(t){const{type:n}=t;this.isGeneratedCards(n)&&lt.set(gi,n)}isGeneratedCards(t){return RT.safeParse(t).success}handleTitleUpdate(t){const{conversationId:n,title:o}=t;lt.set(bt,s=>Xt(s,a=>{const r=a.get(n);r&&(r.title=o)}))}handleCard(t){const{messageId:n,partId:o,card:s}=t,a=this.conversationIdByMessageId.get(n);if(!a)return;const r=this.getConversationState(a);if(s.type==="ads"){WY({card:s,messageId:n,partId:o,conversationState:r,conversationId:a});return}Ne(a,i=>{const d=nt({history:i,messageId:n});d&&d.content.push({type:"card",partId:o,card:s})}),Ce.emit("card:created",{type:s.type,partId:o})}handleDocument(t){const{messageId:n,partId:o,attachmentId:s,fileName:a,contentType:r}=t,i=this.conversationIdByMessageId.get(n);i&&Ne(i,d=>{const m=nt({history:d,messageId:n});m&&m.content.push({type:"document",partId:o,attachmentId:s,fileName:a,contentType:r})})}handleBanned(t){const{expiresAt:n}=t,o=V1(n);o&&H1(o,"chat",n)}handlePage(t){const{messageId:n,page:o,partId:s}=t,a=this.conversationIdByMessageId.get(n);a&&(Ne(a,r=>{const i=nt({history:r,messageId:n});i&&i.content.push({type:"page",partId:s,page:o})}),Ce.emit("pages:page-created",o))}handleStartSuggestion(t){const{pageId:n,suggestionId:o,editTargets:s}=t;if(ep(n)){Ree({pageId:n,suggestionId:o});return}Vae(n,{id:o,text:void 0,editTargets:s})}applyPendingGuidedActions(t){const n=this.getConversationState(t),{pendingGuidedActions:o}=n;o.length!==0&&Ne(t,s=>{const a=pr(s);if(!a)return;const r=sC(a.content);if(!r||!r.text)return;const{text:i}=r,d=n.pendingGuidedActions[0];if(!d)return;const{targetText:m,prefill:p}=d;if(!m||!p)return;const h=i.lastIndexOf(m);if(h!==-1){const g=i.substring(0,h),y=i.substring(h+m.length),b=`[${m}](${fae}?${hae}=${encodeURIComponent(p)})`,C=g+b+y;r.text=C,n.processedGuidedLinksCount+=1,n.pendingGuidedActions.shift()}})}handleGuidedConversationAction(t,n){if(!Gl())return;const o=gae(t);this.getConversationState(n).pendingGuidedActions.push(o)}handleAppendSuggestion(t){const{pageId:n,text:o}=t;ep(n)||Hae(n,t.suggestionId,o)}handleSuggestionCompleted(t){const{pageId:n}=t;ep(n)&&HC(n)}handleCollaboratorStartAction(t,n){const{pageId:o}=t.parameters;t.parameters.conversationId,Pee(o)}handleCollaboratorUndoAction(t,n){const{pageId:o,conversationId:s}=t.parameters;o&&Mee(o)}handleCollaboratorSuggestionCompleteAction(t,n){const{pageId:o,conversationId:s}=t.parameters;HC(o)}handleActivityStart(t){const{messageId:n,partId:o,activity:s}=t,a=this.conversationIdByMessageId.get(n);a&&Ne(a,r=>{const i=nt({history:r,messageId:n});i?(Xs(a,i.id),i.content.push({activity:s,type:"activity",partId:o})):Je({feature:"activity",errorType:"handleActivityStart",errorMessage:"Could not find message with messageId to start activity",customData:JSON.stringify({messageId:n})})})}async handleActivityUpdate(t){const{messageId:n,partId:o,update:s}=t,a=this.conversationIdByMessageId.get(n);if(a)try{const r=await op();Ne(a,i=>{const d=nt({history:i,messageId:n});if(!d)return;const m=bn(d.content,o);if(!m||m.type!=="activity"){Je({feature:"activity",errorType:"handleActivityUpdate",errorMessage:"Could not find activity message with partId in message with messageId",customData:JSON.stringify({messageId:n,partId:o})});return}r(m.activity,s),Zy.run({conversationId:a,partId:o,activity:m.activity})})}catch(r){Je({feature:"activity",errorType:"handleActivityUpdate",errorMessage:"Error updating activity",exception:JSON.stringify({error:r})})}}async handlePartUpdate(t){const{messageId:n,partId:o,update:s}=t,a=this.conversationIdByMessageId.get(n);if(a)try{const r=await op();Ne(a,i=>{const d=nt({history:i,messageId:n});if(!d){Je({feature:"partUpdate",errorType:"handlePartUpdate",errorMessage:"Could not find message with messageId for partUpdate",customData:JSON.stringify({messageId:n,partId:o})});return}const m=bn(d.content,o);if(!m){Je({feature:"partUpdate",errorType:"handlePartUpdate",errorMessage:"Could not find message item with partId for partUpdate",customData:JSON.stringify({messageId:n,partId:o})});return}const{patches:p}=s;r(m,p),K$.run({event:t,conversationId:a})})}catch(r){Je({feature:"partUpdate",errorType:"handlePartUpdate",errorMessage:"Error applying part update patch",exception:JSON.stringify({error:r})})}}async processInvokeAction(t){const n=lt.get(Te);if(n)switch(t.actionName){case"phone_send_message":{Ne(n,o=>{const s=pr(o);s&&s.content.push({type:"card",partId:Math.random().toString(),card:{type:"phoneSendMessage",actionId:t.actionId,contactName:t.parameters.contactName,text:t.parameters.text,phoneNumber:t.parameters.phoneNumber}})});break}case"edge_get_page_content":{const o=t.parameters.map(s=>({tabId:s.tabId,windowId:s.windowId,pageUrl:s.pageUrl??"",pageTitle:s.pageTitle??""}));z$.run({actionId:t.actionId,tabs:o,inputMethod:this.getConversationState(n).inputMethod}),ci.run({conversationId:n});break}case"edge_get_tabs_list":{rq.run({actionId:t.actionId,count:t.parameters.maxCount});break}case"windows_collaborator_start":{this.handleCollaboratorStartAction(t,n);break}case"windows_collaborator_undo":{this.handleCollaboratorUndoAction(t,n);break}case"windows_collaborator_suggestion_complete":{this.handleCollaboratorSuggestionCompleteAction(t,n);break}case"windows_search_files":{W("windowslocalfilesearch")&&await W$.run({event:t,handled:!1});break}case"windows_get_known_directories":case"windows_copy_files":case"windows_move_files":case"windows_create_directories":{W("windowsfileoperations")&&await $$.run({event:t,handled:!1});break}case"browser_search":{const o=!W("edge-history-chain-of-thought"),s=o?wY(n,F("chat.multiTabsSearchIndicatorForHistory")):void 0;Y$.run({actionId:t.actionId,queries:t.parameters.queries,startTime:t.parameters.startTime?jC(t.parameters.startTime):void 0,endTime:t.parameters.endTime?jC(t.parameters.endTime):void 0,maxResults:t.parameters.maxResults,states:mee(t.parameters.states),inputMethod:this.getConversationState(n).inputMethod}).then(()=>{o&&aC(n,s,"success")}).catch(a=>{Je({feature:"multiTabsSearch",errorType:"fetchTabsContent",errorMessage:a instanceof Error?a.message:"unknown"}),o&&aC(n,s,"failed")}),ci.run({conversationId:n});break}case"guided_conversation":{this.handleGuidedConversationAction(t,n);break}case"map_add":case"map_remove":case"map_set_view":{const o=await Eae(t),s={version:"v1",response:{responseParts:[],isError:!o}};this.sendActionResult({actionId:t.actionId,result:s});break}default:{const{handled:o}=await G$.run({event:t,handled:!1});if(o)break}}}handleInvokeAction(t){const{success:n,data:o}=uQ.safeParse(t);n&&this.processInvokeAction(o).catch(s=>{})}handleBrowserAutomate(t){const{partId:n,tabIds:o,activeTabId:s,messageId:a}=t,r=this.conversationIdByMessageId.get(a);r&&(R.trackEvent({name:"system",data:{eventName:"browserAutomate",eventInfo_conversationId:r,eventInfo_messageId:a}}),Ne(r,i=>{const d=nt({history:i,messageId:a});if(d){const m=bn(d.content,n);if(m&&m.type==="activity"){const p=m.activity.artifacts.find(h=>h.type==="browser");p?(p.tabIds=o,p.activeTabId=s):m.activity.artifacts.push({type:"browser",tabIds:o,activeTabId:s}),Zy.run({conversationId:r,partId:n,activity:m.activity})}}}))}trackVideoGenerationStart(t,n,o){const s=this.getConversationState(o);s.timing.onVideoGenerationStart({messageId:n,conversationId:o,chatMode:s.chatMode,taskId:t})}trackVideoGenerationCompletion(t,n,o){if(o&&n&&t.status==="completed"&&t.result?.type==="success"){const s=this.getConversationState(o);s.timing.onVideoGenerationReceived({messageId:n,conversationId:o,chatMode:s.chatMode,taskId:t.id})}}handleTaskStart(t){const{messageId:n,task:o,partId:s}=t,a=this.conversationIdByMessageId.get(n);this.messageIdByTaskId.set(o.id,n);const r=new Date().toISOString();a&&(gee([o],a,r),lt.set(Fl,!1),Ne(a,i=>{const d=nt({history:i,messageId:n});if(d){const m=EK(o,s,r);m&&d.content.push(m)}}),H$.run({task:o,action:"startTask"}),Ce.emit("tasks:task-start",o),(o.type==="podcast"||o.type==="research"||o.type==="videoGeneration")&&Dte(),o.type==="videoGeneration"&&this.trackVideoGenerationStart(o.id,n,a))}async handleTaskUpdate(t){const{taskId:n,update:o}=t;if(RY(n,o))return;let s=!1;const a=this.messageIdByTaskId.get(n),r=a?this.conversationIdByMessageId.get(a):void 0;try{const i=await op();a&&r&&Ne(r,d=>{const m=nt({history:d,messageId:a});if(m){const h=wK(m.content)?.task;h&&h.type==="research"&&(i(h,o),AY(h,r))}}),h1(n,d=>{if(d.type==="computerUse"||d.type==="videoGeneration"||d.type==="planning")i(d,o);else if(d.type==="podcast"){const m=d.podcast?.id??"";i(d,o),d.podcast&&(d.podcast.id=m)}}),s=!0}catch(i){console.error("Error applying task update patch:",i)}if(s){const i=lt.get(Ls).get(n);switch(i?.type){case"computerUse":DY(n,o);break;case"podcast":hY(i);break;case"videoGeneration":this.trackVideoGenerationCompletion(i,a,r),BY(i);break;case"planning":OK(i);break}Ce.emit("tasks:task-update",i)}}handleError(t){const{errorCode:n}=t;if(n==="over-turn-limit")lt.set(ma,0);else if(n==="over-task-quota"||n==="over-lifetime-task-quota")lt.set(dG,n),lt.set(Yt,"over-task-quota");else if(n==="unknown-error")for(const[o]of this.conversationMetadata.entries())Ne(o,s=>{for(const a of s)a.author==="ai"&&a.streamingState==="streaming"&&(a.streamingState="idle")});else if(n==="page-content-length-exceeded"||n==="page-count-exceeded"){Ce.emit("page:message-error",n);for(const[o]of this.conversationMetadata.entries())Ne(o,s=>{for(const a of s)a.author==="ai"&&a.streamingState==="streaming"&&(a.streamingState="idle")})}else for(const[o]of this.conversationMetadata.entries())zl(F("error.eventNotRecognized"),o);lt.set(Fl,!1)}handleChainOfThought(t){const{messageId:n,partId:o,text:s}=t,a=this.conversationIdByMessageId.get(n);a&&Ne(a,r=>{const i=nt({history:r,messageId:n});if(i){Xs(a,i.id);let d=bn(i.content,o);const m=this.getConversationState(a);if(d)d.type!=="chainOfThought"?console.error(`chainOfThought event with partId that is not a chainOfThought item. Item is of type ${d.type}`,t):d.text=d.text.concat(s);else{d={type:"chainOfThought",text:"",title:"",partId:o},i.content.push(d);const{title:p,text:h}=_ee(s);d.title=p,d.text=h,m.timing.onChainOfThoughtReceived({messageId:n,conversationId:a,chatMode:m.chatMode}),m.chainOfThoughtCount+=1}}})}async handleHashcashChallenge(t){if(!t)return;const n=lt.get(Te);R.trackEvent({name:"system",data:{eventName:"challengeRequest",eventInfo_method:"hashcash",eventInfo_customData:JSON.stringify({conversationId:n,parameter:t})}});const[o,s]=t.split(":"),a=Number(s);if(!o||Number.isNaN(a)||a<=0)return;const r=await IK({token:o,difficulty:a});this.sendChallengeResponse({method:"hashcash",token:r.nonce.toString()}),R.trackEvent({name:"system",data:{eventName:"challengeResponse",eventInfo_method:"hashcash",eventInfo_duration:r.timeElapsed,eventInfo_customData:JSON.stringify({difficulty:a,numberOfTries:r.nonce,totalHashes:r.totalHashes,method:r.method,numberOfWorkers:r.numberOfWorkers})}})}async handleChallenge(t){const n=()=>{const o=lt.get(Te);if(!o)return;const{lastUserMessage:s}=this.getConversationState(o);s&&this.send(s)};if(t.method==="copilot"){const{parameter:o}=t,s=Number(o),a=Math.round((s**3/100+s*25)%22).toString();this.sendChallengeResponse({method:"copilot",token:a}),n(),Ce.emit("challenge:success");return}if(t.method==="hashcash"){await this.handleHashcashChallenge(t.parameter),n(),Ce.emit("challenge:success");return}ot("kill-cf-turnstile")||(this.ws.pauseAutoReconnect(),NA({onToken:o=>{this.sendChallengeResponse({token:o,method:"cloudflare"}),n(),this.ws.resumeAutoReconnect()},onFinish:()=>{this.ws.resumeAutoReconnect()}}))}handleRelatedSearchResultsAvailable(t){const{messageId:n}=t;bY(n)}handleParticipantUpdate(t){const{conversationId:n,participant:o,updateType:s,id:a}=t,r={id:a,createdAt:new Date().toISOString(),author:"system",participant:o,updateType:s};Ne(n,d=>{d.push(r)});const i=B(vt);if(o.userId===i?.id&&s==="kicked"){Os();return}NZ(n)}addSuggestionCard(t,n){Ne(n,o=>{const s=pr(o);s&&s.content.push({type:"card",partId:Math.random().toString(),card:{type:t}})})}handleFeatureSuggestion(t){switch(t.feature){case"research":this.addSuggestionCard("suggestResearch",t.conversationId);break;case"planning-agent":this.addSuggestionCard("suggestAgentMode",t.conversationId);break;default:t.feature}}handleDone(t){vf()&&lt.get(ra)==="responding"&&lt.set(ra,"idle");const{messageId:n}=t,o=this.conversationIdByMessageId.get(n);if(!o)return;Oee({conversationId:o,messageId:n}),Gl()&&this.applyPendingGuidedActions(o);const s=this.getConversationState(o);s.timing.onLastToken({messageId:n,conversationId:o,citationCount:s.citationCount,imageCount:s.imageCount,chainOfThoughtCount:s.chainOfThoughtCount,chatMode:s.chatMode,inputMethod:s.inputMethod,uploadImageCount:s.uploadImageCount,uploadFileCount:s.uploadFileCount,guidedLinksCount:s.processedGuidedLinksCount});const r=lt.get(bt).get(o)?.history??[],i=nt({history:r,messageId:n});Ne(o,m=>{if(!i)return;const p=nt({history:m,messageId:i.id}),h=i.content.find(g=>g.type==="image"&&g.partialGenerationStep!==void 0);if(p&&h){const g=bn(p.content,h.partId);g&&(g.partialGenerationStep===0?g.type="deleted":g.type==="image"&&(g.isPartiallyLoading=!1,g.partialGenerationStep=void 0,g.status="non-complete"))}if(p){p.streamingState="idle";const g=p.content.filter(y=>y.type==="activity");for(const y of g)if($ee(y.activity)){y.activity.status==="running"&&(y.activity.status="failed");for(const C of y.activity.steps)C.status==="running"&&(C.status="completed")}}});const d=this.pendingSideBySideMessages.get(n);d&&(this.pendingSideBySideMessages.delete(n),Ne(o,m=>{const p=nt({history:m,messageId:n});p&&(p.streamingState="idle",p.sideBySideConfig={...d,isStreamingComplete:!0})})),lt.set(gi,void 0),lt.set(Fl,!1),window.setTimeout(()=>{lt.set(pd,m=>Xt(m,p=>{const h=p.get(o);h?.has(n)&&(h.delete(n),h.size===0&&p.delete(o))}))},3e3),lt.set(uT,!0),i&&$ae({message:i,conversationId:o}),aS(o),J$.run({conversationMessages:r,messageId:n,inputMethod:s.inputMethod})}async handleToolExecuting(t){const n=lt.get(Te);if(!n)return;const{type:o}=t.tool;switch(o){case"browserPageContext":{ci.run({conversationId:n});break}}}}let Cl=!1,Sl=!1;async function ere(e,t){if(e.stage==="start"||e.stage==="created"){if(Cl||Sl)return;Cl=!0;try{const n=await ko("/user/settings",{query:{"api-version":"2"}});Cl=!1;const{status:o}=n,s={stage:e.stage,code:e.code,reason:e.reason,wasClean:e.wasClean,online:e.online,statusCode:o};Sl=o===403||o===zi,(Sl||o===401)&&R.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"WebSocketFailureCode",eventInfo_details:JSON.stringify(s)}}),Sl&&(Ee(br,o===zi?"age-verification":"socket-failure-code"),t())}catch{Cl=!1}}}async function tre(){try{const{load:e}=await N(async()=>{const{load:o}=await import("./botd.esm-CqBqtDMb.js");return{load:o}},__vite__mapDeps([10,5])),t=await e({monitoring:!1}),{bot:n}=t.detect();return n}catch(e){return R.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"BotDetectionError",eventInfo_details:"Failed on bot detection",eventInfo_errorMessage:e instanceof Error?e.message:"Unknown bot detection error"}}),!1}}async function nre(){return new Promise((e,t)=>{NA({onToken:async n=>{try{const o=await Nt({path:"/challenges/verify",args:{body:{token:n,method:"cloudflare"}}}),{isValid:s}=await o.json();e(s)}catch(o){R.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"CloudflareChallengeVerificationError",eventInfo_details:"Error verifying Cloudflare challenge",eventInfo_errorMessage:o instanceof Error?o.message:""}})}t()}})})}const ore="eval/chat",v_=e=>import(e),Df=new Map,bl=new Map,sre=/(['"])((\w+:(\/?\/?))?[^\s,]+)\1/,mo={maxRetries:2,initialDelayMs:200,backoffFactor:2,jitterFactor:.1},are=(e,t)=>async()=>{const n=Date.now();let o;o=`${e}?t=${n}`;let s,a;try{const i=await fetch(new URL(o,import.meta.url).href);i.ok||(s=`Fetch failed: ${i.status} ${i.statusText} for ${o}`,a=new Error(s))}catch(i){i instanceof Error?(s=`Fetch error: ${i.message} for ${o}`,a=i):(s=`Unknown error for ${o}`,a=new Error(s))}if(a)throw Je({feature:"lazyWithRetry",scenario:t,errorType:"lazyLoadAttemptFailure",errorMessage:s}),a;const r=await v_(o);return Df.set(e,o),r};async function rre(e,t,n,o){try{let s;const a=e?Df.get(e):void 0;return a?s=await v_(a):s=await t(),s}catch(s){if(e&&Df.delete(e),ot("kill-lazy-retry")||(o.maxRetries??0)<=0)throw s;if(!e)throw Je({feature:"lazyWithRetry",scenario:n,errorType:"lazyLoadModulePathParsingFailure",errorMessage:"Could not resolve path from importer function",customData:String(t)}),s;const r=are(e,n),m={...o,onSuccess:p=>{_o({feature:"lazyWithRetry",scenario:n,customData:JSON.stringify({attempts:p.attemptCount})})},onFailure:p=>{Je({feature:"lazyWithRetry",scenario:n,errorType:"lazyLoadRetryFailure",errorMessage:`Lazy import failed after ${p.attemptCount} attempt(s). Reason: ${p.exitReason??"unknown"}`,customData:JSON.stringify(p.errors)})}};return ya(r,m)}}function ire(e){const n=String(e).match(sre);if(n)return n[2]}function y_(e,t){return async n=>{const o=ire(n);if(o&&bl.has(o))return bl.get(o);const s=rre(o,n,e,t);o&&bl.set(o,s);try{return await s}finally{o&&bl.delete(o)}}}class z1{static instance;static getInstance(){return this.instance??=new z1,this.instance}attemptingCount=0;isFirstTimeToReconnect=!0;constructor(){this.attemptingCount=0,this.isFirstTimeToReconnect=!0}trackAttempting(t){this.attemptingCount+=1,this.attemptingCount>1&&(this.isFirstTimeToReconnect&&(this.isFirstTimeToReconnect=!1,this.trackReconnectEvent("started",this.getDuration(t))),this.trackReconnectEvent("attempting",this.getDuration(t)))}trackSuccess(t){this.attemptingCount>1?this.trackReconnectEvent("connected",this.getDuration(t)):this.trackConnectionEvent("connected",this.getDuration(t)),this.isFirstTimeToReconnect=!0}trackDisconnected(t){this.trackConnectionEvent("disconnected",this.getDuration(t))}trackError(t){this.attemptingCount>1&&this.trackReconnectEvent("failed",this.getDuration(t))}getDuration(t){return t?performance.now()-t:void 0}trackConnectionEvent(t,n){R.trackEvent({name:"system",data:{eventName:"webSocketConnectionEvent",eventInfo_connectionStatus:t,eventInfo_duration:n}})}trackReconnectEvent(t,n){R.trackEvent({name:"system",data:{eventName:"webSocketReconnectEvent",eventInfo_reconnectStatus:t,eventInfo_duration:n}})}}const Il=z1.getInstance(),lS=[1e3,2e3,4e3,8e3,16e3,3e4],cre=5e3,lre=1e4,ure=1e4,dre=3,mre=6e4;function pre(e){if(!e||e.length===0)return lS;const t=e.filter(n=>Number.isFinite(n)&&n>=0);return t.length>0?t:lS}class fre{connection;socketStage="start";autoReconnect;reconnectIntervals;reconnectIntervalIndex;reconnectTimeout;sendQueue=[];connecting=!1;state=null;cachedSendData=null;pongTimeout=null;pingOnSend=!1;windowStartTime=null;connectionCount=0;cooldownStart=null;reconnectPausedValue=!1;get reconnectPaused(){return this.reconnectPausedValue}set reconnectPaused(t){t&&ot("kill-pause-auto-reconnect")||(this.reconnectPausedValue=t)}boundVisibilityChange;boundOnlineHandler;getUrl=null;onopen;onmessage;onclose;onerror;constructor({autoReconnect:t=!1,reconnectIntervals:n,pingOnSend:o=!1}={}){this.connection=null,this.autoReconnect=t,this.reconnectIntervals=t?pre(n):[0],this.reconnectIntervalIndex=0,this.pingOnSend=o,this.reconnectTimeout=null,this.onopen=null,this.onmessage=null,this.onclose=null,this.onerror=null}async initialize(){this.state=null,await this.connect(!0),this.autoReconnect&&(this.boundVisibilityChange=()=>{document.visibilityState==="visible"&&this.reconnectIfNeeded()},this.boundOnlineHandler=()=>{W("chat-connect-window")&&this.state!=="destroyed"&&(this.state=null),this.reconnectIfNeeded()},window.addEventListener("online",this.boundOnlineHandler),window.addEventListener("offline",this.disconnect),document.addEventListener("visibilitychange",this.boundVisibilityChange))}connect=async t=>{if(!(this.connection?.readyState===WebSocket.CONNECTING||this.connecting||this.pongTimeout)){if(!this.getUrl)throw new Error("getUrl function is not set");Il.trackAttempting(this.windowStartTime),this.connecting=!0,this.socketStage="start";try{const n=await this.getUrl();this.connection=new WebSocket(n)}catch(n){if(this.connecting=!1,t)throw n;this.reconnectIfNeeded();return}this.connecting=!1,this.socketStage="created",this.connection.onopen=n=>{if(this.state=null,this.socketStage="opened",!ot("kill-rapid-reconnect-detect")){const o=performance.now();!this.windowStartTime||o-this.windowStartTime>=ure?(this.windowStartTime=o,this.connectionCount=1):this.connectionCount+=1,this.connectionCount>=dre&&(this.cooldownStart=o,this.windowStartTime=null,this.connectionCount=0,this.sendQueue=[])}this.onopen&&this.onopen(n),this.processSendQueue(),this.reconnectIntervalIndex=0,this.reconnectTimeout&&(window.clearTimeout(this.reconnectTimeout),this.reconnectTimeout=null),Il.trackSuccess(this.windowStartTime)},this.connection.onmessage=n=>{if(this.socketStage="received",this.state!=="destroyed"){this.pingOnSend&&this.removePongTimeout();try{const o=JSON.parse(n.data);this.onmessage&&this.onmessage(o),o.event==="pong"&&(this.pingOnSend||this.removePongTimeout(),this.processSendQueue())}catch{}}},this.connection.onclose=n=>{this.connection&&this.connection.bufferedAmount>0&&this.cachedSendData&&(this.sendQueue.push(this.cachedSendData),this.cachedSendData=null),this.onclose&&this.onclose(n,this.socketStage),this.autoReconnect&&this.state===null&&!this.reconnectPaused&&this.reconnect(),this.removePongTimeout(),Il.trackDisconnected(this.windowStartTime)},this.connection.onerror=n=>{this.onerror&&this.onerror(n),this.connection&&this.connection.close(),this.removePongTimeout(),Il.trackError(this.windowStartTime)}}};reconnect=()=>{this.reconnectTimeout&&window.clearTimeout(this.reconnectTimeout);const t=this.getCooldownLeft();if(!ot("kill-rapid-reconnect-detect")&&t!==null){if(t>0){this.reconnectTimeout=window.setTimeout(this.connect,t);return}this.cooldownStart=null,this.reconnectIntervalIndex=0}const n=this.reconnectIntervals[this.reconnectIntervalIndex];this.reconnectTimeout=window.setTimeout(this.connect,n),this.reconnectIntervalIndex=Math.min(this.reconnectIntervalIndex+1,this.reconnectIntervals.length-1)};processSendQueue=()=>{if(this.sendQueue.length>0){const t=this.sendQueue;this.sendQueue=[];for(const n of t)this.send(n)}};reconnectIfNeeded=t=>{const n=t?lre:cre;if(!(this.state==="destroyed"||this.reconnectPaused)){if(!this.connection||this.connection.readyState!==WebSocket.OPEN){this.reconnect();return}this.pongTimeout===null&&(this.connection.send(JSON.stringify({event:"ping"})),this.pongTimeout=window.setTimeout(()=>{this.pongTimeout=null,this.connection?.close(),this.reconnect()},n))}};removePongTimeout(){this.pongTimeout!==null&&(window.clearTimeout(this.pongTimeout),this.pongTimeout=null)}getCooldownLeft(){if(this.cooldownStart===null)return null;const t=performance.now()-this.cooldownStart;return Math.max(0,mre-t)}status(){return{connecting:this.connecting,readyState:this.connection?.readyState??-1,state:this.state,cooldownLeft:this.getCooldownLeft(),connectionCount:this.connectionCount,online:navigator.onLine,stage:this.socketStage}}send(t){if(this.state!=="destroyed")if(this.connection&&this.connection.readyState===WebSocket.OPEN&&this.pongTimeout===null)try{this.cachedSendData=t,this.connection.send(t)}catch{this.sendQueue.push(t),this.connect()}else this.sendQueue.push(t),this.connect()}cleanup(){this.boundOnlineHandler&&window.removeEventListener("online",this.boundOnlineHandler),window.removeEventListener("offline",this.disconnect),this.boundVisibilityChange&&document.removeEventListener("visibilitychange",this.boundVisibilityChange)}disconnect=()=>{this.connection&&(this.state="disconnected",this.connection.close())};destroy(){this.connection&&(this.state="destroyed",this.cleanup(),this.connection.close(),this.connection=null,this.windowStartTime=null,this.connectionCount=0,this.cooldownStart=null,this.reconnectPaused=!1)}pauseAutoReconnect(){this.reconnectPaused=!0}resumeAutoReconnect(){this.reconnectPaused=!1,this.autoReconnect&&this.reconnectIfNeeded()}sendPing(){this.reconnectIfNeeded(!0)}}async function hre({useMockConnection:e,useRetry:t}={}){const n=async({cursor:o})=>{const a=!!gw()||!!vw()?ore:"chat";return o?cf(a,{cursor:o}):cf(a)};try{return await Ri.get({getUrl:n})}catch(o){throw t&&Ri.reset(),o}}async function wn({useMockConnection:e,connectionType:t}={}){const n=W("chat-client-retry"),o=()=>t==="temporary"?gre({useMockConnection:e,useRetry:n}):hre({useMockConnection:e,useRetry:n});return n?ya(o,mo):o()}async function C_({getUrl:e}){if(typeof WebSocket>"u")return{destroy:()=>{},send:()=>{},regenerate:()=>{},sendContext:()=>{},sendAudioStart:()=>{},sendAudio:()=>{},sendAudioEnd:()=>{},sendAudioClick:()=>{},setCharacterAppearance:()=>{},setCallType:()=>{},stop:()=>{},setOnEvent:()=>()=>{},setOnOpen:()=>{},setOnClose:()=>{},sendChallengeResponse:()=>{},sendActionResult:()=>{},sendMessagePreview:()=>{},updateChatOptions:()=>Promise.resolve(),reportLocalConsents:()=>Promise.resolve(),selectSxSMessage:()=>{},status:()=>({connecting:!1,readyState:-1,state:null,cooldownLeft:0,connectionCount:0,online:!1,stage:"start"}),resetConversationState:()=>{},resetConversationTiming:()=>{},setConversationIdByMessageId:()=>{},setMessageIdByTaskId:()=>{},setChatModeForConversation:()=>{},setInputMethodForConversation:()=>{},setUploadCountsForConversation:()=>{},callBeforeSendForConversation:()=>{},callOnSentForConversation:()=>{},setUserMessageForConversation:()=>{},onSubmitMessageBlocked:()=>{},sendCommandResults:()=>{},sendPing:()=>{}};const t=qg(),n=!!J.instance().config().isBotDetectionEnabled;if(W("client-side-request-challenge")&&!ot("kill-client-side-request-challenge")&&n&&!t){const o=await tre(),s=!o||await nre();if(R.trackEvent({name:"system",data:{eventName:"botDetectionTriggered",eventInfo_result:s?"success":"failed",eventInfo_isBot:o}}),!s)return Promise.reject()}return new Promise((o,s)=>{let a=!1;const r=ot("kill-chat-auto-reconnect"),i=W("ping-on-send"),d=performance.now(),m=W("chat-connect-window")?[500,1e3,1500,2e3,5e3,1e4,2e4,3e4]:void 0,p=new fre({autoReconnect:!r,reconnectIntervals:m,pingOnSend:i}),h=new Xae(p);let g=null,y=null;p.getUrl=()=>e({cursor:h.latestMessagePartId}),p.onopen=async()=>{const b=performance.now();p.onmessage=C=>{try{By.parse(C)}catch(T){T instanceof Fi&&dr(T,"/chat")}h.processEvent(C)},await h.updateChatOptions(),await h.reportLocalConsents(),g&&g(),a=!0,o({destroy:()=>{p.destroy(),h.clearAllStreamingStates()},stop:(C={})=>{const{conversationId:T,taskId:S}=C;p.send(JSON.stringify({event:"stop",conversationId:T})),S&&p.send(JSON.stringify({event:"send",conversationId:T,content:[{type:"command",command:{type:"cancelTask",taskId:S}}],mode:"research"})),T&&Ne(T,E=>{for(const I of E)I.author==="ai"&&I.streamingState==="streaming"&&(I.streamingState="idle")})},send:h.send,regenerate:h.regenerate,sendContext:(C,T)=>{p.send(JSON.stringify({event:"sendContext",conversationId:T,context:C}))},sendAudioStart:C=>{const T=fw.run(C),{conversationId:S,options:E,clientType:I,mode:x,context:w}=T,P={event:"audioStart",conversationId:S,mode:x,options:E,clientType:I,context:w};p.send(JSON.stringify(P))},sendAudio:C=>{const T={event:"audio",audio:C};p.send(JSON.stringify(T))},sendAudioEnd:()=>{const C={event:"audioEnd"};p.send(JSON.stringify(C))},sendAudioClick:(C,T)=>{h.sendAudioClick(C,T)},setCharacterAppearance:(C,T)=>{h.setCharacterAppearance(C,T)},setCallType:C=>{const T={event:"setCallType",callType:C};p.send(JSON.stringify(T))},sendChallengeResponse:h.sendChallengeResponse,setOnEvent:C=>{p.onmessage=T=>{try{By.parse(T),h.processEvent(T)}catch(S){S instanceof Fi&&dr(S,"/chat")}C(T)}},setOnOpen:C=>{g=C},setOnClose:C=>{y=C},sendActionResult:h.sendActionResult,selectSxSMessage:C=>{const{sideBySideComparisonId:T,selectedMessageId:S}=C,E={event:"selectMessage",sideBySideComparisonId:T,selectedMessageId:S};p.send(JSON.stringify(E))},resetConversationState:h.resetConversationState,resetConversationTiming:h.resetConversationTiming,setConversationIdByMessageId:h.setConversationIdByMessageId,setMessageIdByTaskId:h.setMessageIdByTaskId,setChatModeForConversation:h.setChatModeForConversation,setInputMethodForConversation:h.setInputMethodForConversation,setUploadCountsForConversation:h.setUploadCountsForConversation,callBeforeSendForConversation:h.callBeforeSendForConversation,callOnSentForConversation:h.callOnSentForConversation,setUserMessageForConversation:h.setUserMessageForConversation,onSubmitMessageBlocked:h.onSubmitMessageBlocked,sendMessagePreview:h.sendMessagePreview.bind(h),updateChatOptions:h.updateChatOptions.bind(h),reportLocalConsents:h.reportLocalConsents.bind(h),status:()=>p.status(),sendCommandResults:h.sendCommandResults.bind(h),sendPing:()=>p.sendPing()}),R.trackEvent({name:"system",data:{eventName:"chatWebSocketOpened",eventInfo_duration:b-d}})},p.onclose=(b,C)=>{if(b.code!==1e3){const T={stage:C,code:b.code,reason:b.reason,wasClean:b.wasClean,online:navigator.onLine};R.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"WebSocketUnexpectedClose",eventInfo_details:JSON.stringify(T)}}),W("socket-close-track")&&ere(T,Vd).catch(()=>{})}y&&y()},p.onerror=b=>{const C=b instanceof ErrorEvent?b.message:"Unknown WebSocket error";R.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"ChatWebsocketError",eventInfo_errorMessage:C,eventInfo_details:JSON.stringify(b)}}),a||(p.destroy(),s(new Error(`WebSocket connection error: ${C}`)))},p.initialize().catch(b=>{p.destroy();const C=b instanceof Error?b.message:"Unknown WebSocket error";R.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"ChatWebsocketInitializationError",eventInfo_errorMessage:C,eventInfo_details:b instanceof Error?b.stack??"":""}}),s(new Error(`WebSocket initialization error: ${C}`))})})}async function Vd(){if(Ri.isInstantiated){const e=B(Rt),t=B(Rc),n=await Ri.get();n.stop(),n.destroy(),n.stop({conversationId:e?.id}),Ri.reset();try{R.trackEvent({name:"system",data:{eventName:"chatClientReset",eventInfo_isMessageStreaming:t}})}catch{}}}const Ri=new Ds(e=>C_(e)),uS=new Ds(e=>C_(e));async function gre({useMockConnection:e,useRetry:t}={}){const{acquireSessionKey:n}=await N(async()=>{const{acquireSessionKey:a}=await import("./temporary-conversation-BKE1QPYP.js");return{acquireSessionKey:a}},__vite__mapDeps([11,1,2])),o=await n(),s=async({cursor:a})=>{const r={...a?{cursor:a}:{},temporarySessionKey:o};return cf("chat",r)};try{return await uS.get({getUrl:s})}catch(a){throw t&&uS.reset(),a}}function vre(){const e=M(ut),t=q("account-change-chat-reset");l.useEffect(()=>{t&&Vd()},[e,t])}function S_(e){const{onStartComplete:t}=e;l.useEffect(()=>{const n=()=>{t(),Ce.off("app:start-complete",n)};return Ce.on("app:start-complete",n),()=>{Ce.off("app:start-complete",n)}},[t])}function yre(){S_({onStartComplete:()=>{e()}});const e=()=>{try{const n="n59ae4ieqq";if(ot("kill-clarity")||!t(n))return()=>{};window.clarity??=function(...r){window.clarity&&(window.clarity.q??=[]).push(r)};const s=document.createElement("script");return s.type="text/javascript",s.async=!0,s.src=`/cl/tag/${n}`,document.body.appendChild(s),window.clarity("signal",async a=>{if(a.type==="cl_dtrs"&&a.value){const r=B(Te);try{await Nt({path:"/clarity/signal",args:{body:{token:a.value,conversationId:r}}}),R.trackEvent({name:"system",data:{eventName:"copilotFeatureSuccess",eventInfo_feature:"Clarity",eventInfo_scenario:"Clarity signal event sent via API",eventInfo_customData:JSON.stringify(a)}})}catch(i){R.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"ClaritySignalError",eventInfo_details:"Failed to send clarity via API",eventInfo_errorMessage:i instanceof Error?i.message:"Unknown clarity signal error"}})}}}),window.clarity("metadata",()=>{yf({surface:"cmc"});const a=B(Vg);a!==null&&yf({isNewUser:a.toString()})},!1,!0),()=>{delete window.clarity,s.remove()}}catch(n){return R.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"useClarity",eventInfo_details:"Error loading Clarity",eventInfo_errorMessage:`${n}`}}),()=>{}}},t=n=>n.trim()!==""}async function sp(e,t){if(!(t==="user"&&(await sq.run({theme:e})).intercepted)){if(J.instance().config().persistThemeChoice){const o=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";e!==o?($t(Ss,e),Zo(Ss,e,{expireDays:365*10})):(mt(Ss),vr(Ss))}document.documentElement.setAttribute("data-theme",e),Ce.emit("theme:color-applied",e)}}function Cre(){const e=Yo(Ss),t=$u()==="ssr"?null:kt(Ss);return e??t??null}function Sre(){const{persistThemeChoice:e,enforceTheme:t}=J.instance().config(),[n,o]=Le(ss);l.useEffect(()=>{const s=window.matchMedia("(prefers-color-scheme: dark)"),a=i=>{const d=i.matches?"dark":"light";o(d),sp(d,"system"),e&&(mt(Ss),vr(Ss))};let r=e?Cre():"";return r!=="dark"&&r!=="light"&&(r=s.matches?"dark":"light"),t&&(r=t),o(r),sp(r,"system"),s.addEventListener("change",a),()=>{s.removeEventListener("change",a)}},[o,e,t]),l.useEffect(()=>{n&&sp(n,"user")},[n])}const G1=new Set;function bre(e=!1){return kt(Bp)!==null&&!e?!1:(mt(Ku),mt(yr),Are(),$t(Bp,"true"),!0)}function b_(){return parseInt(kt(Ku)??"0",10)}function Ire(){return new Date(kt(yr)??new Date().toISOString())}function Ere(e){kt(yr)||$t(yr,e)}function Tre(e){let t;try{t=b_()}catch{t=0}t<qp&&(t+=1,$t(Ku,`${t}`),G1.add(e),t===qp&&Ere(new Date().toISOString()))}function wre(e){e&&(G1.has(e)||Tre(e))}function Are(){G1.clear()}function xre(){const e=Dt(),t=G(WT);l.useEffect(()=>{e&&bre()&&t(!0)},[e,t])}function _re(){l.useEffect(()=>{if(window.ReportingObserver===void 0)return()=>{};const e=new ReportingObserver(t=>{for(const n of t){if(n.type!=="csp-violation"||!n.body)continue;const{body:o}=n,{blockedURL:s,documentURL:a,effectiveDirective:r,disposition:i}=o;console.error("Reporting CSP violation",{blockedURL:s,documentURL:a,effectiveDirective:r,disposition:i}),R.trackEvent({name:"system",data:{eventName:"copilotCSPViolation",eventInfo_blockedURL:s,eventInfo_documentURL:a,eventInfo_effectiveDirective:r,eventInfo_disposition:i}})}},{buffered:!0,types:["csp-violation"]});return e.observe(),()=>{e.disconnect()}},[])}function kre(){const e=q("custom-1ds"),t=M(Bt);l.useEffect(()=>{if(!e||!J.instance().config().enableCustom1DS)return z5(),()=>{};if(!t)return()=>{};const n=()=>{if(window.oneDS){const{ApplicationInsights:a}=window.oneDS;return new a}},o=()=>{window.OneDsAzureAnalytics=window.OneDsAzureAnalytics??n();function a(){return!!!window.OneDsAzureAnalytics?.getCookieMgr().get("MSCC")}const r={adobe:a(),google:a()},i={instrumentationKey:"c72e6b24df604532a6282edd268b4ba4-9cdee1fe-5d2f-4626-9620-dbad9b53a8e5-8065",channelConfiguration:{eventsLimitInMem:50,autoFlushEventsLimit:1},propertyConfiguration:{userConsentCookieName:Wu.name,gpcDataSharingOptIn:yI(),callback:{userConsentDetails:()=>{if(!Zu.includes(t))return{Required:!0,Analytics:!0,SocialMedia:!0,Advertising:!0};const d=Ia();return{Required:Object.values(d).includes(!0),Analytics:d.analytics,SocialMedia:d.socialMedia,Advertising:d.advertising}}}},webAnalyticsConfiguration:{coreData:{appId:"JS:Copilot_microsoft_com"},cookiesToCollect:["_mkto_trk"],urlCollectQuery:!0,syncMuid:a()},extensionConfig:{IdSyncPlugin:r}};window.postConsAzure1DSInit||(window.OneDsAzureAnalytics?.initialize(i,[]),window.postConsAzure1DSInit=!0)},s=document.createElement("script");return s.src="https://az416426.vo.msecnd.net/scripts/c/ms.analytics-web-4.min.js",s.async=!0,s.onload=o,document.head.appendChild(s),()=>{document.head.removeChild(s)}},[e,t])}function Hd(){const[e,t]=Le(rG),n=sn();return l.useEffect(()=>{n.endsWith("/chats/new/talk")&&(R.setLandingPage("deepLinkVoiceCall"),t("audioCall"))},[n,t]),[e,()=>t(null)]}function Pre(e){const{handler:t}=Wx({deferred:!0}),{handler:n}=Yx({deferred:!0}),{passthroughType:o,prompt:s}=Zx(),a=l.useCallback(d=>{R.setLandingPage("chatWithPartialPromptPassthrough"),t(d)},[t]),r=l.useCallback(d=>{R.setLandingPage("chatWithFullPromptPassthrough"),n(d)},[n]),i=l.useCallback(()=>{if(s&&o)switch(o){case"partial":a(s);break;case"full":r(s);break}},[r,a,o,s]);l.useEffect(()=>{e&&i()},[e,i])}const I_=_(null),E_=_(!1),Mre=_(!1),cxe=_(0),Rre=_("free-talk");function zd(){const e=sn(),t=M(I_),n=M(E_),o=M(Rre),s=q("labs-portrait-enabled")&&e.startsWith("/labs/portrait"),a=q("labs-portrait-v2"),r=s&&t,i=r?t.id:void 0,d=r&&!n?t.voiceId:void 0;return{isPortraitEnabled:s,isPortraitV2Enabled:a,portraitId:i,portraitVoiceId:d,portraitScenario:o}}function Nre(){return typeof window>"u"?!1:W("labs-portrait-enabled")&&window.location.pathname.startsWith("/labs/portrait")}const Lre=["study-mode-lumi","study-mode-lumi-v2","study-mode-summary"];function W1(){const e=q("study-mode-summary"),n=Zt()==="study";return e&&n&&!ld()}const T_=["character-animation-spda2e","character-animation-vasa"],Dre=[...T_,...Lre];function $1(e){return e==="study"?Dre:T_}function js(){const{isPortraitEnabled:e}=zd(),t=Zt(),{lumiEnabled:n=!1}=J.instance().config();return!!((!!Pc($1(t),"any")||n)&&!e)}function q1(){const e=M(io);return js()&&!!e}function Ore(){const e=co(),t=Nre(),{lumiEnabled:n=!1}=J.instance().config();return!!((!!Mc($1(e),"any")||n)&&!t)}function _n(){const e=ke().get(io),t=co(),{lumiEnabled:n=!1}=J.instance().config();return!!((!!Mc($1(t),"any")||n)&&e)}function El(e){return xT.includes(e)}function Ure(){const e=sn(),t=l.useRef(!1),n=M(vt),[o,s]=Le(io),a=js();l.useEffect(()=>{e.startsWith("/chats")&&Pt("appearance-talk")==="1"&&(t.current=!0)},[e]),l.useEffect(()=>{a&&n&&t.current&&(t.current=!1,s(Da))},[n,t,o,s,a])}function lxe(){return q("edu-discovery-cross-sell")}function Fre(){return Pc(["study-mode-lumi","study-mode-summary"],"any")}function jre(){return!!M(io)}function uxe(){const e=Fre(),t=jre();return e&&t}function w_(){return q("study-mode-homepage")}function A_(e){l.useEffect(()=>{const t=()=>{e()};return st.on("languageChanged",t),()=>{st.off("languageChanged",t)}},[e])}async function Bre(e,t){const n="/activation/homepage";return(await pt(n,ZH,{query:{supportedWidgets:e.join(","),...t?{intent:t}:{}},options:{method:"GET",headers:{"Content-Type":"application/json"}},analytics:{anonymousPath:n}})).data}const Of=1e3*60*60,dxe=1e3*60,Vre={refetchInterval:Of,refetchOnWindowFocus:!1,staleTime:Of};function dS(e,t){if(e)return["conversation-starter"];const n=["conversation-starter","conversation-starter-prompted-greeting","categorized-conversation-starter","conversation-starter-send-message"];return W("feature-discovery")&&n.push("banner"),t&&n.push("study-and-learn"),n}function Hre(){const e=G(Jx),[t,n]=l.useState(!1),o=D1(),s=G(Bd),a=it("kill-landing-widgets"),r=w_(),i=!!J.instance().config().landingPage?.shouldFetchWidgetsData;S_({onStartComplete:()=>{n(!0)}});const d=t&&i,{data:m,isLoading:p,error:h,refetch:g}=ts({queryKey:["homepage",dS(a,r),o],enabled:d,queryFn:()=>Bre(dS(a,r),o),...Vre});l.useEffect(()=>{s(p)},[p,s]),A_(()=>d&&g()),l.useEffect(()=>{if(m?.pages){const y=m.pages[0];y&&e(y)}},[m,e]),l.useEffect(()=>{h&&(R.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"homepage",eventInfo_errorMessage:String(h),eventInfo_details:"Homepage API error"}}),s(!1),e(void 0))},[h,e,s])}function zre(){const e=M(N1),t=Wr(),o=Vt()==="/",s=e&&t&&o;return l.useMemo(()=>{if(s)return{type:"greeting",greetingMessage:e}},[e,s])}function Gre(e=5){const t=M(Te),n=M(gd),o=M(Bt),s=Dt(),a=Ld(o),r=M(Dg),i=Ba(),d=ot("kill-id-sync");l.useEffect(()=>{const{enforceAdsOptOutOfPersonalization:m}=J.instance().config();if(t&&n){const p=kh(),g=Ia().advertising;if(R.trackEvent({name:"system",data:{eventName:"copilotAdsSignal",eventInfo_scenario:"syncAdvertisingId",eventInfo_conversationId:t,eventInfo_additionalData:JSON.stringify({isIdSyncDisabled:d,isTemporaryConversation:i,isAuthenticated:s,isAdPersonalizationEnabled:g,enforceAdsOptOutOfPersonalization:m,isGdprPlusRegion:a,isChoiceCookieEmpty:!p})}}),i||d)return;const y=new URLSearchParams;if(y.append("cpid",n),y.append("cvid",t),s&&y.append("cp","1"),p){if(a&&!g)return;g&&!m?y.append("ps","1"):y.append("ps","0")}else{if(a)return;y.append("ps","1")}const b=`https://c.bing.com/cp?${y}`,C=performance.now();ya(async()=>{const T=await fetch(b,{method:"GET",mode:"no-cors",credentials:"include"}),S=performance.now();CT(b,"GET",S-C,T.clone())},{maxRetries:e,initialDelayMs:1e3,backoffFactor:2,maxDelayMs:6e4,jitterFactor:0,onFailure:({attemptCount:T,errors:S,exitReason:E})=>{const I=S[S.length-1],x={errorType:I?.errorType??"Unknown",errorMessage:I?.errorMessage??"Unknown error",attemptNumber:T,maxRetries:e,url:b,userAgent:navigator.userAgent,onlineStatus:navigator.onLine,exitReason:E};R.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"AdsError",eventInfo_errorMessage:"Ads Id Sync failed with error",eventInfo_details:JSON.stringify(x)}})}}).catch(()=>{})}},[r,t,o,e,d,a,n,s,i])}function Wre({upsellEligibleSubscription:e,requiresPremium:t}){const n=M(Ur);return l.useMemo(()=>{const o=jG(n,e);return o||FG(n,t)},[e,t,n])}const mS="cmmipliy5qj";function $re(e){const{ocid:t}=e,n=new URL("https://aka.ms/AA84f4p");return n.searchParams.append("ocid",t),n.toString()}function qre(e){const{urlParams:t}=J.instance().config().proSubscription;if(!t)return mS;const{ocids:n}=t;return n[e]?.buy??mS}const Kre="https://account.microsoft.com/services/copilot/details",Yre="https://account.microsoft.com/services/microsoft365/details",mxe="https://account.microsoft.com/";function pxe({entryPoint:e,isPro:t}){const{manageRefId:n}=J.instance().config().proSubscription,o=`copilot.${n}.${e}`,s=new URL(t?Kre:Yre);return s.searchParams.append("ref",o),s.hash="billing",s.toString()}function Zre(e){J.instance().config().subscribeInNewWindow?zr(e):Qg(e)}function Jre(e){const{instanceId:t,payflowEntryPoint:n,requiresPremium:o,userProfileId:s}=e,a=new URL("/subscription/start",window.location.origin),{sourceIdentifier:r,manageRefId:i}=J.instance().config().proSubscription;if(a.searchParams.set("pfcid",t),a.searchParams.set("pff",r??i),s){const d=s.slice(-10);a.searchParams.set("pfah",d)}return a.searchParams.set("pfe",n),a.searchParams.set("pfrp",o?"1":"0"),a}function Qre(e){return l.useCallback(()=>{const t=$re({ocid:e});$n({scenario:"redirectToExternalUpsell",customData:{url:t}}),Zre(t)},[e])}const Xre="https://content.lifecycle.office.net/dime/v1/dime.js";function eie(){return new Promise((e,t)=>{const n=performance.now(),o=document.createElement("script");o.src=Xre,o.type="text/javascript",o.async=!0,o.onload=()=>{$n({scenario:"loadDimeScript",duration:performance.now()-n}),e()},o.onerror=()=>{const s=new Error("Failed to load Dime script");no({...pa(s),scenario:"loadDimeScript",customData:{duration:performance.now()-n}}),t(s)},document.head.appendChild(o)})}const pS=new Ds(eie);async function tie({language:e,market:t,sessionId:n}){const o={language:e,market:t,sessionId:n},s=performance.now();try{const[a]=await Promise.all([mq(),pS.get()]);$n({scenario:"prepareDimeInitialization",duration:performance.now()-s,customData:o}),a||no({scenario:"initializeDime",errorCode:"noUserInfo",customData:o}),a?.username||no({scenario:"initializeDime",errorCode:"NoMSAAuthHint",customData:o}),a?.idTokenClaims?.puid||no({scenario:"initializeDime",errorCode:"NoMSAPuid",customData:o});const r=new window.Dime({language:e,market:t,sessionId:n,partnerId:"cmc",authHint:a?.username,userInfo:{puid:a?.idTokenClaims?.puid}});return $n({scenario:"initializeDime",duration:performance.now()-s,customData:o}),r}catch(a){return pS.reset(),no({...pa(a),scenario:"initializeDime",customData:{...o,duration:performance.now()-s}}),null}}const fS=new Ds(e=>tie(e));class nie{#e=Pn("payflowCorrelationId")??crypto.randomUUID();#t;#n=!1;ensureDime=async({language:t,market:n})=>{const o=performance.now(),s={language:t,market:n,sessionId:this.#e};this.#t&&t!==this.#t&&(this.reset(),$n({scenario:"resetDimeForLanguageChange",customData:s})),this.#t=t;const a=await fS.get({language:t,market:n,sessionId:this.#e});return $n({scenario:"ensureDime",duration:performance.now()-o,customData:s}),a};get sessionId(){return this.#e}get preloaded(){return this.#n}overrideSessionId=t=>{this.reset(),this.#e=t};setPreloaded=()=>{this.#n=!0};reset=()=>{fS.reset(),this.#n=!1}}const ir=new nie,hS="ms-copilot://chat",oie="ms-copilot://subscription",sie=1e3;function aie(e){if(typeof window>"u")return new URLSearchParams;const t=new URLSearchParams,n=R.getFormCode();n&&t.set("form",n);const o=G5();return o&&t.set("ocid",o),e?.prompt&&t.set("q",e.prompt),t}function rie(e){return e?`${hS}?${e.toString()}`:hS}function iie(e){const t=new URLSearchParams({pfcid:e});return`${oie}?${t.toString()}`}async function x_(e){if(!q5()||!e)return!1;try{const t=document.createElement("iframe");return t.style.display="none",t.src=e,document.body.appendChild(t),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t)},sie),!0}catch{return!1}}async function cie(e){const t=aie(e),n=rie(t);return x_(n)}function lie(e){const t=q("subs-return-wcp");return l.useCallback(async n=>{if(t&&e.includes("FromWinChromium"))try{const o=iie(n);if(!await x_(o))throw new Error("Protocol launch failed");$n({scenario:"launchCopilotSubscriptionProtocol",customData:{payflowInstanceId:n}})}catch(o){no({...pa(o),scenario:"launchCopilotSubscriptionProtocolFailed",customData:{payflowInstanceId:n}})}},[t,e])}function uie({payflowEntryPoint:e,upsellReason:t,entryStyle:n,dimeExperience:o,shouldTrackPayflowEnter:s}){const a=M(Bt),{i18n:{resolvedLanguage:r}}=Z(),i=M(ss),d=M(ut),m=M(Oa),p=q("subs-hot-reload"),h=l.useMemo(()=>qre(e),[e]),g=Qre(h),y=lie(e),b=l.useMemo(()=>({payflowEntryPoint:e,upsellReason:t??"unknown",loginProvider:d?.accountType??"unknown",curatedSubscription:m?.tier??Ug,campaignId:h,dimeMarket:a??"unknown",correlationId:ir.sessionId,dimeExperienceId:o??"",upsellEntryStyle:n}),[e,t,d?.accountType,m?.tier,h,a,o,n]);return{launchDime:l.useCallback(async T=>{const S={...b,payflowInstanceId:T};s&&ST({...S});try{if(!o)throw new Error("No dime experience available");const E=await ir.ensureDime({language:VG(r??"en-US"),market:a});if(!E)throw new Error("Dime not a valid instance");_G({...S,dimeExperienceId:o});let I=!1,x;if((await E.launch({experience:o,theme:i??"light",campaignId:h},async()=>{if(kG({...S,dimeExperienceId:o}),p){const P=performance.now();try{await jte(),I=!0;const D=performance.now()-P;$n({scenario:"dimeCheckoutHotReloadSucceeded",duration:D,customData:{payflowInstanceId:T}})}catch(D){x=D}}})).status==="Success"){if(await y(T),I)return;x&&no({...pa(x),scenario:"dimeCheckoutHotReloadFailed",customData:{payflowInstanceId:T}}),Os()}else PG({...S,dimeExperienceId:o})}catch(E){MG({...b,...pa(E),payflowInstanceId:T,dimeExperienceId:o??""}),g()}},[r,a,i,o,h,b,s,g,p,y]),openDimeFallbackPage:g}}function die(e){const t=l.useRef(null),n=M(ut),o=M(OW),{upsellEntryStyle:s,payflowEntryPoint:a,upsellReason:r,payflowType:i}=e,d=n?.accountType??"unknown",m=l.useCallback(h=>{const g=NG({upsellEntryStyle:s,payflowEntryPoint:a,upsellReason:r,loginProvider:d,payflowType:i,actionButton:h?.actionButton,curatedSubscription:o});t.current=g},[o,s,a,r,i,d]),p=l.useCallback(h=>{const{payflowInstanceId:g,actionButton:y}=h,b=t.current;b||no({errorCode:"InvalidImpressionId",errorDetails:"trackClick called before trackImpression - impression ID is missing",scenario:"unknownPayflowEntryPointInSubscriptionStart",customData:{payflowEntryPoint:a,payflowInstanceId:h.payflowInstanceId}}),LG({payflowEntryImpressionId:b??"",loginProvider:d,upsellEntryStyle:s,payflowEntryPoint:a,upsellReason:r,payflowType:i,payflowInstanceId:g,actionButton:y})},[s,a,r,i,d]);return{trackImpression:m,trackClick:p}}function mie(){const e=q("subs-inline-checkout"),t=M(Ur);return e&&t.length===0&&J.instance().config().proSubscription.enabled}function pie(){const e=it("kill-subs-dime"),t=mie(),n=J.instance().config().proSubscription.redirectSubscriptionToCMC??!1,o=!e&&!t&&!n;return{payflowType:l.useMemo(()=>n?"CMC-DIME":t?"ProSubPaywall":o?"DIME":"UniPux",[o,t,n]),shouldUseDime:o,isInlineCheckoutEnabled:t,shouldRedirectToCMC:n,killSubsDime:e,willStayInApp:!!(o||t)}}function fie({shouldUseDime:e,enableDimePreload:t,dimeExperience:n}){const o=M(Bt),{i18n:{resolvedLanguage:s}}=Z(),a=M(ut),r=M(Dr);l.useEffect(()=>{e&&t&&n&&a?.accountType==="MSA"&&r&&!ir.preloaded&&(async()=>{const d=await ir.ensureDime({language:s??"en-US",market:o}),m={language:s,market:o,sessionId:ir.sessionId,experiences:n};if(d){const p=performance.now();try{await d.preload({experiences:[n]}),$n({scenario:"preloadDime",duration:performance.now()-p,customData:m})}catch(h){no({scenario:"preloadDime",...pa(h),customData:{...m,duration:performance.now()-p}})}finally{ir.setPreloaded()}}else no({scenario:"preloadDime",...pa(new Error("Dime not a valid instance")),customData:m})})()},[e,t,n,a?.accountType,r,s,o])}function hie({payflowEntryPoint:e,upsellReason:t,entryStyle:n,isInlineCheckoutEnabled:o,shouldUseDime:s}){const a=M(Bt),r=M(Sd),i=M(ut),d=M(Oa),m=M(vt),p=G(gG),h=G(fG),g=G(vG),y=it("kill-subs-user-mismatched-dialog"),{shouldRedirectMobile:b,redirectMobileSource:C}=BG(d??null);return l.useCallback(()=>{if(a&&RI.includes(a))return $n({scenario:"subscriptionRegionRestricted",customData:{region:a}}),null;if(r)return $n({scenario:"subscriptionUserAgeRestricted"}),null;if(b&&C!==null)return p({source:C,entryStyle:n,upsellReason:t,payflowEntryPoint:e}),null;if((o||s)&&i?.provider==="auth0")return B(mT)?(Bo("shouldStartSubscription",!0),Bo("parsedPayflowEntryPoint",e),Os(),null):(Bo("parsedPayflowEntryPoint",e),h({source:"Composer"}),null);let T=Pn("payflowInstanceId");T||(T=crypto.randomUUID(),Bo("payflowInstanceId",T),no({scenario:"missingPayflowInstanceId",errorCode:"payflowInstanceIdMissing",customData:{generatedPayflowInstanceId:T}}));const S=Pn("payflowAuthHint"),E=m?.id.toLowerCase()??"";if(typeof m?.id=="string"&&typeof S=="string"&&S.length>0&&!E.endsWith(S.toLowerCase())&&!E.startsWith(S.toLowerCase()))if(y)RG({correlationId:Pn("payflowCorrelationId")??"",payflowInstanceId:T});else return g({correlationId:Pn("payflowCorrelationId")??"",payflowInstanceId:T,payflowEntryPoint:e}),null;return T},[a,r,b,C,o,s,i?.provider,e,m?.id,y,p,n,t,h,g])}const gie=e=>{const{beforeNavigate:t,payflowEntryPoint:n,upsellReason:o,upsellEntryStyle:s,requiresPremium:a}=e,r=Fa(),i=Vt(),d=M(ut),m=M(Oa);return l.useCallback(async p=>{ST({payflowEntryPoint:n,upsellReason:o??"unknown",loginProvider:d?.accountType??"unknown",curatedSubscription:m?.tier??Ug,upsellEntryStyle:s,correlationId:p,payflowInstanceId:p}),t?.(),await r({to:"/subscription/pricing",from:i,search:{"payflow-correlationId":p,"entry-point":n,pfrp:JSON.stringify(a)}})},[s,i,n,o,d?.accountType,t,r,m?.tier,a])};async function vie(e){const{payflowEntryPoint:t,requiresPremium:n,instanceId:o}=e,s=B(vt),a=Jre({instanceId:o,payflowEntryPoint:t,requiresPremium:n,userProfileId:s?.id});await cq.run({url:a})}function yie(e){const{payflowEntryPoint:t,upsellReason:n,entryStyle:o,requiresPremium:s=!1,enableDimePreload:a=!1,upsellEligibleSubscription:r,shouldTrackPayflowEnter:i=!0,beforeNavigate:d}=e,{payflowType:m,shouldUseDime:p,isInlineCheckoutEnabled:h,shouldRedirectToCMC:g,killSubsDime:y,willStayInApp:b}=pie(),{trackClick:C,trackImpression:T}=die({upsellEntryStyle:o,payflowEntryPoint:t,upsellReason:n??"",payflowType:m}),S=M(Dr),E=hie({payflowEntryPoint:t,upsellReason:n,entryStyle:o,isInlineCheckoutEnabled:h,shouldUseDime:p}),I=l.useRef(!1),x=Wre({upsellEligibleSubscription:r,requiresPremium:s});fie({shouldUseDime:p,enableDimePreload:a,dimeExperience:x});const w=gie({beforeNavigate:d,payflowEntryPoint:t,upsellReason:n,upsellEntryStyle:o,requiresPremium:s}),{launchDime:P,openDimeFallbackPage:D}=uie({payflowEntryPoint:t,upsellReason:n,entryStyle:o,dimeExperience:x,shouldTrackPayflowEnter:i}),L=l.useCallback(async()=>{if(!S){$n({scenario:"subscriptionUserNotFetched"}),I.current=!0;return}I.current=!1;const U=E();if(U){if(Io("payflowRequiresPremium"),Io("payflowCorrelationId"),Io("payflowAuthHint"),g){await vie({instanceId:U,payflowEntryPoint:t,requiresPremium:s});return}if(h&&!HG(t)){await w(U);return}if(y){D();return}await P(U)}},[y,h,t,P,D,S,w,g,E,s]);return l.useEffect(()=>{S&&I.current&&(I.current=!1,L())},[S,L]),{handleSubscription:l.useCallback(async U=>{const $=crypto.randomUUID();return Bo("payflowInstanceId",$),C({payflowInstanceId:$,actionButton:U?.actionButton}),L()},[C,L]),handleResumeSubscriptionWithCurrentInstanceId:L,willStayInApp:b,payflowType:m,trackImpression:T}}function Gd(){const e=M(vt),t=M(HT),n=M(Oa),o=M(Ur),s=M(Sd),a=M(Bt);return l.useMemo(()=>J.instance().config().proSubscription.enabled?e?n?.tier==="m365-premium-admin"||t?{eligibleSubscriptionUpgrades:[],disabledReason:"AlreadyPurchased"}:s?{eligibleSubscriptionUpgrades:[],disabledReason:"RestrictedAgeGroup"}:!a||RI.includes(a)?{eligibleSubscriptionUpgrades:[],disabledReason:"RestrictedRegion"}:n?.tier==="m365-family-guest"||n?.tier==="m365-premium-guest"||n?.tier==="m365-family-classic-guest"?{eligibleSubscriptionUpgrades:[],disabledReason:"Guest"}:o.length===0?{eligibleSubscriptionUpgrades:["m365-personal","m365-premium"]}:o.some(r=>r.tier==="pro")?{eligibleSubscriptionUpgrades:["m365-premium"]}:o.some(r=>IT.includes(r.tier))?{eligibleSubscriptionUpgrades:[]}:o.some(r=>ET.includes(r.tier))?{eligibleSubscriptionUpgrades:["m365-premium"]}:{eligibleSubscriptionUpgrades:["m365-personal","m365-premium"]}:{eligibleSubscriptionUpgrades:[],disabledReason:"UserProfileUnavailable"}:{eligibleSubscriptionUpgrades:[],disabledReason:"SurfaceNotSupported"},[e,t,n?.tier,s,a,o])}function Cie(e){const t=M(ut),n=M(Dr),o=M(Sd),{upsellFromAuth0:s}=J.instance().config().proSubscription,r=Dt()&&t?.provider==="microsoft",i=Gd(),d=M(Ur),m=Pn("shouldStartSubscription"),p=Pn("parsedPayflowEntryPoint")??"Unknown",h=Pn("payflowRequiresPremium")??!1,g=sn(),y=l.useRef(!1),{handleResumeSubscriptionWithCurrentInstanceId:b}=yie({payflowEntryPoint:p,upsellReason:"",entryStyle:"Redirect",requiresPremium:h});l.useEffect(()=>{if(m&&r&&!g.startsWith("/subscription/start")){Io("shouldStartSubscription"),setTimeout(()=>{b()},0);return}if(!s?.navigateToProSubPageAfterLogin)return;const C=sessionStorage.getItem(Wy);if(!C)return;async function T(S){const[,E]=S.split("-");if(E==="link"){const I=performance.now(),{getAuth0AccessToken:x,auth0:w}=await bo.get(),P=await x(Ed());if(!P){Je({feature:"accountLinkAuth0WithMSA",errorType:"LinkStartedWithoutAuth0Token"});return}try{await Nt({path:"/user/link",args:{body:{token:P}}})}catch(D){D instanceof Error&&Je({feature:"accountLinkAuth0WithMSA",errorType:D.name,errorMessage:D.message,exception:D.stack})}finally{w.logout({openUrl:!1}),_o({feature:"accountLinkAuth0WithMSA",duration:performance.now()-I}),(i.eligibleSubscriptionUpgrades.length!==0||Fg(d).isEligible)&&await b()}}}if(e&&!y.current&&n){if(y.current=!0,sessionStorage.removeItem(Wy),Io("parsedPayflowEntryPoint"),t?.accountType!=="MSA"||o)return;T(C)}},[e,b,s,t,o,n,g,r,m,i,d])}function Sie(e){const{isEnabled:t,onIntercept:n,shouldIntercept:o,clickSource:s}=e;l.useEffect(()=>{if(!t)return()=>{};const a=d=>o(d)?(n(d.toString()),!0):!1,r=d=>{const m=d.target.closest("a");m&&m instanceof HTMLAnchorElement&&a(m.href)&&(s&&de({source:s}),d.preventDefault())},i=window.open;return window.open=function(...m){return m[0]&&!a(m[0])?i.apply(window,m):null},document.addEventListener("click",r),()=>{window.open=i,document.removeEventListener("click",r)}},[t,n,o,s])}function bie(){l.useEffect(()=>{const e=kt(cy),t=Date.now();e||$t(cy,t.toString())},[])}const gS=(e,t)=>e.matchRoutes(t).at(-1)?.routeId;function Iie(){const e=Ou(),t=gS(e,e.state.location.pathname),n=l.useRef(null),o=l.useRef(null),s=l.useRef(new Set(t?[t]:[]));l.useEffect(()=>{function a(C){if(!C.pathChanged)return;const T=gS(e,C.toLocation.pathname);if(T)return T}function r(C){const T=a(C);if(T&&!s.current.has(T))return T}const i=C=>{const T=a(C);T&&(n.current={routeId:T,pathname:C.toLocation.pathname,startTime:performance.now(),isLoaded:s.current.has(T)})},d=C=>{const T=a(C);if(!T||!n.current||n.current.pathname!==C.toLocation.pathname)return;const S=performance.now()-n.current.startTime,E=JSON.stringify({routeId:T,pathname:n.current.pathname,isLoaded:n.current.isLoaded,defaultPreload:Nn().options.defaultPreload??!1});R.trackEvent({name:"system",data:{eventName:"timeToNavigate",eventInfo_customData:E,eventInfo_duration:S}})},m=C=>{const T=r(C);T&&(o.current={routeId:T,startTime:performance.now()})},p=C=>{const T=r(C);if(!T||!o.current||o.current.routeId!==T)return;const S=performance.now()-o.current.startTime,E=JSON.stringify({routeId:T,defaultPreload:Nn().options.defaultPreload??!1,isSidebarNavLinkEnabled:!ot("kill-sidebar-nav-item-router-links")});R.trackEvent({name:"system",data:{eventName:"routeNavigationLoadTime",eventInfo_customData:E,eventInfo_duration:S}}),s.current.add(T),o.current=null},h=e.subscribe("onBeforeNavigate",i),g=e.subscribe("onResolved",d),y=e.subscribe("onBeforeLoad",m),b=e.subscribe("onLoad",p);return()=>{h(),g(),y(),b()}},[e])}function Eie(){const e=Ra(),t=q("router-default-preload-intent");l.useEffect(()=>{e&&Nn().update({defaultPreload:t?"intent":!1})},[e,t])}function Tie(){const[e,t]=Le(Na);return l.useEffect(()=>{t(n=>n||dz())},[t]),e}function wie(e){const[t,n]=l.useState(!1),o=Zt(),s=q("remove-qr");l.useEffect(()=>{!e||t||(s&&o==="chat"&&hn("smart"),n(!0))},[e,s,o,t,n])}function Aie(){l.useEffect(()=>{},[])}function Uf({arg:e}={}){const t=e?.characterId,n=e?.type??"chat",o=e?.discoveryCard;let s;t?s={type:"character",characterId:t}:n==="group"?s={type:"group"}:o&&(s={type:"discovery",feedId:o.feedId,cardId:o.cardId});const a=s?{headers:{"content-type":"application/json"},body:JSON.stringify(s)}:void 0;return pt("/conversations",TV,{options:{method:"POST",...a}}).then(r=>r.data)}function $r(){const e=M(kg),t=Br(),{mutateAsync:n}=Uu({mutationKey:["create-conversation"],mutationFn:async p=>Uf({arg:p}),retry:!1}),o=M(bt),s=Nh(bt),a=G(md),r=G(oT),i=kY(),[d,m]=l.useState(!1);return{createConversation:l.useCallback(async p=>{const{shouldNavigateToChat:h=!0,characterId:g,isTemporary:y=!1,type:b="chat",discoveryCard:C}=p??{},T=b==="group";if(e&&o.get(e)?.characterId===g)return i({id:e,shouldNavigateToChat:h}),e;if(!d)try{m(!0);let S;t&&g?S={isTemporary:!1,characterId:g}:C?S={isTemporary:!1,discoveryCard:C}:y?S={isTemporary:!0}:S={isTemporary:!1},T&&!y&&(S.type="group");const{id:E}=await n(S),I={id:E,updatedAt:new Date().toISOString(),history:[],isNew:!0,characterId:g,continuedAt:null,group:T?{}:null};return y&&r(E),s(w=>{w.set(E,I)}),i({id:E,shouldNavigateToChat:!y&&h}),a(!0),Xse(),E}catch(S){console.error(S)}finally{m(!1)}},[e,d,o,i,n,s,r,a,t])}}async function xie(){const e=performance.now();Wt({apiName:Tn.ACQUIRE_ASSERTION_TOKEN_START});try{const{data:t}=await pt("/auth/assertion",hV,{options:{method:"GET"}});if(!t.assertion){tn({apiName:Tn.ACQUIRE_ASSERTION_TOKEN_FAILURE,errorMessage:"No assertion token received",extraInfo:{duration:performance.now()-e}});return}return Wt({apiName:Tn.ACQUIRE_ASSERTION_TOKEN_SUCCESS,duration:performance.now()-e}),t.assertion}catch(t){tn({apiName:Tn.ACQUIRE_ASSERTION_TOKEN_FAILURE,errorMessage:t instanceof Error?t.message:"Unknown error",errorExtraInfo:{stack:t instanceof Error?t.stack:void 0},extraInfo:{duration:performance.now()-e}});return}}async function _ie(e){const{msal:t}=await Ut.get(),n=performance.now();Wt({apiName:Tn.SILENT_MIGRATION_START});const{InteractionRequiredAuthError:o,AuthError:s}=await ua();try{const a=await t.ssoSilent(JW(e));return Wt({apiName:Tn.SILENT_MIGRATION_SUCCESS,duration:performance.now()-n,extraInfo:{eventInfo_homeAccountId:a.account.homeAccountId,eventInfo_localAccountId:a.account.localAccountId,eventInfo_environment:a.account.environment,eventInfo_tenantId:a.account.tenantId,eventInfo_authority:a.authority}}),a}catch(a){const r=a instanceof o;r&&$t(Ph,"true");const i=a instanceof s?a:void 0;tn({apiName:Tn.SILENT_MIGRATION_FAILURE,errorMessage:a instanceof Error?a.message:"Unknown error",errorExtraInfo:{stack:a instanceof Error?a.stack:void 0,name:a instanceof Error?a.name:void 0,eventInfo_errorCode:i?.errorCode,eventInfo_errorMessage:i?.errorMessage,eventInfo_subError:i?.subError,eventInfo_correlationId:i?.correlationId},extraInfo:{duration:performance.now()-n,eventInfo_isInteractionRequired:r}});return}}const kie="Link failed with status";async function Pie(e){const{msal:t}=await Ut.get(),n=performance.now();Wt({apiName:Tn.LINK_START});let o;try{if(o=await Nt({path:"/user/link",args:{body:{token:e.accessToken}}}),!o.ok)throw o.status===403?$t(qu,"true"):$t(ou,"true"),new Error(`${kie} ${o.status}`);mt(ou),Wt({apiName:Tn.LINK_SUCCESS,duration:performance.now()-n})}catch(s){throw tn({apiName:Tn.LINK_FAILURE,errorMessage:s instanceof Error?s.message:"Unknown error",errorExtraInfo:{stack:s instanceof Error?s.stack:void 0},extraInfo:{duration:performance.now()-n}}),await t.logoutRedirect({account:e.account,onRedirectNavigate:()=>!1}),s}}async function Mie(){const e=performance.now();if(!(B(ut)?.provider!=="auth0"||kt(Ph)==="true"||kt(qu)==="true")){Wt({apiName:Tn.MIGRATION_START});try{const n=await xie();if(n){const o=await _ie(n);o&&(await Pie(o),Ee(mT,!0),Wt({apiName:Tn.MIGRATION_SUCCESS,duration:performance.now()-e}))}}catch(n){tn({apiName:Tn.MIGRATION_FAILURE,errorMessage:n instanceof Error?n.message:"Unknown error",errorExtraInfo:{stack:n instanceof Error?n.stack:void 0},extraInfo:{duration:performance.now()-e}})}}}async function Rie(){return new Promise(e=>{try{const t=window.chrome;t?.authPrivate?.getPrimaryAccountInfo?t.authPrivate.getPrimaryAccountInfo(n=>{e(n??null)}):e(null)}catch{e(null)}})}async function Nie(){try{const e=await Rie();return e?{hasAccount:!0,accountType:e.account_type,isInGoodState:e.is_in_good_state}:void 0}catch{return}}const Lie=7*24*60*60*1e3;function Die(e){return Vo(e)?"AAD":"MSA"}function Oie(){return qt(LM,V().nullable())===!0}function Uie(){if(Oie())return!1;const t=qt(bI,k().nullable());return!(t&&Date.now()-t<Lie)}async function Fie(){performance.mark("cmc-msal-sso-silent-start",{detail:{category:"auth",operation:"sso-silent"}});const e=Nie();try{const{msal:t}=await Ut.get(),n=await t.ssoSilent(KT()),o=await e;if(!(Die(n.account.tenantId)==="MSA")){qy({message:"SSO Silent returned an AAD account",errorCode:"unexpected_account_type",edgeProfileData:o}),await t.logoutRedirect({account:n.account,onRedirectNavigate:()=>!1});return}t.setActiveAccount(n.account),performance.mark("cmc-msal-sso-silent-end",{detail:{category:"auth",operation:"sso-silent",result:"success",accountType:"MSA"}});const a=performance.measure("cmc-msal-sso-silent-success","cmc-msal-sso-silent-start","cmc-msal-sso-silent-end").duration;B(Vg)===!0?(Ee(ut,{id:n.account.idTokenClaims?.oid??"",tenantId:n.account.tenantId,provider:"microsoft",accountType:"MSA"}),R.setUserAccountType("MSA"),$y({accountUpdate:!0,accountType:"MSA",message:"New user account created via MSAL silent SSO",duration:a,edgeProfileData:o})):(Ee(IG,{email:n.account.username}),$y({accountUpdate:!1,accountType:"MSA",message:"MSAL account detected for returning user, showing prompt",duration:a,edgeProfileData:o}))}catch(t){const n=await e,{AuthError:o}=await ua(),s=t instanceof o?t.errorCode:"";performance.mark("cmc-msal-sso-silent-end",{detail:{category:"auth",operation:"sso-silent",result:"failure",errorCode:s,errorMessage:t instanceof Error?t.message:"Unknown error"}}),performance.measure("cmc-msal-sso-silent-failure","cmc-msal-sso-silent-start","cmc-msal-sso-silent-end"),qy({message:t instanceof Error?t.message:"Unknown error",errorCode:s,edgeProfileData:n})}Jo(bI,k(),Date.now())}async function jie(){B(ut)!==null||!Uie()||await Fie()}const __=_([]),Bie={"connector-detail":"connector-list","delete-account":"account",name:"account","memory-management":"memory-overview"};function as(){const[e,t]=Le(__),n=l.useRef([]);l.useEffect(()=>{const d=n.current,m=e;if(d.length>m.length){const p=d.filter((g,y)=>y>=m.length),h=p.length;for(let g=h-1;g>=0;g-=1){const y=p[g];y?.onPopPage&&y.onPopPage()}}n.current=e},[e]);const o=e.length>0?e[e.length-1]?.page:void 0,s=d=>a([d]),a=d=>{const m=d.map(p=>({page:p,onPopPage:void 0}));t(p=>[...p,...m])};return{currentPage:o,pushPage:s,pushPages:a,goBackOrClose:()=>{t(d=>d.length<=0?d:d.slice(0,-1))},closeSettings:()=>{t([])},parentPageOf:Bie}}function k_(e,t){const n={page:e,onPopPage:t?.onPopPageCallback};ke().set(__,o=>[...o,n])}function Wd(e){const{pages:t,className:n,children:o,disableLink:s,clickSource:a,onClick:r,pushPagesDelay:i=0}=e,{pushPages:d}=as(),m=G(To),p=gt({breakpoint:"sm"}),h=l.useCallback(()=>{setTimeout(()=>{Ce.emit("disclaimer:open-settings"),d(t),p&&m(!0)},i),r?.(),de({source:a??"settingsLink",destination:t[t.length-1]})},[d,t,m,r,a,i,p]);return s?c.jsx("span",{children:o}):c.jsx("button",{className:n,type:"button",title:"",onClick:h,children:o})}function Vie(){const e=G(yt);return c.jsx("p",{children:c.jsx(mn,{i18nKey:"settings.copilotBeta.announcementSubtitle",components:{settingsLink:c.jsx(Wd,{pages:["menu","copilot-beta"],className:"underline",clickSource:"disclaimerSettingsLink",onClick:()=>e(null)})}})})}function Hie(){if(!W("copilot-beta-automatic-opt-in"))return;const e=B(Sr);if(e===void 0)Ee(jm,!0),Ee(Sr,!0),Os();else if(e&&B(jm)){const n={title:F("settings.copilotBeta.announcementTitle"),subtitle:c.jsx(Vie,{})};Ee(yt,n),Ee(jm,void 0)}}function K1(e,t={includeFullHrefChanges:!1}){const{includeFullHrefChanges:n}=t,o=Ou(),s=l.useRef(e);s.current=e,l.useEffect(()=>{const a=o.subscribe("onBeforeNavigate",r=>{const{pathChanged:i,hrefChanged:d}=r;(i||n&&d)&&s.current(r)});return()=>a()},[o,n])}let P_=!0,M_=!0;function zie(e){M_=e}function $c(){return P_}function Gie(){K1(()=>{M_||(P_=!1)})}function fxe(e){Bo("redirectPathOnNextStart",e)}function Wie(){const e=Pn("redirectPathOnNextStart");return Io("redirectPathOnNextStart"),e?.startsWith("/")?e:null}const Ji=1e4,Y1={maxRetries:3,initialDelayMs:100,maxDelayMs:500,backoffFactor:2,jitterFactor:.1};async function $ie(e){try{return(await pt(`/conversations/${e}/history`,U5,{analytics:{anonymousPath:"/conversations/*/history"},query:{"api-version":"2"},parseOptions:{safe:!0}}).then(n=>n.data)).results.length>0}catch{return!1}}function ao(e){return e.endsWith("/talk")||e.endsWith("/vision")}function hxe(){return!ot("kill-student-offer")}function ap(e){return!e.includes("kill-student-offer")}function Z1(e){const{id:t,type:n,source:o,destination:s,scenario:a}=e;de({source:o,scenario:a,destination:s,customData:JSON.stringify({eventInfo_galleryArtifactId:t,eventInfo_galleryArtifactType:n})})}function gxe(e){Z1({...e,scenario:"galleryHomePage"})}function vxe(e){Z1({...e,scenario:"galleryDetailPage"})}function yxe(e){const{id:t,type:n}=e;R.trackEvent({name:"system",data:{eventName:"copilotImpression",eventInfo_impressionPage:"galleryDetailPage",eventInfo_impressionElement:"creatorGallery",eventInfo_customData:JSON.stringify({eventInfo_galleryArtifactId:t,eventInfo_galleryArtifactType:n})}})}function Cxe(e){const{galleryItemId:t,url:n,thumbnailUrl:o,errorMessage:s,page:a="galleryHomePage",type:r="image"}=e;Je({feature:"creatorGallery",scenario:"mediaLoad",errorType:"load",errorMessage:s??`Failed to load ${r}`,customData:JSON.stringify({galleryItemId:t,url:n,thumbnailUrl:o,page:a})})}const qie=_(null),Sxe=_(new Map),J1="/imagine";function Kie(e){return/\/imagine\/\w+/.test(e)}function Q1(e){return e.startsWith(J1)}async function Yie(e){const{id:t,isLiked:n}=e,o=await ko(`/gallery/${t}/react/like`,{options:{method:n?"POST":"DELETE"},analytics:{anonymousPath:"/gallery/*"}});if(!o.ok)throw new Error("Failed to fetch Gallery Like data");return o}async function bxe(e){try{const{isLiked:t}=e;Z1({...e,source:t?"like":"unlike"}),await Yie(e)}catch{}}async function Ixe(e){const{index:t,data:n,basePath:o,from:s}=e;ke().set(qie,t);const{id:r}=n;await qn({from:s,to:`${o}/${r}`})}function Exe(){$t(YM,"true")}function Txe(e){return{eventInfo_galleryLoadNumber:e.maxIndex+1,eventInfo_galleryArtifactTypes:Array.from(e.viewedTypes).join(",")}}function R_(){const e=sn();return N_(e)}function N_(e){return/^\/shares\/[a-zA-Z0-9_-]+$/.test(e)}async function Zie(e){const{conversationIdFromUrl:t,conversationIdFromStart:n}=e;return t&&t!=="new"&&await $ie(t)?{conversationId:t,isNew:!1}:n?{conversationId:n,isNew:!0}:{conversationId:null,isNew:!0}}async function Jie(e){const{pathname:t,conversationIdFromUrl:n,conversationFromUrlExists:o,urlPrompt:s,features:a,isBanned:r,enablePageRedirect:i,deepLinkTarget:d,search:m,redirectTargetFromStorage:p,userAccount:h}=e;if(!i||r||Pd(a)||navigator.userAgent.toLowerCase().includes("googlebot")&&t==="/")return null;if(s||n==="new")return{to:d==="audioCall"?"/chats/$conversationId/talk":"/",from:t,needsConversationId:d==="audioCall"};if(t.startsWith("/shares"))return t.startsWith("/shares/pages")?!a.includes("kill-shared-page")?null:Gt(t):t.startsWith("/shares/podcasts")||t.startsWith("/shares/3d-generations")||t.startsWith("/shares/tasks")?null:a.includes("kill-share-conversation")||!N_(t)?Gt(t):null;if(t.startsWith("/campaigns"))return!a.includes("kill-share-campaign")?null:Gt(t);if(t==="/subscription/pricing")return a.includes("subs-inline-checkout")?null:Gt(t);if(t==="/subscription/redeem/enel")return a.includes("enel-subscription")?null:Gt(t);if(t==="/fang")return null;if(ao(t))return t.startsWith("/labs/portrait/talk")&&a.includes("labs-portrait-enabled")?{from:t,to:"/labs/portrait",needsConversationId:!1}:Gt(t);if(t.startsWith("/chats")&&!o)return Gt(t);if(t.startsWith("/pages"))return null;if(t.startsWith("/projects"))return a.includes("projects")?null:{to:"/",from:t};if(t.startsWith("/labs")){if(t.startsWith("/labs/portrait")){const y=a.includes("labs-portrait-enabled"),b=a.includes("labs-portrait-v2");if(!y)return Gt(t);if(!b&&["/labs/portrait/gallery","/labs/portrait/future-self"].some(C=>t.startsWith(C)))return{from:t,to:"/labs/portrait",needsConversationId:!1};if(t.startsWith("/labs/portrait/future-self/create"))return{from:t,to:"/labs/portrait/future-self",needsConversationId:!1}}if(t.startsWith("/labs/career-coach")&&!a.includes("labs-career-coach")||!J.instance().config().enableLabs)return Gt(t)}if(t.startsWith("/login"))return Gt(t);if(t.startsWith("/shopping"))return a.includes("shopping-homepage")?null:{to:"/",from:t};if(t.startsWith("/podcasts"))return t.startsWith("/podcasts/user")||t.startsWith("/podcasts/public")?null:Gt(t);if(["/e/so","/e/sol"].includes(t)&&!ap(a))return Gt(t);if(t==="/e/so"&&ap(a)&&h?.accountType!=="MSA")return{from:t,to:"/e/sol"};if(t==="/e/sol"&&ap(a)&&h?.accountType==="MSA")return{from:t,to:"/e/so"};if(t.startsWith("/library")&&J.instance().config().disableLibrary)return Gt(t);if(p)return{from:t,to:p,needsConversationId:!1};if(t==="/"){if(a.includes("start-in-voice"))return null;const g=m?.get("back");return Qie(g)&&J.instance().config().redirectBackEnabled?{from:"/login",to:new URL(g).pathname,needsConversationId:!1}:Gt(t)}return Kie(t)?a.includes("kill-imagine-detail")?Gt(t):null:t.startsWith(J1)?a.includes("kill-creator-gallery")?Gt(t):null:t.startsWith("/tasks")?a.includes("supersonic-task")?null:Gt(t):null}function Qie(e){if(!e)return!1;try{if(new URL(e).origin===window.location.origin)return!0;throw new Error("Invalid redirect URL: not from same origin")}catch{throw new Error("Invalid redirect URL, malformed URL")}}function Gt(e){return{from:e,to:"/"}}function Xie(){try{const{timeZone:e}=Intl.DateTimeFormat().resolvedOptions();return e}catch{return}}const ece=mz();function tce(){return setTimeout(()=>{Je({feature:"start",scenario:"callStartTimeout",errorType:"timeout",errorMessage:`Start call exceeded ${Ji}ms timeout`})},Ji)}async function nce(){const e=aoe(),t={timeZone:Xie(),startNewConversation:!0,teenSupportEnabled:!0,correctPersonalizationSetting:!0,performUserMerge:e,deferredDataUseCapable:!0},n={};ece&&(n.overrideFeatures="1");const o=aq.run({}),{data:s,response:a,zodError:r}=await pt("/start",FB,{options:{method:"POST",headers:{"Content-Type":"application/json",...o.headers},body:JSON.stringify(t)},parseOptions:{safe:!0},returnResponseWithData:!0,query:n,retry:Y1,requestTimeoutMs:Ji,onFailedRequest:i=>{throw i.status===zi?new Error(Lh):new Ju(`Start api failure with status ${i.status}`,{route:"/start",statusCode:i.status})}});if(Gi.trackClientExperimentationAssignment(a.headers),Gi.trackLatestApiAssignment(a.headers),r)throw r;return s}function oce(){const{i18n:e}=Z(),{showBoundary:t}=AI(),n=G(br),o=G(Qz),s=G(tT),a=G(bt),r=G(oT),i=G(ma),d=G(Te),m=G(Vg),p=G(ud),h=G(UW),g=Fa(),[y]=Hd(),b=sn(),C=l.useRef(b);C.current=b;const T=Fu({strict:!1}),S=l.useRef(T);S.current=T;const E=l.useRef(az()),I=M(jc),x=l.useRef(I);x.current=I;const w=l.useRef(!0),P=l.useRef(!1),{mutateAsync:D}=Uu({mutationKey:["start"],mutationFn:nce,retry:!1}),L=Ou();return l.useCallback(async j=>{const U=performance.now();if(!e.language||P.current)return!1;P.current=!0;const $=hq(),{enablePageRedirect:K,overwriteData:X}=j;o(!0);let ne=!1,me;try{const Se=tce(),{isNewUser:ge,banExpiresAt:ve,remainingTurns:Pe,features:Me,currentConversationId:ye,allowBeta:Ie,userId:He,inDataUseWaitingPeriod:Ze,isBlocked:Be}=await D();clearTimeout(Se),await ux(),Ce.emit("app:start-complete");const be=R.getPicassoId();be!==null&&He!==null&&be!==He&&R.trackEvent({name:"health",data:{eventName:"userIdMismatch",eventInfo_customData:JSON.stringify({existingPicassoId:be,newPicassoId:He??"",origin:"start"})}}),R.setFeatures(Me),R.setIsNewUser(ge),yf({isNewUser:ge.toString()});const re=yw({featureOverrides:[],localFeatureOverrides:Cw(),localFeaturesToDisable:Sw(),serverFeatures:Me,surfaceConfig:J.instance().config()});re.includes("kill-picasso-id-on-start")||R.setPicassoId(He??null),mt(GM),re.includes("msal-silent-sso")&&jie(),re.includes("3p-migration-phase-1")?(Jo(Wp,V(),!0),Mie()):mt(Wp),re.includes("test-3rd-party-cookie")?Jo($p,V(),!0):mt($p);const te=V1(ve),H=Pd(re),Y=W5(),oe=!H&&Y&&(We=>J5.includes(We))(Y);let De,_e;if(oe){const{id:We}=await Uf({arg:{characterId:Y}});De=We,_e=!0}else{const We=await Zie({conversationIdFromUrl:H?void 0:S.current.conversationId,conversationIdFromStart:H?void 0:ye});if(De=We.conversationId??"",_e=We.isNew,!De){const{id:Oe}=await Uf({arg:H?{isTemporary:!0}:void 0});De=Oe,H&&r(Oe)}}const ze=await Jie({pathname:C.current,conversationIdFromUrl:S.current.conversationId,conversationFromUrlExists:S.current.conversationId===De,urlPrompt:x.current?.prompt??null,features:re,enablePageRedirect:K,isBanned:!!te,deepLinkTarget:y,search:new URLSearchParams(window.location.search),redirectTargetFromStorage:Wie(),userAccount:B(ut)});a(We=>{if(!X&&We.size>0)return We;const Oe=oe?Y:null,qe=new Map([[De,{id:De,updatedAt:new Date().toISOString(),history:[],isNew:_e,characterId:Oe,continuedAt:null}]]);return!_e&&ye&&qe.set(ye,{id:ye,updatedAt:new Date().toISOString(),history:[],isNew:!0,characterId:null,continuedAt:null}),qe}),d(We=>We&&!X?We:De),s(We=>We.length>0&&!X?We:re),i(Pe),m(ge),h(Ze??null),p(Ie??!1),Be&&n("tier-4-region-block"),Ie&&Hie(),H1(te,"start",ve),await L.invalidate(),w.current&&(w.current=!1,ze&&await g({...ze,params:ze.needsConversationId?{conversationId:De}:{},search:E.current})),ne=!0}catch(Se){if(Se instanceof Ju&&(me=Se.statusCode),R.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"StartEndpointError",eventInfo_errorName:Se instanceof Error?Se.name:"UnknownError",eventInfo_errorMessage:Se instanceof Error?Se.message:"",eventInfo_details:Se instanceof Error?Se.stack??"":"",...me!==void 0&&{eventInfo_statusCode:me}}}),Se instanceof Error){if(Se.message===Lh)return n("age-verification"),!0;MR(Se,"/start")}console.error(Se),t(Se)}finally{o(!1),zie(!1),R.trackEvent({name:"system",data:{eventName:"copilotFeatureLatency",eventInfo_scenario:"UseStartLatency",eventInfo_duration:performance.now()-U,eventInfo_customData:JSON.stringify({success:ne,statusCode:me})}}),R.flush()}return!0},[D,a,d,r,n,o,s,i,m,p,h,g,e.language,t,y,L])}function sce(){const e=M(Rh),[t,n]=Le(_g),o=oce();return l.useEffect(()=>{t||!e||o({enablePageRedirect:!0,overwriteData:!1}).then(s=>{s&&n(!0)}).catch(console.error)},[o,t,n,e]),{appInitialized:t}}let L_=-1;const qc=e=>{addEventListener("pageshow",t=>{t.persisted&&(L_=t.timeStamp,e(t))},!0)},ks=(e,t,n,o)=>{let s,a;return r=>{t.value>=0&&(r||o)&&(a=t.value-(s??0),(a||s===void 0)&&(s=t.value,t.delta=a,t.rating=((i,d)=>i>d[1]?"poor":i>d[0]?"needs-improvement":"good")(t.value,n),e(t)))}},D_=e=>{requestAnimationFrame(()=>requestAnimationFrame(()=>e()))},X1=()=>{const e=performance.getEntriesByType("navigation")[0];if(e&&e.responseStart>0&&e.responseStart<performance.now())return e},$d=()=>X1()?.activationStart??0,Ps=(e,t=-1)=>{const n=X1();let o="navigate";return L_>=0?o="back-forward-cache":n&&(document.prerendering||$d()>0?o="prerender":document.wasDiscarded?o="restore":n.type&&(o=n.type.replace(/_/g,"-"))),{name:e,value:t,rating:"good",delta:0,entries:[],id:`v5-${Date.now()}-${Math.floor(8999999999999*Math.random())+1e12}`,navigationType:o}},rp=new WeakMap;function O_(e,t){return rp.get(e)||rp.set(e,new t),rp.get(e)}const qd=(e,t,n={})=>{try{if(PerformanceObserver.supportedEntryTypes.includes(e)){const o=new PerformanceObserver(s=>{Promise.resolve().then(()=>{t(s.getEntries())})});return o.observe({type:e,buffered:!0,...n}),o}}catch{}},U_=e=>{let t=!1;return()=>{t||(e(),t=!0)}};let cr=-1;const vS=()=>document.visibilityState!=="hidden"||document.prerendering?1/0:0,Tu=e=>{document.visibilityState==="hidden"&&cr>-1&&(cr=e.type==="visibilitychange"?e.timeStamp:0,ace())},yS=()=>{addEventListener("visibilitychange",Tu,!0),addEventListener("prerenderingchange",Tu,!0)},ace=()=>{removeEventListener("visibilitychange",Tu,!0),removeEventListener("prerenderingchange",Tu,!0)},F_=()=>(cr<0&&(cr=(document.prerendering?void 0:globalThis.performance.getEntriesByType("visibility-state").filter(t=>t.name==="hidden")[0]?.startTime)??vS(),yS(),qc(()=>{setTimeout(()=>{cr=vS(),yS()})})),{get firstHiddenTime(){return cr}}),Kd=e=>{document.prerendering?addEventListener("prerenderingchange",()=>e(),!0):e()},CS=[1800,3e3],rce=(e,t={})=>{Kd(()=>{const n=F_();let o,s=Ps("FCP");const a=qd("paint",r=>{for(const i of r)i.name==="first-contentful-paint"&&(a.disconnect(),i.startTime<n.firstHiddenTime&&(s.value=Math.max(i.startTime-$d(),0),s.entries.push(i),o(!0)))});a&&(o=ks(e,s,CS,t.reportAllChanges),qc(r=>{s=Ps("FCP"),o=ks(e,s,CS,t.reportAllChanges),D_(()=>{s.value=performance.now()-r.timeStamp,o(!0)})}))})};let j_=0,ip=1/0,Tl=0;const ice=e=>{for(const t of e)t.interactionId&&(ip=Math.min(ip,t.interactionId),Tl=Math.max(Tl,t.interactionId),j_=Tl?(Tl-ip)/7+1:0)};let Ff;const SS=()=>Ff?j_:performance.interactionCount??0,cce=()=>{"interactionCount"in performance||Ff||(Ff=qd("event",ice,{type:"event",buffered:!0,durationThreshold:0}))};let bS=0;class lce{u=[];l=new Map;m;p;v(){bS=SS(),this.u.length=0,this.l.clear()}P(){const t=Math.min(this.u.length-1,Math.floor((SS()-bS)/50));return this.u[t]}h(t){if(this.m?.(t),!t.interactionId&&t.entryType!=="first-input")return;const n=this.u.at(-1);let o=this.l.get(t.interactionId);if(o||this.u.length<10||t.duration>n.T){if(o?t.duration>o.T?(o.entries=[t],o.T=t.duration):t.duration===o.T&&t.startTime===o.entries[0].startTime&&o.entries.push(t):(o={id:t.interactionId,entries:[t],T:t.duration},this.l.set(o.id,o),this.u.push(o)),this.u.sort((s,a)=>a.T-s.T),this.u.length>10){const s=this.u.splice(10);for(const a of s)this.l.delete(a.id)}this.p?.(o)}}}const B_=e=>{const t=globalThis.requestIdleCallback||setTimeout;document.visibilityState==="hidden"?e():(t(e=U_(e)),document.addEventListener("visibilitychange",e,{once:!0}))},IS=[200,500],uce=(e,t={})=>{globalThis.PerformanceEventTiming&&"interactionId"in PerformanceEventTiming.prototype&&Kd(()=>{cce();let n,o=Ps("INP");const s=O_(t,lce),a=i=>{B_(()=>{for(const m of i)s.h(m);const d=s.P();d&&d.T!==o.value&&(o.value=d.T,o.entries=d.entries,n())})},r=qd("event",a,{durationThreshold:t.durationThreshold??40});n=ks(e,o,IS,t.reportAllChanges),r&&(r.observe({type:"first-input",buffered:!0}),document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"&&(a(r.takeRecords()),n(!0))}),qc(()=>{s.v(),o=Ps("INP"),n=ks(e,o,IS,t.reportAllChanges)}))})};class dce{m;h(t){this.m?.(t)}}const ES=[2500,4e3],mce=(e,t={})=>{Kd(()=>{const n=F_();let o,s=Ps("LCP");const a=O_(t,dce),r=d=>{t.reportAllChanges||(d=d.slice(-1));for(const m of d)a.h(m),m.startTime<n.firstHiddenTime&&(s.value=Math.max(m.startTime-$d(),0),s.entries=[m],o())},i=qd("largest-contentful-paint",r);if(i){o=ks(e,s,ES,t.reportAllChanges);const d=U_(()=>{r(i.takeRecords()),i.disconnect(),o(!0)});for(const m of["keydown","click","visibilitychange"])addEventListener(m,()=>B_(d),{capture:!0,once:!0});qc(m=>{s=Ps("LCP"),o=ks(e,s,ES,t.reportAllChanges),D_(()=>{s.value=performance.now()-m.timeStamp,o(!0)})})}})},TS=[800,1800],jf=e=>{document.prerendering?Kd(()=>jf(e)):document.readyState!=="complete"?addEventListener("load",()=>jf(e),!0):setTimeout(e)},pce=(e,t={})=>{let n=Ps("TTFB"),o=ks(e,n,TS,t.reportAllChanges);jf(()=>{const s=X1();s&&(n.value=Math.max(s.responseStart-$d(),0),n.entries=[s],o(!0),qc(()=>{n=Ps("TTFB",0),o=ks(e,n,TS,t.reportAllChanges),o(!0)}))})},fce=e=>{const o=performance.getEntriesByType("navigation")[0]?.type;let s;const a=navigator;a.connection&&typeof a.connection.effectiveType=="string"&&(s=a.connection.effectiveType);const r={eventName:e.name,eventInfo_duration:e.value,eventInfo_navigationType:o,eventInfo_connectionType:s};R.trackEvent({name:"system",data:r});try{if(e.name==="INP")return;const i=`web-vitals-measure-${e.name}`;performance.measure(i,{start:0,duration:e.value})}catch{}};let wS=!1;function hce(){const e=G(gT);if(typeof window>"u"||wS)return;wS=!0;let t=!1;const n=s=>{fce(s),e(a=>({...a,[s.name.toLowerCase()]:s.value}))},o=s=>{t||(t=!0,n(s))};pce(n),rce(n),mce(o,{reportAllChanges:!0}),uce(n)}function gce(){l.useEffect(()=>(window.addEventListener("unhandledrejection",My),()=>{window.removeEventListener("unhandledrejection",My)}),[])}function vce(e={}){const{isAppInitialized:t=!1}=e,n=window.appStart;return l.useEffect(()=>!t||!n?()=>{}:(window.addEventListener("beforeunload",Ly),()=>{window.removeEventListener("beforeunload",Ly)}),[t,n]),{startTime:n}}function yce({reason:e,onReload:t}){const{t:n}=Z();return c.jsxs(_s,{isOpen:!0,hideDismissButton:!0,preventClose:!0,children:[c.jsx("h1",{className:"pb-3 text-xl",children:n("authentication.accountChanged")}),c.jsx("p",{className:"pb-7",children:n(e==="login"?"authentication.signedInOtherTab":"authentication.signedOutOtherTab")}),c.jsx(ee,{onClick:t,title:n("authentication.reloadToContinue"),variant:"pill",size:"48-lg",className:"w-full",children:n("authentication.reloadToContinue")})]})}function Cce(){const e=l.useRef(null),t=(o,s)=>{e.current&&clearTimeout(e.current),e.current=setTimeout(o,s)},n=()=>{e.current&&(clearTimeout(e.current),e.current=null)};return l.useEffect(()=>()=>{n()},[]),{setSafeTimeout:t,clearSafeTimeout:n}}function V_(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}const H_=({title:e,titleId:t,...n})=>l.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 12 12","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M6,12c3.3,0,6-2.7,6-6S9.3,0,6,0S0,2.7,0,6S2.7,12,6,12z M5,3c0-0.6,0.4-1,1-1s1,0.4,1,1v3c0,0.6-0.4,1-1,1  S5,6.6,5,6V3z M5.2,8.2C5.4,8,5.7,7.9,6,7.9S6.6,8,6.8,8.2C7,8.4,7.1,8.7,7.1,9c0,0.3-0.1,0.6-0.3,0.8C6.6,10,6.3,10.1,6,10.1  S5.4,10,5.2,9.8C5,9.6,4.9,9.3,4.9,9C4.9,8.7,5,8.4,5.2,8.2z",fill:"currentColor"}),l.createElement("rect",{fill:"none"})),wxe=Object.freeze(Object.defineProperty({__proto__:null,default:H_},Symbol.toStringTag,{value:"Module"}));function Sce(e){const{type:t,title:n,subTitle:o="",className:s}=e,a=`${n} ${o}`;return c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:Ae(t==="error"&&"border-system-red-450 bg-system-red-300/20 text-system-red-550 dark:bg-system-red-600/20",t==="default"&&"border-neutral-350","w-full rounded-2xl border-2 p-4",s),children:[c.jsxs("div",{className:"flex text-base",children:[t==="error"&&c.jsx("div",{className:"me-1 flex items-center",children:c.jsx(H_,{className:"size-4"})}),c.jsx("h3",{children:c.jsx("strong",{children:n})})]}),c.jsx("p",{className:"text-sm",children:o})]}),c.jsx(Ao,{msg:a})]})}function bce(e){const{accountActionRequired:t}=e,[n,o]=l.useState(!1),{setSafeTimeout:s}=Cce(),{loginHint:a,correlationId:r}=t,i=async()=>{if(!a)return;const{msal:m}=await Ut.get(),p={...Wg(),loginHint:a,account:m.getAccountByUsername(a)??void 0,prompt:void 0,correlationId:r,extraQueryParameters:{sus:"2"},tokenBodyParameters:{sus:"2"},tokenQueryParameters:{sus:"2"}};if(m$({authWorkflowAccountType:"microsoft",apiName:"msal:reauthStart"}),V_()){await m.acquireTokenRedirect(p);return}try{const h=await m.acquireTokenPopup({...p,redirectUri:`${window.location.origin}/auth/popup-redirect`});h.accessToken&&(Ee(bs,null),Ce.emit("auth:reauth-popup-success",{accessToken:h.accessToken}))}catch(h){h instanceof Error&&h.message.includes("popup")&&await m.acquireTokenRedirect(p),o(!0),s(()=>{o(!1)},3e3)}},d=async()=>{e1()};return c.jsxs(c.Fragment,{children:[c.jsx(Md,{className:"gap-0 border-none p-0",headerClassName:"hidden",isOpen:!0,children:c.jsxs("div",{className:"flex w-[448px] min-w-[280px] max-w-[90vw] flex-col items-center p-8 pt-12 text-center",children:[c.jsx("h1",{className:"font-bold text-lg sm:text-2xl",children:F("signInPrompt.makeSureYou")}),c.jsx("p",{className:"mt-3 text-start text-sm sm:text-base",children:F("signInPrompt.confirmYourAccount")}),c.jsx(ee,{className:"mt-6 w-full text-sm sm:mt-9 sm:text-base",color:"strong",onClick:i,title:F("signInPrompt.continueAs",{name:a}),"aria-label":F("signInPrompt.continueAs",{name:a}),variant:"square",size:"56-xl",children:F("signInPrompt.continueAs",{name:a})}),c.jsx(ee,{onClick:d,className:"mt-3 w-full text-sm sm:text-base",title:F("signInPrompt.continueWithoutSignIn"),"aria-label":F("signInPrompt.continueWithoutSignIn"),variant:"square",size:"56-xl",children:F("signInPrompt.continueWithoutSignIn")})]})}),n&&c.jsx("div",{className:"fixed start-1/2 top-[1.5rem] z-50 w-[400px] min-w-[280px] max-w-[90vw] -translate-x-1/2 rounded-2xl bg-white sm:w-[500px] md:w-[600px]",children:c.jsx(Sce,{type:"error",title:F("signInPrompt.couldntReconnect"),subTitle:F("signInPrompt.tryAgain")})})]})}const z_=({title:e,titleId:t,...n})=>l.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 25 24","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{fill:"#F25022",d:"M12.05 3H3.5v8.55h8.55V3Z"}),l.createElement("path",{fill:"#7FBA00",d:"M21.5 3h-8.55v8.55h8.55V3Z"}),l.createElement("path",{fill:"#00A4EF",d:"M12.05 12.45H3.5V21h8.55v-8.55Z"}),l.createElement("path",{fill:"#FFB900",d:"M21.5 12.45h-8.55V21h8.55v-8.55Z"})),G_=({title:e,titleId:t,...n})=>l.createElement("svg",{viewBox:"0 0 32 32",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M16.289 7.53846C17.3723 7.53846 18.7302 6.8061 19.5389 5.82962C20.2712 4.94469 20.8053 3.70884 20.8053 2.47298C20.8053 2.30515 20.79 2.13732 20.7595 2C19.5541 2.04577 18.1047 2.80865 17.235 3.8309C16.5484 4.60903 15.9229 5.82963 15.9229 7.08074C15.9229 7.26383 15.9534 7.44692 15.9686 7.50795C16.0449 7.5232 16.167 7.53846 16.289 7.53846ZM12.4747 26C13.9547 26 14.6107 25.0083 16.4569 25.0083C18.3335 25.0083 18.7455 25.9695 20.3933 25.9695C22.0106 25.9695 23.0939 24.4743 24.1161 23.0095C25.2604 21.3312 25.7334 19.6834 25.7639 19.6071C25.6571 19.5766 22.5599 18.3102 22.5599 14.7552C22.5599 11.6732 25.0011 10.2848 25.1384 10.178C23.5211 7.85887 21.0646 7.79784 20.3933 7.79784C18.5777 7.79784 17.0977 8.89638 16.167 8.89638C15.16 8.89638 13.8326 7.85887 12.2611 7.85887C9.27061 7.85887 6.23438 10.3306 6.23438 14.9994C6.23438 17.8983 7.36343 20.965 8.75186 22.9485C9.94194 24.6268 10.9794 26 12.4747 26Z"})),e0=({title:e,titleId:t,...n})=>l.createElement("svg",{viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M29.546 13.667H16.6074V19.1073H24.0425C23.6865 20.781 22.7411 22.2039 21.3419 23.1773V26.6204H25.6809C28.2662 24.1829 29.754 20.5792 29.754 16.3183C29.754 15.4014 29.6798 14.5178 29.546 13.667Z",fill:"#4285F4"}),l.createElement("path",{d:"M25.6811 26.6202L24.1728 25.4233L21.3422 23.1771C20.0963 24.0439 18.4918 24.5553 16.6077 24.5553C13.0066 24.5553 9.94929 22.0813 8.84297 18.7412H4.37549V22.2862C6.62805 26.8602 11.2579 29.9995 16.6077 29.9995C20.3024 29.9995 23.4137 28.7583 25.6811 26.6202Z",fill:"#34A853"}),l.createElement("path",{d:"M8.84338 18.7412C8.55701 17.8759 8.39918 16.9539 8.39918 16C8.39918 15.0465 8.55701 14.1245 8.84338 13.2592V9.71387H4.37549C3.44448 11.6046 2.91699 13.7387 2.91699 16C2.91699 18.2617 3.44448 20.3958 4.37549 22.2865L8.84338 18.7412Z",fill:"#FBBC05"}),l.createElement("path",{d:"M21.9211 9.56791L25.7683 5.64882C23.3952 3.38751 20.301 2 16.6078 2C11.258 2 6.62807 5.13939 4.37549 9.71335L8.843 13.2583C9.94932 9.91789 13.0066 7.44426 16.6078 7.44426C18.6489 7.44426 20.4778 8.1629 21.9211 9.56791Z",fill:"#EA4335"}));function Ice({accountActionRequired:e,onReload:t}){const{t:n}=Z(),o=Gc(),{login:s}=Fd(),{reason:a}=e,r=async()=>{a==="token-expired"&&e.provider==="microsoft"&&e1(!1)},i=async(m,p)=>{await r();let h="";switch(m==="microsoft"?h="MSA":m==="auth0"&&(h=p?.connection==="apple"?"Apple":"Google"),de({source:"sessionExpired",scenario:`continueWith${h}`,destination:`continueWith${h}Redirect`}),m){case"microsoft":s({provider:m,scenario:"sessionExpired"});break;case"auth0":s({provider:m,scenario:"sessionExpired",opts:p});break}},d=async()=>{en({source:"signin",scenario:"sessionExpired"}),await r(),s({provider:"microsoft"})};return c.jsxs(c.Fragment,{children:[c.jsx("h1",{className:"pb-3 text-xl",children:n("authentication.sessionExpired")}),c.jsx("p",{className:"pb-7",children:n("authentication.sessionExpiredMessage")}),o?c.jsxs(c.Fragment,{children:[c.jsxs(ee,{onClick:()=>i("microsoft"),title:n("signInPrompt.continueWithMicrosoft"),variant:"pill",size:"48-lg",className:"mt-3 w-full",children:[c.jsx(z_,{className:"size-6"}),n("signInPrompt.continueWithMicrosoft")]}),c.jsxs(ee,{onClick:()=>i("auth0",{connection:"apple"}),title:n("signInPrompt.continueWithApple"),variant:"pill",size:"48-lg",className:"mt-3 w-full",children:[c.jsx(G_,{className:"size-6 text-black dark:text-white"}),n("signInPrompt.continueWithApple")]}),c.jsxs(ee,{onClick:()=>i("auth0",{connection:"google"}),title:n("signInPrompt.continueWithGoogle"),variant:"pill",size:"48-lg",className:"mt-3 w-full",children:[c.jsx(e0,{className:"size-6"}),n("signInPrompt.continueWithGoogle")]})]}):c.jsx(ee,{onClick:d,title:n("common.loginText"),variant:"pill",size:"48-lg",className:"mt-3 w-full",children:n("common.loginText")}),c.jsx(ee,{onClick:t,title:n("signInPrompt.continueWithoutSignIn"),variant:"pill",color:"subtle-dimmed-inverted",size:"48-lg",className:"mt-3 w-full",children:n("signInPrompt.continueWithoutSignIn")})]})}function Ece(e){const{accountActionRequired:t}=e;return c.jsx(Tce,{accountActionRequired:t})}function Tce(e){const{accountActionRequired:t}=e,{reason:n,errorMessage:o}=t;l.useEffect(()=>{R.trackEvent({name:"system",data:{eventName:"copilotWebBackgroundAccountChange",eventInfo_action:"shown",eventInfo_reason:n}}),n==="token-expired"&&t.provider==="microsoft"&&f$(o)},[n,o,t.provider]);const s=async()=>{R.trackEvent({name:"system",data:{eventName:"copilotWebBackgroundAccountChange",eventInfo_action:"reload",eventInfo_reason:n}}),n==="token-expired"&&t.provider==="microsoft"&&await e1(),Os()};return n==="login"||n==="logout"?c.jsx("div",{className:"flex max-w-72 flex-col items-center p-1 text-center",children:c.jsx(yce,{reason:n,onReload:s})}):t.provider==="microsoft"?c.jsx(bce,{accountActionRequired:t}):c.jsx(Md,{isOpen:!0,children:c.jsx("div",{className:"flex max-w-96 flex-col items-center p-1 text-center",children:c.jsx(Ice,{accountActionRequired:t,onReload:s})})})}function wce(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function Ace(e){if(!wce(e)&&typeof e!="number")return!1;const t=Eo(e);return!isNaN(Number(t))}function W_(e,t){const n=Eo(e);if(isNaN(t))return nu(e,NaN);if(!t)return n;const o=n.getDate(),s=nu(e,n.getTime());s.setMonth(n.getMonth()+t+1,0);const a=s.getDate();return o>=a?s:(n.setFullYear(s.getFullYear(),s.getMonth(),o),n)}function xce(e,t){return W_(e,t*12)}function _ce(e,t){return xce(e,-13)}const Yd=({title:e,titleId:t,...n})=>l.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M4.53033 12.9697C4.23744 12.6768 3.76256 12.6768 3.46967 12.9697C3.17678 13.2626 3.17678 13.7374 3.46967 14.0303L7.96967 18.5303C8.26256 18.8232 8.73744 18.8232 9.03033 18.5303L20.0303 7.53033C20.3232 7.23744 20.3232 6.76256 20.0303 6.46967C19.7374 6.17678 19.2626 6.17678 18.9697 6.46967L8.5 16.9393L4.53033 12.9697Z"})),Axe=Object.freeze(Object.defineProperty({__proto__:null,default:Yd},Symbol.toStringTag,{value:"Module"})),kce="p-2 -m-2 bg-slate-200 rounded-xl text-stroke-350";function $_(e){const{disabled:t,checked:n,label:o,className:s,labelClassName:a,setChecked:r,"aria-label":i,"aria-expanded":d,spatialNavigationAutofocus:m=!1}=e,p=l.useId(),{focusable:h,refCallback:g}=kd({autoRestoreFocus:!0,forceFocus:!0});return c.jsxs("label",{"aria-label":i,className:O("relative flex cursor-pointer items-center",s,h.focused&&kce),ref:g,htmlFor:p,"data-spatial-focus-key":h.focusKey,"data-spatial-navigation-autofocus":m,children:[c.jsx("input",{checked:n,type:"checkbox",id:p,className:"peer sr-only",onChange:y=>r(y.target.checked),disabled:t,"aria-expanded":d}),c.jsx("span",{className:O("flex aspect-square size-5 items-center justify-center rounded-full border transition-colors duration-200 peer-focus-visible:ring-1 peer-focus-visible:ring-black peer-focus-visible:ring-offset-2 peer-disabled:pointer-events-none peer-disabled:opacity-40 dark:peer-focus-visible:ring-white","contrast-more:peer-focus-visible:outline contrast-more:peer-focus-visible:outline-2 contrast-more:peer-focus-visible:outline-offset-2",n&&"bg-black contrast-more:bg-white dark:bg-white"),children:c.jsx(Yd,{className:O("size-3 text-white transition-opacity duration-200 contrast-more:text-current dark:text-black contrast-more:dark:text-current",n?"opacity-100":"opacity-0")})}),c.jsx("span",{className:O("mt-px ps-4 peer-disabled:pointer-events-none peer-disabled:opacity-40",a),children:o})]})}const po=({title:e,titleId:t,...n})=>l.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M8.46967 4.21967C8.17678 4.51256 8.17678 4.98744 8.46967 5.28033L15.1893 12L8.46967 18.7197C8.17678 19.0126 8.17678 19.4874 8.46967 19.7803C8.76256 20.0732 9.23744 20.0732 9.53033 19.7803L16.7803 12.5303C17.0732 12.2374 17.0732 11.7626 16.7803 11.4697L9.53033 4.21967C9.23744 3.92678 8.76256 3.92678 8.46967 4.21967Z"})),xxe=Object.freeze(Object.defineProperty({__proto__:null,default:po},Symbol.toStringTag,{value:"Module"})),Pce={top:36,bottom:36,left:24,right:24};function wl(e){const{ariaLabelId:t,options:n,renderOption:o,onSelect:s,onOpen:a,value:r,id:i,actionLabel:d,placeholder:m,className:p,menuClassName:h,expandIconClassName:g,disabled:y=!1,isValid:b=!0,supportsBrowserAutofill:C,supportsTypeahead:T=!1,autoComplete:S,boundary:E,padding:I=Pce,useFloatingContainer:x=!0,multiSelect:w=!1,multiSelectedValues:P=[],onMultiSelectionChange:D}=e,{t:L}=Z(),[j,U]=l.useState(!1),[$,K]=l.useState(null),X=n.findIndex(oe=>oe.key===r),ne=l.useRef([]),me=l.useRef([]);l.useEffect(()=>{j&&K(X>=0?X:0)},[j,X]);const Se=l.useCallback(oe=>{const De=n[oe]?.key;De&&s(De)},[s,n]),{refs:ge,floatingStyles:ve,context:Pe}=ac({placement:"bottom-start",strategy:"absolute",open:j,onOpenChange:oe=>{U(oe),oe&&a?.()},whileElementsMounted:kr,middleware:[oc({padding:I}),lh({boundary:E,apply({rects:oe,elements:De,availableHeight:_e}){Object.assign(De.floating.style,{maxHeight:`${_e}px`,minWidth:`${oe.reference.width}px`})},padding:I})]}),Me=uh(Pe,{event:"mousedown",enabled:!y}),ye=rc(Pe),Ie=Lu(Pe,{role:"listbox"}),He=U9(Pe,{listRef:ne,activeIndex:$,selectedIndex:X,onNavigate:K,loop:!0,focusItemOnHover:!1,openOnArrowKeyDown:!y}),Ze=F9(Pe,{enabled:T,listRef:me,activeIndex:$,onMatch:j?K:Se}),{getReferenceProps:Be,getFloatingProps:be,getItemProps:re}=Du([ye,Ie,He,Me,Ze]),te=l.useCallback(oe=>{if(w){if(!D)return;const De=P.includes(oe);D(De?P.filter(_e=>_e!==oe):[...P,oe])}else s(oe),U(!1)},[w,s,D,P]);let H;w?P.length>0?H=c.jsx("div",{className:"truncate",children:L("dropdown.multiselect.itemsSelected",{count:P.length})}):H=c.jsx("div",{className:"truncate text-foreground-550 dark:text-foreground-600",children:m}):X>-1?H=o(n[X]):H=c.jsx("div",{className:"truncate text-foreground-550 dark:text-foreground-600",children:m});const Y=l.useCallback(oe=>{y||s(oe.currentTarget.value)},[s,y]),ue=l.useRef(null);return l.useEffect(()=>{const oe=De=>{if(De.key==="Escape"&&j){const _e=ge.floating.current,ze=ge.reference.current;(_e instanceof HTMLElement&&_e.contains(document.activeElement)||ze instanceof HTMLElement&&ze.contains(document.activeElement))&&(De.preventDefault(),De.stopPropagation(),U(!1))}};return window.addEventListener("keydown",oe,!0),()=>{window.removeEventListener("keydown",oe,!0)}},[j,ge.floating,ge.reference]),c.jsxs(c.Fragment,{children:[C&&c.jsx("select",{"aria-hidden":!0,className:"hidden",onChange:Y,autoComplete:S,disabled:y,children:n.map(oe=>c.jsx("option",{value:oe.key,children:oe.text},oe.key))}),c.jsxs("button",{role:"combobox",type:"button",id:i,ref:ge.setReference,"aria-labelledby":t,"aria-expanded":j,"aria-haspopup":"listbox","aria-autocomplete":"none","aria-invalid":!b,"aria-disabled":y,className:O("flex w-full cursor-pointer items-center justify-between gap-2 rounded-2xl bg-black/5 px-[1.125rem] py-4 dark:bg-background-450/25",p,y&&"pointer-events-none opacity-50"),...Be(),children:[c.jsx("div",{className:"min-w-0",children:H}),c.jsxs("div",{className:O("flex min-h-[26px] shrink-0 grow items-center justify-end gap-2",g),children:[d&&c.jsx("span",{children:d}),c.jsx(po,{className:"size-6 rotate-90"})]})]}),x&&c.jsx("div",{ref:ue}),j&&c.jsx(Nu,{root:x?ue.current:void 0,children:c.jsx(dh,{context:Pe,modal:!1,initialFocus:-1,returnFocus:!1,children:c.jsx("div",{ref:ge.setFloating,style:ve,className:O("flex overflow-hidden rounded-2xl shadow-md",h),...be(),children:c.jsx("div",{className:O("flex w-full flex-col overflow-hidden rounded-2xl border-2 border-black/10 p-2 dark:border-white/10",GK),children:c.jsx("div",{className:O("t-custom-scrollbar vertical-scrollbar overflow-y-auto py-1 pe-1"),children:n.map((oe,De)=>c.jsx("div",{ref:_e=>{ne.current[De]=_e,me.current[De]=oe.text},role:"option",tabIndex:De===$?0:-1,"aria-selected":w?P.includes(oe.key):De===X&&De===$,className:"relative cursor-pointer rounded-xl px-3 py-2 -outline-offset-2 hover:bg-black/5 dark:hover:bg-white/8",...re({onClick(){w||te(oe.key)},onKeyDown(_e){_e.key==="Enter"&&(_e.preventDefault(),te(oe.key))}}),children:w?c.jsx($_,{label:oe.text,checked:P.includes(oe.key),setChecked:()=>te(oe.key)}):o(oe)},oe.key))})})})})})]})}function AS(e){const{htmlFor:t,content:n,required:o,className:s,afterContent:a}=e;return c.jsxs("div",{className:"flex items-center",children:[c.jsxs("label",{htmlFor:t,className:Ae("flex items-center gap-0.5 text-foreground-900",s),children:[n,o&&c.jsx("span",{className:"text-system-red-550 dark:text-system-red-350",children:"*"})]}),a]})}const xS="absolute size-full",Mce="bg-gradient-discover-light dark:bg-gradient-discover-dark",Rce="bg-gradient-authentication-light dark:bg-gradient-authentication-dark";function Bs(e){const{isBottomFade:t,forceGradient:n,isFixed:o,overrideGradientType:s,customColor:a,customImage:r,cover:i,noRepeat:d,center:m}=e,p=sn(),h=p==="/login",g=n===!0||h,b=(s??(h?"authentication":"default"))==="authentication"?Rce:Mce;return c.jsxs("div",{className:O(o?"fixed":"absolute",t?"-inset-x-4 bottom-0 h-dvh":"inset-0","overflow-hidden"),children:[c.jsx("div",{className:O(xS,a??"bg-background-150",i&&"bg-cover",d&&"bg-no-repeat",m&&"bg-center"),style:r?{backgroundImage:r}:void 0}),c.jsx(It,{children:g&&c.jsx(he.div,{className:O(xS,b),initial:"initial",animate:"animate",exit:"exit",variants:{initial:je,animate:rt,exit:je},transition:b1},p)})]})}const q_=_(void 0);function Nce(e){const{buttonClassName:t}=e,{t:n}=Z(),{closeSettings:o}=as(),s=G(q_),a=M(Te);function r(){en({source:"complianceLinks",scenario:"cookies",conversationId:a,destination:"#"}),s("more-options"),o()}return c.jsx(ee,{role:"menuitem",variant:"rect",size:"28-xxs",color:"subtle-dimmed-inverted",className:t,title:n("settings.cookies"),onClick:()=>r(),testId:"cookies-compliance-button",children:c.jsx("span",{children:n("settings.cookies")})})}const Qi="https://www.bing.com/new/termsofuse",dn="https://go.microsoft.com/fwlink/?LinkId=521839",wu="https://www.microsoft.com/microsoft-copilot/learn/?form=MG0AUO&OCID=MG0AUO#faqs",Wl="hover:underline focus:underline";function _S(e){return J.instance().config().textOverrides?.(e)??e}function _xe(e){const{component:t="link",buttonClassName:n}=e,o=M(Te),{pushPage:s}=as(),a=M(Bt),r=Ld(a),i=(d,m)=>{en({source:"complianceLinks",scenario:d,conversationId:o,destination:m})};return c.jsxs("div",{role:"menuitem",className:Ae("flex w-full flex-wrap justify-center gap-x-3 gap-y-1 text-black/80 text-xs dark:text-white/80",t==="button"?"flex-col p-0":"px-5 py-2"),children:[t==="link"?c.jsx(Lce,{handleAnalytics:i}):c.jsx(Dce,{handleAnalytics:i,className:n??"",setPage:s}),r&&c.jsx(Nce,{buttonClassName:O(Wl,{"text-xs p-0 min-h-0 mx-0 min-w-0 gap-x-0 safe-hover:bg-transparent dark:safe-hover:bg-transparent dark:text-white/80":t==="link",[n??""]:t==="button"})})]})}function Lce(e){const{handleAnalytics:t}=e;return c.jsxs(c.Fragment,{children:[c.jsx(Go,{href:dn,title:F(_S("settings.privacyLink")),className:Wl,onClick:()=>t("privacy",dn),children:F(_S("settings.privacyLink"))}),c.jsx(Go,{href:Qi,title:F("settings.termsOfServiceLink"),className:Wl,onClick:()=>t("terms",Qi),children:F("settings.termsOfServiceLink")}),c.jsx(Go,{href:wu,title:F("settings.faqLink"),className:Wl,onClick:()=>t("faq",wu),children:F("settings.faqLink")})]})}function Dce(e){const{handleAnalytics:t,className:n,setPage:o}=e,s=(a,r)=>{t(a,r);const d=J.instance().config().settingsOverrides?.shouldShowPolicyTermsQRCodes,m={privacy:"privacyStatement",terms:"terms",faq:"faq",cookies:void 0};d&&a in m?o?.(m[a]):zr(r)};return c.jsxs(c.Fragment,{children:[c.jsx(ee,{role:"menuitem",variant:"rect",color:"subtle-dimmed-inverted",className:n,title:F("settings.privacyLink"),onClick:()=>s("privacy",dn),children:c.jsx("span",{children:F("settings.privacyLink")})}),c.jsx(ee,{role:"menuitem",variant:"rect",color:"subtle-dimmed-inverted",className:n,title:F("settings.termsOfServiceLink"),onClick:()=>s("terms",Qi),children:c.jsx("span",{children:F("settings.termsOfServiceLink")})}),c.jsx(ee,{role:"menuitem",variant:"rect",color:"subtle-dimmed-inverted",className:n,title:F("settings.faqLink"),onClick:()=>s("faq",wu),children:c.jsx("span",{children:F("settings.faqLink")})})]})}const kS={...vc,"United Kingdom":"UK"};function Oce(e,t,n){const o=new Date(n,t-1,e);return Ace(o)&&o.getFullYear()===n&&o.getMonth()===t-1&&o.getDate()===e}function Uce(e,t,n){const o=new Date(n,t-1,e),s=_ce(new Date);return o<=s}const cp="border-2 border-system-red-550/50 bg-system-red-550/10 text-system-red-550 dark:text-system-red-350",PS={termsLink:c.jsx(MS,{link:Qi}),privacyLink:c.jsx(MS,{link:dn})};function MS(e){const{children:t,link:n}=e;return c.jsx(Go,{className:"underline",href:n,title:"",children:t})}function Fce(e){const{onSubmit:t}=e,[n,o]=l.useState(void 0),[s,a]=l.useState(""),[r,i]=l.useState(""),[d,m]=l.useState(""),[p,h]=l.useState(kS["United States"]),[g,y]=l.useState(!1),{i18n:b}=Z(),C=b.resolvedLanguage??"en-US",T=new Intl.NumberFormat(C,{minimumIntegerDigits:2,useGrouping:!1}),S=new Intl.NumberFormat(C,{minimumIntegerDigits:4,useGrouping:!1});l.useEffect(()=>{y(!!!(r&&d&&s&&p))},[r,d,s,p]);const E=[{key:"01",text:F("common.date.month.january")},{key:"02",text:F("common.date.month.february")},{key:"03",text:F("common.date.month.march")},{key:"04",text:F("common.date.month.april")},{key:"05",text:F("common.date.month.may")},{key:"06",text:F("common.date.month.june")},{key:"07",text:F("common.date.month.july")},{key:"08",text:F("common.date.month.august")},{key:"09",text:F("common.date.month.september")},{key:"10",text:F("common.date.month.october")},{key:"11",text:F("common.date.month.november")},{key:"12",text:F("common.date.month.december")}],I=Object.entries(kS).sort().map(([L,j])=>({key:j,text:L})),x=Array.from({length:31},(L,j)=>{const U=j+1,$=T.format(U);return{key:U.toString(),text:$}}),w=Array.from({length:125},(L,j)=>{const U=new Date().getFullYear()-j,$=S.format(U);return{key:`${new Date().getFullYear()-j}`,text:$}}),P=L=>c.jsx("p",{children:L.text}),D=async()=>{const L=parseInt(s,10),j=parseInt(r,10),U=parseInt(d,10);if(!Oce(U,j,L)){de({source:"auth0AccountVerificationPage",scenario:"auth0VerificationInvalidDate",destination:"auth0AccountVerificationPage",customData:JSON.stringify({})}),o(!1);return}if(!Uce(U,j,L)){de({source:"auth0AccountVerificationPage",scenario:"auth0VerificationNotAdult",destination:"auth0AccountVerificationPage",customData:JSON.stringify({})}),o(!1);return}const X=fn(new Date(L,j-1,U),"yyyy-MM-dd"),ne=await t(X,p);o(ne)};return c.jsxs(c.Fragment,{children:[c.jsx(Bs,{forceGradient:!0,overrideGradientType:"authentication"}),c.jsxs("section",{className:"relative m-auto flex min-h-dvh max-w-[500px] flex-col items-center justify-center gap-3 overflow-y-auto px-5 py-12 text-center",children:[c.jsx("h1",{className:"mb-4 text-center font-semibold text-2xl sm:text-4xl",children:F("error.auth0VerificationTitle")}),c.jsx("p",{children:F("error.auth0VerificationDescription")}),c.jsxs("div",{className:"mt-12 w-full",children:[c.jsx(AS,{className:"mb-2 text-base",htmlFor:"birthdate-month",content:F("error.auth0VerificationBirthdate"),required:!0}),c.jsxs("div",{id:"birthdate-group",className:"flex gap-2",children:[c.jsx("span",{id:"month-label",className:"sr-only",children:r||F("dates.month")}),c.jsx("span",{id:"day-label",className:"sr-only",children:d||F("dates.day")}),c.jsx("span",{id:"year-label",className:"sr-only",children:s||F("dates.year")}),c.jsx(wl,{renderOption:P,options:E,onSelect:i,id:"birthdate-month",ariaLabelId:"month-label",placeholder:F("dates.month"),className:O("flex-1",oa,n===!1&&cp),value:r,isValid:n,menuClassName:at.dropdownMenuOverModal}),c.jsx(wl,{renderOption:P,options:x,onSelect:m,id:"birthdate-day",ariaLabelId:"day-label",placeholder:F("dates.day"),className:O("flex-1",oa,n===!1&&cp),value:d,menuClassName:at.dropdownMenuOverModal}),c.jsx(wl,{renderOption:P,options:w,onSelect:a,id:"birthdate-year",ariaLabelId:"year-label",placeholder:F("dates.year"),className:O("flex-1",oa,n===!1&&cp),value:s,menuClassName:at.dropdownMenuOverModal})]}),n===!1&&c.jsx("div",{className:O("mt-2 text-start text-system-red-550 text-sm dark:text-system-red-350"),children:F("error.authh0VerificationAgeError")})]}),c.jsxs("div",{className:"mt-12 w-full",children:[c.jsx(AS,{className:"mb-2 text-base",htmlFor:"country",content:F("error.auth0VerificationCountryRegion"),required:!0}),c.jsx(wl,{renderOption:P,options:I,onSelect:h,id:"country","aria-labelledby":"country-group",placeholder:F("error.auth0VerificationCountryRegion"),className:O("flex-1",oa),value:p,menuClassName:at.dropdownMenuOverModal})]}),c.jsxs("div",{className:"mt-12 w-full text-black text-xs dark:text-white/90",children:[c.jsx(mn,{i18nKey:F("error.auth0VerificationDisclaimer"),components:{termsLink:PS.termsLink,privacyLink:PS.privacyLink}}),c.jsx(ee,{className:"mt-4 w-full",color:"strong",size:"56-xl",variant:"rect",onClick:D,title:F("common.continue"),disabled:g,children:F("common.continue")})]})]})]})}function jce(){const[e,t]=l.useState(void 0);l.useEffect(()=>{async function o(){const s=await x$();t(s)}o()},[]),l.useEffect(()=>{const o=new URLSearchParams(window.location.search);o.delete("code"),o.delete("state"),o.delete("error"),window.history.replaceState({},document.title,`${window.location.pathname}?${o}`)},[]),l.useEffect(()=>{e&&Lt({page:"auth0AccountVerificationPage",scenario:"auth0Verification",customData:JSON.stringify({accountType:e})})},[e]);const n=async(o,s)=>{const a=await A$(o,s);if(!a)return!1;const{ageGroup:r}=a,i=r===ta.NOT_ADULT,d=r===ta.ADULT;return i||d?(Os(),!0):!1};return c.jsx(Fce,{onSubmit:n})}function RS(e){return J.instance().config().textOverrides?.(e)??e}const lp="w-full";function Bce(){const{switchAccount:e}=Fd(),{t}=Z(),n=Gc(),o=async(r,i)=>{await e({provider:r,scenario:"ageVerification",...i&&{opts:{connection:i}}})},s=J.instance().config().hideAgeVerificationButton!==!0,a=J.instance().config().hideAgeVerificationSwitchAccountButton!==!0;return c.jsxs(c.Fragment,{children:[c.jsx(Bs,{forceGradient:!0}),c.jsxs("section",{className:"relative z-10 m-auto flex h-dvh max-w-96 flex-col items-center justify-center gap-3 px-5 text-center",children:[c.jsx("h1",{className:"text-4xl",children:t(RS("error.ageVerificationTitle"))}),c.jsx("h2",{className:"text-foreground-600",children:t(RS("error.ageVerification"))}),s&&c.jsx(ee,{className:"mt-6 w-full",color:"default",size:"56-xl",variant:"rect",testId:"age-verification",title:t("error.ageVerificationVerifyAge"),onClick:()=>{Qg(IR)},children:t("error.ageVerificationVerifyAge")}),s&&c.jsx("div",{className:"text-balance text-foreground-600",children:t("error.ageVerificationOr")}),n?c.jsxs(c.Fragment,{children:[c.jsxs(ee,{onClick:()=>o("microsoft"),color:"default",title:t("signInPrompt.continueWithMicrosoft"),variant:"pill",size:"56-xl",className:Ae(lp),children:[c.jsx(z_,{className:"size-6"}),t("signInPrompt.continueWithMicrosoft")]}),c.jsxs(ee,{onClick:()=>o("auth0","apple"),color:"default",variant:"pill",size:"56-xl",title:t("signInPrompt.continueWithApple"),className:Ae(lp),children:[c.jsx(G_,{className:"size-6 text-black dark:text-white"}),t("signInPrompt.continueWithApple")]}),c.jsxs(ee,{onClick:()=>o("auth0","google"),color:"default",variant:"pill",size:"56-xl",title:t("signInPrompt.continueWithGoogle"),className:Ae(lp),children:[c.jsx(e0,{className:"size-6"}),t("signInPrompt.continueWithGoogle")]})]}):a&&c.jsx(ee,{className:"w-full",color:"default",size:"56-xl",variant:"rect",title:t("error.ageVerificationSwitchAccount"),onClick:()=>o("microsoft"),children:t("error.ageVerificationSwitchAccount")})]})]})}function Vce(){return M(ut)?.provider==="auth0"?c.jsx(jce,{}):c.jsx(Bce,{})}function Hce(e,t,n={}){const{leading:o=!0,trailing:s=!1}=n;let a=!1,r=null;const i=d=>{e(...d)};return!o&&!s?()=>{}:(...d)=>{a?r=d:(o?i(d):s&&(r=d),a=!0,setTimeout(()=>{a=!1,s&&r&&(i(r),r=null,a=!0,setTimeout(()=>{a=!1},t))},t))}}function Bf(e,t=1e3){const n=l.useRef(null);return l.useEffect(()=>{n.current=e},[e]),l.useMemo(()=>Hce((...a)=>{n.current?.(...a)},t),[t])}const ui=typeof HTMLElement<"u"&&"showPopover"in HTMLElement.prototype&&typeof HTMLElement.prototype.showPopover=="function";function zce(e=!0){const t=l.useRef(null),n=l.useCallback(()=>{const a=t.current;if(a&&ui)try{a.showPopover()}catch(r){Je({feature:"toast",scenario:"showPopoverToast",errorMessage:r instanceof Error?r.message:void 0})}},[]),o=l.useCallback(()=>{const a=t.current;if(a&&ui)try{a.hidePopover()}catch(r){Je({feature:"toast",scenario:"hidePopoverToast",errorMessage:r instanceof Error?r.message:void 0})}},[]),s=Bf(()=>{o(),n()},50);return l.useEffect(()=>{if(n(),ui&&e){const a=requestAnimationFrame(s);return()=>cancelAnimationFrame(a)}return()=>{}},[n,s,e]),l.useEffect(()=>{if(!ui||!e)return()=>{};const a=new MutationObserver(()=>{document.querySelectorAll("dialog[open]").length>0&&requestAnimationFrame(s)});return a.observe(document.documentElement,{childList:!0,subtree:!0,attributeFilter:["open"]}),()=>a.disconnect()},[s,e]),{toastRef:t,supportsPopover:ui}}function Gce({onClick:e}){return c.jsx("div",{className:"absolute end-0 top-0 z-10 cursor-pointer p-1 rtl:right-auto",children:c.jsx(ee,{title:F("product.dismiss"),"aria-label":F("product.dismiss"),variant:"rect",color:"subtle-bright-inverted",size:"32-xs",onClick:e,children:c.jsx(on,{className:"size-4"})})})}function K_(e){const{title:t,subtitle:n,link:o,onClick:s,Icon:a,iconSize:r="regular",iconClassName:i,removeIconBorder:d,dismissable:m=!0,ctaLabel:p,intent:h="info",contentClassName:g}=e,y=Hc(),b=T=>{(T.key==="Enter"||T.key===" ")&&(T.preventDefault(),s?.())},C=n??o?c.jsxs(c.Fragment,{children:[typeof n=="string"?`${n} `:n,o&&c.jsx("span",{className:"text-accent-450 underline text-sm dark:text-accent-600",role:"button",tabIndex:0,"aria-label":o,onKeyDown:b,children:o})]}):null;return c.jsx("div",{className:O("flex","flex-col","items-center","justify-center","py-2","ps-2","pe-1.5",{"w-[min(381px,100vw)]":!!C},g),children:c.jsxs("div",{className:O("relative flex w-full items-center p-0",{"gap-x-3":a,"flex-row-reverse":a&&y}),children:[a&&c.jsx("div",{"aria-hidden":"true",className:O("flex shrink-0 items-center justify-center rounded-xl",r==="small"?"ms-2 size-5":"size-16",!d&&"border border-black/10 dark:border-white/10"),children:c.jsx(a,{className:i})}),c.jsxs("div",{className:O("flex flex-1 flex-col justify-center py-1",!a&&"ps-4",m&&(C??t)&&!p?"pe-10":"pe-4"),children:[c.jsx("header",{className:O("flex w-full overflow-hidden",{"items-center":!!C,"items-center justify-center":!C}),children:c.jsx("h2",{className:O("text-foreground-750 text-sm-strong",{"text-base-strong":!!C,"text-sm":!C},h==="error"&&"text-system-red-550"),children:t})}),C&&c.jsx("p",{className:"w-full text-foreground-700 text-sm",children:C}),c.jsx(Ao,{msg:`${t??""} ${typeof n=="string"?n:""}`,type:"assertive"})]}),p&&c.jsx("div",{className:O("flex shrink-0 items-center","me-4",m&&"me-10"),children:c.jsx(ee,{variant:"rect",size:"40-base",className:"border border-black/8",title:p,onClick:T=>{T.stopPropagation(),s?.()},children:p})})]})})}const Wce=["overflow-hidden","rounded-3xl","border","border-solid","border-white/20","shadow-lg","backdrop-blur-[30px]","bg-acrylic-default-tint-light/95","dark:bg-acrylic-default-tint-dark/95"];function $ce(e){const{children:t,dismiss:n,dismissable:o=!0,className:s,onClick:a,onActiveChange:r,customColorTheme:i,bringToFrontOnDialog:d=!0}=e,m=M(ss),p=i??m,[h,g]=l.useState(!1),[y,b]=l.useState(!1),C=h||y,{toastRef:T,supportsPopover:S}=zce(d);l.useEffect(()=>{r?.(C)},[C,r]);const E="top-5 start-1/2 -translate-x-1/2 rtl:translate-x-1/2",I=J.instance().config(),x=(S?I.toastPopoverNotificationPositioning:I.toastNotificationPositioning)??E,w=S?{popover:"manual"}:{};return c.jsx("div",{"data-theme":p,className:O("pointer-events-none",S?"fixed m-0 overflow-visible bg-transparent":"absolute",at.toastNotification,x,s),onMouseEnter:()=>g(!0),onMouseLeave:()=>g(!1),onFocus:()=>b(!0),onBlur:()=>b(!1),ref:T,...w,children:c.jsx(It,{children:c.jsxs(he.div,{className:O("pointer-events-auto","relative",Wce,a&&"cursor-pointer"),initial:{opacity:0,y:-40,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-40,scale:.98},transition:{type:"spring",stiffness:400,damping:30},onClick:a,children:[o&&c.jsx(Gce,{onClick:n}),t]})})})}function Y_(){const[e,t]=Le(yt),[n,o]=l.useState(!1),[s,a]=l.useState(!1),r=l.useCallback(()=>{e?.trackingArgs&&de({source:"toastNotification",scenario:e.trackingArgs.scenario,customData:e.trackingArgs.customData})},[e]),i=l.useCallback(()=>{t(null)},[t]),d=l.useCallback(()=>{if(!e?.action)return;r();const{action:p}=e;p(),i(),e.onClick?.()},[e,r,i]);if(l.useEffect(()=>{let p;return a(!1),o(!1),e?.dismissAfter&&(p=window.setTimeout(()=>a(!0),e.dismissAfter)),()=>clearTimeout(p)},[e]),l.useEffect(()=>{s&&!n&&i()},[s,n,i]),!e)return null;const m=e.title?c.jsx(K_,{title:e.title,subtitle:e.subtitle,link:e.link,onClick:e.onClick,Icon:e.Icon,iconSize:e.iconSize,iconClassName:e.iconClassName,removeIconBorder:e.removeIconBorder,dismissable:e.dismissable,ctaLabel:e.ctaLabel,intent:e.intent,contentClassName:e.contentClassName}):e.children;return c.jsx($ce,{dismissable:e.dismissable,className:e.className,dismiss:p=>{p?.stopPropagation(),e.onDismiss?.(),i()},onClick:e.action?d:void 0,onActiveChange:o,customColorTheme:e.customColorTheme,bringToFrontOnDialog:e.bringToFrontOnDialog,children:m})}function kxe(e){const t=ke(),n={...e,children:c.jsx(K_,{title:e.title,subtitle:e.subtitle,link:e.link,onClick:e.onClick,Icon:e.Icon,iconSize:e.iconSize,iconClassName:e.iconClassName,removeIconBorder:e.removeIconBorder,dismissable:e.dismissable,ctaLabel:e.ctaLabel,intent:e.intent,contentClassName:e.contentClassName})};t.set(yt,n)}const qce=e=>{R.trackEvent({name:"system",data:{eventName:"copilotImpression",eventInfo_impressionPage:e}})},Vf=e=>{const{source:t,destination:n,pageName:o,customData:s}=e;R.trackEvent({name:"interaction",data:{eventName:"copilotClick",eventInfo_clickSource:t,eventInfo_clickDestination:n,eventInfo_pageName:o,eventInfo_customData:s}})};function up(e){const{children:t,href:n,source:o}=e;return c.jsx(Go,{className:"underline",href:n,title:t,onClick:()=>Vf({source:o,pageName:"UnderAgeDisclaimerPage"}),children:t})}const Kce=["error.under18Compliance.disclaimer1","error.under18Compliance.disclaimer2","error.under18Compliance.disclaimer3","error.under18Compliance.disclaimer4"],Yce="https://www.microsoft.com/microsoft-copilot/for-individuals/privacy",Zce="https://support.microsoft.com/topic/microsoft-copilot-age-limits-and-parental-controls-f79b47a6-288a-4513-8c01-afe4d16db900",Jce="https://www.microsoft.com/microsoft-copilot/for-individuals/termsofuse";function Qce(){const{t:e}=Z(),[t,n]=Le(Hg),o=G(yt);l.useEffect(()=>{qce("underAgeDisclaimerPage")},[]);const{mutate:s,isPending:a}=Uu({mutationKey:["underage-compliance-consent"],mutationFn:async()=>{if(!t?.compliance)return;const r=await Nt({path:"/user/consents",args:{options:{method:"POST"},body:{consentType:"teen",version:t.compliance.version}}});if(!r.ok)throw new Error(`Failed to submit teen compliance consent, ${r.status}: ${r.statusText}`)},onSuccess:()=>{Vf({source:"continueButton",pageName:"UnderAgeDisclaimerPage",customData:"success"}),n(r=>r&&{...r,compliance:null})},onError:r=>{Vf({source:"continueButton",pageName:"UnderAgeDisclaimerPage",customData:r.message}),o({title:e("common.somethingWrong"),subtitle:e("common.somethingWrongDescription"),dismissAfter:5e3,dismissable:!0})},retry:!1});return c.jsxs(c.Fragment,{children:[c.jsx(Bs,{}),c.jsx(Y_,{}),c.jsxs("section",{className:"relative m-auto flex h-full max-w-2xl flex-col gap-2 px-6 py-10 sm:justify-center sm:gap-4",children:[c.jsx("h1",{className:"self-start text-lg-medium",children:e("error.under18Compliance.title")}),c.jsx("ul",{className:"mb-10 flex flex-col gap-2 ps-6 sm:mb-24 sm:gap-3",children:Kce.map(r=>c.jsx("li",{className:"ps-2",children:c.jsx(mn,{i18nKey:r,components:{bold:c.jsx("span",{className:"text-base-strong"})}})},r))}),c.jsxs("div",{className:"mt-auto flex flex-col items-center gap-2 sm:mt-0",children:[c.jsx(ee,{color:"strong",size:"56-xl",variant:"pill",title:e("common.continue"),onClick:()=>s(),disabled:a,className:"w-80 max-md:mt-auto",children:a?c.jsx(xt,{className:"size-8"}):c.jsx("span",{className:"px-1.5",children:e("common.continue")})}),c.jsx("span",{className:"px-6 py-2 text-foreground-450 text-xs",children:c.jsx(mn,{i18nKey:"error.under18Compliance.legalLinks",components:{PrivacyLink:c.jsx(up,{href:Yce,source:"privacyStatementLink"}),LearnMoreLink:c.jsx(up,{href:Zce,source:"learnMoreLink"}),TermsLink:c.jsx(up,{href:Jce,source:"termsOfUseLink"})}})})]})]})]})}const Z_=({title:e,titleId:t,...n})=>l.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M12 4.5C7.85786 4.5 4.5 7.85786 4.5 12C4.5 16.1421 7.85786 19.5 12 19.5C16.1421 19.5 19.5 16.1421 19.5 12C19.5 11.6236 19.4723 11.2538 19.4188 10.8923C19.3515 10.4382 19.6839 10 20.1429 10C20.5138 10 20.839 10.2562 20.8953 10.6228C20.9642 11.0718 21 11.5317 21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C14.3051 3 16.4077 3.86656 18 5.29168V4.25C18 3.83579 18.3358 3.5 18.75 3.5C19.1642 3.5 19.5 3.83579 19.5 4.25V7.25C19.5 7.66421 19.1642 8 18.75 8H15.75C15.3358 8 15 7.66421 15 7.25C15 6.83579 15.3358 6.5 15.75 6.5H17.0991C15.7609 5.25883 13.9691 4.5 12 4.5Z"})),Pxe=Object.freeze(Object.defineProperty({__proto__:null,default:Z_},Symbol.toStringTag,{value:"Module"}));function Xce(e){const{t}=Z(),{btnTitle:n,onBtnClick:o=()=>{},loading:s=!1}=e;return c.jsxs("section",{className:"relative z-10 m-auto flex h-full max-w-96 flex-col items-center justify-center gap-3 px-5 text-center",children:[c.jsx("h1",{className:"text-4xl","data-testid":"unhandled-error-title",children:t("error.unhandledErrorTitle")}),c.jsx("h2",{className:"text-foreground-600",children:t("error.unhandledError")}),c.jsx(ee,{className:"mt-6 w-full",color:"default",size:"56-xl",variant:"rect",title:t("error.unhandledErrorReload"),onClick:o,testId:"unhandled-error-reload",disabled:s,children:n??c.jsxs(c.Fragment,{children:[c.jsx(Z_,{className:"size-6"}),t("error.unhandledErrorReload")]})})]})}function t0(){return c.jsxs("main",{className:"relative size-full overflow-hidden",children:[c.jsx(Bs,{forceGradient:!0}),c.jsx(Xce,{onBtnClick:()=>{Os()}})]})}function ele(){const{t:e}=Z();return c.jsxs("section",{className:"relative z-10 m-auto flex h-full max-w-96 flex-col items-center justify-center gap-3 px-5 text-center",children:[c.jsx("h1",{className:"text-4xl","data-testid":"unhandled-error-title",children:e("error.unhandledErrorTitle")}),c.jsx("h2",{className:"text-foreground-600",children:e("error.regionUnavailable")})]})}function tle(){return c.jsxs("main",{className:"relative size-full overflow-hidden",children:[c.jsx(Bs,{forceGradient:!0}),c.jsx(ele,{})]})}function nle(){const{t:e}=Z(),t=M(GT);let n="main";kt(Vp)&&t==="permanent"&&(n="confirm-submission");const[o,s]=l.useState(n),[a,r]=l.useState(""),[i,d]=l.useState(!1),m=!a||a.trim().length===0||i,p=t==="permanent"?e("composer.userBan.permanent"):e("composer.userBan.temporary",{duration:e(t==="1-hr"?"composer.userBan.duration1Hr":"composer.userBan.duration24Hr")}),h=e(t==="permanent"?"composer.userBan.banMessagePermanent":"composer.userBan.banMessageTemporary"),g=async()=>{if(!m){en({source:"submitBanAppeal"}),d(!0);try{await Nt({path:"/user/bans/appeal",args:{body:{appealText:`APPEAL: ${a}`}}}),s("confirm-submission"),$t(Vp,new Date().toISOString())}catch(y){R.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"submitBanAppeal",eventInfo_errorMessage:`${y}`,eventInfo_details:"Error submitting ban appeal"}})}d(!1)}};return c.jsxs("main",{className:"relative size-full",children:[c.jsx(Bs,{forceGradient:!0}),c.jsxs(jt,{id:o,className:"relative z-10 m-auto flex h-dvh max-w-[540px] flex-col items-center justify-center gap-3 p-12 text-center",children:[o==="main"&&c.jsxs(c.Fragment,{children:[c.jsx("h1",{className:"text-4xl",children:p}),c.jsx("p",{children:h}),t==="permanent"&&c.jsx(ee,{color:"strong",size:"56-xl",className:"mt-6 w-full",title:e("composer.userBan.submitAppeal"),onClick:()=>s("submit-appeal"),children:e("composer.userBan.submitAppeal")}),c.jsx(Ao,{msg:`${p}. ${h}`})]}),o==="submit-appeal"&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex w-full items-center pb-4",children:[c.jsx(ee,{variant:"square",color:"subtle-dimmed-inverted",size:"32-xs",title:e("common.backText"),onClick:()=>s("main"),children:c.jsx(Hr,{className:"size-5 -rotate-90"})}),c.jsx("h2",{className:"grow pe-8",children:e("composer.userBan.submitAppeal")})]}),c.jsx("textarea",{className:"h-[240px] w-full resize-none rounded-xl bg-background-100 p-4 placeholder:text-foreground-650 contrast-more:border-2 dark:text-white",onChange:y=>r(y.target.value),disabled:i,placeholder:e("composer.userBan.submitAppealPlaceholder")}),c.jsx(ee,{color:"strong",className:"w-full",size:"56-xl",title:e("common.submitText"),onClick:g,disabled:m,children:e("common.submitText")})]}),o==="confirm-submission"&&c.jsxs(c.Fragment,{children:[c.jsx("h1",{className:"text-4xl",children:e("composer.userBan.appealSubmitted")}),c.jsx("p",{children:e("composer.userBan.appealSubmittedDescription")}),c.jsx(Ao,{msg:`${e("composer.userBan.appealSubmitted")}, ${e("composer.userBan.appealSubmittedDescription")}`})]})]})]})}function ole(e){const t=M(bs);M(Rh);const n=M(Hg),o=M(br),s=!it("kill-underage-compliance");return o==="user-banned"?{type:"user-banned"}:o==="age-verification"?{type:"age-verification"}:o==="tier-4-region-block"?{type:"tier-4-region-block"}:o?{type:"error"}:!e&&t?{type:"account-action-required",action:t}:s&&n?.compliance?{type:"underage-compliance"}:{type:"ready"}}function sle(e){const{children:t,appInitialized:n}=e,o=ole(n);switch(o.type){case"user-banned":return c.jsx(nle,{});case"age-verification":return c.jsx(Vce,{});case"tier-4-region-block":return c.jsx(tle,{});case"error":return c.jsx(t0,{});case"account-action-required":return c.jsx(Ece,{accountActionRequired:o.action});case"initializing":return null;case"underage-compliance":return c.jsx(Qce,{});case"ready":default:return t}}function ale(e){const{children:t}=e;xre(),bie(),Hd(),zq(),wse(),Gie();const{appInitialized:n}=sce();Hre(),Pre(n),Sre(),gce();const o=Tie(),s=G(Lg);return Sie({isEnabled:o,onIntercept:s,shouldIntercept:a=>Jg(a)}),vce({isAppInitialized:n}),Dq(),rte(),Mq(n),Nq({appInitialized:n}),wie(n),kre(),Ure(),hce(),vre(),Cie(n),Aie(),yre(),_re(),Gre(),Iie(),Eie(),c.jsx(sle,{appInitialized:n,children:t})}function rle(){const e=M(gd),t=l.useRef(!1);l.useEffect(()=>{e&&!t.current&&(R.trackEvent({name:"system",data:{eventName:"copilotStart",eventInfo_duration:window.appEnd-window.appStart,eventInfo_landingPage:R.getLandingPage()}}),R.flush(),t.current=!0)},[e])}function J_(e,t){if(e){if(e.indexOf("-")!==-1)return e;if(t)return`${e}-${t}`}else if(t)return t;return"en-US"}function Mxe(){const e=B(Bt);return J_(st.resolvedLanguage,e)}function Q_(){const{i18n:e}=Z(),t=M(Bt);return J_(e.resolvedLanguage,t)}const ile={"shopping-homepage":["en-US"]};function X_(e,t){const n=Q_(),o=it(t),s=q(e),a=ile[e],r=a&&a.length>0?a.some(i=>n.toLowerCase()===i.toLowerCase()):!1;return o?!1:s?!0:r}function e3(e){if(e.length===0)throw new Error("Array must have at least one element");return Math.floor(Math.random()*e.length)}function Rxe(e,t){if(e.length===1)throw new Error("Array must have at least two elements");let n;do n=e3(e);while(n===t);return n}function cle(e){if(e.length!==0)return e[e3(e)]}function lle(e){const t=[...e];for(let n=e.length-1;n>0;n-=1){const o=Math.floor(Math.random()*(n+1)),s=t[n];s&&t[o]&&(t[n]=t[o],t[o]=s)}return t}function Nxe(e,t){if(e.length!==t.length)return!1;const n=[...e].sort(),o=[...t].sort();return n.every((s,a)=>s===o[a])}const ule={refetchOnWindowFocus:!1,refetchOnReconnect:!1,staleTime:1/0,refetchInterval:Of};function dle(e,t){return pt(e,JB,t?{query:{"api-version":"2"}}:void 0).then(n=>n.data)}function Cn(e){return Array.isArray(e)?In(e):{positive:In(e.positive),negative:In(e.negative)}}function In(e){const t=e,n=t.slice(0,-1),o=t.slice(-1);return[...lle(n),...o]}function mle(e){return{newsArticle:In(e.newsArticle),newsVideo:In(e.newsVideo),newsGem:In(e.newsGem),chat:In(e.chat),dailyBriefing:In(e.dailyBriefing),podcast:In(e.podcast),default:In(e.default)}}function ple(e){return{journey:In(e.journey),product:In(e.product)}}function fle(){const e=q("adspositivefeedbacksurvey"),t=q("speech-language-setting"),n=X_("shopping-homepage","kill-shopping-homepage"),o=q("map-panel"),s=e||t||n||o,a=s?"v2":"v1",{data:r,refetch:i}=ts({queryKey:["config",a],queryFn:()=>dle("/config",s),...ule}),d=G(Nc),m=G(Pg),p=G(iT),h=G(dT),g=G(Lne),y=G(Dne),b=G(One),C=G(fd),T=G(Mg),S=G(cT),E=G(Mo),I=G(sG),x=G(aG);A_(i),l.useEffect(()=>{if(r){d(r.voices),r.voiceLanguages&&m(r.voiceLanguages),p(r.signInPrompts),h(r.maxTextMessageLength),g(r.maxPageContentLength),b(r.pageLimit),y(r.maxPageTitleLength),r.characters&&T(r.characters),r.feedbackOptions.text=In(r.feedbackOptions.text),r.feedbackOptions.image=In(r.feedbackOptions.image),r.feedbackOptions.discover&&(r.feedbackOptions.discover=mle(r.feedbackOptions.discover)),r.feedbackOptions.shoppingHome&&(r.feedbackOptions.shoppingHome=ple(r.feedbackOptions.shoppingHome)),r.feedbackOptions.card.local=Cn(r.feedbackOptions.card.local),r.feedbackOptions.card.ads=Cn(r.feedbackOptions.card.ads),r.feedbackOptions.card.video=Cn(r.feedbackOptions.card.video),r.feedbackOptions.card.image=Cn(r.feedbackOptions.card.image),r.feedbackOptions.card.shopping=Cn(r.feedbackOptions.card.shopping),r.feedbackOptions.card.recipe=Cn(r.feedbackOptions.card.recipe),r.feedbackOptions.card.sports=Cn(r.feedbackOptions.card.sports),r.feedbackOptions.card.finance=Cn(r.feedbackOptions.card.finance),r.feedbackOptions.card.quiz=Cn(r.feedbackOptions.card.quiz),r.feedbackOptions.card.weather=Cn(r.feedbackOptions.card.weather),r.feedbackOptions.card.personalArtifacts=Cn(r.feedbackOptions.card.personalArtifacts),r.feedbackOptions.card.healthcareInfo=Cn(r.feedbackOptions.card.healthcareInfo),r.feedbackOptions.card.navigation=Cn(r.feedbackOptions.card.navigation),r.feedbackOptions.card.healthcareEntity=Cn(r.feedbackOptions.card.healthcareEntity),C(r.feedbackOptions),S(r.messagePreview);const w=U=>{const $={};for(const K of U)K in Gn&&Gn[K]&&($[K]=Gn[K]);return $},P=w(r.attachments.image.mimeTypes),D=w(r.attachments.document.mimeTypes),L=B(Px),j=(U,$)=>({maxBytes:U.maxBytes??$.maxBytes,mimeTypes:Object.keys(U.mimeTypes??{}).length?U.mimeTypes??{}:$.mimeTypes});E({maxFilesPerMessage:r.attachments.maxFilesPerMessage||L.maxFilesPerMessage,image:j({maxBytes:r.attachments.image.maxBytes,mimeTypes:P},L.image),document:j({maxBytes:r.attachments.document.maxBytes,mimeTypes:D},L.document)}),I(r.portraits??[]),x(r.characterAppearance??null)}},[r,p,d,h,g,y,C,T,b,S,E,I,x,m])}function hle(){const e=Nh(bt);return l.useCallback(n=>{e(o=>{for(const{id:s,title:a,updatedAt:r,characterId:i,continuedAt:d,group:m,isPinned:p,type:h,conversationType:g,source:y,url:b,taskId:C,status:T}of n){const S=o.get(s);S?(S.title=a,S.updatedAt=r,S.characterId=i??null,S.continuedAt=d,S.group=m??null,S.isPinned=p??!1,S.type=h,g&&(S.conversationType=g),S.source=y,S.url=b,S.taskId=C,S.status=T):o.set(s,{id:s,title:a,updatedAt:r,characterId:i??null,history:[],continuedAt:null,group:m??null,isPinned:p??!1,type:h,conversationType:g,source:y,url:b,taskId:C,status:T})}})},[e])}function t3(){const e=q("m365-wxp-history-sync"),t=M(VW);return e&&t}function gle(e,t){if(!e&&!t)return;const n=new Set(["chat","character","xbox"]);return e&&n.add("group"),t&&n.add("m365"),Array.from(n).join(",")}function vle(){const e=hle(),t=G(md),n=q("group-conversations"),o=t3();return l.useCallback(async({url:a,args:r,isFirstPage:i})=>{const d=gle(n,o),m=await pt(a,EV,{query:{...r,...d?{types:d}:{}}}).then(p=>p.data);if(m.results.length>0){const p=m.results.map(h=>({...h,history:[]}));e(p),t(!0)}else i&&t(!1);return m},[n,o,e,t])}function n0(e){const{data:t,error:n,isPending:o,isFetchingNextPage:s,hasNextPage:a,fetchNextPage:r,refetch:i}=j9({staleTime:6048e5,refetchOnMount:!1,refetchOnWindowFocus:!1,refetchOnReconnect:!1,...e}),d=l.useCallback(async()=>{a&&await r()},[r,a]),m=t?.pages,p=o||s,h=l.useCallback(async()=>{await i({cancelRefetch:!1})},[i]);return{loader:{loading:p,hasNextPage:a,error:n??void 0,onLoadMore:d,data:m},refetch:h}}function yle(){const e=vle(),t=t3();return n0({queryKey:["conversations",{m365Sync:t}],queryFn:({pageParam:n})=>e(n),initialPageParam:{url:"/conversations",isFirstPage:!0},getNextPageParam:n=>n.next?{url:"/conversations",args:{cursor:n.next}}:null})}const o0=_("default");async function Cle({imgSrc:e,givenName:t}){const n=W("3p-migration-phase-1"),o=await Mn.instance().hasBothMsalAndAuth0Accounts();let s=e,a=t;const r=kt(Hi),i=kt(su);return n&&o?(i&&(s=i),r&&(a=r)):n||(mt(su),mt(Hi)),{imgSrc:s,givenName:a}}async function Sle(e){const t=W("3p-migration-phase-1"),n=await Mn.instance().hasBothMsalAndAuth0Accounts();let o=e;const s=kt(Hi);return t&&n&&s&&e&&e!==s&&(o=s,tn({apiName:Tn.NAME_INCONSISTENT})),o}const ble="aster";function Ile(){const e=G(Bt),t=G(RW),n=!it("kill-picasso-id-on-start");return l.useCallback(async()=>{const o=await pt("/user",u5,{parseOptions:{safe:!0},returnResponseWithData:!0,query:{"api-version":ex},retry:Y1,requestTimeoutMs:Ji}).then(d=>d.data),{id:s,anid:a,isHistoryMigrationPending:r}=o;R.setAnid(a);const i=R.getPicassoId();return i!==null&&i!==s&&R.trackEvent({name:"health",data:{eventName:"userIdMismatch",eventInfo_customData:JSON.stringify({existingPicassoId:i,newPicassoId:s,origin:"user"})}}),n||R.setPicassoId(s),t(r),e(o.regionCode),o},[n,t,e])}function Ele(){const e=M(ut),t=M(hc),{refetch:n}=yle(),o=Ile(),s=G(vt),a=G(Xz),r=G(ma),i=G(Or),d=G(Bg),m=G(FT),p=G(o0),h=G(BT),g=G(Tr),y=G(VT),b=G(wW),C=G(mG),T=G(of),S=G(PW),E=G(AW),I=G(xW),x=G(_W),w=G(kW),P=G(MW),D=G(DT),L=G(vd),j=G(yd),U=G(Cd),$=G(Hg),K=Br(),X=q("account-change-chat-reset"),ne=Hd()[0]==="audioCall";l.useEffect(()=>{(async()=>{a(!0);try{const Se=Promise.all([o(),pt("/user/settings",fV,{query:{"api-version":"2"},returnResponseWithData:!0,retry:Y1,requestTimeoutMs:Ji}).then(ft=>ft.data),n()]),ge=Mn.instance().getUserInfo(),[{id:ve,preferredName:Pe,firstName:Me,isPro:ye,inEeaPlusRegion:Ie,isEligibleForFreeTrial:He,phoneLink:Ze,ageGroup:Be,allowedToggles:be,remainingUsage:re,subscriptions:te,accountTier:H,requiredConsents:Y},{preferredVoice:ue,preferredCharacter:oe,preferredVoiceLanguage:De,personality:_e,toggles:ze}]=await Se,We=!ze.training,Oe=!ze.personalization,qe=!ze["phone-connection"],se=ze["voice-training"],ie=ze["biometric-data-use"],we=ze["browser-cookies"],$e=ze["microsoft-profile-access"],wt=ze["one-drive-access"],_t=ze["computer-use-actions"],{allowOutlookAccess:An,allowEdgePasswordsAccess:No,optInToGenerativeUI:Lo}=ze;R.setIsAad(t);const xn=await Sle(Me);if(s({id:ve,preferredName:Pe,firstName:xn,isPro:ye&&!t,inEeaPlusRegion:Ie,isEligibleForFreeTrial:He,phoneLink:Ze,ageGroup:Be,allowedToggles:be,subscriptions:te,accountTier:H,isStudent:void 0,requiredConsents:Y}),D(Pe??xn??void 0),!X&&!ne&&await Vd(),i(ue||ble),d(De??""),K&&oe){const ft=Q5(oe);m(ft)}h(We),g(se),y(Oe),b(!!qe),C(!!Lo),T(!!ie),S(we),E(!!$e),I(!!wt),x(!!An),w(!!No),P(_t),$(Y),p(_e?.traits[0]??"default"),re&&(L(re.podcastGenerations),j(re.researchCalls),U(re.videoGenerations)),R.setSettings({userSettingVoiceType:ue??void 0,userConsentPersonalization:!Oe,userConsentModelTraining:!We,userSettingComputerUseActions:_t??void 0,userSubscription:ye?"pro":"free",accountTier:H??"free",activeSubscriptions:te?.map(ft=>ft.tier).join(",")??""});const go=await ge;if(go){const{mail:ft,isStudent:ct,givenName:Kn,imgSrc:is}=go,Do=await Cle({imgSrc:is,givenName:Kn});s(cs=>cs&&{...cs,givenName:Do.givenName,email:ft,imgSrc:Do.imgSrc,isStudent:ct}),Do.givenName&&!Pe&&!Me&&D(Do.givenName),t||r(null)}}finally{a(!1)}})().catch(console.error)},[e,X,s,a,r,n,h,i,K,b,C,g,y,T,S,E,I,P,o,t,m,ne,D,L,j,U,$,x,w,d,p])}function Zd(){const e=J.instance().config().connectorPlatform?.additionalGoogleAuthCheck,[t,n]=l.useState(e===void 0);return l.useEffect(()=>{if(typeof e!="function")return;const o=e;async function s(){await o()&&n(!0)}s().catch(()=>{})},[e]),t}const n3=()=>{const e=it("kill-google-drive-connector"),{isGoogleDriveEnabled:t=!1}=J.instance().config().connectorPlatform??{},n=Zd();return!e&&t&&n},Tle=()=>{const e=it("kill-google-calendar-connector"),{isGoogleCalendarEnabled:t=!1}=J.instance().config().connectorPlatform??{},n=Zd();return!e&&t&&n},o3=()=>{const e=M(Yu),t=it("kill-outlook-connector"),{isOutlookEnabled:n=!1}=J.instance().config().connectorPlatform??{};return!t&&e&&n},s3=()=>{const e=M(Yu),t=it("kill-onedrive-connector"),{isOneDriveEnabled:n=!1}=J.instance().config().connectorPlatform??{};return!t&&e&&n},a3=()=>{const e=it("kill-google-mail-connector"),{isGmailEnabled:t=!1}=J.instance().config().connectorPlatform??{},n=Zd();return!e&&t&&n},r3=()=>{const e=it("kill-google-contacts-connector"),{isGoogleContactsEnabled:t=!1}=J.instance().config().connectorPlatform??{},n=Zd();return!e&&t&&n},i3=()=>{const e=M(Yu),t=q("edge-browser-connector"),{isEdgeBrowserEnabled:n=!1}=J.instance().config().connectorPlatform??{};return e&&t&&!!n},NS="userConnectors",wle="/connections",Ale=["one-drive","outlook","edge-browser","gmail","google-calendar","google-contacts","google-drive","fitbit","health-ex"];async function xle(){const{data:e}=await pt(wle,QH,{options:{method:"GET",headers:{"Content-Type":"application/json"}}});return e.connections}function _le(){const e=Dt(),t=n3(),n=Tle(),o=o3(),s=s3(),a=a3(),r=r3(),i=i3(),d=q("connector-fitbit"),m=q("connector-health-ex"),p=e&&(t||n||o||s||a||r||i||d||m),h=G(Er),g=ot("kill-google-drive-connector"),y=l.useMemo(()=>{let S=[...Ale];return(g||!t)&&(S=S.filter(E=>E!=="google-drive")),o||(S=S.filter(E=>E!=="outlook")),n||(S=S.filter(E=>E!=="google-calendar")),s||(S=S.filter(E=>E!=="one-drive")),a||(S=S.filter(E=>E!=="gmail")),r||(S=S.filter(E=>E!=="google-contacts")),i||(S=S.filter(E=>E!=="edge-browser")),d||(S=S.filter(E=>E!=="fitbit")),m||(S=S.filter(E=>E!=="health-ex")),S},[g,o,n,s,a,r,t,i,d,m]),{data:b,error:C,isLoading:T}=ts({queryKey:["userConnectors"],queryFn:xle,enabled:p});return l.useEffect(()=>{if(b!==void 0){const S=y.map(E=>{const I=b.find(x=>x.type===E);return{type:E,status:I?.status??"disconnected",id:I?.id??`${E}-${crypto.randomUUID()}`,scopes:I?.scopes??[]}});h(S)}},[b,h,y]),{isLoading:T,error:!!C,data:T||!b?null:b}}const kle=f({isMobileAppInstalled:V()}),Ple="/user/install-status",Mle={refetchOnWindowFocus:!1,refetchOnReconnect:!1,staleTime:6e4};async function Rle(){try{return(await pt(Ple,kle,{options:{method:"GET"}})).data.isMobileAppInstalled}catch(e){throw console.error("Failed to fetch mobile app install status:",e),e}}function Nle(){const e=G(pG),{data:t,error:n,isLoading:o,refetch:s}=ts({queryKey:["mobileAppInstallStatus"],queryFn:Rle,...Mle});return l.useEffect(()=>{t!==void 0&&e(t)},[t,e]),{isMobileAppInstalled:t,isLoading:o,error:n,refetch:s}}function Lle(){const e=it("kill-windows-protocol-launcher"),t=M(Ng),n=M(nT);l.useEffect(()=>{if(e||!q5()||!n)return;(async()=>{try{await cie({prompt:t??void 0})}catch(s){console.error(s)}})()},[n,e,t])}const Hf="composer-visible",c3="composer-input";function Dle(e){return e.entryType==="element"&&"identifier"in e}function Ole(){performance.getEntriesByName("startupTime-begin").length||performance.mark("startupTime-begin",{startTime:window.appStart});const e=performance.measure("measure-TTC","startupTime-begin",Hf);_o({feature:"composer",scenario:"measure-TTC",duration:e.duration})}function Ule(){const e=$c();if(typeof window>"u"||!e)return()=>{};const t=new PerformanceObserver(n=>{try{if(performance.getEntriesByName(Hf).length>0){t.disconnect();return}for(const o of n.getEntries()){if(!Dle(o))continue;const{startTime:s,entryType:a,identifier:r}=o;if(a==="element"&&r===c3){performance.mark(Hf,{startTime:s}),Ole(),t.disconnect();break}}}catch{}});return t.observe({type:"element",buffered:!0}),()=>t.disconnect()}function Fle(){l.useEffect(()=>Ule(),[])}function jle(){return Ele(),_le(),Nle(),fle(),_oe(),rle(),Lle(),Fle(),null}async function Ble(){const e=ke();async function t(){try{J.instance().config().enableAuth0&&await bo.get();const{msal:n}=await Ut.get();R.trackEvent({name:"system",data:{eventName:"copilotMsalInit",eventInfo_initTrigger:"DCL",eventInfo_timing:performance.now()-window.appStart}}),n.addEventCallback(async r=>{w$(r);const{EventType:i}=await ua();r.eventType===i.ACCOUNT_ADDED?e.set(bs,{reason:"login"}):r.eventType===i.ACCOUNT_REMOVED&&e.set(bs,{reason:"logout"})}),await Mn.instance().initAuthAccount(),e.set(Rh,!0);const{monitorAccountChangesAcrossTabs:s,enableAuth0:a}=J.instance().config();s&&n.enableAccountStorageEvents(),a&&s&&rf.addEventListener("message",r=>{const i=tz.safeParse(r.data);if(!i.success)return;const{eventName:d}=i.data;d==="auth0.accountAdded"?e.set(bs,{reason:"login"}):d==="auth0.accountRemoved"&&e.set(bs,{reason:"logout"})})}catch(n){R.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"MsalInitError",eventInfo_details:"DCL",eventInfo_errorMessage:n instanceof Error?n.message:""}})}}return t()}function Vle(){if(typeof document>"u")return;const e=()=>{setTimeout(()=>Ble(),0)};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",e,{once:!0}):e()}const l3={LAYOUT:"layout-ttvr-element",SIDEBAR:"sidebar-ttvr-element"};function u3(){const e=gt({breakpoint:"sm"});return(J.instance().config().responsiveFullWidthSidebarEnabled??!1)&&e}function Hle(e){return["/login","/e/so","/e/sol","/fang","/subscription/ewallet/return","/subscription/redeem/enel"].includes(e)}function Vs(){const e=Vt(),t=M(eR);return(J.instance().config().sidebarNavigation??!1)&&t&&!Hle(e)}function qr(){const e=Vs(),t=q("sidebar-narrow"),n=J.instance().config().useCompactSidebarHeader??!1;return e&&t&&!n}function Kc(){const e=Vs(),t=qr(),n=M(To),o=gt({breakpoint:"md"});return e&&t&&!n&&!o}function Yc({endDelay:e=200}={}){const[t,n]=l.useState(!1),o=l.useRef(null);return l.useEffect(()=>{if(typeof window>"u")return()=>{};const s=()=>{n(!0),o.current!==null&&window.clearTimeout(o.current),o.current=window.setTimeout(()=>{n(!1)},e)};return window.addEventListener("resize",s),()=>{window.removeEventListener("resize",s),o.current!==null&&window.clearTimeout(o.current)}},[e]),t}const zle="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7";function s0(e){const{elementTiming:t}=e;return c.jsx("img",{elementtiming:t,src:zle,alt:"","aria-hidden":"true",className:"pointer-events-none absolute size-px"})}const Gle="secondary",Wle=!1,$le="2xs",qle=!0,Kle="outline",Yle="regular",Zle={"2xs":"h-min text-2xs px-0.5",sm:"h-5 text-sm px-2",md:"h-6 text-base px-2.5"},Jle={secondary:{soft:"bg-background-200 text-foreground-800",solid:"bg-foreground-800 text-background-100",outline:"bg-transparent text-foreground-800 border border-foreground-450"},success:{soft:"bg-system-green-250 text-system-green-550 dark:bg-system-green-750 dark:text-system-green-350",solid:"bg-system-green-550 text-foreground-100 dark:bg-system-green-400 dark:text-foreground-900",outline:"bg-transparent text-system-green-550 border border-system-green-550 dark:text-system-green-350 dark:border-system-green-350"},danger:{soft:"bg-system-red-200 text-system-red-550 dark:bg-system-red-650 dark:text-system-red-350",solid:"bg-system-red-550 text-foreground-100 dark:bg-system-red-400 dark:text-foreground-900",outline:"bg-transparent text-system-red-550 border border-system-red-550 dark:text-system-red-350 dark:border-system-red-350"},warning:{soft:"bg-system-orange-100 text-system-orange-300 dark:bg-system-orange-650 dark:text-system-orange-400",solid:"bg-system-orange-400 text-foreground-100 dark:text-foreground-900",outline:"bg-transparent text-system-orange-300 border border-system-orange-300 dark:text-system-orange-400 dark:border-system-orange-400"}},Qle={regular:"font-normal",light:"font-[450] [font-variation-settings:'wght'_450]"};function Au(e){const{className:t,color:n,pill:o,size:s,text:a,uppercase:r,variant:i,fontWeight:d}=e;return c.jsx("p",{className:O("inline flex-none rounded",Jle[n??Gle][i??Kle],(o??Wle)&&"rounded-full",Zle[s??$le],(r??qle)&&"uppercase",Qle[d??Yle],t),children:a})}function d3({defaultValue:e,controlledValue:t,onChange:n}){const o=t!==void 0,[s,a]=l.useState(e);return l.useEffect(()=>{o&&a(t)},[t,o]),{state:o?t:s,setState:d=>{o||a(d),n?.(d)}}}function m3(e){const{renderTrigger:t,triggerClick:n,children:o,className:s,options:a,isOpen:r,trapFocus:i,onIsOpenChange:d}=e,{state:m,setState:p}=d3({controlledValue:r,defaultValue:!1,onChange:d}),{disableFocusManager:h=!1}=a??{},g=Hc(),{refs:y,x:b,y:C,strategy:T,context:S,middlewareData:E}=ac({open:m,placement:a?.placement??"bottom-end",onOpenChange:p,middleware:[nc(a?.offset??1),oc({fallbackAxisSideDirection:"end"}),sc(),B9()],whileElementsMounted:kr}),I=uh(S),x=rc(S,{escapeKey:!1}),w=Lu(S,{role:a?.roleType??"dialog"}),{getReferenceProps:P,getFloatingProps:D}=Du([I,x,w]);l.useEffect(()=>{if(!m)return;const j=U=>{U.key==="Escape"&&(U.preventDefault(),U.stopPropagation(),U.stopImmediatePropagation(),p(!1))};return document.addEventListener("keydown",j,{capture:!0}),()=>{document.removeEventListener("keydown",j,{capture:!0})}},[m,p]);const L=j=>{a?.stopReferencePropagation&&j.stopPropagation(),n?.(j)};return c.jsxs(c.Fragment,{children:[t?.({ref:y.setReference,...P({onClick:L})},m),m&&c.jsx(Nu,{root:a?.rootRef,children:c.jsx(dh,{context:S,modal:i,disabled:h,returnFocus:a?.returnFocus??!0,children:c.jsx("div",{ref:j=>{y.setFloating(j),a?.menuRef&&(a.menuRef.current=j)},style:{position:T,top:`${C}px`,[g?"insetInlineEnd":"insetInlineStart"]:`${b}px`,visibility:E.hide?.referenceHidden?"hidden":"visible"},"data-outside-events-ignore":a?.ignoreOutsideEvents?"":void 0,...D({onClick:j=>{a?.stopFloatingPropagation&&j.stopPropagation(),a?.hideOnMenuClick&&p(!1)}}),className:Ae("flex rounded-2xl p-1.5 shadow-xl",a?.overrideZIndex??at.modal,s),children:o})})})]})}function Xle(e={}){const{disabled:t=!1}=e,n=it("kill-shared-page"),o=l.useCallback(async s=>{const{pageParam:a}=s,{url:r,args:i}=a,d={...i,...n?{}:{"api-version":"2"}};return await pt(r,TB,{query:d,analytics:{anonymousPath:"/pages"}}).then(p=>p.data)},[n]);return n0({queryKey:["pages"],queryFn:o,enabled:!t,initialPageParam:{url:"/pages",isFirstPage:!0},getNextPageParam:s=>s.next?{url:"/pages",args:{cursor:s.next}}:null})}function p3(e){const{callback:t,signInScenario:n,onShowSignIn:o,signInReason:s}=e,a=Dt(),r=G(Us);return(...i)=>{if(!a){r({isOpen:!0,scenario:n,reason:s}),o&&typeof o=="function"&&o();return}t(...i)}}function eue(){return qn({to:"/",from:Nn().state.location.pathname})}const dp=_(!1),f3=_(!1),zf=_(null),LS=_(null),tue=_(null),nue=_(!0),oue=_(-1),Lxe=_(!1),Dxe=Pu("muteCoachmarkVisible",!0),sue=Pu("studyVoiceCoachmarkNumberOfTimesShown",0),Oxe=_(!1);function Kr(){const{createConversation:e}=$r();return l.useCallback(async()=>{h3(),await e({shouldNavigateToChat:!1}),await eue()},[e])}function h3(){Ee(Yt,null),Ee(jc,null),Ee(zf,null)}const a0=(e={})=>{const{circular:t,axis:n,memorizeCurrent:o=!0,tabbable:s,ignoreDefaultKeydown:a,unstable_hasDefault:r}=e;Ad(V9);const i=fu({mover:{cyclic:!!t,direction:aue(n??"vertical"),memorizeCurrent:o,tabbable:s,hasDefault:r},...a&&{focusable:{ignoreKeydown:a}}});return _d()?{}:i};function aue(e){switch(e){case"horizontal":return ri.Horizontal;case"grid":return ri.Grid;case"grid-linear":return ri.GridLinear;case"both":return ri.Both;case"vertical":default:return ri.Vertical}}function rue(e){const t=e.children[0];return t instanceof HTMLElement?t:null}function iue(e,t=!0){l.useEffect(()=>{if(t&&e.current){const n=rue(e.current);n&&n.focus()}},[e,t])}const fo=e=>c.jsx(lue,{...e});fo.Motion=l.forwardRef(cue);function cue(e,t){const{children:n,axis:o="vertical",circular:s=!0,tabbable:a,autoFocus:r=!1,...i}=e,d=a0({axis:o,circular:s,tabbable:a}),m=l.useRef(null);return l.useImperativeHandle(t,()=>m.current,[]),I1(m,r),c.jsx(he.div,{ref:m,...d,...i,children:n})}function lue(e){const{children:t,axis:n="vertical",circular:o,tabbable:s,autoFocus:a=!1,...r}=e,i=a0({axis:n,circular:o,tabbable:s}),d=l.useRef(null);return iue(d,a),c.jsx("div",{ref:d,...i,...r,children:t})}function uue(){const{t:e}=Z(),t=Kr(),{createPage:n}=moe(),o=Dt(),s=q("pages-anonymous"),{refetch:a}=Xle({disabled:!o&&!s}),r=async()=>{Jne(),await n?.({content:"",sourcePage:"createNewPage",impressionScenario:"actionMenuCreateNewPage",featureLatencyInfo:{scenario:"createPage",startTimestamp:Date.now()}}),await a()},i=p3({callback:r,signInScenario:"sidebarActionCreatePage",signInReason:"createPage"}),d=async()=>{!o&&s?r():i()},m=()=>{setTimeout(()=>{d()},0)};return c.jsxs(fo,{axis:"vertical",circular:!0,autoFocus:!0,tabbable:!0,role:"presentation",className:"flex flex-col",children:[c.jsx(ee,{color:"subtle-dimmed-inverted",size:"40-base",variant:"rect",alignment:"start",title:e("sidebar.actions.newChat"),role:"menuitem",onClick:()=>{t()},children:e("sidebar.actions.newChat")}),c.jsx(ee,{color:"subtle-dimmed-inverted",size:"40-base",alignment:"start",variant:"rect",title:e("sidebar.actions.newPage"),role:"menuitem",testId:"create-new-page-button",onClick:m,children:e("sidebar.actions.newPage")})]})}function g3(e){const{buttonSize:t}=e,{t:n}=Z(),o=Ra();return c.jsx(m3,{options:{placement:"bottom-end",hideOnMenuClick:!0,roleType:"menu"},className:lo,renderTrigger:({onClick:s,...a},r)=>c.jsx(ee,{...a,testId:"sidebar-action-menu-button",title:n("sidebar.actions.menuTitle"),tooltip:{placement:"bottom",disabled:r},color:"subtle-dimmed-inverted",variant:"rect",size:t,className:"min-w-6 rounded-sm rounded-e-xl px-0",onClick:i=>{o&&(de({source:"sidebarActionsMenu",customData:JSON.stringify({buttonSize:t})}),s(i))},id:"sidebar-new-action-menu-button",children:c.jsx(po,{className:"size-3.5 rotate-90"})}),children:c.jsx(uue,{})})}const v3=({title:e,titleId:t,...n})=>l.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M10.7327 19.7905C11.0326 20.0762 11.5074 20.0646 11.7931 19.7647C12.0788 19.4648 12.0672 18.99 11.7673 18.7043L5.51587 12.7497L20.25 12.7497C20.6642 12.7497 21 12.4139 21 11.9997C21 11.5855 20.6642 11.2497 20.25 11.2497L5.51577 11.2497L11.7673 5.29502C12.0672 5.00933 12.0787 4.5346 11.7931 4.23467C11.5074 3.93475 11.0326 3.9232 10.7327 4.20889L3.31379 11.2756C3.14486 11.4365 3.04491 11.6417 3.01393 11.8551C3.00479 11.9019 3 11.9503 3 11.9997C3 12.0493 3.00481 12.0977 3.01398 12.1446C3.04502 12.3579 3.14496 12.563 3.31379 12.7238L10.7327 19.7905Z"})),Uxe=Object.freeze(Object.defineProperty({__proto__:null,default:v3},Symbol.toStringTag,{value:"Module"})),Jd=({title:e,titleId:t,...n})=>l.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M21.7803 3.28033C22.0732 2.98744 22.0732 2.51256 21.7803 2.21967C21.4874 1.92678 21.0125 1.92678 20.7196 2.21967L10.7197 12.2197L10.25 13.75L11.7803 13.2803L21.7803 3.28033ZM6.25 3C4.45507 3 3 4.45508 3 6.25V17.75C3 19.5449 4.45507 21 6.25 21H17.75C19.5449 21 21 19.5449 21 17.75V9.75C21 9.33579 20.6642 9 20.25 9C19.8358 9 19.5 9.33579 19.5 9.75V17.75C19.5 18.7165 18.7165 19.5 17.75 19.5H6.25C5.2835 19.5 4.5 18.7165 4.5 17.75V6.25C4.5 5.2835 5.2835 4.5 6.25 4.5H14.25C14.6642 4.5 15 4.16421 15 3.75C15 3.33579 14.6642 3 14.25 3H6.25Z"})),Fxe=Object.freeze(Object.defineProperty({__proto__:null,default:Jd},Symbol.toStringTag,{value:"Module"})),Qd=({title:e,titleId:t,...n})=>l.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M3.75 8.5C3.75 8.08579 4.08579 7.75 4.5 7.75H5.75C6.16421 7.75 6.5 8.08579 6.5 8.5C6.5 8.91421 6.16421 9.25 5.75 9.25H4.5C4.08579 9.25 3.75 8.91421 3.75 8.5ZM3.75 12C3.75 11.5858 4.08579 11.25 4.5 11.25H5.75C6.16421 11.25 6.5 11.5858 6.5 12C6.5 12.4142 6.16421 12.75 5.75 12.75H4.5C4.08579 12.75 3.75 12.4142 3.75 12ZM3.75 15.5C3.75 15.0858 4.08579 14.75 4.5 14.75H5.75C6.16421 14.75 6.5 15.0858 6.5 15.5C6.5 15.9142 6.16421 16.25 5.75 16.25H4.5C4.08579 16.25 3.75 15.9142 3.75 15.5ZM4.25 3C2.45507 3 1 4.45507 1 6.25V17.75C1 19.5449 2.45508 21 4.25 21H19.75C21.5449 21 23 19.5449 23 17.75V6.25C23 4.45507 21.5449 3 19.75 3H4.25ZM19.75 19.5H9V4.5H19.75C20.7165 4.5 21.5 5.2835 21.5 6.25V17.75C21.5 18.7165 20.7165 19.5 19.75 19.5ZM4.25 4.5H7.5V19.5H4.25C3.2835 19.5 2.5 18.7165 2.5 17.75V6.25C2.5 5.2835 3.2835 4.5 4.25 4.5Z"})),jxe=Object.freeze(Object.defineProperty({__proto__:null,default:Qd},Symbol.toStringTag,{value:"Module"})),due=_(!0),mue=_(!0),pue=_(!1),fue=_(!1),y3=_(!1);function r0(){const e=M(ud),t=M(Sr);return e&&!!t}function Zc(){const e=Vt();return e.startsWith("/podcasts")||e.startsWith("/shares/podcasts")}function Hs(e,t={},n){const{initialize:o=!1}=t,s=l.useRef(null);return l.useEffect(()=>{const a=n??s.current,r=new ResizeObserver(([i])=>{i&&e(i.contentRect)});return a&&(r.observe(a),o&&e(a.getBoundingClientRect())),()=>r.disconnect()},[e,o,n]),s}function Xd(){return lb().map(t=>t.context)}function C3(){const e=Xd();return!!e[e.length-1]?.customLayout}function hue(){const e=Xd();return!!e[e.length-1]?.standalonePage}function gue(){const e=Xd();return!!e[e.length-1]?.supportsBackgroundImage}function S3(){const e=Xd();return!!e[e.length-1]?.showSidebarHeaderAcrylicBackplate}function vue(e){const{isSidebarOpen:t,toggle:n}=e,o=Kr(),s=M(Hn),{t:a}=Z(),r=Vt(),i=Zc(),d=r0(),m=M(y3),p=Yc(),h=S3(),g=!t&&(h||ao(r)||i||Q1(r)),y=l.useRef(null),b=Hs(()=>{const C=document.getElementById("app");if(C){const T=!t&&y.current?y.current.clientWidth:0;C.style.setProperty("--header-controls-inline-start-width",`${T}px`)}});return c.jsx("div",{className:Ae("pointer-events-none absolute start-0 top-0 w-full p-1 pe-3.5",at.sidebar),ref:b,children:c.jsx("div",{className:"relative",children:c.jsxs("div",{className:"absolute flex min-w-full items-center justify-between gap-1 p-1",children:[c.jsx(It,{children:g&&c.jsx(he.div,{className:Ae("pointer-events-auto absolute inset-0 rounded-2xl border border-stroke-100 shadow-md dark:border-stroke-300",lo),initial:"initial",animate:"animate",exit:"exit",variants:{initial:je,animate:rt,exit:je},transition:p?{duration:0}:zn})}),c.jsxs("div",{className:"pointer-events-auto flex shrink-0 items-center gap-1","data-theme":s&&!t?s.theme:void 0,ref:y,children:[(m||t)&&c.jsxs(c.Fragment,{children:[c.jsx(ee,{title:a(t?"sidebar.close":"sidebar.open"),className:"after:absolute after:inset-0 after:rounded-lg hover:after:bg-black/3 dark:hover:after:bg-white/5",color:"subtle-dimmed-inverted",variant:"square",size:"28-xxs",onClick:()=>{de({source:"sidebarToggle",pageName:r,customData:JSON.stringify({isOpen:t})}),n()},testId:"sidebar-toggle-button",children:t?c.jsx(v3,{className:"size-4"}):c.jsx(Qd,{className:"size-5"})}),d&&!m&&c.jsx(Au,{text:a("settings.copilotBeta.beta"),className:"relative me-2 ms-1 uppercase"})]}),(m||!t)&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex items-center rounded-lg hover:bg-black/3 dark:hover:bg-white/5",children:[c.jsx(ee,{title:a("composer.startNewChat"),color:"subtle-dimmed-inverted",variant:"square",size:"28-xxs",onClick:async()=>{de({source:"sidebarNewConversation",destination:"/chat",pageName:r,customData:JSON.stringify({isOpen:t})}),await o()},children:c.jsx(Jd,{className:"size-5"})}),c.jsx(g3,{buttonSize:"28-xxs"})]}),d&&c.jsx(Au,{text:a("settings.copilotBeta.beta"),className:"relative me-2 ms-1 uppercase"})]})]})]})})})}const Bxe={button:"button",toast:"toast"},Jc={CallTypeChanged:"callTypeChanged",LabsTryButton:"labsTryButton",CharacterTalkToggleButton:"characterTalkToggleButton",SidebarBanner:"appearanceCtaSidebarBanner",DiscoverySidebarBanner:"appearanceCtaDiscoverySidebarBanner",EducationModal:"appearanceEducationModal"};let i0=null;function yue(){return i0}function b3(e){i0=e}function DS(){i0=null}class Cue{resourceObserver;entries=[];keyword=null;constructor(){this.resourceObserver=new PerformanceObserver(t=>{this.handleResources(t)})}trackStart(t){this.keyword=t,this.resourceObserver.observe({type:"resource",buffered:!1})}trackEnd(){const{entries:t}=this,n=t[t.length-1];return this.resourceObserver.disconnect(),this.entries=[],this.keyword=null,n?{name:n.name,duration:Math.round(n.duration)}:null}handleResources(t){if(this.keyword)for(const n of t.getEntries())n.name.includes(this.keyword)&&this.entries.push(n)}}const Sue="/static/cmc/assets/meshopt_decoder-3Kt66jYv.js";class Ct{static Core;static Math;static Viewer;static isInitialized=!1;static async loadLibraries(){const[t,,n]=await Promise.all([N(()=>import("./index-DqCLogWr.js").then(o=>o.c),__vite__mapDeps([12,13,14,1,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267])),N(()=>import("./index-BpzazC4O.js").then(o=>o.b),__vite__mapDeps([268,269,1,13,14,28,16,17,34,270,271,122,25,35,52,272,273,274,275,212,73,31,26,27,276,148,277,224,278,279,280,281,223,33,282,283,147,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,19,20,21,305,306,307,308,64,65,309,310,311,312,313])),N(()=>import("./math.scalar.functions-B0475LkX.js").then(o=>o.m),[])]);t.MeshoptCompression.Configuration={decoder:{url:Sue}},t.Logger.LogLevels=t.Logger.NoneLogLevel,Ct.Core=t,Ct.Math=n,Ct.isInitialized=!0}static async loadViewerLibraries(){const t=await N(()=>import("./index-DoiVkAx0.js"),__vite__mapDeps([314,1,24,13,14,18,71,315,270]));Ct.Viewer=t}static async loadDebugLibraries(){await Ct.loadLibraries(),await N(()=>import("./babylon.inspector.bundle-RyN0am4a.js").then(t=>t.b),__vite__mapDeps([316,1,317,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,318,315,269,270,271,268,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,319,320,321]))}static isLoaded(){return Ct.isInitialized}static getCore(){return Ct.throwIfNotInitialized("Core"),Ct.Core}static getMath(){return Ct.throwIfNotInitialized("Core"),Ct.Math}static getViewer(){return Ct.throwIfNotInitialized("Viewer"),Ct.Viewer}static throwIfNotInitialized(t){if(!Ct.isInitialized)throw new Error(`Libraries ${t} are not loaded yet. Call loadLibraries first.`)}}function Vxe(e){const t=e.split(/[\\/]/),n=t.pop();return{basePath:`${t.join("/")}/`,fileName:n??""}}function Hxe(e,t){R.trackEvent({name:"interaction",data:{eventName:"characterAnimation",eventInfo_characterAnimationState:e,eventInfo_characterId:t}})}function zxe(e,t){const{Texture:n}=Ct.getCore();return new Promise((o,s)=>{const a=new n(e,t,!1,!1,1,()=>{o(a)},s)})}function Gxe(e){const{Vector3:t}=Ct.getCore();return new t(e[0],e[1]??0,e[2]??0)}function Wxe(e){return Math.max(...e)-Math.min(...e)}function $xe(e){return e*Math.PI/180}function OS(e){const{Clamp:t}=Ct.getMath();return t(e,0,1)}function bue(e,t,n){return Math.abs(e-t)>n?t:e}function qxe(e,t,n=.01,o=.2){const{MoveTowards:s}=Ct.getMath();return s(e,bue(e,t,n),o)}let Iue;function di(...e){Iue??=W("babylon-debug")}class Eue{interactTime=0;voiceChatToggledTime=0;speechEndDetectedTime=0;startMessageTime=0;mountedTime=0;libsLoadedTime=0;sceneInitializedTime=0;interactSource="";currentConversationId="";currentMessageId="";serverTurnCounter;visualizerEnabled=!1;loadedEnd=!1;voiceChatToggledOn=!1;resourceMonitor=new Cue;isFirstTime=!1;isVoiceCall;constructor(t=!0){this.isVoiceCall=t,this.isFirstTime=!kt(CI)}resetLoading=()=>{di("%c[] -> resetAppearanceEvent"),this.interactTime=0,this.visualizerEnabled=!1,this.loadedEnd=!1};isAvailable=()=>this.isVoiceCall?_n()&&this.voiceChatToggledOn&&this.interactTime>0:_n()&&this.mountedTime>0;trackLoadingEvent=t=>{if(!this.isAvailable())return;const{eventName:n,duration:o,characterId:s,networkDuration:a}=t;if(s&&!El(s))return;const i=["voiceChatToggled","appearanceVisible","appearanceLoadingComplete"].includes(n);R.trackEvent({name:"system",data:{eventName:n,eventInfo_duration:Math.round(o),eventInfo_conversationId:this.currentConversationId,eventInfo_firstTime:this.isFirstTime,eventInfo_characterId:s,eventInfo_trigger:i?this.interactSource:void 0,eventInfo_networkDuration:a,eventInfo_customData:JSON.stringify({isVoiceCall:this.isVoiceCall})}}),di(`%c[] -> ${n} : `,"color: #691dc6",Math.round(o),this.isFirstTime?"firstTime":"",s?`characterId: ${s}`:"",`isVoiceCall: ${this.isVoiceCall===!0}`)};onUserInteract=(t,n)=>{n?.skipResetLoading||this.resetLoading(),this.interactTime=performance.now(),this.interactSource=t,b3(t),di("%c[] -> onUserInteract","color: #222222")};onVoiceChatToggled=(t,n)=>{if(t==="end")this.voiceChatToggledOn=!1,this.speechEndDetectedTime=0,this.resourceMonitor.trackEnd();else{this.voiceChatToggledOn=!0,this.voiceChatToggledTime=performance.now(),this.currentConversationId=n??"";const o=this.voiceChatToggledTime-this.interactTime;this.trackLoadingEvent({eventName:"voiceChatToggled",duration:o})}};onMounted=()=>{this.mountedTime=performance.now();let t;this.isVoiceCall?t=this.mountedTime-this.voiceChatToggledTime:(this.interactTime=this.mountedTime,t=0),this.trackLoadingEvent({eventName:"appearanceMounted",duration:t})};onUnmounted=()=>{this.resourceMonitor.trackEnd()};onBabylonLibrariesLoaded=t=>{if(!El(t))return;this.libsLoadedTime=performance.now();const n=this.libsLoadedTime-this.mountedTime;this.trackLoadingEvent({eventName:"appearanceBabylonLoaded",duration:n,characterId:t})};onSceneInitializationStart=t=>{El(t)&&this.resourceMonitor.trackStart(".glb")};onSceneInitialized=t=>{if(!El(t))return;this.sceneInitializedTime=performance.now();const n=this.sceneInitializedTime-this.libsLoadedTime,o=this.resourceMonitor.trackEnd();di("%c[] -> monitorResult : ","color: #5bb173",o),this.trackLoadingEvent({eventName:"appearanceSceneInitialized",duration:n,characterId:t,networkDuration:o?o.duration:void 0}),this.trackLoadingEvent({eventName:"appearanceLoadingComplete",duration:this.sceneInitializedTime-this.interactTime,characterId:t}),this.loadedEnd=!0,this.checkEnd()};onVisualizerEnabled=()=>{if(this.visualizerEnabled)return;this.visualizerEnabled=!0,this.isVoiceCall&&!this.voiceChatToggledOn&&(this.voiceChatToggledOn=!0);const t=Math.round(performance.now()-this.interactTime);this.trackLoadingEvent({eventName:"appearanceVisible",duration:t}),this.checkEnd()};checkEnd=()=>{this.visualizerEnabled&&this.loadedEnd&&this.resetLoading()};onStartMessage=(t,n,o)=>{this.currentMessageId=t,this.startMessageTime=n,this.serverTurnCounter=o};onSpeechEndDetected=t=>{this.speechEndDetectedTime=t};onAnimationStart=()=>{const t=Math.round(performance.now()-(this.speechEndDetectedTime||this.startMessageTime));R.trackEvent({name:"system",data:{eventName:"copilotAnimationStart",eventInfo_conversationId:this.currentConversationId,eventInfo_messageId:this.currentMessageId,eventInfo_duration:t,eventInfo_serverTurnCounter:this.serverTurnCounter}}),di("%c[] -> onAnimationStart : ","color: #691dc6",Math.round(t))};onColorUpdate=t=>{R.trackEvent({name:"system",data:{eventName:"appearanceColorUpdate",eventInfo_conversationId:this.currentConversationId,eventInfo_duration:0,eventInfo_firstTime:this.isFirstTime,eventInfo_customData:JSON.stringify(t)}})}}const mp=new Map,Tue=(e=!0)=>(mp.has(e)||mp.set(e,new Eue(e)),mp.get(e)),ga=Tue(!0),wue="/static/cmc/assets/lumi-square-B1_IY09F.webm",Aue="data:image/webp;base64,UklGRuAGAABXRUJQVlA4WAoAAAAQAAAAPwAAPwAAQUxQSPABAAABkCQAkCFJMZ61bdu2rZNt27Zt27Zt27ZttOKSiogPRMQEAMeQRGlTRAOxUSuMP3jryYOzi+onFJG059UAau/2S8YuRq+HaH6tdgivmlfR+t/EBIxSrPChy43JuATXf4GOdyflEWe2B52vic4h3wWkHBtCV+c9knoaU4UO9SDxqzw0cVcj/b5oFGlPIsd+BDluIcsP2Z0VeoZMVwY7yvMMuf4v5ybdXeS7PchF/FPI+H9FB+FrkfXGYLuByPtXEasKf5nhNJtkd5H7y2QWy5B/c7OGKHBrsEny+xJeZjCZjiIbGuT6IWO2wVyUeS5ck/qxkI9pNPVQqKeMZoYUbKwKPi2mryrBGzHjVTn+iJmtKucVM09V3S9mlqqqT8xoVcn/YrqoMv0QU1sV9Z6Un1lUsFHKzQhNOymTQZv9swxPSV3QNhm7w3RQOyDBUwEMo1yWMAWMGwnYGcMs6lF2OxKCZcX/vLyTY4D1VFbnq4LD+Ff53GkfHZwW+8HkXsc44LoNiw+D4gLhWAa7cwNp6EqqT4PjAHGsvTR36kYB8oRHKQ6ViQIMEx9y5t9QJAawjLvW0Z/puaMB09B+f1y86ZkpOvAtccIqcKh8vHDgHL3jPbMXfVKEBgHzWC32fVZ57w7PBCLDc7SYvnn/2lG1EgM1VlA4IMoEAABQGgCdASpAAEAAPikQhkIhoQoFA34MAUJZgCdMoSEH61+MfsY1T+2fibjkTK9nX6/7jO2B5gHPi3GW8wehn0qflVZgB1gOXQ9ZuWgsxxM66H5AZL7/C/Y7rEv91/J3ZEP63/s/yA9bTzW/RP+9/Kr6Av4l/Kv8H+Zn+F///gl9DX9TlBP4/u5lnqSxFS9F7sD8mqxrREFHwUlkm6bkl3BUp3dXytXljlJLfMn5z+FZCS6lMviAWjwKqkiqz1Xy8kharhmOS1MgUfy/eOZ6gelEO6hsGqJ/gw7RVAAA/v7spf/3Z7/+7Cv//doYIoq5IRecW9KGbtgXQyQn2TgjuovYXnDnncdyY+R9kyVdkZLpdIz8SW7VHDyHDrT7sLm4ac30adnLLsaftHJ7xezOXxRNY0RXMcoxMovA3zTPvq8t7hjxYhHzldhhfTW+U4cThCjbGtlp/vhz0WSNOYdokdPZ//jr2OlfB0IO72/kswbAJqjS147MZJXRDeFIC1s20oYpIN9HA/shgxPJmyMHn6y6ihngKA9SaJ9dHhtR2EY3i4elMvo3L6wE7s4XcZupxF3wYCQz+rRBRiyPGdQTyfLwuMl9pxl1As6e/eu3IyaTd2Ie9VCXVls4d//hcC94pvnml5SxycJDnsm7kQj1PqWDh/pQ+yc3ACFGZ3V516Hv47tbeurTRCIo1VcrqQHxDkCrkiabw95wHTHsHYxGkEi/53r/ixamTbiESmHIGgiAj94RAibdzh+F0Jg56aKeFljUEAipxLxmmIe11/iNGSRN/ZPenrUPpU8L0v/wj/xqbFGAVHORQDAfQ6DAJUj52PpsOijf+kE6B0YO8jciXXEbdil5WzM+qBwQpwAMb/RuUC4qBfZOroG+VfspPagyx/aB7eh/4yaN4/8JSZbiI6sonTdgC9289rk8UTWj8hMT/UPleL4+TSMv2K7N/z5GOTXVjPpagklsdgGkxOfrn5oW+NWIh5M/6XQjizzjny4MB9pfn6r/WAjuTK/xGT+aNC2FD3YujomeqgoF73qZq1EUnj8qtwwUBpGa0KHdVchC0/J78/izwEmlT0MNlf8kFYLT4LglZ3bN+z2qQSB5Cv1/5ia33+vXWV3OWt9ac5JKI8PPFu41gTV7v/mkSDYyC5DP7dTjn9GqvfCiFR5HrdTNnhClUjcLaDRHY0gwJGXkchezt1K5SJhzt6zDpcvo0yXRtf/Yka3U34ixGZa91McoxzIB9/0MeQR0FinLFZvKu3++KgeBu0H/nTpChOyl7Ee4UVHZa4TyiLGtSlkQb2IQePPro155VZ/5LZM9eid/j/njBTn8BxE8femtFkMnZ0IKd2Z+nz2pGCmGzlBGwtHasVAO7OAFNGGe6nta6AWBBAnbQT/rQSDgfZZ3F4sNxVvIPSEL+dz/sZurs65Zx9IWPS0Lyr5bzE70w0zGU5pFcuMlm6OUJw6aQxFoaSxnlgFlJmR472YOJapiJyJl3wEbdOpaigaGhUCf/4zZ7P1hJrqHbTqDLQsvaKER8OYwrOtEOLCRtjeRErWX42YASvAfWt2+8IA4m4bVvKD+Xew0gtkJb96JneNR0gIfszUod84oXj/wGBnf9mP+f8IEzVwQet5ZacFvQTgAAA==";function c0(e){const{className:t}=e,{t:n}=Z();return V_()?c.jsx("img",{src:Aue,alt:n("settings.appearanceIconAlt"),className:O("size-6")}):c.jsx("video",{src:wue,title:n("settings.appearanceIconAlt"),className:O("size-8 rounded-xl",t),autoPlay:!0,loop:!0,muted:!0,playsInline:!0})}const US="Sidebar";function xue(){const{t:e}=Z(),t=G(io),n=l.useRef(!1);l.useEffect(()=>{n.current||(n.current=!0,Lt({page:US,scenario:"Displayed",element:"appearanceCtaSidebarBanner"}))},[]);const o=async()=>{t(Da),ga.onUserInteract(Jc.SidebarBanner),await to({talkType:"talk"}),de({pageName:US,source:"appearanceCtaSidebarBanner",scenario:"open",destination:"AudioCallWithAppearance"})};return c.jsxs(ee,{title:e("settings.appearanceSidebarBannerAltText"),"aria-label":e("settings.appearanceSidebarBannerAltText"),className:"my-4 flex w-full gap-2 p-2",onClick:o,color:"subtle-dimmed-inverted",alignment:"start",children:[c.jsx(c0,{}),c.jsx("div",{className:"text-start text-sm",children:e("settings.appearanceSidebarStartVoiceBannerText")})]})}const pp="Sidebar";function _ue(e){const{onDismiss:t}=e,{t:n}=Z(),o=G(io),s=G(kw),a=l.useRef(!1),r=G(Fq);l.useEffect(()=>{a.current||(a.current=!0,Lt({page:pp,scenario:"Displayed",element:"appearanceCtaDiscoverySidebarBanner"}))},[]);const i=async()=>{s($E),r(!0),o(Da),ga.onUserInteract(Jc.DiscoverySidebarBanner),await to({talkType:"talk"}),t(),de({pageName:pp,source:"appearanceCtaDiscoverySidebarBanner",scenario:"open",destination:"AudioCallWithAppearance"})},d=m=>{m.stopPropagation(),s(ng),t(),de({pageName:pp,source:"appearanceCtaDiscoverySidebarBanner",scenario:"dismiss"})};return c.jsx("div",{className:"my-2 flex w-full px-1",children:c.jsxs("div",{className:"flex cursor-pointer flex-row items-center justify-center gap-1 rounded-2xl bg-foreground-100 p-3 dark:bg-background-650/10",role:"button",tabIndex:0,title:n("settings.appearanceSidebarBannerText"),"aria-label":n("settings.appearanceSidebarBannerText"),onClick:i,onKeyDown:async m=>{(m.key==="Enter"||m.key===" ")&&(m.preventDefault(),await i())},children:[c.jsx(c0,{}),c.jsxs("div",{className:"mx-1 flex flex-1 flex-col gap-2",children:[c.jsx("div",{className:"text-start text-xs",children:n("settings.appearanceSidebarBannerText")}),c.jsxs("div",{className:"flex flex-row items-center gap-1 text-accent-550",children:[c.jsx("div",{className:"text-start text-xs",children:n("settings.appearanceSidebarBannerTryItText")}),c.jsx(po,{className:"size-3"})]})]}),c.jsx("div",{className:"flex h-full flex-col justify-start self-stretch",children:c.jsx(ee,{title:n("product.dismiss"),"aria-label":n("product.dismiss"),variant:"rect",color:"subtle-dimmed-inverted",size:"28-xxs",onClick:d,children:c.jsx(on,{className:"size-3"})})})]})})}function I3(e){const{children:t,color:n="neutral",className:o}=e;return c.jsx("div",{className:O("flex h-4 shrink-0 items-center rounded px-1.5 text-2xs",n==="neutral"?"bg-black/8 text-foreground-550 dark:bg-white/8 dark:text-foreground-650":"bg-accent-350/30 text-accent-650 dark:bg-accent-450/30",o),children:t})}const kue="relative flex shrink-0 items-center justify-center";function ps(e){const{titleString:t,badgeString:n,isSelected:o,isIconOnly:s,children:a,testId:r,buttonClassName:i,onClick:d,to:m}=e,p=Kc(),h=c.jsx("span",{className:"flex w-full items-center justify-between",children:c.jsxs("span",{className:O("flex min-w-0 gap-1.5"),children:[c.jsx("span",{className:O(kue,"size-6"),children:a}),c.jsx(It,{mode:"popLayout",children:!s&&c.jsx(he.span,{className:"flex min-w-0 flex-1 flex-col",animate:"animate",exit:"exit",variants:{animate:rt,exit:je},transition:zn,children:c.jsxs("span",{className:"flex min-h-6 w-full items-center gap-1.5 text-start text-sm-medium",children:[t,n&&c.jsx(I3,{color:"accent",children:n})]})})})]})}),g=O("pointer-events-auto w-full flex-col px-2 py-1.5",s&&"h-9 w-10",o&&"bg-black/5 before:contrast-more:border-[4px] dark:bg-white/8",i),y={placement:"right",gap:12,disabled:!p},b="36-sm",C=o?"page":void 0;let T;if("to"in e&&m){const{params:S,search:E,hash:I,preload:x,resetScroll:w,onPointerDown:P}=e;T=c.jsx(ee,{className:g,title:t+(n?` (${n})`:""),tooltip:y,size:b,color:"subtle-dimmed-inverted",testId:r,"aria-current":C,onClick:d,to:m,params:S,search:E,hash:I,preload:x,resetScroll:w,onPointerDown:P,children:h})}else T=c.jsx(ee,{className:g,title:t+(n?` (${n})`:""),tooltip:y,size:b,color:"subtle-dimmed-inverted",onClick:d,testId:r,"aria-current":C,children:h});return c.jsx(he.div,{className:"relative w-full",layout:"position",transition:zn,children:T})}const FS=65,Pue=100;function jS({count:e=1}){const t=uM(),n=l.useMemo(()=>{let o=t??Math.floor(Math.random()*4294967295);const s=4294967296,a=1664525,r=1013904223;function i(){return o=(a*o+r)%s,o/s}return Array.from({length:e},()=>{const d=i();return`${Math.floor(d*(Pue-FS+1))+FS}%`})},[e,t]);return c.jsx("div",{className:"flex flex-col gap-5 px-3 py-1",children:n.map((o,s)=>c.jsx("div",{style:{width:o},className:Ae("relative h-5 overflow-hidden rounded-lg bg-background-300 opacity-30 dark:bg-background-250 dark:opacity-40","border border-background-300 dark:border-background-250","after:absolute after:inset-0 after:h-full","after:opacity-50 dark:after:opacity-5","after:bg-gradient-to-r after:from-transparent after:via-white after:to-transparent","after:bg-[length:80%_100%] after:bg-no-repeat","after:animate-[shimmer-translate-x_2s_infinite]","rtl:after:animate-[shimmer-translate-x-reverse_2s_infinite]")},s))})}const E3=({title:e,titleId:t,...n})=>l.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M8 4.5H8.99998V10.7382C8.99998 11.1132 8.90628 11.4822 8.72739 11.8117L5.14269 18.415C4.50968 19.5811 5.35388 20.9999 6.68068 20.9999H17.3193C18.6461 20.9999 19.4903 19.5811 18.8573 18.415L15.2726 11.8117C15.0937 11.4822 15 11.1132 15 10.7382V4.5H16C16.4142 4.5 16.75 4.16421 16.75 3.75C16.75 3.33579 16.4142 3 16 3H8C7.58579 3 7.25 3.33579 7.25 3.75C7.25 4.16421 7.58579 4.5 8 4.5ZM10.5 10.7382V4.5H13.5V10.7382C13.5 11.3631 13.6561 11.9781 13.9543 12.5273L14.7537 14H9.24621L10.0457 12.5273C10.3438 11.9781 10.5 11.3631 10.5 10.7382ZM8.43192 15.5H15.568L17.539 19.1307C17.6294 19.2973 17.5088 19.4999 17.3193 19.4999H6.68068C6.49114 19.4999 6.37054 19.2973 6.46097 19.1307L8.43192 15.5Z"})),Kxe=Object.freeze(Object.defineProperty({__proto__:null,default:E3},Symbol.toStringTag,{value:"Module"})),T3=({title:e,titleId:t,...n})=>l.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M11.0656 8.00389L11.25 7.99875H18.75C20.483 7.99875 21.8992 9.3552 21.9949 11.0643L22 11.2487V18.7487C22 20.4818 20.6435 21.898 18.9344 21.9936L18.75 21.9987H11.25C9.51697 21.9987 8.10075 20.6423 8.00515 18.9332L8 18.7487V11.2487C8 9.51571 9.35646 8.0995 11.0656 8.00389ZM18.75 9.49875H11.25C10.3318 9.49875 9.57881 10.2059 9.5058 11.1052L9.5 11.2487V18.7487C9.5 19.6669 10.2071 20.4199 11.1065 20.4929L11.25 20.4987H18.75C19.6682 20.4987 20.4212 19.7916 20.4942 18.8923L20.5 18.7487V11.2487C20.5 10.2822 19.7165 9.49875 18.75 9.49875ZM15.5818 4.23284L15.6345 4.40964L16.327 6.998H14.774L14.1856 4.79787C13.9355 3.86431 12.9759 3.31029 12.0423 3.56044L4.79787 5.50158C3.91344 5.73856 3.36966 6.61227 3.52756 7.49737L3.56044 7.64488L5.50158 14.8893C5.69372 15.6064 6.30445 16.0996 7.00045 16.1764L7.00056 17.6816C5.69932 17.6051 4.52962 16.7445 4.10539 15.4544L4.05269 15.2776L2.11155 8.03311C1.66301 6.35913 2.6067 4.6401 4.23284 4.10539L4.40964 4.05269L11.6541 2.11155C13.3281 1.66301 15.0471 2.6067 15.5818 4.23284Z"})),Yxe=Object.freeze(Object.defineProperty({__proto__:null,default:T3},Symbol.toStringTag,{value:"Module"})),w3=({title:e,titleId:t,...n})=>l.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M3.5 12C3.5 7.30558 7.30558 3.5 12 3.5C16.6944 3.5 20.5 7.30558 20.5 12C20.5 16.6944 16.6944 20.5 12 20.5C7.30558 20.5 3.5 16.6944 3.5 12ZM12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2ZM7.08349 8.70767C6.67722 7.6882 7.68791 6.67747 8.7074 7.08372L12.7356 8.68888C13.9078 9.15602 14.8461 10.0704 15.3431 11.2303L17.1969 15.5557C17.6414 16.5929 16.5927 17.6415 15.5555 17.197L11.2301 15.3433C10.0703 14.8462 9.15587 13.908 8.68872 12.7358L7.08349 8.70767ZM8.69209 8.69233L10.0822 12.1805C10.4018 12.9825 11.0274 13.6245 11.821 13.9646L15.572 15.5721L13.9644 11.8212C13.6243 11.0276 12.9824 10.4019 12.1803 10.0823L8.69209 8.69233Z"})),Zxe=Object.freeze(Object.defineProperty({__proto__:null,default:w3},Symbol.toStringTag,{value:"Module"})),A3=({title:e,titleId:t,...n})=>l.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M2 5.25C2 3.45507 3.45507 2 5.25 2H14.75C16.5449 2 18 3.45507 18 5.25V8H16.5V5.25C16.5 4.2835 15.7165 3.5 14.75 3.5H5.25C4.2835 3.5 3.5 4.2835 3.5 5.25V12.75C3.5 13.7165 4.2835 14.5 5.25 14.5H8V16H5.25C3.45507 16 2 14.5449 2 12.75V5.25ZM19 13.25C19 13.9404 18.4404 14.5 17.75 14.5C17.0596 14.5 16.5 13.9404 16.5 13.25C16.5 12.5596 17.0596 12 17.75 12C18.4404 12 19 12.5596 19 13.25ZM9 12.25C9 10.4551 10.4551 9 12.25 9H18.75C20.5449 9 22 10.4551 22 12.25V18.75C22 20.5449 20.5449 22 18.75 22H12.25C10.4551 22 9 20.5449 9 18.75V12.25ZM12.25 10.5C11.2835 10.5 10.5 11.2835 10.5 12.25V18.75C10.5 18.9393 10.5301 19.1216 10.5856 19.2923L13.98 16.1069C14.845 15.2977 16.1892 15.2977 17.0542 16.1069L20.4246 19.2598C20.4736 19.0985 20.5 18.9273 20.5 18.75V12.25C20.5 11.2835 19.7165 10.5 18.75 10.5H12.25ZM12.25 20.5H18.75C18.9854 20.5 19.2099 20.4535 19.4149 20.3693L16.0295 17.2023C15.7411 16.9326 15.2931 16.9326 15.0047 17.2023L11.6167 20.3819C11.8131 20.4582 12.0267 20.5 12.25 20.5ZM5.75 5C6.16421 5 6.5 5.33579 6.5 5.75V6.25C6.5 6.66421 6.16421 7 5.75 7C5.33579 7 5 6.66421 5 6.25V5.75C5 5.33579 5.33579 5 5.75 5ZM6.5 8.75C6.5 8.33579 6.16421 8 5.75 8C5.33579 8 5 8.33579 5 8.75V9.25C5 9.66421 5.33579 10 5.75 10C6.16421 10 6.5 9.66421 6.5 9.25V8.75ZM14.25 5C14.6642 5 15 5.33579 15 5.75V6.25C15 6.66421 14.6642 7 14.25 7C13.8358 7 13.5 6.66421 13.5 6.25V5.75C13.5 5.33579 13.8358 5 14.25 5ZM6.5 11.75C6.5 11.3358 6.16421 11 5.75 11C5.33579 11 5 11.3358 5 11.75V12.25C5 12.6642 5.33579 13 5.75 13C6.16421 13 6.5 12.6642 6.5 12.25V11.75Z"})),Jxe=Object.freeze(Object.defineProperty({__proto__:null,default:A3},Symbol.toStringTag,{value:"Module"})),Mue=({title:e,titleId:t,...n})=>l.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M12.8199 5.57912L11.9992 6.40163L11.1759 5.57838C9.07688 3.47931 5.67361 3.47931 3.57455 5.57838C2.10768 7.04524 1.66588 9.14901 2.24917 10.9995H3.85417C3.19569 9.56827 3.45603 7.81821 4.63521 6.63904C6.14849 5.12575 8.602 5.12575 10.1153 6.63904L11.4727 7.99648C11.7706 8.29435 12.2553 8.28854 12.5459 7.98363L13.8806 6.63978C15.3977 5.12268 17.8528 5.12268 19.3699 6.63978C20.5498 7.81969 20.8084 9.56628 20.1486 10.9995H21.7539C22.3385 9.14845 21.8988 7.04731 20.4306 5.57912C18.3277 3.47623 14.9228 3.47623 12.8199 5.57912ZM11.4699 21.0751L4.8943 14.4995H6.85723C6.90822 14.4995 6.95886 14.4973 7.00904 14.493L12.0002 19.4842L16.988 14.4995H19.1101L12.5306 21.0751C12.2377 21.368 11.7628 21.368 11.4699 21.0751ZM9.42082 8.4141C9.29247 8.15739 9.02887 7.99645 8.74188 7.99956C8.45489 8.00266 8.19484 8.16928 8.07207 8.42871L6.38232 11.9995H2.75C2.33579 11.9995 2 12.3353 2 12.7495C2 13.1637 2.33579 13.4995 2.75 13.4995H6.85714C7.14708 13.4995 7.41105 13.3324 7.53507 13.0703L8.76856 10.4637L11.3292 15.5849C11.4465 15.8196 11.6779 15.9759 11.9394 15.9971C12.2009 16.0183 12.4544 15.9013 12.608 15.6886L15.3062 11.9527L16.4356 13.2434C16.578 13.4062 16.7837 13.4995 17 13.4995H21.25C21.6642 13.4995 22 13.1637 22 12.7495C22 12.3353 21.6642 11.9995 21.25 11.9995H17.3403L15.8144 10.2556C15.664 10.0837 15.4433 9.98967 15.215 10.0003C14.9867 10.011 14.7758 10.1251 14.642 10.3104L12.117 13.8065L9.42082 8.4141Z"})),em=({title:e,titleId:t,...n})=>l.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M15.1017 16.1624C13.717 17.3101 11.9391 18 10 18C5.58172 18 2 14.4183 2 10C2 5.58172 5.58172 2 10 2C14.4183 2 18 5.58172 18 10C18 11.9391 17.3101 13.717 16.1624 15.1018L20.7803 19.7197C21.0732 20.0126 21.0732 20.4874 20.7803 20.7803C20.4874 21.0732 20.0125 21.0732 19.7196 20.7803L15.1017 16.1624ZM16.5 10C16.5 6.41015 13.5899 3.5 10 3.5C6.41015 3.5 3.5 6.41015 3.5 10C3.5 13.5899 6.41015 16.5 10 16.5C13.5899 16.5 16.5 13.5899 16.5 10Z"})),Qxe=Object.freeze(Object.defineProperty({__proto__:null,default:em},Symbol.toStringTag,{value:"Module"})),x3=({title:e,titleId:t,...n})=>l.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M7 7V5a3 3 0 0 1 5-2.236A3 3 0 0 1 17 5v2h1.5A1.5 1.5 0 0 1 20 8.5v10.005A3.495 3.495 0 0 1 16.505 22H8a4 4 0 0 1-4-4V8.5A1.5 1.5 0 0 1 5.5 7H7Zm6.635 13.5a3.479 3.479 0 0 1-.625-1.995V8.5H5.5V18A2.5 2.5 0 0 0 8 20.5h5.635ZM11.5 7V5a1.5 1.5 0 0 0-3 0v2h3ZM13 7h2.5V5a1.5 1.5 0 0 0-2.656-.956c.101.3.156.622.156.956v2Zm1.51 11.505a1.995 1.995 0 0 0 3.99 0V8.5h-3.99v10.005Z"})),Xxe=Object.freeze(Object.defineProperty({__proto__:null,default:x3},Symbol.toStringTag,{value:"Module"})),Rue="discover",Nue="chat",Lue={CHAT:"chat"},e_e={SMALL:"small",BIG:"big",LARGE:"large",EXTRA_LARGE_V2:"extraLargeV2"},_3={ADDRESS_BAR_SEARCH:"addressBarSearch",DRAWER:"drawer"};function t_e(e){return e===Lue.CHAT?Nue:Rue}const Due=_(_3.ADDRESS_BAR_SEARCH),Oue="/discover";function Uue(e){return e.startsWith(Oue)}function l0(){const e=sn();return Uue(e)}const BS="/health";function Fue(e){return e===BS||e.startsWith(`${BS}/`)}function k3(){const e=Vt();return Fue(e)}function VS(e){return e?{x:e.scrollLeft,y:e.scrollTop}:{x:0,y:0}}function jue(e,t={}){const{checkIsScrolling:n=!0,scrollEndDelay:o=150}=t,[s,a]=l.useState(VS(e.current)),[r,i]=l.useState(!1),d=l.useRef(void 0);return l.useEffect(()=>{const m=e.current;let p=null;if(m===null)return()=>{};function h(){p??=window.requestAnimationFrame(()=>{l.startTransition(()=>{a(VS(m)),n&&i(!0)}),n&&(d.current&&window.clearTimeout(d.current),d.current=window.setTimeout(()=>{l.startTransition(()=>{i(!1)})},o)),p=null})}return m.addEventListener("scroll",h),()=>{m.removeEventListener("scroll",h),d.current&&clearTimeout(d.current)}},[n,e,o]),t.checkIsScrolling?{...s,isScrolling:r}:s}function Bue({onScrollStart:e,onScrollEnd:t,scrollRefs:n}){const o=l.useRef({}),s=Bf(r=>{const{target:i}=r;i instanceof Window?o.current={scrollSource:"window",scrollStartTime:Date.now(),scrollStartX:i.scrollX,scrollStartY:i.scrollY,scrollWidth:document.documentElement.scrollWidth,scrollHeight:document.documentElement.scrollHeight}:i instanceof HTMLElement&&(o.current={scrollSource:i.id,scrollStartTime:Date.now(),scrollStartX:i.scrollLeft,scrollStartY:i.scrollTop,scrollWidth:i.scrollWidth,scrollHeight:i.scrollHeight}),e?.(o.current)}),a=Bf(r=>{const{target:i}=r;i instanceof Window?(o.current={...o.current,scrollEndX:i.scrollX,scrollEndY:i.scrollY,scrollDuration:Date.now()-(o.current.scrollStartTime??0)},t?.(o.current)):i instanceof HTMLElement?(o.current={...o.current,scrollEndX:i.scrollLeft,scrollEndY:i.scrollTop,scrollDuration:Date.now()-(o.current.scrollStartTime??0)},t?.(o.current)):o.current={}});l.useEffect(()=>{const r={passive:!0};for(const i of n)i.current?.addEventListener("scroll",s,r),i.current?.addEventListener("scrollend",a,r);return()=>{for(const i of n)i.current?.removeEventListener("scroll",s),i.current?.removeEventListener("scrollend",a)}},[n,s,a])}function P3(e){const{scrollableRef:t,customData:n,customTrackCallback:o}=e,s=l.useCallback(a=>{window.requestAnimationFrame(()=>{if(o)o(a);else{const r=JSON.stringify(typeof n=="object"||n===void 0?{scrollWidth:a.scrollWidth,scrollHeight:a.scrollHeight,...n??{}}:n);xG({...a,scrollSource:e.source??a.scrollSource,customData:r})}})},[n,o,e.source]);Bue({onScrollEnd:s,scrollRefs:t?[t]:[]})}function Vue(){const{t:e}=Z();return l.useEffect(()=>{Ee(yt,{title:e("common.somethingWrong"),subtitle:e("common.somethingWrongDescription"),dismissable:!0,dismissAfter:1500})},[e]),null}function Hue(){return null}function rs(e,t){return l.lazy(async()=>{try{const n=t.retryStrategy??{maxRetries:0},o=await y_(t.moduleName,n)(e);if(o.default)return o;const{exportName:s}=t;if(s&&o[s])return{default:o[s]};throw new Error(`Exported module not found "${t.moduleName}"`)}catch(n){let o,s;if(n instanceof Error&&(o=n.message,s=n.stack),R.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"LazyModuleLoadError",eventInfo_errorName:t.moduleName,eventInfo_errorMessage:o,eventInfo_errorStack:s}}),t.throwError)throw n;return t.errorFallback?{default:t.errorFallback}:t.showErrorToast?{default:Vue}:{default:Hue}}})}function ws(e){return J.instance().config().settingsOverrides?.[e.key]??e.default}const ho={image:"ImagesTab",page:"PagesTab",research:"ResearchTab",podcast:"PodcastsTab",video:"VideosTab"},zue={image:"ImagesList",page:"PagesList",research:"ResearchList",podcast:"PodcastsList",video:"VideosList"},Gue={image:"ImageItem",page:"PageItem",research:"ResearchItem",podcast:"PodcastItem",video:"VideoItem"};function Wue(e){de({pageName:e,source:"LibraryNavItem",destination:"library"})}function n_e(e){const t=ho[e];de({pageName:"library",source:t})}function o_e(e){Lt({page:"library",scenario:ho[e],element:zue[e]})}function s_e(e){const{type:t,index:n}=e;de({pageName:"library",source:Gue[t],scenario:ho[t],customData:JSON.stringify({itemIndex:n})})}function a_e(e){const{type:t,index:n}=e;de({pageName:"library",source:"Share",scenario:ho[t],customData:JSON.stringify({itemIndex:n})})}function r_e(e){const{type:t,index:n}=e;de({pageName:"library",source:"Delete",scenario:ho[t],customData:JSON.stringify({itemIndex:n})})}function i_e(e){const{type:t,index:n,format:o}=e;let s="Download";o==="pdf"?s="ExportAsPdf":s="ExportAsDocx",de({pageName:"library",source:s,scenario:ho[t],customData:JSON.stringify({itemIndex:n})})}function c_e(e){const{type:t,isEmpty:n}=e;de({pageName:"library",source:"CreateButton",scenario:ho[t],customData:JSON.stringify({isEmpty:n})})}function l_e(e){de({pageName:"library",source:"SignInButton",scenario:ho[e]})}function u_e(){Lt({page:"library",element:"LibrarySignInPromotion"})}function d_e(){Lt({page:"library"})}function m_e(e){Lt({page:"library",scenario:ho[e],element:"EmptyState"})}function p_e(e){Lt({page:"library",scenario:ho[e],element:"ErrorPage"})}function f_e(e){de({pageName:"library",source:"retryButton",scenario:ho[e]})}function Cs(e){const{fallback:t,children:n}=e;return c.jsx(hI,{serverFallback:t,children:c.jsx(l.Suspense,{fallback:t,children:n})})}const $ue=rs(()=>N(()=>import("./sidebar-settings-DjuMjw6x.js"),__vite__mapDeps([322,1,323,324,325,326,327,328,329,330,331,332,333,334,335,2,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362])),{moduleName:"sidebar-settings",retryStrategy:mo}),fp="bg-sidebar-light dark:bg-sidebar-dark",HS="before:pointer-events-none before:absolute before:h-10 before:w-full before:from-sidebar-light before:to-transparent dark:before:from-sidebar-dark",que=rs(()=>N(()=>import("./sidebar-pages-CS6fCQt4.js"),__vite__mapDeps([363,1,2])),{moduleName:"sidebar-pages",exportName:"SidebarPages",retryStrategy:mo}),Kue=l.lazy(()=>N(()=>import("./sidebar-projects-DJq03mEj.js"),__vite__mapDeps([364,1,365,366,367,329,368,2])).then(e=>({default:e.SidebarProjects}))),Yue=l.lazy(()=>N(()=>import("./sidebar-tasks-tvpHi1Gm.js"),__vite__mapDeps([369,1,370,371,372,373,374,375,376,377,378,342,379,380,381,382,327,383,384,385,386,387,388,2,389,390,391,323,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,329,415,416,417,418])).then(e=>({default:e.SidebarTasks}))),Zue=l.lazy(()=>N(()=>import("./conversations-DaYzRBJ1.js"),__vite__mapDeps([419,1,420,329,421,422,423,368,424,425,426,427,428,429,430,2])));function Jue(e){const{toggle:t,isSidebarTranslucent:n,onOpenConversationSearch:o}=e,{t:s}=Z(),a=Vt(),r=Fa(),i=Kr(),d=M(To),m=Yc(),p=G(Due),h=l.useRef(!0);l.useEffect(()=>{h.current=!1},[]);const g=Dt(),y=Ra(),b=q("pages-sidebar-empty-cta"),C=q("pages-anonymous"),T=!J.instance().config().disableLibrary,S=!T&&(g||b||C)&&y,E=q("projects"),I=q("supersonic-task"),x=js(),w=q("appearance-discoverability-sidebar-banner"),P=M(kw),D=M(io),L=M(a1),j=M(jq),U=J.instance().config().enableLabs,$=!J.instance().config().disableDiscoverTab,K=!it("kill-creator-gallery"),X=X_("shopping-homepage","kill-shopping-homepage"),ne=a==="/shopping",me=q("healthcare-space"),Se=k3(),ge=l0(),ve=ge||a==="/daily",{modalType:Pe}=Fu({strict:!1}),Me=a.startsWith("/library"),ye=a.startsWith("/labs"),Ie=Q1(a),He=J1,[Ze,Be]=l.useState(x&&w&&!L&&!P);l.useEffect(()=>{(P||j)&&Be(!1)},[P,j]);const be=l.useMemo(()=>x&&w&&D&&L&&P!==ng&&!j,[x,P,w,D,L,j]),re=M(Dr),te=l.useRef(null),{y:H}=jue(te),Y=H>0,ue=u3(),oe=G(To);P3({scrollableRef:te,source:"sidebar"});const De=ws({key:"shouldUseFlyoutSettings",default:!1}),ze=q("sidebar-settings")&&!De&&y,We=qr(),Oe=Kc(),qe=We&&!ue&&!d,se=!it("kill-sidebar-nav-item-router-links"),ie=q("hide-conversation-dates"),we=l.useCallback(async(...$e)=>{se||await r(...$e)},[se,r]);return c.jsxs("div",{className:O("flex h-dvh flex-col px-0.5 pb-0.5 pt-1",ue?"w-full":"w-sidebar"),children:[c.jsx("div",{className:"h-[52px] shrink-0"}),c.jsx("div",{className:O("t-custom-scrollbar min-h-0 flex-1 overflow-x-hidden",d?"overflow-y-auto":"overflow-y-hidden"),ref:te,children:c.jsxs("div",{className:O("flex min-h-full w-full flex-col px-1",{"justify-between":ze}),children:[c.jsx(he.div,{className:O(!n&&fp,!n&&HS,"pointer-events-none sticky top-0 z-10 pb-3",Y&&"before:bottom-0 before:top-full before:bg-gradient-to-b before:opacity-90",Y&&"after:absolute after:bottom-0 after:mx-1 after:w-[calc(100%-8px)] after:border-b after:border-black/8 dark:after:border-white/10",ue&&"whitespace-nowrap"),layout:!0,transition:zn,children:c.jsxs("div",{className:O(!n&&fp,"pointer-events-auto relative flex flex-col items-start gap-0.5",Oe?"pt-0":"pt-1"),"data-theme":n?"dark":void 0,children:[c.jsx(It,{mode:"popLayout",children:Oe&&c.jsxs(he.div,{className:"flex flex-col gap-0.5",animate:"animate",exit:"exit",variants:{animate:{scale:1,...rt},exit:{scale:.6,...je}},transition:m||h.current?{duration:0}:zn,children:[c.jsx(ps,{buttonClassName:"cursor-e-resize",titleString:s("sidebar.open"),isIconOnly:!0,onClick:()=>{de({source:"sidebarToggle",pageName:a,customData:JSON.stringify({isOpen:d})}),t()},testId:"sidebar-toggle-button",children:c.jsx(Qd,{className:"size-5"})}),c.jsx(ps,{titleString:s("composer.startNewChat"),isIconOnly:!0,onClick:async()=>{y&&(de({source:"sidebarNewConversation",destination:"/",pageName:a,customData:JSON.stringify({isOpen:d})}),await i())},children:c.jsx(Jd,{className:"size-5"})})]})}),d&&!Oe&&o&&c.jsx("div",{className:"w-full pb-1 pe-2 ps-1 md:hidden",children:c.jsxs(ee,{title:s("sidebar.conversationSearch.searchConversations"),variant:"pill",color:"subtle-dimmed-inverted",alignment:"start",size:"40-base",className:"w-full rounded-4xl bg-white/45 px-3 py-2.5 dark:bg-white/5",onClick:async()=>{if(!g){await r({to:"/login",from:a});return}o()},children:[c.jsx(em,{className:"size-5 shrink-0 text-foreground-400"}),c.jsx("span",{className:"text-foreground-400 text-sm",children:s("sidebar.conversationSearch.searchConversations")})]})}),$&&c.jsx(ps,{titleString:s("sidebar.discover"),isSelected:ve,isIconOnly:qe,testId:"sidebar-discover-button",onClick:async()=>{if(!y)return;!ge||ge&&!!Pe?(p(_3.DRAWER),de({source:"sidebarDiscoverButton",destination:"/discover",pageName:a}),await we({to:"/discover",from:a,search:{modalUrl:void 0}})):ue&&oe(!1)},to:se?"/discover":void 0,children:c.jsx(w3,{className:"size-5"})}),X&&c.jsx(ps,{titleString:s("sidebar.shopping.title"),isSelected:ne,isIconOnly:qe,testId:"sidebar-shopping-button",onClick:async()=>{y&&(de({source:"sidebarShoppingButton",destination:"/shopping",pageName:a}),await we({to:"/shopping",from:a}),ue&&ne&&oe(!1))},to:se?"/shopping":void 0,children:c.jsx(x3,{className:"size-5"})}),K&&c.jsx(ps,{titleString:s("sidebar.gallery.titleV2"),isSelected:Ie,isIconOnly:qe,onClick:async()=>{y&&(de({source:"sidebarGalleryButton",destination:He,pageName:a}),await we({to:He,from:a}),ue&&Ie&&oe(!1))},to:se?He:void 0,children:c.jsx(A3,{className:"size-5"})}),T&&c.jsx(ps,{titleString:s("sidebar.library"),isSelected:Me,isIconOnly:qe,onClick:()=>{y&&(we({to:"/library",from:a}),Wue(a))},to:se?"/library":void 0,children:c.jsx(T3,{className:"size-5"})}),me&&c.jsx(ps,{titleString:s("sidebar.health.title"),isSelected:Se,isIconOnly:qe,testId:"sidebar-health-button",onClick:async()=>{y&&(await we({to:"/health",from:a}),ue&&Se&&oe(!1))},to:se?"/health":void 0,children:c.jsx(Mue,{className:"size-5"})}),U&&c.jsx(ps,{titleString:s("sidebar.labs"),isSelected:ye,isIconOnly:qe,onClick:async()=>{y&&(de({source:"sidebarLabsButton",destination:"/labs",pageName:a}),await we({to:"/labs",from:a}),ue&&ye&&oe(!1))},to:se?"/labs":void 0,children:c.jsx(E3,{className:"size-5"})})]})}),c.jsx(It,{children:d&&c.jsxs(he.div,{className:"grow",animate:"animate",exit:"exit",variants:{animate:rt,exit:je},layout:"position",transition:zn,children:[be&&y&&c.jsx(xue,{}),Ze&&!be&&y&&c.jsx(_ue,{onDismiss:()=>Be(!1)}),c.jsxs("div",{className:"relative flex grow flex-col py-4",children:[S&&c.jsx(Cs,{fallback:null,children:c.jsx(que,{isCompact:!ue})}),E&&c.jsx(Cs,{fallback:null,children:c.jsx(Kue,{isCompact:!ue})}),I&&c.jsx(Cs,{fallback:null,children:c.jsx(Yue,{isCompact:!ue})}),c.jsx("h2",{className:O("mb-2 flex gap-2 px-2.5 align-middle text-sm-medium",{"mb-6":!ie&&y}),"data-testid":"sidebar-conversations-header",children:s("sidebar.conversations")}),re&&y?c.jsx(Cs,{fallback:c.jsx(jS,{count:16}),children:c.jsx(Zue,{isCompact:!ue})}):c.jsx(jS,{count:16})]})]})}),!ze&&c.jsx("div",{className:O(!n&&fp,!n&&HS,"sticky bottom-0 py-1",!n&&"before:bottom-full before:bg-gradient-to-t")}),c.jsx(Cs,{fallback:null,children:ze&&c.jsx($ue,{isSidebarTranslucent:n})})]})})]})}const Que="/static/cmc/assets/copilot-wordmark-DvWA6bVb.svg",M3=({title:e,titleId:t,...n})=>{const[o,s]=l.useState("");return l.useEffect(()=>{s(Math.random().toString(36).slice(2,10))},[]),l.createElement("svg",{viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M22.9253 4.97196C22.5214 3.79244 21.4126 3 20.1658 3L18.774 3C17.3622 3 16.1532 4.01106 15.9033 5.40051L14.4509 13.4782L15.0163 11.5829C15.3849 10.347 16.5215 9.5 17.8112 9.5L23.0593 9.5L25.3054 10.809L27.4705 9.5H26.5598C25.313 9.5 24.2042 8.70756 23.8003 7.52804L22.9253 4.97196Z",fill:`url(#${o}-paint0_radial_262034_2117)`}),l.createElement("path",{d:"M9.39637 27.0147C9.79613 28.2011 10.9084 29 12.1604 29H14.5727C16.1772 29 17.4805 27.704 17.4893 26.0995L17.5315 18.4862L16.9699 20.4033C16.6058 21.6461 15.4659 22.5 14.1708 22.5H8.88959L6.96437 21.0214L4.88007 22.5H5.78013C7.03206 22.5 8.14435 23.299 8.54411 24.4853L9.39637 27.0147Z",fill:`url(#${o}-paint1_radial_262034_2117)`}),l.createElement("path",{d:"M19.7501 3H8.81266C5.68767 3 3.81268 7.08916 2.56269 11.1783C1.08177 16.0229 -0.856044 22.5021 4.75017 22.5021H9.66051C10.9615 22.5021 12.105 21.6415 12.4657 20.3915C13.2784 17.5759 14.7501 12.4993 15.9014 8.65192C16.4758 6.73249 16.9543 5.08404 17.6886 4.05749C18.1003 3.48196 18.7864 3 19.7501 3Z",fill:`url(#${o}-paint2_radial_262034_2117)`}),l.createElement("path",{d:"M19.7501 3H8.81266C5.68767 3 3.81268 7.08916 2.56269 11.1783C1.08177 16.0229 -0.856044 22.5021 4.75017 22.5021H9.66051C10.9615 22.5021 12.105 21.6415 12.4657 20.3915C13.2784 17.5759 14.7501 12.4993 15.9014 8.65192C16.4758 6.73249 16.9543 5.08404 17.6886 4.05749C18.1003 3.48196 18.7864 3 19.7501 3Z",fill:`url(#${o}-paint3_linear_262034_2117)`}),l.createElement("path",{d:"M12.2478 29H23.1852C26.3102 29 28.1852 24.9103 29.4352 20.8207C30.9161 15.9755 32.854 9.49548 27.2477 9.49548H22.3375C21.0364 9.49548 19.893 10.3562 19.5322 11.6062C18.7196 14.4221 17.2479 19.4994 16.0965 23.3474C15.5221 25.2671 15.0436 26.9157 14.3093 27.9424C13.8976 28.518 13.2115 29 12.2478 29Z",fill:`url(#${o}-paint4_radial_262034_2117)`}),l.createElement("path",{d:"M12.2478 29H23.1852C26.3102 29 28.1852 24.9103 29.4352 20.8207C30.9161 15.9755 32.854 9.49548 27.2477 9.49548H22.3375C21.0364 9.49548 19.893 10.3562 19.5322 11.6062C18.7196 14.4221 17.2479 19.4994 16.0965 23.3474C15.5221 25.2671 15.0436 26.9157 14.3093 27.9424C13.8976 28.518 13.2115 29 12.2478 29Z",fill:`url(#${o}-paint5_linear_262034_2117)`}),l.createElement("defs",null,l.createElement("radialGradient",{id:o+"-paint0_radial_262034_2117",cx:0,cy:0,r:1,gradientTransform:"matrix(-7.37821 -8.55084 -7.96607 7.17216 25.5747 13.5466)",gradientUnits:"userSpaceOnUse"},l.createElement("stop",{offset:.0955758,stopColor:"#00AEFF"}),l.createElement("stop",{offset:.773185,stopColor:"#2253CE"}),l.createElement("stop",{offset:1,stopColor:"#0736C4"})),l.createElement("radialGradient",{id:o+"-paint1_radial_262034_2117",cx:0,cy:0,r:1,gradientTransform:"matrix(6.61516 7.92888 7.80904 -6.47171 7.1753 21.9482)",gradientUnits:"userSpaceOnUse"},l.createElement("stop",{stopColor:"#FFB657"}),l.createElement("stop",{offset:.633728,stopColor:"#FF5F3D"}),l.createElement("stop",{offset:.923392,stopColor:"#C02B3C"})),l.createElement("radialGradient",{id:o+"-paint2_radial_262034_2117",cx:0,cy:0,r:1,gradientTransform:"matrix(-0.990905 -17.2799 98.0282 -5.51056 8.54161 22.4952)",gradientUnits:"userSpaceOnUse"},l.createElement("stop",{offset:.03,stopColor:"#FFC800"}),l.createElement("stop",{offset:.31,stopColor:"#98BD42"}),l.createElement("stop",{offset:.49,stopColor:"#52B471"}),l.createElement("stop",{offset:.843838,stopColor:"#0D91E1"})),l.createElement("linearGradient",{id:o+"-paint3_linear_262034_2117",x1:9.52186,y1:3,x2:10.3572,y2:22.5029,gradientUnits:"userSpaceOnUse"},l.createElement("stop",{stopColor:"#3DCBFF"}),l.createElement("stop",{offset:.246674,stopColor:"#0588F7",stopOpacity:0})),l.createElement("radialGradient",{id:o+"-paint4_radial_262034_2117",cx:0,cy:0,r:1,gradientTransform:"matrix(-8.64067 24.4636 -29.4075 -10.797 27.8096 7.58585)",gradientUnits:"userSpaceOnUse"},l.createElement("stop",{offset:.0661714,stopColor:"#8C48FF"}),l.createElement("stop",{offset:.5,stopColor:"#F2598A"}),l.createElement("stop",{offset:.895833,stopColor:"#FFB152"})),l.createElement("linearGradient",{id:o+"-paint5_linear_262034_2117",x1:28.6736,y1:8.30469,x2:28.6627,y2:13.617,gradientUnits:"userSpaceOnUse"},l.createElement("stop",{offset:.0581535,stopColor:"#F8ADFA"}),l.createElement("stop",{offset:.708063,stopColor:"#A86EDD",stopOpacity:0}))))};function zS(e,t){l.useEffect(()=>(Ce.emit("ref:registered",{name:e,ref:t}),()=>{Ce.emit("ref:unregistered",{name:e,ref:t})}),[e,t])}function St(e){const{url:t,className:n}=e;return c.jsx("div",{className:O("bg-current forced-color-adjust-none forced-colors:bg-[ButtonText]",n),style:{WebkitMaskImage:`url(${t})`,maskImage:`url(${t})`,WebkitMaskRepeat:"no-repeat",maskRepeat:"no-repeat",WebkitMaskPosition:"center",maskPosition:"center",WebkitMaskSize:"contain",maskSize:"contain"}})}const GS={placement:"bottom"};function Xue(e){const{isSidebarOpen:t,toggle:n,isSidebarAtomSynced:o,onOpenConversationSearch:s}=e,a=Kr(),r=l.useRef(!0);l.useEffect(()=>{r.current=!1},[]);const i=M(Hn),{t:d}=Z(),m=Yc(),p=Vt(),h=p==="/",g=Zc(),y=gt({breakpoint:"md"}),b=r0(),C=qr(),T=Kc(),S=Ra(),E=S3(),I=Dt(),x=Fa(),w=!t&&(E||ao(p)||g),P=l.useRef(null),D=Hs(()=>{const L=document.getElementById("app");if(L){const j=y&&P.current?P.current.clientWidth:0;L.style.setProperty("--sidebar-header-secondary-buttons-collapsed-width",`${j}px`),L.style.setProperty("--header-controls-inline-start-width",`${j}px`)}});return zS("sidebar-header-container",D),zS("sidebar-header-buttons",P),c.jsx("div",{className:O("pointer-events-none absolute start-0 top-0 w-full py-1.5 pe-2.5 md:py-3",!C&&(!t||!o)?"ps-2":"ps-0.5",at.sidebar),children:c.jsx("div",{className:"relative",children:c.jsxs("div",{className:O("absolute flex min-w-full items-end justify-between p-1",T?"gap-3":"gap-0.5"),ref:D,children:[(t||C)&&c.jsx("div",{className:O("flex w-0 items-center",(!o||C&&!t)&&"max-md:hidden"),children:c.jsxs(ee,{role:"link",title:d("sidebar.homepageLink"),className:O("pointer-events-auto absolute start-1 top-1 flex items-center gap-2 pe-2.5 ps-2.5",T&&"gap-0"),size:"36-sm",color:"subtle-dimmed-inverted",testId:"sidebar-copilot-brand-button",onClick:async()=>{!h&&S&&(de({source:"sidebarBrandButton",destination:"/chat",pageName:p}),await a())},children:[c.jsx(M3,{className:"size-5"}),c.jsx(jt,{className:"flex items-center",mode:"popLayout",initial:r.current?!1:"initial",delay:m?0:Wn.default,duration:m?0:Wn.slow,children:c.jsxs("span",{className:O("flex items-center text-lg-strong",!o&&C&&"max-md:hidden",!t&&C&&"hidden"),children:[c.jsx(St,{url:Que,className:"h-[18px] w-[58px]"}),b&&c.jsx(Au,{text:"BETA",className:"ms-2 uppercase"})]})})]})}),c.jsxs("div",{className:O("pointer-events-auto relative mx-1 flex shrink-0 items-center gap-0.5",T&&"md:hidden"),"data-theme":i&&!t?i.theme:void 0,ref:P,children:[c.jsx(It,{children:w&&c.jsx(he.div,{className:O("pointer-events-auto absolute border border-stroke-100 shadow-md dark:border-stroke-300","-inset-1 rounded-2xl",lo),initial:"initial",animate:"animate",exit:"exit",variants:{initial:je,animate:rt,exit:je},transition:m?{duration:0}:zn})}),c.jsx(ee,{title:d(t?"sidebar.close":"sidebar.open"),tooltip:GS,className:O("after:absolute after:inset-0 after:rounded-xl max-md:hover:after:bg-black/3 max-md:dark:after:hover:bg-white/5",!C&&"hover:after:bg-black/3 dark:after:hover:bg-white/5",C&&t&&"md:cursor-w-resize",C&&!t&&"md:cursor-e-resize"),color:"subtle-dimmed-inverted",variant:"square",size:"36-sm",onClick:()=>{de({source:"sidebarToggle",pageName:p,customData:JSON.stringify({isOpen:t})}),n()},testId:"sidebar-toggle-button",children:c.jsx(Qd,{className:"size-5"})}),s&&c.jsx(ee,{title:d("sidebar.conversationSearch.search"),className:"hidden after:absolute after:inset-0 after:rounded-xl hover:after:bg-black/3 dark:hover:after:bg-white/5 md:flex",color:"subtle-dimmed-inverted",variant:"square",size:"36-sm",onClick:async()=>{if(!I){await x({to:"/login",from:p});return}s()},children:c.jsx(em,{className:"size-5"})}),c.jsxs("div",{className:"flex rounded-xl safe-hover:bg-black/3 dark:safe-hover:bg-white/5 max-md:active:bg-black/3 max-md:dark:active:bg-white/5",children:[c.jsx(ee,{title:d("composer.startNewChat"),tooltip:GS,color:"subtle-dimmed-inverted",variant:"square",size:"36-sm",className:O("rounded-sm rounded-s-xl max-md:w-[34px]",T?"md:w-10":"w-[34px]"),onClick:async()=>{S&&(de({source:"sidebarNewConversation",destination:"/chat",pageName:p,customData:JSON.stringify({isOpen:t})}),await a())},testId:"sidebar-new-conversation-button",children:c.jsx(Jd,{className:"size-5"})}),c.jsx(g3,{buttonSize:"36-sm"})]}),b&&c.jsx(Au,{text:d("settings.copilotBeta.beta"),className:O("relative m-2 uppercase",t&&o&&"max-md:hidden",(t||C)&&"md:hidden")})]})]})})})}const ede=l.lazy(()=>N(()=>import("./sidebar-search-content-DITO8o6N.js"),__vite__mapDeps([431,1,2])).then(e=>({default:e.SidebarSearchContent})));function tde(e){const{isSidebarAtomSynced:t=!0,isSidebarTranslucent:n}=e,{t:o}=Z(),[s,a]=Le(To),[r,i]=l.useState(!1),d=Yc(),m=gt({breakpoint:"md"}),[p,h]=l.useState(m),g=l.useRef(m),y=l.useRef(null),b=J.instance().config().useCompactSidebarHeader??!1,C=J.instance().config().isSidebarSmokeLayerVisible??!0;K1(()=>{m&&a(!1)});const T=Kc(),S=q("conversation-search"),E=r&&s&&S,I=!E;l.useEffect(()=>{g.current===!1&&m&&a(!1),g.current===!0&&!m&&a(EI()==="open"),g.current=m,h(m)},[m,a]),Xo({onOutsideEvent:()=>a(!1),elements:[y],shouldAttachListeners:s&&!C&&m,includeScroll:!1,invokeOnce:!1,includeFocus:!1});const x=()=>{a(!s),m||ZM(s?"close":"open")};return c.jsxs(c.Fragment,{children:[c.jsx(It,{children:p&&s&&C&&c.jsx(he.div,{className:O("fixed inset-0 bg-black/30",!t&&"hidden"),onClick:()=>a(!1),initial:"initial",animate:"animate",exit:"exit",variants:{initial:je,animate:rt,exit:je},transition:zn})}),c.jsxs(he.div,{ref:y,className:Ae("relative w-full",n?"bg-white/10 backdrop-blur-md":"bg-sidebar-light dark:bg-sidebar-dark",!C&&"shadow-lg"),layout:"position",role:"navigation","data-testid":"sidebar-container",children:[c.jsx(s0,{elementTiming:l3.SIDEBAR}),!s&&c.jsx("button",{onClick:x,type:"button",className:"absolute size-full cursor-e-resize outline-none max-md:hidden","aria-label":o("sidebar.open")}),I&&(b?c.jsx(vue,{isSidebarOpen:s,toggle:x}):c.jsx("div",{"data-theme":n?"dark":void 0,children:c.jsx(Xue,{isSidebarOpen:s,toggle:x,isSidebarAtomSynced:t,onOpenConversationSearch:S?()=>i(!0):void 0})})),c.jsx(It,{children:c.jsx(he.div,{className:O("overflow-hidden",!s&&!T&&"hidden",s&&!t&&"max-md:hidden"),animate:"animate",exit:"exit",variants:{animate:rt,exit:je},transition:d?{duration:0}:zn,children:E?c.jsx(Cs,{fallback:c.jsx("div",{className:"h-screen w-sidebar"}),children:c.jsx(ede,{onCancel:()=>i(!1)})}):c.jsx(Jue,{toggle:x,isSidebarTranslucent:n,onOpenConversationSearch:S?()=>i(!0):void 0})})})]})]})}const nde=260,ode=52,sde=()=>{const e=qr(),t=gt({breakpoint:"md"});return e&&!t?ode:0},ade={"wchromium-home":"pt-0 md:pt-0","wchromium-default":"pt-10 md:pt-10"},rde="bg-sidebar-light dark:bg-sidebar-dark";function ide(e){const{children:t,background:n,borderless:o,paddingTop:s}=e,a=gt({breakpoint:"md"}),r=Vs(),d=M(To)&&r,[m,p]=l.useState(!1),h=M(ia),g=M(Lg),y=u3(),b=qr(),C=Yc(),T=ba(),S=G(To),[E,I]=l.useState(!1);l.useEffect(()=>{T&&!E&&(a&&S(!1),I(!0))},[T,a,S,E]);const x=r&&(d||b),w=Kc(),P=y?"100%":nde,D=sde(),L=h||!!g,j=E?{width:d?P:D}:{},U=n&&(!d||w);return c.jsxs("div",{className:Ae("flex h-full overflow-hidden",rde),inert:L?!0:void 0,children:[n,r&&c.jsx(he.div,{className:Ae("absolute h-full w-0 will-change-auto max-md:bg-sidebar-light max-md:dark:bg-sidebar-dark md:relative",d?"md:w-sidebar":"md:w-sidebar-narrow",at.sidebar),animate:j,transition:C?{duration:0}:zn,onAnimationStart:()=>p(!0),onAnimationComplete:()=>p(!1),children:c.jsx(tde,{isSidebarAtomSynced:E,isSidebarTranslucent:!!U})}),c.jsx("main",{className:O("relative flex w-full min-w-0 will-change-auto",!U&&"after:pointer-events-none after:fixed after:inset-2 after:z-30 after:rounded-container after:border after:border-transparent after:opacity-0 after:transition-opacity after:duration-0",x&&!m&&"md:after:opacity-100 md:after:duration-1000",w?"after:start-sidebar-narrow":"after:start-sidebar",!o&&["dark:after:border-white/12 dark:after:border-s-white/8",x&&"md:py-1.5 md:pe-1.5"],s&&ade[s]),children:t}),c.jsx(s0,{elementTiming:l3.LAYOUT})]})}function tm(e){const{children:t,className:n,backgroundColor:o,showBackground:s=!0}=e,a=Vs(),r=qr(),i=sn(),d=ao(i);return c.jsxs("div",{className:O("relative h-full overflow-hidden",n),children:[c.jsx("div",{className:Ae("absolute size-full",a&&"md:t-main-clip-path"),children:s&&c.jsx(Bs,{customColor:o,isFixed:!0})}),c.jsx("div",{className:Ae("relative size-full",!d&&"overflow-hidden",a&&r&&"md:rounded-container"),children:t})]})}const cde=2;function R3(){const e=M(Oq),t=js(),n=W1(),o=M(Uq),s=M(a1);let a=!1;return(t||n)&&!o&&!s&&(yue()===Jc.LabsTryButton?a=!0:a=(qt(au,k())??0)>=cde),{noModalToShow:!a&&!e,shouldShowEducationModal:a,isAppearanceEducationModalDisplayed:e,isAppearanceEducationModalClicked:o}}const As={CLOSE_BUTTON:"closeButton",ONE_LINE_COMPOSER:"oneLineComposer",IMAGE_VIEWER:"imageViewer",NONE:"none"},Yr=_(),lde=_(e=>{const t=e(Yr);if(!(!t||!Array.isArray(t.media)||typeof t.currentMediaIndex!="number"))return t.media[t.currentMediaIndex]});function ude(){return M(lde)}function dde(e){const t=B(Te);en({source:e.source??"defaultMediaViewerSource",scenario:"mediaViewerOpen",messageId:e.messageId,conversationId:t})}function mde(){const e=B(Yr),t=B(Te);e&&en({source:"mediaViewer",scenario:"mediaViewerNext",messageId:e.messageId,conversationId:t})}function pde(){const e=B(Yr),t=B(Te);e&&en({source:"mediaViewer",scenario:"mediaViewerPrevious",messageId:e.messageId,conversationId:t})}function WS(){const e=B(Yr),t=B(Te);e&&en({source:"mediaViewer",scenario:"mediaViewerClose",messageId:e.messageId,conversationId:t})}async function fde(e,t){const n=t??Ox(),s=await(await fetch(e)).blob(),a=URL.createObjectURL(s),r=document.createElement("a");r.href=a,r.download=n,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(a)}const hde=_();function N3(){const[e,t]=Le(hde),n=l.useCallback(a=>{t(a),de({source:"mediaViewer",scenario:"PictureInPictureOpen"})},[t]),o=l.useCallback(()=>{t(void 0)},[t]);return{isPictureInPictureOpen:e!==void 0,openPictureInPicture:n,closePictureInPicture:o}}function gde(e){const t=fn(new Date,"yyyyMMdd_HHmmss");return{filename:`${e}_${t}.mp4`}}function Ro(){const[e,t]=Le(Yr),n=G(fc),{openPictureInPicture:o}=N3(),{t:s}=Z(),a=q("viewer-inner-action-buttons"),r=l.useCallback(()=>{const{onClose:E}=e??{};WS(),n(!1),t(void 0),E?.()},[t,e,n]),i=l.useCallback(()=>{mde(),t(E=>{if(!E)return E;if(E.currentMediaIndex<E.media.length-1){const I=E.currentMediaIndex+1;return{...E,currentMediaIndex:I,isCurrentMediaLoading:hp(E.media[I])}}return E})},[t]),d=l.useCallback(()=>{pde(),t(E=>{if(!E)return E;if(E.currentMediaIndex>0){const I=E.currentMediaIndex-1;return{...E,currentMediaIndex:I,isCurrentMediaLoading:hp(E.media[I])}}return E})},[t]),m=l.useCallback(E=>{const I=a&&E.contentComposerType===void 0?{showInnerActionButtons:!0,contentComposerType:As.NONE}:{},x={...E,...I,isCurrentMediaLoading:hp(E.media[E.currentMediaIndex])};dde(x),n(!1),t(x)},[t,n,a]),p=e?.media[e.currentMediaIndex],h=p?.type==="video",g=e?.source==="videoActionCard"||e?.source==="library",y=h&&g,b=h&&!y,C=l.useCallback(()=>{if(p&&p.type==="video"){const{player:E}=p;o({url:p.url,title:p.source?.title??"",startTime:E?.getCurrentTime()??0}),WS(),t(void 0)}},[o,t,p]),T=l.useCallback(()=>{if(!y)return;const{filename:E}=gde(s("video.downloadFileName"));fde(p.url,E)},[y,p,s]),S=e?.contentComposerType??As.CLOSE_BUTTON;return l.useMemo(()=>({openMediaViewer:m,closeMediaViewer:r,isMediaViewerOpen:e!==void 0,next:i,previous:d,isPictureInPictureSupported:b,triggerPictureInPicture:C,contentComposerType:S,showOneLineComposerWhenMediaViewerOpen:S===As.ONE_LINE_COMPOSER,contentPageType:e?.contentPageType,triggerVideoDownload:y?T:void 0}),[m,r,e,i,d,b,C,S,y,T])}function hp(e){if(e&&"initLoading"in e)return e.initLoading}function vde(){const e=sn(),{isAppearanceEducationModalDisplayed:t}=R3(),{isMediaViewerOpen:n}=Ro(),o=["/subscription/pricing","/subscription/ewallet/return","/subscription/manage","/subscription/start","/connector/callback"],s=M1(),a=!e.startsWith("/labs")||e==="/labs/portrait/talk";return!o.includes(e)&&!e.startsWith("/topic-selection")&&(!e.startsWith("/fang")||n)&&!e.startsWith("/login")&&e!=="/e/so"&&e!=="/e/sol"&&!e.startsWith("/gaming")&&(!e.startsWith("/library")||n)&&!e.startsWith("/conversations")&&!e.startsWith("/campaigns")&&!e.startsWith("/pages")&&!e.startsWith("/shares/pages")&&!e.startsWith("/research")&&!e.startsWith("/shares/3d-generations")&&!Q1(e)&&a&&!t&&!s&&!e.startsWith("/shares/tasks")}function yde(){const[e,t]=Le(fue);return l.useEffect(()=>{async function n(){const s=await(J.instance().config().isCommandHeaderSupported??(()=>Promise.resolve(!1)))();t(s)}n().catch(()=>{})},[t]),e}const Cde=16/9,Sde=48,L3=296,bde=L3/Cde,Ide=bde+Sde;function Ede(){return c.jsx("div",{className:"pointer-events-none absolute inset-0 me-4 ms-2 mt-[72px]",children:c.jsx("div",{className:"absolute bottom-0 end-4",style:{width:`${L3}px`,height:`${Ide}px`},children:c.jsx("div",{className:Ae("relative flex h-full flex-col overflow-hidden rounded-4xl","bg-acrylic-default-fallback-light/[98] dark:bg-acrylic-default-fallback-dark/[98]"),style:{boxShadow:"0px 16px 24px -2px rgba(0, 0, 0, 0.12)"},children:c.jsx("div",{className:"flex h-full items-center justify-center",children:c.jsx(xt,{className:"size-12"})})})})})}class D3{audioContext;audioAnalyser;destinationNode;destinationCleanup;get isInitialized(){return this.audioContext!==void 0&&this.audioContext.state!=="closed"}async initialize({sampleRate:t,reuseAudioContextDuringCall:n,audioCategory:o="ambient"}){if(this.audioContext){if(n){if(this.audioAnalyser)try{this.audioAnalyser.disconnect()}catch{}this.audioAnalyser=this.audioContext.createAnalyser();return}await this.cleanup()}try{this.audioContext=new AudioContext({sampleRate:t});const{destination:s,cleanup:a}=this.getDestination(this.audioContext,o);this.destinationNode=s,this.destinationCleanup=a,this.audioAnalyser=this.audioContext.createAnalyser()}catch(s){const a=s instanceof Error?s.message:String(s);throw new Error(`Failed to initialize audio context: ${a}`)}}async cleanup(){if(this.destinationCleanup?.(),this.destinationCleanup=void 0,this.destinationNode=void 0,this.audioContext&&this.audioContext.state!=="closed")try{await this.audioContext.close()}catch(t){t instanceof DOMException&&t.name==="InvalidStateError"||Je({feature:"AudioContextManager",scenario:"cleanup",errorType:"AudioContextCloseError",errorMessage:t instanceof Error?t.message:String(t)})}this.audioContext=void 0,this.audioAnalyser=void 0}getDestination(t,n){if(n==="ambient"||!t.createMediaStreamDestination)return{destination:t.destination,cleanup:()=>{}};const o=t.createMediaStreamDestination(),s=new Audio;return s.srcObject=o.stream,s.play().catch(a=>{Je({feature:"AudioContextManager",scenario:"playback",errorType:"playMediaStreamDestination",errorMessage:a instanceof Error?a.message:String(a)})}),{destination:o,cleanup:()=>{s.pause(),s.srcObject=null,o.disconnect()}}}}class O3{mode;volumeUpdateRaf=-1;audioAnalyser;volume=or(0);constructor(t){this.mode=t}startTracking(t){this.audioAnalyser&&this.stopTracking(),this.audioAnalyser=t,this.trackVolume()}trackVolume(){if(!this.audioAnalyser){this.stopTracking();return}const t=new Uint8Array(this.audioAnalyser.frequencyBinCount);this.audioAnalyser.getByteTimeDomainData(t);const n=yte(t);Math.abs(n-this.volume.get())>hte&&(this.volume.set(n),$C(n,this.mode)),this.volumeUpdateRaf=requestAnimationFrame(()=>{this.trackVolume()})}stopTracking(){this.volumeUpdateRaf!==-1&&(cancelAnimationFrame(this.volumeUpdateRaf),this.volumeUpdateRaf=-1),this.audioAnalyser=void 0,this.volume.set(0),$C(0,this.mode)}}function h_e(e){}const Tde=2,wde=300;class Ade extends EventTarget{audioContextManager=new D3;volumeTracker=new O3("output");get audioContext(){return this.audioContextManager.audioContext}outputGainNode=null;outputSourceNodes=new Set;audioDuration=0;nextBufferTime=0;audioOffset=0;currentPlaybackRate=1;audioStarted=!1;audioChunksLoadDone=!1;preBufferedDuration=0;get isReusingAudioContext(){return W("reuse-audio-context-for-voice-output")}get audioPlaying(){return this.audioContext?.state==="running"}get audioEnded(){return this.audioChunksLoadDone&&this.outputSourceNodes.size===0}get playbackTime(){if(!this.audioContext||this.audioContext.state==="closed")return 1/0;const{currentTime:t,outputLatency:n}=this.audioContext;return(t-(n||0)-this.audioOffset)*this.currentPlaybackRate}hasEnoughBufferToPlay(){return this.audioChunksLoadDone?!0:this.outputSourceNodes.size>=Tde||this.preBufferedDuration*1e3>=wde}get volume(){return this.volumeTracker.volume}async initialize(t,n,o){this.audioContextManager.isInitialized&&await this.stopAudioPlayback(),this.currentPlaybackRate=KA(t);try{await this.audioContextManager.initialize({sampleRate:n,reuseAudioContextDuringCall:this.isReusingAudioContext,audioCategory:o}),this.audioContext?.suspend()}catch(s){throw this.onAudioError(s),s}this.audioDuration=0,this.nextBufferTime=0,this.audioOffset=0,this.audioStarted=!1,this.audioChunksLoadDone=!1,this.preBufferedDuration=0,this.setUpOutputVolumeTracking()}setUpOutputVolumeTracking(){const{audioContext:t,audioAnalyser:n,destinationNode:o}=this.audioContextManager;!t||!n||!o||(this.outputGainNode=t.createGain(),this.outputGainNode.connect(n),n.connect(o),this.volumeTracker.startTracking(n))}appendAudioSource(t){if(!this.audioContext||!this.outputGainNode||!t.buffer)return;this.outputSourceNodes.add(t),t.connect(this.outputGainNode);const n=()=>{if(this.outputSourceNodes.delete(t),t.buffer){const a=t.buffer.length/t.buffer.sampleRate;this.preBufferedDuration=Math.max(0,this.preBufferedDuration-a)}this.outputSourceNodes.size===0&&(this.audioChunksLoadDone?this.stopAudioPlayback():(this.audioContext?.suspend(),this.dispatchEvent(new CustomEvent("audioSuspend")),this.onAudioSuspend()))};t.addEventListener("ended",n,{once:!0}),this.nextBufferTime<this.audioContext.currentTime&&(this.audioOffset+=this.audioContext.currentTime-this.nextBufferTime,this.nextBufferTime=this.audioContext.currentTime),t.start(this.nextBufferTime);const o=t.buffer.length/t.buffer.sampleRate;this.nextBufferTime+=o,this.audioDuration+=o,this.preBufferedDuration+=o,(!W("enable-audio-out-pre-buffering")||this.hasEnoughBufferToPlay())&&this.startPlayback()}async startPlayback(){if(this.audioContext&&this.audioContext.state!=="closed")try{await this.audioContext.resume(),this.audioStarted||(this.audioStarted=!0,this.dispatchEvent(new CustomEvent("audioStart")),void 0),this.onAudioResume()}catch(t){this.onAudioError(t)}}setAudioDone(){this.setAudioChunksLoadDone(),this.outputSourceNodes.size>0&&this.startPlayback()}setAudioChunksLoadDone(){this.audioChunksLoadDone=!0}async stopAudioPlayback(){for(const t of this.outputSourceNodes)t.stop();this.outputSourceNodes.clear(),this.setAudioChunksLoadDone(),this.volumeTracker.stopTracking(),this.isReusingAudioContext||await this.audioContextManager.cleanup(),this.audioStarted&&(this.audioStarted=!1,this.onAudioEnd(),this.dispatchEvent(new CustomEvent("audioEnd")))}async cleanUpAudioContextAfterCallIfNeeded(){this.isReusingAudioContext&&await this.audioContextManager.cleanup()}onAudioError(t){this.dispatchEvent(new CustomEvent("error",{detail:t}))}onAudioSuspend(){}onAudioEnd(){}onAudioResume(){}}class xde{ENERGY_THRESHOLD_MULTIPLIER=3;SILENCE_DURATION=500;MIN_SPEECH_DURATION=300;ZERO_CROSSING_MIN=.01;ZERO_CROSSING_MAX=.5;MAX_VALID_LATENCY_MS=2e3;AUDIO_SAMPLE_OFFSET=128;audioAnalyser;voiceDetectionRaf=-1;voiceDetectionActive=!1;energyHistory=[];noiseFloor=.01;isSpeaking=!1;silenceStartTime=0;lastVoiceDetectionTime=0;lastClientSideVoiceEndTime=null;serverVADLatencyMeasurements=[];onClientSideVoiceStartDetected;onClientSideVoiceEndDetected;startVoiceDetection(t){this.voiceDetectionActive&&this.stopVoiceDetection(),!(typeof window>"u")&&(this.audioAnalyser=t,this.voiceDetectionActive=!0,this.energyHistory=[],this.noiseFloor=.01,this.isSpeaking=!1,this.silenceStartTime=0,this.lastVoiceDetectionTime=Date.now(),this.lastClientSideVoiceEndTime=null,this.serverVADLatencyMeasurements=[],this.performVoiceDetection())}stopVoiceDetection(){this.voiceDetectionRaf!==-1&&(cancelAnimationFrame(this.voiceDetectionRaf),this.voiceDetectionRaf=-1),this.voiceDetectionActive=!1,this.audioAnalyser=void 0,this.displayServerVADLatencyStatistics()}setOnClientSideVoiceStartDetected(t){this.onClientSideVoiceStartDetected=t}setOnClientSideVoiceEndDetected(t){this.onClientSideVoiceEndDetected=t}getLastClientVoiceEndTime(){return this.lastClientSideVoiceEndTime?this.lastClientSideVoiceEndTime-this.SILENCE_DURATION:null}onServerSpeechEndDetected(){if(`${this.lastClientSideVoiceEndTime}`,`${this.voiceDetectionActive}${this.isSpeaking}`,!this.lastClientSideVoiceEndTime)return null;const t=Date.now(),n=this.lastClientSideVoiceEndTime-this.SILENCE_DURATION,o=t-n;return`${t}${this.lastClientSideVoiceEndTime}${n}${o}`,o>=0&&o<=this.MAX_VALID_LATENCY_MS?(this.serverVADLatencyMeasurements.push(o),o):null}getLastServerVADLatency(){return this.serverVADLatencyMeasurements[this.serverVADLatencyMeasurements.length-1]??null}performVoiceDetection(){if(!this.voiceDetectionActive||!this.audioAnalyser){`${this.voiceDetectionActive}`,this.audioAnalyser;return}try{const t=this.audioAnalyser.frequencyBinCount,n=new Uint8Array(t);this.audioAnalyser.getByteTimeDomainData(n);const o=new Float32Array(t);for(let r=0;r<t;r+=1){const i=n[r];i!==void 0&&(o[r]=(i-this.AUDIO_SAMPLE_OFFSET)/this.AUDIO_SAMPLE_OFFSET)}const s=this.advancedVoiceDetection(o),a=Date.now();s?(this.isSpeaking||a-this.lastVoiceDetectionTime>this.MIN_SPEECH_DURATION&&(this.isSpeaking=!0,this.onClientSideVoiceStartDetected?.()),this.silenceStartTime=0,this.lastVoiceDetectionTime=a):this.isSpeaking&&(this.silenceStartTime===0?this.silenceStartTime=a:a-this.silenceStartTime>this.SILENCE_DURATION&&(this.isSpeaking=!1,this.lastClientSideVoiceEndTime=a,this.onClientSideVoiceEndDetected?.()))}catch{}this.voiceDetectionRaf=requestAnimationFrame(()=>{this.performVoiceDetection()})}advancedVoiceDetection(t){let n=0,o=0;for(let p=0;p<t.length;p+=1){const h=t[p];if(h!==void 0&&(n+=h*h,p>0)){const g=t[p-1];g!==void 0&&g>=0!=h>=0&&(o+=1)}}n=Math.sqrt(n/t.length);const s=o/t.length;if(this.energyHistory.push(n),this.energyHistory.length>100){this.energyHistory.shift();const p=[...this.energyHistory].sort((g,y)=>g-y),h=p[Math.floor(p.length*.1)];h!==void 0&&(this.noiseFloor=h)}const a=this.noiseFloor*this.ENERGY_THRESHOLD_MULTIPLIER,i=n-this.noiseFloor>a,d=s>this.ZERO_CROSSING_MIN&&s<this.ZERO_CROSSING_MAX;return i&&d}displayServerVADLatencyStatistics(){if(this.serverVADLatencyMeasurements.length===0)return;const t=this.serverVADLatencyMeasurements,n=t.length,o=t.reduce((s,a)=>s+a,0)/n;[...t].sort((s,a)=>s-a),Math.min(...t),Math.max(...t),`${o.toFixed(1)}`,`${t.join(", ")}`}}const _de="/static/cmc/assets/call_ending-BxIIadI4.mp3",kde="/static/cmc/assets/call_opening-CKuCznU5.mp3";function Pde(){const e=Zt(),t=js(),n=Pc(["study-mode-lumi","study-mode-summary"],"any"),o=q("tv-new-lumi");return t||e==="study"&&n||o}function Mde(){const e=Ore(),t=W("tv-new-lumi");return e||t||co()==="study"&&Mc(["study-mode-lumi","study-mode-summary"],"any")}const g_e={lmks_rest:"lmksRest",frames:"frames",expr:"expr",neck_pose:"neckPose",jaw_pose:"jawPose",eyes_pose:"eyesPose",eyes_open_ratio:"eyesOpenRatio",rotation:"rotation",translation:"translation",lmks:"lmks"};class Rde{lmksRest;frames;constructor(t,n){this.lmksRest=t,this.frames=n}}class Nde{exp;pose;constructor(t,n){this.exp=t,this.pose=n}isValid(){return this.exp.dtype!==""&&this.exp.data.length>0||this.pose.dtype!==""&&this.pose.data.length>0}}const{EPSILON:Gf}=Number,Lde=["Viseme_Neutral","Viseme_AI","Viseme_E","Viseme_U","Viseme_CDG","Viseme_WQ","Viseme_O","Viseme_L","Viseme_ShCh","Viseme_FV","Viseme_MBP"],Dde=[0,1,1,6,2,3,4,5,6,1,6,1,2,5,7,4,8,7,9,4,4,10],Es={enablePose:!1,enableNeck:!1,enableEye:!1,enableEyebrow:!1};function v_e(e){Es.enablePose=e,Es.enableNeck=e,Es.enableEye=e,Es.enableEyebrow=e}function Ode(e,t=null){const{Quaternion:n,Vector3:o}=Ct.getCore(),s=.3,a=.5,r=30/360*Math.PI,i=1,d=.01,m=["eye_BlinkUp","eye_Squint","eye_RSquare"],p=[.5,.2,.2],h=.5,g=.3,y=n.RotationAxis(o.Right(),Math.PI/4),b=y.conjugate(),C=new o(i,i,i),T=new o(-1,-1,-1),S={pose:{translation:new o(0,0,0),rotation:n.Identity()},expression:{eyes_open_ratio:0,eye_BlinkUp:0,eye_Squint:0,eye_RSquare:0,eyebrow_value:0,eyebrow_height:0,eyebrow_bend:0,viseme:new Array(11).fill(0),viseme22_idx:0,viseme11_idx:0},offset:e.offset??null};if(Es.enablePose){let I=$S(e.rotation);if(Es.enableNeck){const D=$S(e.neckPose);I.multiplyInPlace(D)}I=y.multiplyToRef(I,I).multiplyToRef(b,I);let[x,w]=Fde(I);w>r&&(w=r),S.pose.rotation=n.RotationAxis(x,w);const P=o.FromArray(e.translation);o.ClampToRef(P,T,C,P),S.pose.translation=P}const E=e.eyesOpenRatio[0]??0;if(S.expression.eyes_open_ratio=E,Es.enableEye&&t!==null){let I=0,x=0,w=0;if(t.expression.eye_BlinkUp>0)E<.9&&(I=1,x=0,w=0);else if(t.expression.eye_Squint>0)E<.9&&(I=0,x=h,w=0);else if(t.expression.eye_RSquare>0)E>1.1&&(I=0,x=0,w=g);else{const P=t.expression.eyes_open_ratio;E<.75&&P<.8?(I=1,x=0,w=0):E<.8&&P<.85?(I=0,x=h,w=0):E>1.1&&(I=0,x=0,w=g)}S.expression.eye_BlinkUp=I,S.expression.eye_Squint=x,S.expression.eye_RSquare=w}if(Es.enableEyebrow){const I=e.viseme.slice(1,4);S.expression.eyebrow_value=e.viseme[2]??0,S.expression.eyebrow_height=OS(((I[1]??0)-0)*2)*d,S.expression.eyebrow_bend=OS((0-(I[1]??0))*3)}{const I=Math.round(e.viseme[0]??0),x=Dde[I]??0;S.expression.viseme[x]=1,t!==null&&t.expression.viseme22_idx!==I&&(S.expression.viseme[x]=.9),S.expression.viseme22_idx=I,S.expression.viseme11_idx=x}if(t!==null){for(const[L,j]of m.entries()){const U=p[L]??0;S.expression[j]=qS(t.expression[j],S.expression[j],0,U)}const I=S.expression.viseme,x=t.expression.viseme;if((I[10]??0)<1e-6)for(let L=0;L<Lde.length;L+=1)I[L]=qS(x[L]??0,I[L]??0,0,s);const P=S.pose.translation,D=t.pose.translation;S.pose.translation=new o(P.x*a+D.x*(1-a),P.y*a+D.y*(1-a),P.z*a+D.z*(1-a))}return S}function Ude(e){const{TmpVectors:t,Vector3:n}=Ct.getCore(),o=t.Vector3[0];o.fromArray(e);const s=o.length();return s<Gf?[n.Up(),0]:[o.scale(1/s),s]}function $S(e){const{Quaternion:t}=Ct.getCore(),[n,o]=Ude(e);return t.RotationAxis(n,o)}function Fde(e){const{Vector3:t}=Ct.getCore(),n=e.lengthSquared();Math.abs(n-1)>Gf&&e.normalize();const o=Math.acos(e.w),s=o*2,a=Math.sin(o),r=Math.abs(a)<5e-4?1:a,i=new t(e.x/r,e.y/r,e.z/r);return i.lengthSquared()<Gf&&(i.y=1),[i,s]}function qS(e,t,n,o){return Math.abs(t-e)<n?e:e<t?Math.min(e+o,t):Math.max(e-o,t)}function jde(e,t,n){const{Vector3:o,Quaternion:s}=Ct.getCore(),{Lerp:a}=Ct.getMath();return{pose:{translation:o.Lerp(e.pose.translation,t.pose.translation,n),rotation:s.Slerp(e.pose.rotation,t.pose.rotation,n)},expression:{eyes_open_ratio:0,eye_BlinkUp:a(e.expression.eye_BlinkUp,t.expression.eye_BlinkUp,n),eye_Squint:a(e.expression.eye_Squint,t.expression.eye_Squint,n),eye_RSquare:a(e.expression.eye_RSquare,t.expression.eye_RSquare,n),eyebrow_value:0,eyebrow_height:a(e.expression.eyebrow_height,t.expression.eyebrow_height,n),eyebrow_bend:a(e.expression.eyebrow_bend,t.expression.eyebrow_bend,n),viseme:new Array(11).fill(0).map((i,d)=>a(e.expression.viseme[d]??0,t.expression.viseme[d]??0,n)),viseme22_idx:0,viseme11_idx:0}}}const Bde=3.141592653589793,KS="System.Single, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089";function Vde(e){const t=[],n=[],o=(i,d)=>{if(d>=i.length)throw new Error("index out of range");return i[d]===void 0?0:i[d]};for(const{frame:i,offset:d}of e){if(i.length<97)return console.log("Invalid frame length"),null;const m=new Array(28).fill(0);m[12]=o(i,78),m[16]=o(i,43),m[17]=o(i,43),m[21]=o(i,72),m[23]=.5*o(i,52)+.5*o(i,53),m[24]=.75*o(i,76),m[26]=.75*o(i,76),t.push({exp:m,offset:d});const p=[[-1*o(i,88)+Bde,-1*o(i,89),o(i,90)],[0,o(i,92),-1*o(i,91)],[0,o(i,95),-1*o(i,94)]];n.push(p)}const s={dtype:KS,shape:[t.length,16],data:t,isColumnMajor:!1},a={dtype:KS,shape:[n.length,3,3],data:n,isColumnMajor:!1};return new Nde(s,a)}class Hde{constructor(t){this.getPlayTime=t}activeModel=null;a2eAnimationData=null;vasaAnimationData=null;vasaExpFrames=[];frameOffsetTimeAvailable=!1;currentFrameIndex=0;get fps(){return this.activeModel==="spda2e"?jz:this.activeModel==="vasa"?Bz:25}get frameCount(){return this.activeModel==="spda2e"&&this.a2eAnimationData?this.a2eAnimationData.exp.data.length:this.activeModel==="vasa"&&this.vasaAnimationData?this.vasaAnimationData.frames.length:0}get playbackTime(){return this.getPlayTime()}reset(){this.activeModel=null,this.a2eAnimationData=null,this.vasaAnimationData=null,this.vasaExpFrames=[],this.frameOffsetTimeAvailable=!1,this.currentFrameIndex=0}setFrameData({frame:t,offsetInMilliseconds:n}){t&&(this.activeModel=t.model,t.model==="spda2e"&&this.setA2EFrame(t.poseDiffusion,n),t.model==="vasa"&&this.setVasaFrameData(t,n))}setA2EFrame(t,n){if(!t?.length)return;const o=Vde([{frame:t,offset:n}]);if(o){if(!this.a2eAnimationData){this.a2eAnimationData=o;return}this.a2eAnimationData.exp.data.push(...o.exp.data),this.a2eAnimationData.pose.data.push(...o.pose.data),this.frameOffsetTimeAvailable=this.a2eAnimationData.exp.data.every(({offset:s})=>!Number.isNaN(s))}}setVasaFrameData(t,n){if(!t)return;const o={...t,offset:n};if(!this.vasaAnimationData){this.vasaAnimationData=new Rde([],[o]);return}this.vasaExpFrames.push(Ode(o,this.vasaExpFrames.at(-1))),this.vasaAnimationData.frames.push(o),this.frameOffsetTimeAvailable=this.vasaAnimationData.frames.every(({offset:s})=>!Number.isNaN(s))}getCurrentFrameIndex(t){if(this.frameOffsetTimeAvailable){let n=this.currentFrameIndex;for(;n<t.length;n+=1){this.currentFrameIndex=n;const o=t[n];if(o?.offset!==void 0&&o.offset!==null&&o.offset/1e3>=this.playbackTime)break}return n}return Math.round(this.playbackTime/(1/this.fps))}getCurrentA2EFrame(){if(!this.a2eAnimationData)return null;const t=this.a2eAnimationData.exp.data;return this.currentFrameIndex=this.getCurrentFrameIndex(t),t[this.currentFrameIndex]??null}getCurrentVasaFrame(){if(!this.vasaAnimationData)return null;const{frames:t,lmksRest:n}=this.vasaAnimationData;this.currentFrameIndex=this.getCurrentFrameIndex(t);const o=t[this.currentFrameIndex];return o?{frame:o,lmksRest:n}:null}getCurrentVasaExpFrame(){if(!this.vasaAnimationData)return null;this.currentFrameIndex=this.getCurrentFrameIndex(this.vasaExpFrames);const t=this.vasaExpFrames[this.currentFrameIndex-1],n=this.vasaExpFrames[this.currentFrameIndex];if(t&&n&&this.playbackTime<(n.offset??1/0)/1e3){const o=this.playbackTime-(t.offset??0)/1e3;return jde(t,n,o)}return n??null}}const zde="network-indicator";class Gde{isOnline=!0;activeIndicatorId=null;onOnlineStatusChange(t){this.isOnline=t,t||this.dismissActiveIndicator()}showIndicator(t){if(!this.isOnline)return;const n=this.buildIndicatorId(t);if(this.activeIndicatorId===n&&B(yt)?.id===this.activeIndicatorId)return;this.activeIndicatorId=n,Ee(yt,{id:this.activeIndicatorId,title:F("common.networkUnstableTitle"),subtitle:F("common.networkUnstableSubtitle"),dismissable:!0,onDismiss:()=>{this.activeIndicatorId=null}});const o=B(Te);R.trackEvent({name:"system",data:{eventName:"networkIndicatorShown",eventInfo_conversationId:o,eventInfo_source:t.source,eventInfo_reason:t.reason,eventInfo_customData:t.customData}})}dismissActiveIndicator(){this.activeIndicatorId&&(HW(this.activeIndicatorId),this.activeIndicatorId=null)}buildIndicatorId(t){return`${zde}:${t.source}:${t.reason}`}}const Wde=new Gde,YS=1e3,$de=3,ZS="voice-call",JS="audio-stutter";class qde{hasTriggered=!1;timerId=null;get isIndicatorEnabled(){return W("voice-network-indicator")}evaluate(t){if(this.hasTriggered)return;const n=t.reduce((s,a)=>s+a,0),o=t.length;if(n>YS&&o>=$de){this.onSlowNetwork(),this.cancelPending();return}this.timerId??=window.setTimeout(()=>{this.onSlowNetwork()},YS)}cancelPending(){this.timerId&&(window.clearTimeout(this.timerId),this.timerId=null)}onSlowNetwork(){if(this.hasTriggered)return;this.hasTriggered=!0,this.cancelPending();const t=B(Te);R.trackEvent({name:"system",data:{eventName:"slowNetworkDetected",eventInfo_conversationId:t,eventInfo_source:ZS,eventInfo_reason:JS}}),this.isIndicatorEnabled&&Wde.showIndicator({source:ZS,reason:JS})}}let U3=class $l{static instance=null;audioDuration=0;audioStutterTime=0;audioStutterStamps=[];audioStutterDurations=[];audioChunkStamps=[];animationDuration=0;animationStutterTime=0;animationStutterDurations=[];animationChunkStamps=[];realFramesPlayed=0;realFramesStartTime=-1;simulatedFramesPlayed=0;simulatedFramesStartTime=-1;networkIndicator=new qde;static getInstance(){return $l.instance??=new $l,$l.instance}getMetrics(){return{audioDuration:this.audioDuration,audioStutterMax:Math.max(...this.audioStutterDurations,0),audioStutterTotal:this.audioStutterDurations.reduce((t,n)=>t+n,0),audioStutterStamps:this.audioStutterStamps,audioStutterDurations:this.audioStutterDurations,audioChunkStamps:this.audioChunkStamps,animationDuration:this.animationDuration,animationStutterMax:Math.max(...this.animationStutterDurations,0),animationStutterTotal:this.animationStutterDurations.reduce((t,n)=>t+n,0),animationStutterDurations:this.animationStutterDurations,animationChunkStamps:this.animationChunkStamps,animationRealFramesPlayed:this.realFramesPlayed,animationRealFramesStartTime:this.realFramesStartTime,animationSimulatedFramesPlayed:this.simulatedFramesPlayed,animationSimulatedFramesStartTime:this.simulatedFramesStartTime}}reset(){this.audioDuration=0,this.audioStutterTime=0,this.audioStutterDurations=[],this.audioChunkStamps=[],this.animationDuration=0,this.animationStutterTime=0,this.animationStutterDurations=[],this.animationChunkStamps=[],this.realFramesPlayed=0,this.realFramesStartTime=-1,this.simulatedFramesPlayed=0,this.simulatedFramesStartTime=-1,this.networkIndicator.cancelPending()}onAudioReceived(){this.audioChunkStamps.push(performance.now())}onAudioSuspend(){this.audioStutterTime||(this.audioStutterTime=performance.now(),this.audioStutterStamps.push(this.audioStutterTime)),this.networkIndicator.evaluate(this.audioStutterDurations)}onAudioResume(){this.stampAudioStutterDuration(),this.networkIndicator.cancelPending()}onAudioEnd(){this.onTurnEnd()}setAudioDuration(t){this.audioDuration=t}onCharacterAnimationReceived(){this.animationChunkStamps.push(performance.now())}onCharacterAnimationMissedInCache(){this.animationStutterTime||(this.animationStutterTime=performance.now())}onAnimationFrame(t){t?(this.simulatedFramesPlayed||(this.simulatedFramesStartTime=performance.now()),this.simulatedFramesPlayed+=1):(this.realFramesPlayed||(this.realFramesStartTime=performance.now()),this.realFramesPlayed+=1)}onCharacterAnimationResume(){this.stampAnimationStutterDuration()}setAnimationDuration(t){this.animationDuration=t}stampAudioStutterDuration(){if(this.audioStutterTime){const t=performance.now()-this.audioStutterTime;this.audioStutterDurations.push(t),this.audioStutterTime=0}}stampAnimationStutterDuration(){if(this.animationStutterTime){const t=performance.now()-this.animationStutterTime;this.animationStutterDurations.push(t),this.animationStutterTime=0}}onTurnEnd(){this.stampAudioStutterDuration(),this.stampAnimationStutterDuration(),this.networkIndicator.cancelPending()}};const QS={SUMMARY:"summary",ADAPTIVE_UI:"adaptiveUI"},XS=U3.getInstance(),Kde={"click-close":"clickClose","navigate-away":"navigateAway","visibility-hidden":"visibilityHidden"};let u0=class F3{static instance;readyTime=0;startCallTime=0;startMessageTime=0;firstTokenTime=0;mostRecentTokenTime=0;interruptAudioTime=0;speechEndTime=0;currentConversationId="";currentCallId="";currentOrLastCallId="";currentMessageId="";serverTurnCounter=1;latestTurnDetails=null;messagesTurnDetails={};introComplete=!1;isTurnRunning=!1;receivedTranscript=!1;receivedText=!1;receivedAudio=!1;receivedFirstToken=!1;receivedLastToken=!1;receivedFirstAnimation=!1;hasAnimationTimeout=!1;hasAudioStarted=!1;hasAudioPlaybackError=!1;scenario=void 0;messageStatus="idle";audioTranscriptLength=0;callStartNode=void 0;isTrackingSpeechEnd=!1;voiceConnectionStatus="off";disconnectedTime=0;reconnectedTime=0;static getInstance(){return this.instance??=new F3,this.instance}onBeforeStartCall(t,n){this.readyTime=performance.now(),n?this.scenario="portrait":t?this.scenario="appearance":this.scenario=void 0}onStartCall(t,n){this.interruptAudioTime=0,this.speechEndTime=0,this.introComplete=!1,this.serverTurnCounter=1,this.startCallTime=performance.now(),this.currentConversationId=t,this.currentCallId=crypto.randomUUID(),this.currentOrLastCallId=this.currentCallId,this.messageStatus="idle",this.latestTurnDetails=null,this.messagesTurnDetails={},this.audioTranscriptLength=0,this.disconnectedTime=0,this.reconnectedTime=0,this.voiceConnectionStatus="connected",R.trackEvent({name:"interaction",data:{eventName:"copilotCompose",eventInfo_conversationId:this.currentConversationId,eventInfo_callId:this.currentCallId,eventInfo_inputMethod:"voice",eventInfo_landingPage:R.getLandingPage(),eventInfo_scenario:this.scenario,eventInfo_mode:n}}),R.trackEvent({name:"interaction",data:{eventName:"audioStartSent",eventInfo_conversationId:this.currentConversationId,eventInfo_callId:this.currentCallId,eventInfo_duration:this.startCallTime-this.readyTime,eventInfo_scenario:this.scenario,eventInfo_mode:n}}),W("voice-upload-diagnostic-audio")&&N(async()=>{const{AUDIO_RECORDER:s}=await Promise.resolve().then(()=>fr);return{AUDIO_RECORDER:s}},void 0).then(({AUDIO_RECORDER:s})=>{s.setCallId(this.currentCallId),s.setScenario(this.scenario)}),this.trackStartVoiceCall("start")}onStartMessage(t){this.receivedTranscript=!1,this.receivedText=!1,this.receivedAudio=!1,this.receivedFirstToken=!1,this.receivedLastToken=!1,this.receivedFirstAnimation=!1,this.hasAnimationTimeout=!1,this.isTurnRunning=!0,this.hasAudioStarted=!1,this.hasAudioPlaybackError=!1,this.currentMessageId=t,this.messagesTurnDetails[t]=this.latestTurnDetails,this.latestTurnDetails=null,this.startMessageTime=performance.now(),this.messageStatus="streaming",ga.onStartMessage(t,this.startMessageTime,this.serverTurnCounter);const n=Math.round(this.startMessageTime-(this.speechEndTime||this.startCallTime));R.trackEvent({name:"system",data:{eventName:"copilotAudioReqtoResp",eventInfo_conversationId:this.currentConversationId,eventInfo_callId:this.currentCallId,eventInfo_messageId:this.currentMessageId,eventInfo_duration:n,eventInfo_scenario:this.scenario,eventInfo_customData:JSON.stringify({turnId:this.messagesTurnDetails[t]?.turnId,LatencyStartPoint:this.speechEndTime?"SpeechEnd":"CallStart"})}}),R.trackEvent({name:"system",data:{eventName:"copilotAudioStartMessage",eventInfo_conversationId:this.currentConversationId,eventInfo_callId:this.currentCallId,eventInfo_messageId:this.currentMessageId,eventInfo_scenario:this.scenario,eventInfo_firstTurn:!this.introComplete,eventInfo_customData:JSON.stringify({turnId:this.messagesTurnDetails[t]?.turnId})}}),this.voiceConnectionStatus==="waitingForStartMessage"&&(this.trackVoiceCallStartMessageAfterReconnect("startSuccess",this.getDuration(this.reconnectedTime)),this.reconnectedTime=0),this.voiceConnectionStatus="startMessageReceived",this.trackStartVoiceCall("success")}onTranscriptReceived(t){this.receivedTranscript=!0,this.audioTranscriptLength=t}onTextReceived(t){t===this.currentMessageId&&(this.receivedText=!0)}onAudioInterrupt(t){this.interruptAudioTime=performance.now(),this.messageStatus==="streaming"&&(this.messageStatus="interrupted"),this.latestTurnDetails??={turnId:crypto.randomUUID(),detectedBy:"server"},this.latestTurnDetails.speechStartTime=this.interruptAudioTime,R.trackEvent({name:"system",data:{eventName:"copilotAudioInterrupt",eventInfo_conversationId:this.currentConversationId,eventInfo_callId:this.currentCallId,eventInfo_messageId:this.currentMessageId,eventInfo_duration:this.mostRecentTokenTime?this.interruptAudioTime-this.mostRecentTokenTime:0,eventInfo_scenario:this.scenario,eventInfo_mode:t,eventInfo_customData:JSON.stringify({turnId:this.latestTurnDetails.turnId,LatencySinceSpeechEnd:this.isTrackingSpeechEnd?Math.round(this.interruptAudioTime-this.speechEndTime):void 0,LatencyStartPoint:this.isTrackingSpeechEnd?"SpeechEnd":void 0})}}),this.isTrackingSpeechEnd=!1,this.onTurnEnd()}onAudioReceived(t){this.receivedAudio=!0,this.mostRecentTokenTime=performance.now();const n=this.messagesTurnDetails[this.currentMessageId];if(!this.receivedFirstToken){this.receivedFirstToken=!0,this.firstTokenTime=this.mostRecentTokenTime;const o=Math.round(this.mostRecentTokenTime-(this.speechEndTime||this.startCallTime));R.trackEvent({name:"system",data:{eventName:"copilotAudioResptoReceived",eventInfo_conversationId:this.currentConversationId,eventInfo_callId:this.currentCallId,eventInfo_messageId:this.currentMessageId,eventInfo_duration:o,eventInfo_scenario:this.scenario,eventInfo_mode:t,eventInfo_customData:JSON.stringify({turnId:n?.turnId,LatencyStartPoint:this.speechEndTime?"SpeechEnd":"CallStart"})}}),this.speechEndTime&&R.trackEvent({name:"system",data:{eventName:"copilotAudioFirstTokenReceived",eventInfo_conversationId:this.currentConversationId,eventInfo_callId:this.currentCallId,eventInfo_messageId:this.currentMessageId,eventInfo_duration:this.mostRecentTokenTime-this.speechEndTime,eventInfo_scenario:this.scenario,eventInfo_serverTurnCounter:this.serverTurnCounter,eventInfo_mode:t,eventInfo_customData:JSON.stringify({turnId:n?.turnId})}})}}onClientSpeechStartDetected(){if(!W("enable-vad-latency-measure"))return;this.latestTurnDetails??={turnId:crypto.randomUUID(),detectedBy:"client"};const{clientSpeechStartTime:t,clientTurnCounter:n,speechStartTime:o}=this.latestTurnDetails;this.latestTurnDetails.clientTurnCounter=t&&!o&&n?n+1:1,this.latestTurnDetails.clientSpeechStartTime=performance.now()}onClientSpeechEndDetected(t){if(W("enable-vad-latency-measure")&&this.latestTurnDetails&&this.latestTurnDetails.clientSpeechStartTime){const n=t-performance.timeOrigin;this.latestTurnDetails.clientSpeechEndTime=n,R.trackEvent({name:"system",data:{eventName:"copilotAudioClientInput",eventInfo_conversationId:this.currentConversationId,eventInfo_callId:this.currentCallId,eventInfo_duration:n-this.latestTurnDetails.clientSpeechStartTime,eventInfo_scenario:this.scenario,eventInfo_customData:JSON.stringify({turnId:this.latestTurnDetails.turnId,isServerVADStarted:!!this.latestTurnDetails.speechStartTime,clientTurnCounter:this.latestTurnDetails.clientTurnCounter})}})}}onSpeechEndDetected(t){this.isTrackingSpeechEnd=!0,this.speechEndTime=performance.now(),this.serverTurnCounter+=1,this.latestTurnDetails&&(this.latestTurnDetails.speechEndTime=this.speechEndTime),ga.onSpeechEndDetected(this.speechEndTime),this.interruptAudioTime&&R.trackEvent({name:"system",data:{eventName:"copilotAudioInput",eventInfo_conversationId:this.currentConversationId,eventInfo_callId:this.currentCallId,eventInfo_duration:this.speechEndTime-this.interruptAudioTime,eventInfo_scenario:this.scenario,eventInfo_mode:t,eventInfo_customData:JSON.stringify({turnId:this.latestTurnDetails?.turnId})}})}onServerVADLatencyMeasured(t){R.trackEvent({name:"system",data:{eventName:"copilotAudioSpeechEndDetected",eventInfo_conversationId:this.currentConversationId,eventInfo_callId:this.currentCallId,eventInfo_duration:t,eventInfo_scenario:this.scenario,eventInfo_serverTurnCounter:this.serverTurnCounter,eventInfo_customData:JSON.stringify({turnId:this.latestTurnDetails?.turnId})}})}onCallUIEventReceived(t){const n=performance.now(),o=this.speechEndTime?n-this.speechEndTime:void 0,s=t==="study"?QS.SUMMARY:QS.ADAPTIVE_UI;R.trackEvent({name:"system",data:{eventName:"callUIEventReceived",eventInfo_scenario:s,eventInfo_conversationId:this.currentConversationId,eventInfo_duration:o,eventInfo_mode:t}})}onCharacterAnimationReceived(){this.receivedFirstAnimation||(this.receivedFirstAnimation=!0,R.trackEvent({name:"system",data:{eventName:"copilotAudioCharacterAnimationReceived",eventInfo_conversationId:this.currentConversationId,eventInfo_duration:performance.now()-this.speechEndTime,eventInfo_messageId:this.currentMessageId,eventInfo_callId:this.currentCallId,eventInfo_scenario:this.scenario,eventInfo_serverTurnCounter:this.serverTurnCounter}}))}onCharacterAnimationEnd(){R.trackEvent({name:"system",data:{eventName:"copilotAudioCharacterAnimationEnd",eventInfo_conversationId:this.currentConversationId,eventInfo_duration:performance.now()-this.speechEndTime,eventInfo_messageId:this.currentMessageId,eventInfo_callId:this.currentCallId,eventInfo_scenario:this.scenario}})}onCharacterAnimationTimeout(){this.hasAnimationTimeout=!0}onCharacterEmotionReceived(t,n){R.trackEvent({name:"system",data:{eventName:"copilotCharacterEmotionReaction",eventInfo_conversationId:this.currentConversationId,eventInfo_messageId:this.currentMessageId,eventInfo_duration:performance.now()-this.speechEndTime,eventInfo_emotion:t,eventInfo_bodyReaction:n}})}onCharacterAppearanceReceived(t){R.trackEvent({name:"system",data:{eventName:"copilotCharacterAppearanceEvent",eventInfo_conversationId:this.currentConversationId,eventInfo_messageId:this.currentMessageId,eventInfo_duration:performance.now()-this.speechEndTime,eventInfo_customData:JSON.stringify(t)}})}onMessageDone(t){const{messageId:n,voiceType:o,audioChatMode:s}=t;let a={transcriptLength:this.audioTranscriptLength};this.messageStatus==="interrupted"&&(a.interruptedAtMs=this.interruptAudioTime-this.startMessageTime);const r=this.messagesTurnDetails[n];if(r){const{turnId:i,detectedBy:d,clientSpeechStartTime:m=0,clientSpeechEndTime:p=0,speechStartTime:h=0,speechEndTime:g=0}=r;a={...a,turnId:i,turnDetectedBy:d,clientSpeechDuration:p-m,clientSpeechStartAt:m-h,clientSpeechEndAt:p-h,timeToSpeechEnd:g-h,timeToStartMessage:this.startMessageTime-h,timeToFirstAudio:this.firstTokenTime-h,timeToLastAudio:this.mostRecentTokenTime-h,timeToDone:performance.now()-h}}if(R.trackEvent({name:"system",data:{eventName:"copilotAudioMessageDone",eventInfo_conversationId:this.currentConversationId,eventInfo_callId:this.currentCallId,eventInfo_messageId:n,eventInfo_scenario:this.scenario,eventInfo_firstTurn:!this.introComplete,eventInfo_transcriptReceived:this.receivedTranscript,eventInfo_textReceived:this.receivedText,eventInfo_audioReceived:this.receivedAudio,eventInfo_customData:JSON.stringify(a)}}),R.trackEvent({name:"system",data:{eventName:"copilotResponseRender",eventInfo_inputMethod:"voice",eventInfo_responseMethod:"voice",eventInfo_conversationId:this.currentConversationId,eventInfo_callId:this.currentCallId,eventInfo_messageId:this.currentMessageId,eventInfo_responseVoiceType:o,eventInfo_landingPage:R.getLandingPage(),eventInfo_scenario:this.scenario,eventInfo_mode:s}}),this.messageStatus="idle",delete this.messagesTurnDetails[n],!this.introComplete){this.introComplete=!0,R.trackEvent({name:"system",data:{eventName:"copilotAudioCallSetUp",eventInfo_duration:performance.now()-this.readyTime,eventInfo_conversationId:this.currentConversationId,eventInfo_callId:this.currentCallId,eventInfo_responseVoiceType:o,eventInfo_scenario:this.scenario,eventInfo_mode:s}});return}!this.receivedLastToken&&n===this.currentMessageId&&(this.receivedLastToken=!0,this.speechEndTime&&R.trackEvent({name:"system",data:{eventName:"copilotAudioLastTokenReceived",eventInfo_conversationId:this.currentConversationId,eventInfo_messageId:n,eventInfo_callId:this.currentCallId,eventInfo_duration:this.mostRecentTokenTime-this.speechEndTime,eventInfo_scenario:this.scenario,eventInfo_mode:s}}))}onEndCall(t){const{numMessages:n,audioChatMode:o,availabilityStatus:s,endReason:a,notReceivedStartMessage:r}=t,i=performance.now(),d=i-this.startCallTime,m=this.callStartNode==="success"&&this.currentCallId?d:-1,{reason:p,detail:h}=this.getReportCallEndReason(a);r&&this.trackStartVoiceCall("fail","not_receive_startmessage_until_end_call"),this.onTurnEnd(),R.trackEvent({name:"system",data:{eventName:"copilotAudioCallEnd",eventInfo_conversationId:this.currentConversationId,eventInfo_callId:this.currentCallId,eventInfo_duration:m,eventInfo_numMessages:n,eventInfo_scenario:this.scenario,eventInfo_mode:o,eventInfo_messageId:this.currentMessageId,eventInfo_customData:JSON.stringify({LatencySinceSpeechEnd:this.isTrackingSpeechEnd?Math.round(i-this.speechEndTime):void 0,LatencyStartPoint:this.isTrackingSpeechEnd?"SpeechEnd":void 0,voiceStatus:s,audioCallEndReason:p,audioCallEndReasonDetail:h})}}),this.isTrackingSpeechEnd=!1,this.currentCallId="",this.voiceConnectionStatus==="disconnected"?this.trackVoiceCallReconnectedEvent("ended",this.getDuration(this.disconnectedTime)):this.voiceConnectionStatus==="waitingForStartMessage"&&this.trackVoiceCallStartMessageAfterReconnect("ended",this.getDuration(this.reconnectedTime)),this.disconnectedTime=0,this.reconnectedTime=0,this.voiceConnectionStatus="off",this.trackStartVoiceCall(void 0)}onAudioStartFailed(t,n){R.trackEvent({name:"system",data:{eventName:"copilotAudioStartFailed",eventInfo_conversationId:this.currentConversationId,eventInfo_callId:this.currentCallId,eventInfo_duration:performance.now()-this.startCallTime,eventInfo_reason:t,reason:t,eventInfo_scenario:this.scenario,eventInfo_mode:n}}),this.trackStartVoiceCall("fail","start_fail",t)}onConsentRequired(t,n){R.trackEvent({name:"system",data:{eventName:"biometricConsentRequired",eventInfo_conversationId:this.currentConversationId,eventInfo_callId:this.currentCallId,eventInfo_consentType:t,eventInfo_consentVersion:n}})}onAudioStartTimeout(t){R.trackEvent({name:"system",data:{eventName:"copilotAudioStartTimeout",eventInfo_conversationId:this.currentConversationId,eventInfo_callId:this.currentCallId,eventInfo_duration:t,eventInfo_scenario:this.scenario}}),this.trackStartVoiceCall("fail","start_timeout")}onTerminated(t,n){R.trackEvent({name:"system",data:{eventName:"copilotAudioTerminated",eventInfo_conversationId:this.currentConversationId,eventInfo_callId:this.currentCallId,eventInfo_duration:performance.now()-this.startCallTime,eventInfo_reason:t,reason:t,eventInfo_scenario:this.scenario,eventInfo_mode:n}})}onError(t,n){R.trackEvent({name:"system",data:{eventName:"copilotAudioError",eventInfo_conversationId:this.currentConversationId,eventInfo_callId:this.currentCallId,eventInfo_duration:performance.now()-this.startCallTime,eventInfo_errorCode:t,eventInfo_scenario:this.scenario,eventInfo_mode:n}})}onAudioStart(){if(!this.hasAudioStarted){this.hasAudioStarted=!0;const t=Math.round(performance.now()-(this.speechEndTime||this.startCallTime));R.trackEvent({name:"system",data:{eventName:"copilotAudioStart",eventInfo_conversationId:this.currentConversationId,eventInfo_callId:this.currentCallId,eventInfo_messageId:this.currentMessageId,eventInfo_duration:t,eventInfo_scenario:this.scenario,eventInfo_serverTurnCounter:this.serverTurnCounter,eventInfo_customData:JSON.stringify({turnId:this.messagesTurnDetails[this.currentMessageId]?.turnId,LatencySinceSpeechEnd:this.isTrackingSpeechEnd?t:void 0,LatencyStartPoint:this.speechEndTime?"SpeechEnd":"CallStart"})}}),this.isTrackingSpeechEnd=!1}}onAudioEnd(){this.onTurnEnd()}onAudioError(){this.hasAudioPlaybackError=!0}onTurnEnd(){if(this.isTurnRunning){this.isTurnRunning=!1,XS.onTurnEnd();const{audioDuration:t,audioStutterStamps:n,audioStutterDurations:o,audioStutterTotal:s,audioStutterMax:a,audioChunkStamps:r,animationDuration:i,animationStutterDurations:d,animationStutterTotal:m,animationStutterMax:p,animationChunkStamps:h,animationRealFramesPlayed:g,animationRealFramesStartTime:y,animationSimulatedFramesPlayed:b,animationSimulatedFramesStartTime:C}=XS.getMetrics(),T=o.length,S=d.length;R.trackEvent({name:"system",data:{eventName:"copilotAnimationSummary",eventInfo_conversationId:this.currentConversationId,eventInfo_callId:this.currentCallId,eventInfo_messageId:this.currentMessageId,eventInfo_scenario:this.scenario,eventInfo_audioReceived:this.receivedAudio,eventInfo_animationReceived:this.receivedFirstAnimation,eventInfo_timeout:this.hasAnimationTimeout,eventInfo_audioDuration:t,eventInfo_animationDuration:i,eventInfo_audioPlayed:this.hasAudioStarted,eventInfo_audioPlayError:this.hasAudioPlaybackError,eventInfo_animationMissedInCache:S>0,eventInfo_audioMissedInCache:T>0,eventInfo_animationRealFramesPlayed:g,eventInfo_animationSimulatedFramesPlayed:b,eventInfo_animationRealFramesStartTime:Math.max(y-this.startMessageTime,-1),eventInfo_animationSimulatedFramesStartTime:Math.max(C-this.startMessageTime,-1)}}),(T>0||S>0)&&R.trackEvent({name:"system",data:{eventName:"copilotAudioStutter",eventInfo_conversationId:this.currentConversationId,eventInfo_callId:this.currentCallId,eventInfo_messageId:this.currentMessageId,eventInfo_scenario:this.scenario,eventInfo_audioDuration:t,eventInfo_animationDuration:i,eventInfo_audioStutterCount:T,eventInfo_audioStutterDurationMax:a,eventInfo_audioStutterDurationTotal:s,eventInfo_audioStutterStamps:n.map(E=>Math.round(E-this.startMessageTime)),eventInfo_audioChunkStamps:r.map(E=>Math.round(E-this.startMessageTime)),eventInfo_animationStutterCount:S,eventInfo_animationStutterDurationMax:p,eventInfo_animationStutterDurationTotal:m,eventInfo_animationChunkStamps:h.map(E=>Math.round(E-this.startMessageTime))}})}}trackAudioPermission(t,n,o,s){switch(t){case"mic-request":this.trackStartVoiceCallEvent(t);break;case"mic-granted":case"mic-denied":this.trackStartVoiceCallEvent(t,o,s,n?Math.round(performance.now()-n):void 0);break}}trackStartVoiceCall(t,n,o){switch(t){case"start":this.callStartNode="start",this.trackStartVoiceCallEvent(t);break;case"success":case"fail":this.callStartNode==="start"&&(this.trackStartVoiceCallEvent(t,n,o),this.callStartNode=t);break;case void 0:this.callStartNode=void 0;break}}trackStartVoiceCallEvent(t,n,o,s){R.trackEvent({name:"system",data:{eventName:"copilotStartVoiceCall",eventInfo_conversationId:this.currentConversationId,eventInfo_callId:this.currentCallId,eventInfo_scenario:this.scenario,eventInfo_errorCode:n,eventInfo_errorDescription:o,eventInfo_duration:this.getDuration(this.startCallTime),eventInfo_customData:JSON.stringify({isFirst:!0,isConnected:navigator.onLine,node:t,micAccessDuration:s})}})}getCurrentOrLastCallId(){return this.currentOrLastCallId}onConnectionClosed(){this.voiceConnectionStatus!=="disconnected"&&(this.voiceConnectionStatus="disconnected",this.disconnectedTime=performance.now())}onConnected(){this.voiceConnectionStatus==="disconnected"&&(this.voiceConnectionStatus="waitingForStartMessage",this.reconnectedTime=performance.now(),this.trackVoiceCallReconnectedEvent("connected",this.getDuration(this.disconnectedTime)),this.disconnectedTime=0)}trackVoiceCallReconnectedEvent(t,n){const o={status:t};R.trackEvent({name:"system",data:{eventName:"voiceCallReconnected",eventInfo_conversationId:this.currentConversationId,eventInfo_callId:this.currentCallId,eventInfo_scenario:this.scenario,eventInfo_customData:JSON.stringify(o),eventInfo_duration:n}})}trackVoiceCallStartMessageAfterReconnect(t,n){const o={status:t};R.trackEvent({name:"system",data:{eventName:"voiceCallStartMessageAfterReconnected",eventInfo_conversationId:this.currentConversationId,eventInfo_callId:this.currentCallId,eventInfo_scenario:this.scenario,eventInfo_customData:JSON.stringify(o),eventInfo_duration:n}})}getDuration(t){if(t)return Math.round(performance.now()-t)}getReportCallEndReason(t){let n="",o="";switch(t.category){case"server-terminated":n="terminate",o=t.detail;break;case"server-banned":n="banned";break;case"client-terminated":["click-close","navigate-away","visibility-hidden"].includes(t.detail)?n=Kde[t.detail]??t.detail:(n="clientTerminate",o=t.detail);break;case"client-restarted":n="clientRestart",o=t.detail;break;case"unknown":default:n="unknown";break}return{reason:n,detail:o}}};const Al=u0.getInstance(),j3=u0.getInstance(),eo=U3.getInstance(),Yde=100;class Zde extends EventTarget{audioContextManager=new D3;volumeTracker=new O3("input");clientVADTracker=new xde;audioStream=null;isMuted=!1;audioCaptureCleanup=void 0;get volume(){return this.volumeTracker.volume}get audioContext(){return this.audioContextManager.audioContext}startVoiceDetection(){if(!W("enable-vad-latency-measure"))return;const t=this.audioContextManager.audioAnalyser;t&&this.clientVADTracker.startVoiceDetection(t)}stopVoiceDetection(){W("enable-vad-latency-measure")&&this.clientVADTracker.stopVoiceDetection()}setOnClientSideVoiceStartDetected(t){this.clientVADTracker.setOnClientSideVoiceStartDetected(t)}setOnClientSideVoiceEndDetected(t){this.clientVADTracker.setOnClientSideVoiceEndDetected(t)}onServerSpeechEndDetected(){return W("enable-vad-latency-measure")?this.clientVADTracker.onServerSpeechEndDetected():null}getLastClientVoiceEndTime(){return W("enable-vad-latency-measure")?this.clientVADTracker.getLastClientVoiceEndTime():null}getLastServerVADLatency(){return W("enable-vad-latency-measure")?this.clientVADTracker.getLastServerVADLatency():null}get isInputMuted(){return this.isMuted}set isInputMuted(t){this.toggleMute(t)}async startAudioCapture(t,n){this.audioContextManager.isInitialized&&await this.stopAudioCapture();try{await this.audioContextManager.initialize({sampleRate:Od()?void 0:Dd})}catch(i){throw this.dispatchEvent(new CustomEvent("error",{detail:i})),i}const o=()=>{this.stopAudioCapture(),this.dispatchEvent(new CustomEvent("audioTrackEnded"))},s=i=>{this.dispatchEvent(new CustomEvent("audioData",{detail:i}))},{audioContext:a,audioAnalyser:r}=this.audioContextManager;if(a&&r){const{stream:i,cleanup:d}=await _te(s,a,r,t,o,n);this.audioStream=i,this.audioCaptureCleanup=d,this.isInputMuted&&this.toggleMute(!0),this.volumeTracker.startTracking(r),this.startVoiceDetection()}}async stopAudioCapture(){if(this.audioCaptureCleanup&&(this.audioCaptureCleanup(),this.audioCaptureCleanup=void 0),this.audioStream){for(const t of this.audioStream.getTracks())t.stop();this.audioStream=null}this.volumeTracker.stopTracking(),this.stopVoiceDetection(),await this.audioContextManager.cleanup()}toggleMute(t=!this.isMuted){if(this.audioStream)for(const n of this.audioStream.getTracks())n.enabled=!t;this.isMuted!==t&&(this.isMuted=t,this.dispatchEvent(new CustomEvent("muteStateChanged",{detail:t})))}}class Jde extends Ade{startJinglePromise=void 0;animationSyncPromise=void 0;audioDelayPromise=void 0;async initialize(t=yc,n=qA){await super.initialize(t,n),this.animationSyncPromise=void 0,eo.reset()}appendAudioData(t){if(eo.onAudioReceived(),!this.audioContext||!this.outputGainNode)return;const{Animation:n}=et;!this.audioStarted&&!this.animationSyncPromise&&(this.animationSyncPromise=n.getAnimationSyncPromise()?.finally(()=>{this.animationSyncPromise=void 0}));const o=xte(t,this.audioContext);this.appendAudioSource(o),eo.setAudioDuration(this.audioDuration)}async startPlayback(){if(this.startJinglePromise??this.animationSyncPromise??this.audioDelayPromise){const t=et.currentTurnIndex,n=Promise.all([this.startJinglePromise,this.animationSyncPromise,this.audioDelayPromise]);try{await n}catch(o){o instanceof Error&&(`${o.message}`,void 0)}if(t!==et.currentTurnIndex)return}await super.startPlayback()}async playCallStartJingle(){this.startJinglePromise??=qC(kde,3e3).finally(()=>{this.startJinglePromise=void 0}),await this.startJinglePromise}async playCallEndJingle(){await qC(_de,3e3)}setAudioDelayPromise(t){this.audioDelayPromise=ju(t).finally(()=>{this.audioDelayPromise=void 0})}onAudioSuspend(){eo.onAudioSuspend()}onAudioResume(){eo.onAudioResume()}onAudioEnd(){eo.onAudioEnd()}onAudioError(t){super.onAudioError(t),j3.onAudioError()}}class Qde extends EventTarget{isAnimationEnabled=!1;frameManager=new Hde(()=>et.AudioOut.playbackTime);syncHandler;isUseAppearanceComponent=!1;get currentA2EFrame(){return this.shouldAnimationPlay?this.frameManager.getCurrentA2EFrame():null}get currentVasaFrame(){return this.shouldAnimationPlay?this.frameManager.getCurrentVasaFrame():null}get currentVasaExpFrame(){return this.shouldAnimationPlay?this.frameManager.getCurrentVasaExpFrame():null}hasAudioStuttered=!1;get initialAnimationWaitingTime(){return W("voice-unified-ui")?0:this.hasAudioStuttered?Yde:0}animationSyncDeferred;appearanceReady=!1;get animationEnded(){return et.AudioOut.audioEnded}get shouldAnimationPlay(){return this.isAnimationEnabled&&!this.animationEnded&&et.AudioOut.audioStarted}emotionData=null;characterAppearance=null;async initSyncHandler(){if(this.isUseAppearanceComponent=Mde(),!!this.isUseAppearanceComponent&&!this.syncHandler){const{AudioAnimationSyncHandler:t}=await N(async()=>{const{AudioAnimationSyncHandler:n}=await import("./index-B7ft8GyI.js");return{AudioAnimationSyncHandler:n}},__vite__mapDeps([432,433,1,15,13,14,16,17,37,35,38,39,40,41,42,43,44,45,46,47,48,49,50,51,24,18,25,54,22,23,26,27,28,29,30,31,32,33,34,36,21,52,53,203,224,69,70,150,165,183,182,195,194,138,135,136,144,142,160,157,159,149,163,166,270,211,72,190,277,269,271,122,299]));this.syncHandler=new t("spda2e","volume-based"),this.syncHandler.setInitialAnimationTimeout(this.initialAnimationWaitingTime),this.syncHandler.setAudioInfoProvider({getCurrentTime:()=>et.AudioOut.playbackTime,getOutputVolume:()=>et.AudioOut.volume.get()}),this.syncHandler.onFrameMissedInCache(()=>{eo.onCharacterAnimationMissedInCache()}),this.syncHandler.onResume(()=>{eo.onCharacterAnimationResume()}),this.syncHandler.onFrame(n=>{eo.onAnimationFrame(n)}),et.AudioOut.addEventListener("audioSuspend",()=>{this.hasAudioStuttered=!0,this.syncHandler?.setInitialAnimationTimeout(this.initialAnimationWaitingTime)})}}async initialize(t=!1){this.stopAnimation(),this.isAnimationEnabled=t,this.isUseAppearanceComponent&&this.syncHandler?.startTurn()}stopAnimation(){if(this.isUseAppearanceComponent){this.syncHandler?.interruptTurn();return}this.frameManager.reset(),this.emotionData=null,this.isAnimationEnabled=!1,this.animationSyncDeferred&&this.animationSyncDeferred.reject()}getAnimationSyncPromise(){if(this.isAnimationEnabled)return this.isUseAppearanceComponent?this.syncHandler?.getAnimationPreparedPromise().then(t=>{t==="timeout"&&j3.onCharacterAnimationTimeout()}):(this.animationSyncDeferred||(this.initializeAnimationSync(),this.checkAnimationSyncPromise()),this.animationSyncDeferred?.promise)}initializeAnimationSync(){let t,n;const o=new Promise((r,i)=>{t=r,n=i}),s=ju(Vz),a=Promise.race([o,s]).finally(()=>{this.animationSyncDeferred=void 0});this.animationSyncDeferred={promise:a,resolve:t,reject:n}}checkAnimationSyncPromise(){this.appearanceReady&&this.frameManager.frameCount>Hz&&this.animationSyncDeferred?.resolve()}setAnimationDone(){this.isUseAppearanceComponent?this.syncHandler?.finishTurn():this.appearanceReady&&this.animationSyncDeferred?.resolve()}setAppearanceReady(){this.appearanceReady=!0,this.checkAnimationSyncPromise()}setFrameData(t){eo.onCharacterAnimationReceived(),!(!this.isAnimationEnabled||!t.frame)&&(this.isUseAppearanceComponent?(this.syncHandler?.addFrame(t),eo.setAnimationDuration(this.syncHandler?.animationDuration??-1)):(this.frameManager.setFrameData(t),this.checkAnimationSyncPromise()))}setEmotionData(t){this.isUseAppearanceComponent?this.dispatchEvent(new CustomEvent("set-emotion",{detail:t})):this.emotionData=t}setCharacterAppearance(t){this.characterAppearance=t,this.dispatchEvent(new CustomEvent("set-character-appearance"))}}class Ni{static instance=null;AudioIn=new Zde;AudioOut=new Jde;Animation=new Qde;currentTurnIndex=0;static getInstance(){return Ni.instance??=new Ni,Ni.instance}}const et=Ni.getInstance(),e2=48,t2=50;function n2(e){const{isNested:t}=e,[n,o]=l.useState(1),[s,a]=l.useState(1),r=l.useRef(void 0),i=l.useRef(void 0),d=Hs(y=>{r.current=y.width,i.current=y.height,o((r.current+e2)/r.current),a((i.current+e2)/i.current)},{initialize:!0}),{volume:m}=et.AudioOut,p=oM(m,Iee),h=eu(p,[0,t2],[1,n]),g=eu(p,[0,t2],[1,s]);return c.jsx(he.div,{className:"absolute inset-0",ref:d,initial:je,animate:{...rt,transition:{delay:Tee}},exit:je,children:c.jsx(he.div,{className:Ae("absolute inset-0 flex items-center justify-center overflow-hidden rounded-6xl",t?"-scale-x-100 rounded-5xl blur-lg":"bg-background-100/30 bg-blend-luminosity backdrop-blur-xl after:absolute after:inset-px after:rounded-6xl after:border after:border-transparent dark:bg-background-200/30"),layout:!0,style:{scaleX:h,scaleY:g},children:c.jsx(he.div,{className:Ae("absolute -inset-16 aspect-square bg-gradient-audio-output-light bg-blend-saturation saturate-150 dark:bg-gradient-audio-output-dark dark:saturate-100",t?"animate-spin-slower opacity-20 dark:opacity-30":"animate-spin-slow opacity-40 dark:opacity-50")})})})}function Xde(e){const{dynamicHeight:t}=e;return c.jsx(he.div,{className:Ae("t-bottom-fade pointer-events-none absolute bottom-0 mx-4 box-content w-bottom-fade rounded-lg pt-bottom-fade",t?"h-bottom-fade":"h-composer","[transform:translateZ(0)]"),initial:je,animate:rt,exit:je,transition:b1,children:c.jsx(Bs,{isBottomFade:!0})})}function eme(e){const{categories:t,onClose:n,selectedCategoryIndex:o,handleCategoryClick:s}=e,{t:a}=Z(),r=l.useRef(null),i=wh(r,{amount:"all"});return l.useEffect(()=>{i&&Lt({page:"chatPage",element:"chatStarterPillCategory",customData:JSON.stringify({visibleItems:t.map(d=>d.id)})})},[i,t]),c.jsx(mA,{onClose:n,className:"px-3",children:c.jsxs("div",{className:"flex w-full flex-col items-center gap-4",ref:r,children:[c.jsx("h1",{className:"mt-2 px-3 text-lg-strong",children:a("widgets.categorySelectorModalHeader")}),c.jsx("ul",{className:"flex w-full list-none flex-col items-center",role:"list",children:t.map((d,m)=>c.jsx("li",{className:"w-full",children:c.jsx(ee,{className:"w-full",variant:"rect",color:"subtle-dimmed-inverted",title:d.label,onClick:()=>s(m),children:c.jsxs("span",{className:"flex w-full items-center justify-between",children:[c.jsx("span",{className:"truncate text-start",children:d.label}),o===m&&c.jsx(Yd,{className:"ms-2 size-4 shrink-0 text-foreground-600 contrast-more:text-current"})]})})},d.id))})]})})}const tme="contrast-more:outline contrast-more:after:border-2 contrast-more:after:absolute contrast-more:after:pointer-events-none contrast-more:after:w-2/3 contrast-more:after:h-2/3",nme="text-foreground-550 active:text-foreground-350 dark:text-foreground-600 active:dark:text-foreground-550",ome="bg-white/30 safe-hover:bg-black/3 active:bg-black/2 dark:bg-black/3 dark:safe-hover:bg-white/5 dark:active:bg-white/3",sme="border-[1px] border-black/8 dark:border-white/8",ame=`${nme} ${ome} ${sme}`;function B3(e){const{children:t,isSelected:n,className:o,onClick:s,disabled:a,unselectedColorClass:r,variant:i="standard",testId:d,ariaLabel:m,ariaSetSize:p,ariaPosInSet:h,dataItemId:g,tabIndex:y}=e,{focusable:b}=kd({autoRestoreFocus:!0,forceFocus:!0});let C;return n?C=hu.strong:i==="flat"?C=ame:C=hu[r??"overlay-dimmed-inverted"],c.jsx("button",{disabled:a,type:"button",ref:b.ref,className:O("shadow-none dark:shadow-none",ff,SA["40-base"],bA["40-base"],hf["40-base"],EA,C,o,n&&tme),onClick:s,role:p?"radio":void 0,tabIndex:y,"aria-checked":p?n:void 0,"aria-pressed":p?void 0:n,"aria-label":m,"aria-setsize":p,"aria-posinset":h,"data-spatial-focus-key":b.focusKey,"data-testid":d,"data-item-id":g,children:t})}function rme(e){const{text:t,onClick:n,className:o,testId:s,ariaLabel:a,dataItemId:r}=e;return c.jsx(B3,{isSelected:!1,variant:"flat",className:O("min-w-fit",o),onClick:n,testId:s,ariaLabel:a,dataItemId:r,children:c.jsx("span",{className:"px-1 text-sm",children:t})})}const ime=1e3;function d0(){const e=!!J.instance().config().landingPage?.enablePromptedGreetings,t=D1(),n=q("personalizedgreetings");return e&&(!!t||n)}function cme(){const[e,t]=Le(e_),n=d0();return l.useEffect(()=>{let o;return n?(t(!1),o=window.setTimeout(()=>{t(!0)},ime)):t(!1),()=>{o&&clearTimeout(o)}},[t,n]),e}function V3(e,t){const n={...t,actionType:e.type};switch(e.type){case"sendMessage":case"prefillComposer":return{...n,prompt:e.prompt};case"changeChatMode":return{...n,chatMode:e.key};case"changeComposerCreateMode":return{...n,composerCreateMode:e.key};case"uploadFile":case"tutoringCall":case"createPage":case"createProject":case"openHomeworkHelper":return n;default:{const o=e;throw new Error(`Unhandled action type: ${JSON.stringify(o)}`)}}}function lme({pageName:e,widgetSource:t,categoryId:n,onWidgetClick:o}){return async s=>{const{action:a,id:r,source:i,text:d,index:m}=s,p=V3(a,{id:r,source:i,text:d,index:m});de({pageName:e,source:t,scenario:r,customData:JSON.stringify({prompt:p.prompt,text:d,index:m,category:n})}),await o(p)}}const ume=300,dme=(e,t)=>{if(!e||t===void 0)return null;const{type:n}=e;switch(n){case"categories":return e.categories[t]?.items??[];case"text":return e.items;case"banner":case"card":return null;default:throw new Error(`Unhandled action type: ${n}`)}};function mme(e){const{className:t,onWidgetClick:n,pageName:o="chatPage",widgetSource:s,starterPromptsData:a,shouldStackChips:r,shouldCenterChips:i,containerId:d="",selectedCategory:m,onCategoryClick:p}=e,h=l.useRef(null),g=l.useRef(new Set),{t:y}=Z(),b=wh(h,{once:!0,amount:"all"}),C=gt({breakpoint:"sm"}),T=q("feature-discovery");l.useEffect(()=>{const I=m?.id??"default";if(b&&h.current&&!g.current.has(I)){g.current.add(I);const x=setTimeout(()=>{requestAnimationFrame(()=>{const w=S(h);Lt({page:o,scenario:s,element:"chatStarterPills",customData:JSON.stringify({visibleItems:w,totalItems:w.length,category:m?.id})})})},ume);return()=>clearTimeout(x)}return()=>{}},[o,b,m?.id,a,s]);const S=I=>{const x=I.current;if(!x)return[];const w=x.getBoundingClientRect(),P=x.querySelectorAll("[data-item-id]"),D=[];for(const L of P){const j=L.getBoundingClientRect(),U=L.getAttribute("data-item-id"),K=Math.max(0,Math.min(j.right,w.right)-Math.max(j.left,w.left))/j.width;U&&K>=.5&&D.push(U)}return D},E=lme({pageName:o,widgetSource:s,categoryId:m?.id,onWidgetClick:n});return c.jsxs(jt,{role:"list",className:O("flex w-full gap-2 px-1 py-1 sm:flex-wrap sm:py-4",r?"mb-3 flex-col items-end space-y-1 sm:flex-row":O("scrollbar-container overflow-x-auto overflow-y-hidden",T?"max-h-[60px]":"max-h-[110px]"),i?"sm:justify-center":"sm:justify-start",t),id:d,ref:h,children:[m&&C&&c.jsx(ee,{onClick:p,title:m.label,className:"min-w-fit",color:"overlay-dimmed-inverted",children:c.jsxs("span",{className:"flex items-center gap-2",children:[m.label,c.jsx(po,{className:"size-4 -rotate-90"})]})}),a.map((I,x)=>{const{id:w,text:P,action:D}=I,L=y("composer.starterPromptAriaLabel",{text:P,index:x+1,total:a.length});return c.jsx(rme,{text:P,onClick:()=>E({action:D,id:w,source:"pills",text:P,index:x}),className:Ae(r&&"w-auto min-w-min max-w-[80%] text-start"),testId:`starter-prompt-${w}`,ariaLabel:L,dataItemId:w},w)})]})}function pme(e){const{className:t,onWidgetClick:n,pageName:o="chatPage",selectedCategory:s,selectedCategoryIndex:a,onCategoryClick:r}=e,i=M(Xx),d=d0(),m=M(e_),{isAppearanceOnHomeEnabled:p}=za(),h=p||i?.type==="categories",g=M(N1),y=J.instance().config().landingPage?.stackStarterChipsForSmallScreens;let b="";g?b=g:s&&(b=s.id);const C=dme(i,a);return d&&!m||!C?null:c.jsx(mme,{onWidgetClick:n,className:t,pageName:o,starterPromptsData:C,widgetSource:i?.source??"chatStarterPills",shouldStackChips:y,shouldCenterChips:h,containerId:b,selectedCategory:s,onCategoryClick:r})}const fme=l.lazy(()=>N(()=>import("./starter-prompt-category-CNSy16of.js"),__vite__mapDeps([434,1,2]))),hme=l.lazy(()=>N(()=>import("./mode-specific-card-widget-section-rvKcTJJ2.js"),__vite__mapDeps([435,1,2])));function gme(e){const{className:t,onWidgetClick:n,pageName:o="chatPage"}=e,s=M(Xx),a=gt({breakpoint:"sm"}),[r,i]=Le(Pse),[d,m]=l.useState(!1),p=async T=>{n(T)},h=T=>{T!==r&&(i(T),de({source:"chatStarterPillCategory",pageName:"chatPage",destination:g?g[T]?.id:void 0})),m(!1)},g=s&&s.type==="categories"?s.categories.map(T=>({id:T.id,label:T.label})):void 0,y=g&&!a,b=d&&g&&a;return M(Rse)&&s?.type==="card"?c.jsx("div",{className:O("mx-auto w-full",t),children:c.jsx(l.Suspense,{fallback:c.jsx("div",{className:"h-32 w-full"}),children:c.jsx(hme,{onWidgetClick:p})})}):!s||!["text","categories"].includes(s.type)?null:c.jsxs("div",{className:O("mx-auto flex w-full flex-col gap-3 px-2",t),children:[y&&c.jsx(l.Suspense,{fallback:c.jsx("div",{className:"mt-2 h-8 w-full"}),children:c.jsx(fme,{categories:g,handleCategoryClick:h,selectedCategoryIndex:r,className:"mt-2"})}),c.jsx(pme,{onWidgetClick:p,pageName:o,selectedCategory:g?g[r]:void 0,selectedCategoryIndex:r,onCategoryClick:g?()=>m(!0):void 0}),b&&c.jsx(eme,{categories:g,handleCategoryClick:h,selectedCategoryIndex:r,onClose:()=>m(!1)})]})}const vme=rs(()=>N(()=>import("./composer-auto-complete-BMuTwVoK.js"),__vite__mapDeps([436,1,2])),{moduleName:"composer-auto-complete",retryStrategy:mo}),yme=l.lazy(()=>N(()=>import("./composer-actions-prompt-suggestions-BhuSXzVf.js"),__vite__mapDeps([437,1,438,2])).then(e=>({default:e.ComposerActionsPromptSuggestions}))),Cme=l.lazy(()=>N(()=>import("./composer-file-upload-prompt-suggestions-DJMgNNZ4.js"),__vite__mapDeps([439,1,438,2])).then(e=>({default:e.ComposerFileUploadPromptSuggestions})));function Sme(e){const{composerBottomSection:t,handleSubmit:n,focusInputHandler:o,uploadedAttachments:s,showAutoSuggest:a,autoSuggestResponse:r,autoSuggestRef:i,autoSuggestId:d,isLanding:m,shouldShowStarterPrompts:p}=e,h=(y,b)=>{c_({prompt:y,prefix:b}),n(y)},g=l.useCallback(()=>{Yi(!0),o()},[o]);return c.jsxs(c.Fragment,{children:[a&&c.jsx(l.Suspense,{fallback:null,children:c.jsx(vme,{id:d,dataResponse:r,onClick:(y,b)=>h(y,b),onHighlight:y=>du(y),onDismiss:g,className:"pointer-events-auto mb-3 sm:mb-0 sm:mt-3",ref:i})}),t==="actions-autosuggest"&&c.jsx(l.Suspense,{fallback:null,children:c.jsx(yme,{className:"pointer-events-auto mb-3 sm:mb-0 sm:mt-3",onClick:y=>Zi({prompt:y,prefillSource:"action"},m)})}),t==="file-upload-autosuggest"&&c.jsx(l.Suspense,{fallback:null,children:c.jsx(Cme,{className:"pointer-events-auto mb-3 sm:mb-0 sm:mt-3",isMultiple:s.length>1,variant:s[0]?.type??"file",onClick:y=>{n(y)}})}),t==="starter-prompts"&&p&&c.jsx(gme,{className:"pointer-events-auto sm:mt-8",onWidgetClick:y=>Eu(y,m)})]})}function bme(){return M(Mg).map(t=>t.id)}const Ime=l.lazy(()=>N(()=>import("./character-D7G0e5MN.js"),__vite__mapDeps([440,1,441,2])).then(e=>({default:e.Character})));function Eme(){const[e,t]=Le(Lc),{createConversation:n}=$r(),[o,s]=l.useState(!1),a=G(rT),r=G(ra),i=bme(),d=l.useRef(null),m=M(La);l.useEffect(()=>{if(d.current===null){const C=cle(i);C&&(d.current=C)}},[i]);const{t:p}=Z();l.useEffect(()=>{o&&d.current&&R.trackEvent({name:"system",data:{eventName:"characterPromotionShown",eventInfo_characterId:d.current}})},[o]),l.useEffect(()=>{const C=localStorage.getItem(DM);s(!C&&m.length>=10&&m.length<14)},[e,m.length]);function h(C){switch(C){case"mica":return"mica-head";case"aqua":return"aqua-head";case"erin":return"erin-head";default:return"mica-head"}}async function g(){d.current&&(r("clicking"),R.trackEvent({name:"interaction",data:{eventName:"characterPromotionClicked",eventInfo_characterId:d.current}}),a(!0),Og({settingName:"characterId",oldValue:"",newValue:d.current}),R.setSettings({userSettingCharacterId:d.current}),await Promise.all([Nt({path:"/user/settings",args:{options:{method:"PATCH"},query:{"api-version":"2"},body:{preferredCharacter:d.current}}})]))}const y=l.useCallback(async()=>{s(!1)},[]),b=l.useCallback(async()=>{d.current&&(s(!1),a(!0),t(d.current),await n())},[a,t,n]);return o?c.jsx("div",{className:"pointer-events-auto absolute -top-40 end-4 size-56 pb-2",onClick:g,onKeyDown:async C=>{C.key==="Enter"&&await g()},role:"button",tabIndex:0,"aria-label":p("characterAnimation.characterOptInAriaLabelText"),children:c.jsx(Ime,{className:"outline-none",characterId:h(d.current),onCharacterDismissed:y,onCharacterClicked:b})}):null}const m0="0px 0px 0px 1px rgb(255, 255, 255) inset",p0="0px 0px 0px 1px rgba(255, 255, 255, 0.08) inset",Tme="0px 10px 24px 0px rgba(0, 0, 0, 0.18)",wme="0px 42px 30px 0px rgba(0, 0, 0, 0.06)",Ame="0px 16px 48px 0 rgba(248, 188, 140, 0.18)",xme="0px 16px 48px 0 rgba(0, 0, 0, 0.12)",H3="rgba(0, 0, 0, 0.08)",z3="rgba(0, 0, 0, 0.16)",_me=`0px 16px 24px 0 ${H3}`,kme=`0px 16px 24px 0 ${z3}`,o2={boxShadow:{duration:1.5,ease:"easeInOut",type:"tween"}},Pme=28,Mme=32,Rme=24,Nme=26,Lme="relative flex grow flex-col overflow-hidden before:absolute before:inset-0 before:rounded-3xl before:border-2 before:border-stroke-350",Dme="w-auto rounded-3xl contrast-more:border-2",y_e="bg-gradient-to-b from-white/90 to-white/0 dark:from-black/30 dark:to-background-200/10",Ome="bg-white/90 dark:bg-background-100/45",mi="size-6";function s2(e){const{children:t,className:n}=e;return c.jsx(he.div,{className:n,initial:je,animate:rt,exit:je,transition:{delay:MA},children:t})}const Ume={initial:je,animate:rt};function Fme(e){const{titleKey:t,buttonTextKey:n,button:o,cancelButton:s,onClick:a,closeDialogCallback:r,textKey:i,textComponents:d}=e,{t:m}=Z(),p=m(t),h=m(o.textKey),g=l.useRef(null);return I1(g),c.jsxs(c.Fragment,{children:[c.jsx(he.div,{ref:g,layout:!0,variants:Ume,initial:"initial",animate:"animate",role:"dialog","aria-label":p,tabIndex:-1,children:c.jsxs("div",{className:"m-3 text-center text-foreground-800",children:[c.jsx("h2",{className:"py-3",children:p}),c.jsx("p",{className:"text-sm",children:c.jsx(mn,{i18nKey:i,components:d})}),n&&c.jsx("div",{className:"mx-auto flex w-full max-w-xs justify-around px-5 py-3 text-accent-600",children:c.jsx("button",{onClick:a,type:"button",className:"text-sm",children:m(n)})})]})}),c.jsxs(he.div,{className:"relative mx-0.5 my-1 flex w-full items-center justify-center gap-2 px-2 align-middle",children:[s&&c.jsx(ee,{variant:"rect",title:m(s.textKey),className:"relative my-3 flex h-10 max-w-40 items-center justify-center py-3 dark:bg-black/40 dark:hover:bg-black/40",onClick:()=>{r(),s.onClick()},children:m(s.textKey)}),c.jsx(ee,{variant:"rect",title:h,className:"relative my-3 flex h-10 max-w-40 items-center justify-center py-3 dark:bg-black/40 dark:hover:bg-black/40",onClick:()=>{r(),o.onClick()},children:h})]})]})}function jme(){const e=it("kill-domain-referrer");return l.useCallback(t=>zr(t,{preventReferrer:e}),[e])}function f0({className:e,style:t}){return c.jsx("div",{className:Ae("animate-[shimmer_2s_infinite] bg-black/5 bg-gradient-to-r dark:bg-white/5","from-transparent via-background-150 to-transparent","bg-[length:50%_100%] bg-no-repeat",e),style:t})}const Bme=new Set(["ads","tapToReveal"]);function Vme(e){const{isImageOrVideo:t,isInlineImageOrVideo:n}=e;let o="h-[300px]";return n?o="h-[150px]":t&&(o="h-[144px] sm:h-[176px]"),c.jsx("div",{className:"flex flex-col gap-3 px-4",children:c.jsx(f0,{className:Ae("w-full",o),style:{clipPath:"var(--clip-path-squircle-36)"}})})}function a2(e){const{type:t,length:n}=e;if(t&&Bme.has(t))return c.jsx("div",{});const o=t==="image"||t==="video",s=t==="inlineImage"||t==="inlineVideo",a=o&&n===1;return c.jsx(m1,{size:"md",stroke:!0,className:Ae("relative flex",a?"w-[300px]":"w-full","flex-col py-3 transition-opacity duration-300 ease-in-out"),children:c.jsx(Vme,{isImageOrVideo:o,isInlineImageOrVideo:s})})}function C_e(e){if(e.type==="image")return e.images.length;if(e.type==="video")return e.videos.length}const Hme=l.lazy(()=>N(()=>import("./upsell-block-F8ou4XAG.js"),__vite__mapDeps([442,1,2]))),zme=l.lazy(()=>N(()=>import("./price-tracking-block-CmIGwOIf.js").then(e=>e.p),__vite__mapDeps([443,1,350,347,444,445,353,352])).then(e=>({default:e.PriceTrackingBlock}))),Gme=l.lazy(()=>N(()=>Promise.resolve().then(()=>bve),void 0)),Wme=l.lazy(()=>N(()=>import("./over-task-quota-DxdK4Ng-.js"),__vite__mapDeps([446,1,447,448,2])).then(e=>({default:e.OverTaskQuota}))),$me=l.lazy(()=>N(()=>import("./computer-use-task-closed-BbosIeBB.js"),__vite__mapDeps([449,1,2,450,451,452,453,454,455,405,402,456,457,447,448])).then(e=>({default:e.ComputerUseTaskClosed}))),qme=l.lazy(()=>N(()=>import("./safety-risk-card-DD3r4TT1.js"),__vite__mapDeps([458,1,447,448,2])).then(e=>({default:e.SafetyRiskCard}))),Kme=l.lazy(()=>N(()=>import("./add-to-page-BYi-w3eM.js"),__vite__mapDeps([459,1,2])).then(e=>({default:e.AddToPage}))),Yme=l.lazy(()=>N(()=>import("./composer-prompt-review-CjokCwdy.js"),__vite__mapDeps([460,1,355,2]))),r2=l.lazy(()=>N(()=>import("./composer-action-CNvPGiiK.js"),__vite__mapDeps([447,1,448,2]))),Zme=l.lazy(()=>N(()=>import("./biometric-consent-BrZNj-4u.js"),__vite__mapDeps([461,1,2])).then(e=>({default:e.BiometricConsent}))),Jme=l.lazy(()=>N(()=>import("./composer-sign-in-C-BNjax6.js"),__vite__mapDeps([462,1,463,2])));function Qme(e){const{expandedSection:t,isDialogShown:n,expandedSectionPromptAction:o,chatModalRef:s,biometricConsentCallbacks:a,turnLimitReached:r,closeExpandedSection:i,onVoiceSettingChanged:d,toggleAudioSettingsVisibility:m}=e,{t:p}=Z(),h=G(yt),g=G(Yt),{login:y}=Fd(),b=Gc(),[C,T]=Le(Us),[S,E]=l.useMemo(()=>{const{reason:X}=C;return X?[p(`signInPrompt.${X}Header`,p("signInPrompt.header")),p(`signInPrompt.${X}Text`,p("signInPrompt.text"))]:[p("signInPrompt.header"),p("signInPrompt.textV2")]},[C,p]),I=async()=>{C.scenario&&(en({source:"signin",scenario:C.scenario}),T({isOpen:!1,scenario:null})),b?await qn({from:"/conversations",to:"/login"}):await y({provider:"microsoft",scenario:"composer"})},x=M(xK),w=M(Hw),[P,D]=Le(_K),L=jme(),j=q("shopping-card"),[U,$]=Le(Dse),K=()=>{i(),$(void 0)};return c.jsxs(he.div,{layoutId:"composer-expanded-section-container",className:O(!n&&!o&&"border-b border-black/10 dark:border-white/10",t==="audioSettings"&&"w-settings",o&&"w-prompt-sign-in",o&&(t==="computer-use-task-closed"||t==="safety-risk-card")&&"max-w-single-image"),layout:!0,children:[t!=="dialog"&&c.jsxs(he.div,{"data-testid":"audio-settings-dialog",className:O("t-custom-scrollbar max-h-expanded-section overflow-auto",t==="audioSettings"&&"px-2 py-4"),layout:!0,initial:je,animate:{...rt,transition:{delay:Wn.default}},ref:s,children:[c.jsx(It,{children:o&&c.jsxs(s2,{children:[t==="biometric-consent"&&c.jsx(l.Suspense,{fallback:c.jsx("div",{"aria-hidden":!0}),children:c.jsx(Zme,{onSubmit:a.onSubmitCallback,onCancel:a.onCancelCallback})}),t==="prompt-sign-in"&&c.jsx(l.Suspense,{fallback:c.jsx("div",{className:"flex h-expanded-composer-fallback items-center justify-center",children:c.jsx(xt,{className:"size-12"})}),children:c.jsx(r2,{header:S,text:E,primaryAction:{title:p("common.loginText"),onClick:I},testid:"prompt-sign-in-composer-action",secondaryAction:r?void 0:{onClick:i,title:p("common.maybeLater"),testid:"maybe-later-button"},onClose:i})}),t==="prompt-3p-sign-in"&&c.jsx(l.Suspense,{fallback:c.jsx("div",{className:"flex h-expanded-composer-fallback items-center justify-center",children:c.jsx(xt,{className:"size-12"})}),children:c.jsx(Jme,{dismiss:i})}),t==="confirm-link-navigation"&&P?.url&&c.jsx(l.Suspense,{fallback:c.jsx("div",{className:"flex h-expanded-composer-fallback items-center justify-center",children:c.jsx(xt,{className:"size-12"})}),children:c.jsx(r2,{showImage:!1,header:p("composer.linkConfirmation.header"),text:p("composer.linkConfirmation.text",{url:P.url}),primaryAction:{title:p("common.continue"),onClick:()=>{if(P.url){en({source:"linkNavigationConfirmButton",conversationId:P.conversationId,messageId:P.messageId,destination:pf(P.url)});try{L(Qu(pf(P.url)))}catch{h({intent:"error",title:p("composer.link.openFailed.title"),subtitle:p("composer.link.openFailed.message",{link:P.url}),dismissAfter:3e3})}i(),D(void 0)}}},secondaryAction:{onClick:()=>{i(),D(void 0)},title:p("common.cancel")},onClose:i,restoreFocusOnUnmount:!0})}),t==="prompt-review"&&c.jsx(l.Suspense,{fallback:c.jsx("div",{className:"flex h-expanded-composer-fallback items-center justify-center",children:c.jsx(xt,{className:"size-12"})}),children:c.jsx(Yme,{})}),j&&t==="shopping-upsell-card"&&c.jsx(l.Suspense,{fallback:c.jsx(a2,{}),children:c.jsx(Hme,{onDismiss:()=>g(null)})}),t==="shopping-price-tracking"&&U&&c.jsx(l.Suspense,{fallback:c.jsx(a2,{}),children:c.jsx(zme,{content:U.data,messageId:U.messageId,cardType:U.cardType,onConfirm:()=>g("shopping-upsell-card"),onCancel:K})}),t==="add-to-page"&&c.jsx(l.Suspense,{fallback:c.jsx("div",{className:"flex h-expanded-composer-fallback items-center justify-center",children:c.jsx(xt,{className:"size-12"})}),children:c.jsx(Kme,{onClose:i})}),t==="safety-risk-card"&&c.jsx(l.Suspense,{fallback:c.jsx("div",{className:"flex h-expanded-composer-fallback items-center justify-center",children:c.jsx(xt,{className:"size-12"})}),children:c.jsx(qme,{})}),t==="computer-use-task-closed"&&c.jsx(l.Suspense,{fallback:c.jsx("div",{className:"flex h-expanded-composer-fallback items-center justify-center",children:c.jsx(xt,{className:"size-12"})}),children:c.jsx($me,{})}),t==="over-task-quota"&&c.jsx(l.Suspense,{fallback:c.jsx("div",{className:"flex h-expanded-composer-fallback items-center justify-center",children:c.jsx(xt,{className:"size-12"})}),children:c.jsx(Wme,{})})]})}),t==="audioSettings"&&c.jsx(s2,{children:c.jsx(l.Suspense,{fallback:c.jsx("div",{className:"flex h-expanded-composer-fallback items-center justify-center",children:c.jsx(xt,{className:"size-12"})}),children:c.jsx(Gme,{onVoiceSettingChanged:d,onAppearanceEnabled:m})})})]}),n&&x&&w&&c.jsx(Fme,{titleKey:x.titleKey,textKey:x.textKey,buttonTextKey:x.buttonTextKey,onClick:x.onClick,button:w.button,cancelButton:w.cancelButton,closeDialogCallback:w.closeDialogCallback,textComponents:x.textComponents})]})}function Xme(e,t){const{children:n,className:o,margins:s,data:a,size:r="regular",onButtonRef:i}=e,d=a.isDisabled?"":a.title,m=r==="small";return c.jsx(he.div,{className:O("relative shrink-0",s??"my-1",m?"h-9":"h-10",a.isVisible&&!m&&"size-10",a.isVisible&&m&&"size-9",!a.isVisible&&"overflow-hidden"),layout:!0,initial:!1,ref:t,children:c.jsx(he.button,{type:"button",className:O("absolute flex items-center justify-center rounded-xl fill-foreground-750",m?"size-9 p-1":"size-10 p-2",hu["subtle-dimmed"],"disabled:active:bg-transparent disabled:active:bg-none",a.isDisabled&&IA,o),layout:"position",disabled:!a.isVisible||a.isDisabled,"aria-hidden":!a.isVisible,"aria-label":d,title:d,onClick:a.onClick,"data-testid":a.testId,"aria-expanded":typeof a.ariaExpanded=="boolean"?a.ariaExpanded:void 0,ref:i,children:n})})}const ea=l.forwardRef(Xme),G3=({title:e,titleId:t,...n})=>l.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M2 6.25C2 4.45507 3.45507 3 5.25 3H18.75C20.5449 3 22 4.45507 22 6.25V12H20.5V6.25C20.5 5.2835 19.7165 4.5 18.75 4.5H5.25C4.2835 4.5 3.5 5.2835 3.5 6.25V15.75C3.5 16.7165 4.2835 17.5 5.25 17.5H11V19H5.25C3.45507 19 2 17.5449 2 15.75V6.25ZM14 13C12.8954 13 12 13.8954 12 15V20C12 21.1046 12.8954 22 14 22H21C22.1046 22 23 21.1046 23 20V15C23 13.8954 22.1046 13 21 13H14Z"})),S_e=Object.freeze(Object.defineProperty({__proto__:null,default:G3},Symbol.toStringTag,{value:"Module"}));function epe(e){const{onClick:t}=e,{t:n}=Z();return c.jsx(ea,{data:{title:n("videoCard.pictureInPicture.miniPlayer"),testId:"trigger-picture-in-picture",isVisible:!0,onClick:t},children:c.jsx(G3,{className:"size-6","aria-hidden":!0})})}const Wf=({title:e,titleId:t,...n})=>l.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M18.2498 20.5009C18.664 20.5008 19 20.8365 19 21.2507C19 21.6649 18.6644 22.0008 18.2502 22.0009L5.25022 22.0047C4.836 22.0048 4.5 21.6691 4.5 21.2549C4.5 20.8407 4.83557 20.5048 5.24978 20.5047L18.2498 20.5009ZM11.6482 2.01271L11.75 2.00586C12.1297 2.00586 12.4435 2.28801 12.4932 2.65409L12.5 2.75586L12.499 16.4409L16.2208 12.7205C16.4871 12.4543 16.9038 12.4301 17.1974 12.648L17.2815 12.7206C17.5477 12.9869 17.5719 13.4036 17.354 13.6972L17.2814 13.7813L12.2837 18.7779C12.0176 19.044 11.6012 19.0683 11.3076 18.8507L11.2235 18.7782L6.22003 13.7816C5.92694 13.4889 5.92661 13.014 6.21931 12.7209C6.48539 12.4545 6.90204 12.43 7.1958 12.6477L7.27997 12.7202L10.999 16.4339L11 2.75586C11 2.37616 11.2822 2.06237 11.6482 2.01271L11.75 2.00586L11.6482 2.01271Z",fill:"currentColor"})),b_e=Object.freeze(Object.defineProperty({__proto__:null,default:Wf},Symbol.toStringTag,{value:"Module"})),$f=({title:e,titleId:t,...n})=>l.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M10.25 3.00011C10.6642 3.00011 10.9999 3.33596 11 3.75011C11 4.16432 10.6642 4.50011 10.25 4.50011H6.75C5.50741 4.50011 4.50008 5.50753 4.5 6.75011V17.2501L4.51172 17.4806C4.62714 18.6149 5.58517 19.5001 6.75 19.5001H17.25C18.4926 19.5001 19.5 18.4927 19.5 17.2501V15.2501C19.5001 14.836 19.8358 14.5001 20.25 14.5001C20.6642 14.5001 20.9999 14.836 21 15.2501V17.2501C21 19.3212 19.3211 21.0001 17.25 21.0001H6.75C4.74378 21.0001 3.10551 19.4247 3.00488 17.4435L3 17.2501V6.75011C3.00008 4.6791 4.67898 3.00011 6.75 3.00011H10.25ZM14.9365 2.06847C15.2026 1.94614 15.5159 1.99023 15.7383 2.18077L22.7383 8.18077C22.8986 8.31823 22.9938 8.51756 23 8.72862C23.006 8.9396 22.9224 9.14361 22.7705 9.29015L15.7705 16.0401C15.554 16.2488 15.2338 16.308 14.957 16.1905C14.6802 16.0729 14.5 15.801 14.5 15.5001V12.5245C13.4857 12.5881 12.5295 12.7973 11.5605 13.2931C10.4241 13.8745 9.21642 14.8746 7.87109 16.5958L7.59961 16.9503C7.40588 17.2083 7.06883 17.3141 6.7627 17.212C6.45646 17.1099 6.25 16.8229 6.25 16.5001C6.25002 13.6428 6.93659 10.911 8.41797 8.87218C9.7938 6.97888 11.8288 5.72554 14.5 5.52843V2.75011L14.5078 2.64171C14.5441 2.39296 14.7037 2.17553 14.9365 2.06847ZM16 6.25011C16 6.66432 15.6642 7.00011 15.25 7.00011C12.6933 7.00011 10.855 8.07008 9.63184 9.75304C8.75387 10.9612 8.17794 12.5102 7.91504 14.2462C8.91534 13.1988 9.89198 12.4611 10.877 11.9571C12.3601 11.1983 13.801 11.0001 15.25 11.0001C15.4489 11.0001 15.6396 11.0792 15.7803 11.2198C15.9209 11.3605 16 11.5512 16 11.7501V13.7345L21.1348 8.78233L16 4.37999V6.25011Z"})),I_e=Object.freeze(Object.defineProperty({__proto__:null,default:$f},Symbol.toStringTag,{value:"Module"}));function tpe(){return!it("kill-anonymous-user-share")}const npe=_(void 0);function i2({conversationId:e,messageId:t,scenario:n,trackShareClick:o=()=>{}}){const s=M(Te),a=e??s,r=tpe(),i=G(npe),d=l.useRef(null),m=l.useCallback(()=>{if(!a){Kne({conversationId:"",messageId:t,errorName:"conversationNotFound",errorMessage:"Conversation ID is missing"});return}i({conversationId:a,action:"share",messageId:t,scenario:n,onClose:()=>{setTimeout(()=>{d.current?.focus()},0)}}),o()},[a,t,n,i,o]),p=p3({callback:m,onShowSignIn:o,signInScenario:"loggedOutSharing",signInReason:"shareMessage"});return{shareClickHandler:l.useMemo(()=>r?m:p,[r,m,p]),shareRef:d}}function ope(e){Je({feature:"fileDownload",errorType:"DownloadFileError",errorMessage:e})}function spe(e){const{expandedSection:t,isDialogShown:n}=e,{t:o}=Z(),{closeMediaViewer:s,isPictureInPictureSupported:a,triggerPictureInPicture:r,contentComposerType:i,triggerVideoDownload:d}=Ro(),m=M(Yr),p=ude(),h=q("video-sharing"),{shareClickHandler:g}=i2({messageId:m?.messageId,scenario:"shareAsLinkSingleImage",trackShareClick:()=>tS({scenario:"shareAsLinkSingleImage",pageName:"imageDetailPage"})}),{shareClickHandler:y}=i2({messageId:m?.messageId,scenario:"shareAsLinkSingleVideo",trackShareClick:()=>tS({scenario:"shareAsLinkSingleVideo",pageName:"videoDetailPage"})}),b={title:o("imageCard.composer.closeImageViewer"),icon:c.jsx(on,{className:mi,"aria-hidden":!0}),isVisible:!0,onClick:s},C={title:o("common.share"),icon:c.jsx($f,{className:mi,"aria-hidden":!0}),isVisible:!0,onClick:g},T={title:o("imageCard.composer.downloadImage"),icon:c.jsx(Wf,{className:mi,"aria-hidden":!0}),isVisible:!0,onClick:async()=>{if(p?.type==="image")try{await Hoe({url:p.url,fileName:Ox()})}catch(P){const D=P instanceof Error?P.message:"unknown error on downloading image";ope(D)}}},S={title:o("video.downloadVideoViewer"),icon:c.jsx(Wf,{className:mi,"aria-hidden":!0}),isVisible:!0,onClick:d},E={title:o("common.share"),icon:c.jsx($f,{className:mi,"aria-hidden":!0}),isVisible:!0,onClick:y},I=i===As.IMAGE_VIEWER,x=i===As.CLOSE_BUTTON,w=J.instance().config().uiOverrides?.hideImageDownloadButton;return x?c.jsxs(he.div,{className:O("relative flex max-h-full max-w-chat justify-center",!t&&"p-2",!n&&"h-composer"),layout:!0,children:[c.jsx(ea,{data:b,children:b.icon}),a&&c.jsx(epe,{onClick:r}),h&&p?.type==="video"&&p.shareable&&c.jsx(ea,{data:E,children:E.icon}),d&&c.jsx(ea,{data:S,children:S.icon})]}):I?c.jsxs(he.div,{className:O("relative flex max-h-full max-w-chat justify-center",!t&&"p-2",!n&&"h-composer"),layout:!0,children:[c.jsx(ea,{data:b,children:b.icon}),p?.type==="image"&&p.shareable&&c.jsx(ea,{data:C,children:C.icon}),p?.type==="image"&&p.downloadable&&!w&&c.jsx(ea,{data:T,children:T.icon})]}):null}function Ga(e){l.useEffect(()=>(window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}),[e])}const W3=({title:e,titleId:t,...n})=>l.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M17.7545 14.0002C18.9966 14.0002 20.0034 15.007 20.0034 16.2491V16.8245C20.0034 17.7188 19.6838 18.5836 19.1023 19.263C17.5329 21.0965 15.1457 22.0013 12.0004 22.0013C8.8545 22.0013 6.46849 21.0962 4.90219 19.2619C4.32242 18.583 4.00391 17.7195 4.00391 16.8267V16.2491C4.00391 15.007 5.01076 14.0002 6.25278 14.0002H17.7545ZM17.7545 15.5002H6.25278C5.83919 15.5002 5.50391 15.8355 5.50391 16.2491V16.8267C5.50391 17.3624 5.69502 17.8805 6.04287 18.2878C7.29618 19.7555 9.26206 20.5013 12.0004 20.5013C14.7387 20.5013 16.7063 19.7555 17.9627 18.2876C18.3117 17.8799 18.5034 17.361 18.5034 16.8245V16.2491C18.5034 15.8355 18.1681 15.5002 17.7545 15.5002ZM12.0004 2.00488C14.7618 2.00488 17.0004 4.24346 17.0004 7.00488C17.0004 9.76631 14.7618 12.0049 12.0004 12.0049C9.23894 12.0049 7.00036 9.76631 7.00036 7.00488C7.00036 4.24346 9.23894 2.00488 12.0004 2.00488ZM12.0004 3.50488C10.0674 3.50488 8.50036 5.07189 8.50036 7.00488C8.50036 8.93788 10.0674 10.5049 12.0004 10.5049C13.9334 10.5049 15.5004 8.93788 15.5004 7.00488C15.5004 5.07189 13.9334 3.50488 12.0004 3.50488Z"})),E_e=Object.freeze(Object.defineProperty({__proto__:null,default:W3},Symbol.toStringTag,{value:"Module"})),c2=new Map;function ape(e){const t=e.trim();if(!t)return rpe;const n=c2.get(t);if(n)return n;const o=upe(t);return c2.set(t,o),o}const rpe="#3a3a3a",ipe=4.5,pi=.18,cpe=.62,xl=.03,lpe=.25;function upe(e){const t=mpe(e.normalize("NFC")),n=vp(t,360),o=lpe-xl,s=vp(xu(t,2**8),256),a=xl+s/255*o,r=vp(xu(t,2**16),256);let d=pi+r/255*(cpe-pi),m=a;for(let h=0;h<40;h+=1){const g=l2({l:d,c:m,h:n});if(dpe(g.luminance)>=ipe)return u2(g.r,g.g,g.b);if(d-=.015,d<pi){if(m*=.9,m<xl*.6)break;d=pi}}const p=l2({l:pi,c:xl,h:n});return u2(p.r,p.g,p.b)}function dpe(e){return(1+.05)/(e+.05)}function mpe(e){let t=2166136261;const n=16777619;for(let o=0;o<e.length;o+=1){const s=e.charCodeAt(o);t=vpe(t,s),t=ype(t,n)}return h0(t)}function ppe({l:e,c:t,h:n}){const o=n*Math.PI/180;return{L:e,a:Math.cos(o)*t,b:Math.sin(o)*t}}function fpe(e,t,n){const o=e+.3963377774*t+.2158037573*n,s=e-.1055613458*t-.0638541728*n,a=e-.0894841775*t-1.291485548*n,r=o**3,i=s**3,d=a**3;return{r:4.0767416621*r-3.3077115913*i+.2309699292*d,g:-1.2684380046*r+2.6097574011*i-.3413193965*d,b:-.0041960863*r-.7034186147*i+1.707614701*d}}function gp(e){return e<=.0031308?12.92*e:1.055*e**(1/2.4)-.055}function Qn(e){return e<0?0:e>1?1:e}function hpe(e,t,n){return .2126*e+.7152*t+.0722*n}function l2(e){const{l:t,h:n}=e;let{c:o}=e;for(let a=0;a<12;a+=1){const{L:r,a:i,b:d}=ppe({l:t,c:o,h:n}),m=fpe(r,i,d);if(gpe(m)){const p=hpe(Qn(m.r),Qn(m.g),Qn(m.b));return{r:Qn(gp(Qn(m.r))),g:Qn(gp(Qn(m.g))),b:Qn(gp(Qn(m.b))),luminance:p}}o*=.85}const s=Qn(t**3);return{r:s,g:s,b:s,luminance:s}}function gpe({r:e,g:t,b:n}){return e>=0&&e<=1&&t>=0&&t<=1&&n>=0&&n<=1}function h0(e){return(e%4294967296+4294967296)%4294967296}function vpe(e,t){let n=0;for(let o=0;o<32;o+=1){const s=xu(e,2**o)%2,a=xu(t,2**o)%2;s!==a&&(n+=2**o)}return h0(n)}function ype(e,t){return h0(Math.imul(e,t))}function vp(e,t){return(e%t+t)%t}function xu(e,t){return Math.floor(e/t)}function yp(e){return Math.round(Qn(e)*255).toString(16).padStart(2,"0")}function u2(e,t,n){return`#${yp(e)}${yp(t)}${yp(n)}`}const Cp="relative size-full rounded-full aspect-square",d2="flex items-center justify-center uppercase",Sp="after:absolute after:-inset-px after:rounded-full after:border-[0.5px] after:border-black/10 dark:after:border-white/20";function $3(e){const{firstName:t,imgSrc:n,nameSizeClass:o,altText:s,showTwoCharacters:a=!1,showBorder:r=!0}=e;if(n)return c.jsx("img",{className:O("overflow-hidden object-cover",Cp,r&&Sp),src:n,alt:s??F("common.profileImage")});if(t){let i={},d=t[0];if(a){const m=t.trim().split(/\s+/).filter(Boolean);m.length>=2&&(d=m.slice(0,2).map(p=>p[0]).join("")),i={backgroundColor:ape(t)}}return c.jsx("div",{className:O(Cp,d2,r&&Sp,o??"text-lg",a&&"text-white"),style:i,children:c.jsx("div",{children:d})})}return c.jsx("div",{className:O(Cp,d2,r&&Sp),children:c.jsx(W3,{className:O("size-6 fill-foreground-800",PZ),"alt-text":s??F("common.profileImage")})})}const Cpe=Object.freeze(Object.defineProperty({__proto__:null,default:$3},Symbol.toStringTag,{value:"Module"}));function Spe({participants:e,onSelect:t,onClose:n,position:o,selectedIndex:s=-1}){const{t:a}=Z(),r=l.useRef(null),i=s>=0?`mention-option-${s}`:void 0;l.useEffect(()=>{if(i){const m=document.getElementById(i);m&&m.scrollIntoView({block:"nearest",behavior:"smooth"})}},[i]),Xo({onOutsideEvent:n,elements:[r],includeScroll:!1,includeFocus:!1}),Ga(m=>{m.key==="Escape"&&n()});const d=l.useMemo(()=>({position:"fixed",left:`${o.x}px`,top:`${o.y-12}px`,transform:o.isRtl?"translateY(-100%) translateX(-100%)":"translateY(-100%)"}),[o.x,o.y,o.isRtl]);return e.length===0?null:c.jsx(he.div,{ref:r,initial:je,animate:rt,exit:je,transition:See,"data-testid":"composer-mention-list",style:d,role:"listbox","aria-label":a("userInput.mentionSuggestions"),"aria-activedescendant":i,className:O("pointer-events-auto z-50","flex w-56 flex-col items-center gap-1.5 p-2","max-h-dvh-0.5","rounded-2xl border border-white/90 shadow-lg",lo,"dark:border-white/10"),children:c.jsx("div",{className:"flex w-full flex-col gap-1.5 overflow-y-auto",children:e.map((m,p)=>c.jsxs(ee,{color:"subtle-dimmed",title:m.userDisplayName??m.userId,className:O("justify-start",p===s&&"bg-background-300 dark:bg-background-600"),id:`mention-option-${p}`,role:"option","aria-selected":p===s,onClick:()=>t(m),onKeyDown:h=>{(h.key==="Enter"||h.key===" ")&&t(m)},children:[c.jsx("div",{className:"size-8 shrink-0 overflow-hidden rounded-full",children:m.userId==="copilot"?c.jsx("div",{className:"flex size-full items-center justify-center bg-white",children:c.jsx(M3,{className:"size-full"})}):c.jsx($3,{firstName:m.userDisplayName??"",nameSizeClass:"text-base-medium",showTwoCharacters:!0})}),c.jsx("span",{className:"truncate text-foreground-800 text-sm",children:m.userDisplayName??m.userId})]},m.userId))})})}function Li(e){const t=ke(),o={...t.get(nf),[e]:new Date().toISOString()};t.set(nf,o)}const m2=new Map;function bpe(e){let t=m2.get(e);return t||(t=Ru(nf,n=>!!n[e]),m2.set(e,t)),t}function g0(e){const t=M(bpe(e)),n=l.useCallback(()=>{Li(e)},[e]);return l.useMemo(()=>({alreadyShown:t,dismissCoachmark:n}),[t,n])}const q3="appearanceColorShuffler",Ipe="appearanceSetting",T_e="appearanceVoiceCustomization",w_e="pagesEditThisResponse",A_e="pageSourcesFirstRun",x_e="pageSourcesFirstAdd",__e="galleryDetailPrompt",k_e="GalleryComposerFileUpload",K3="vision",P_e="audioExpressionModeSelector",Epe="studyLive",Tpe="inlineBrowsingPreviousConversations",M_e="inviteTooltip",R_e="flashcardReviewMissed",N_e="mapPanel",L_e="mapLayerDropdown",wpe=1e3,p2=2;function Ape(){const e=W1(),{alreadyShown:t,dismissCoachmark:n}=g0(Epe),[o,s]=Le(sue),[a,r]=l.useState(!1),i=l.useRef(null),d=e&&!t&&o<p2,m=l.useCallback(()=>{o>=p2&&n(),i.current=setTimeout(()=>{r(!1),i.current=null},wpe)},[n,o]);return l.useEffect(()=>()=>{i.current&&(clearTimeout(i.current),i.current=null)},[]),l.useEffect(()=>{d&&(s(p=>p+1),setTimeout(()=>{r(!0)},1e3))},[d,s]),{showStudyLiveCoachmark:a,dismissStudyLiveCoachmark:m}}function xpe(){const e=q("vision-coachmark"),{alreadyShown:t,dismissCoachmark:n}=g0(K3);if(!e)return{shouldShowVisionCoachmark:!1,dismissVisionCoachmark:()=>{}};const o=qt(KM,k()),s=24*60*60*1e3*60,a=!o||Date.now()-o>s;return{shouldShowVisionCoachmark:!t&&a,dismissVisionCoachmark:n}}function Y3(e){const{renderReferenceElement:t,children:n,className:o,placement:s,offset:a,isOpen:r=!0,onOpenChange:i,portalId:d,withArrow:m=!1,arrowClassName:p="dark:fill-black fill-white",animation:h="none",onOutsideEvent:g,onInsideEvent:y,invokeOnce:b=!0,includeScroll:C=!0}=e,T=l.useRef(null),{refs:S,x:E,y:I,strategy:x,context:w,placement:P}=ac({open:r,onOpenChange:i,placement:s??"right",middleware:[nc(a??1),oc({fallbackAxisSideDirection:"end"}),sc(),H9({element:T})],whileElementsMounted:kr});Xo({onOutsideEvent:()=>{g?.()},invokeOnce:b,elements:[S.floating],includeScroll:C});const D=uh(w),L=rc(w),j=Lu(w),U=Hc(),{getReferenceProps:$,getFloatingProps:K}=Du([D,L,j]),X=M(ss),ne=_pe(h,P);return c.jsxs(c.Fragment,{children:[t?.({ref:S.setReference,...$()},r),r&&c.jsx(Nu,{id:d,children:c.jsxs(he.div,{ref:S.setFloating,style:{position:x,top:`${I}px`,[U?"insetInlineEnd":"insetInlineStart"]:`${E}px`,boxShadow:X==="dark"?"0px 0px 0px 1px rgba(255, 255, 255, 0.08) inset":void 0},...ne,...K({}),className:Ae("flex rounded-2xl p-4 shadow-xl",at.coachmark,zK,m&&"!overflow-visible",o),onClick:y,children:[n,m?c.jsx(z9,{ref:T,context:w,tipRadius:3,strokeWidth:2,className:p}):null]})})]})}function _pe(e,t){switch(e){case"bounce":return kpe(t);case"none":return{};default:return{}}}function kpe(e){const n=e.startsWith("top")||e.startsWith("bottom"),o=e.startsWith("top")||e.startsWith("left")?-1:1;return n?{animate:{y:`${o*10}px`,transition:BC}}:{animate:{x:`${o*10}px`,transition:BC}}}function Ppe({triggerComponent:e}){const{t}=Z(),{isOpen:n,title:o,description:s,dismiss:a}=Mpe(),r=i=>{i.stopPropagation(),a()};return c.jsx(Y3,{className:"max-w-48 cursor-pointer bg-black dark:bg-background-850",arrowClassName:"dark:fill-background-850 fill-black",isOpen:n,placement:"top-end",withArrow:!0,renderReferenceElement:i=>c.jsx("div",{ref:i.ref,className:"relative",children:e}),portalId:"composer-container",onInsideEvent:()=>{a()},onOutsideEvent:a,children:c.jsxs("div",{className:"flex max-w-[160px] flex-col gap-0.5 bg-black text-white dark:bg-background-850 dark:text-black",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{className:"text-xs-strong",children:o}),c.jsx("button",{onClick:r,type:"button","aria-label":t("common.dismiss"),children:c.jsx(on,{className:"size-4"})})]}),c.jsx("div",{className:"text-xs",children:s})]})})}function Mpe(){const{t:e}=Z(),{shouldShowVisionCoachmark:t,dismissVisionCoachmark:n}=xpe(),{showStudyLiveCoachmark:o,dismissStudyLiveCoachmark:s}=Ape(),a=q("feature-discovery");return t?{isOpen:!0,title:e("composer.chatModes.vision.coachmarkTitle"),description:e("composer.chatModes.vision.description"),dismiss:n}:o&&!a?{isOpen:!0,title:e("composer.chatModes.study.live.coachmarkTitle"),description:e("composer.chatModes.study.live.coachmarkDescription"),dismiss:s}:{isOpen:!1,title:"",description:"",dismiss:()=>{}}}const Rpe=({title:e,titleId:t,...n})=>l.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M12.0001 3C12.3798 3 12.6936 3.28215 12.7433 3.64823L12.7501 3.75V20.25C12.7501 20.6642 12.4143 21 12.0001 21C11.6204 21 11.3066 20.7178 11.257 20.3518L11.2501 20.25V3.75C11.2501 3.33579 11.5859 3 12.0001 3ZM8.25505 6C8.63475 6 8.94854 6.28215 8.99821 6.64823L9.00505 6.75V17.25C9.00505 17.6642 8.66927 18 8.25505 18C7.87536 18 7.56156 17.7178 7.5119 17.3518L7.50505 17.25V6.75C7.50505 6.33579 7.84084 6 8.25505 6ZM15.7452 6C16.1249 6 16.4387 6.28215 16.4883 6.64823L16.4952 6.75V17.25C16.4952 17.6642 16.1594 18 15.7452 18C15.3655 18 15.0517 17.7178 15.002 17.3518L14.9952 17.25V6.75C14.9952 6.33579 15.3309 6 15.7452 6ZM4.75122 9C5.13092 9 5.44471 9.28215 5.49437 9.64823L5.50122 9.75V14.25C5.50122 14.6642 5.16543 15 4.75122 15C4.37152 15 4.05773 14.7178 4.00807 14.3518L4.00122 14.25V9.75C4.00122 9.33579 4.33701 9 4.75122 9ZM19.2523 9C19.632 9 19.9458 9.28215 19.9955 9.64823L20.0023 9.75V14.2487C20.0023 14.6629 19.6665 14.9987 19.2523 14.9987C18.8726 14.9987 18.5588 14.7165 18.5091 14.3504L18.5023 14.2487V9.75C18.5023 9.33579 18.8381 9 19.2523 9Z"})),Z3=({title:e,titleId:t,...n})=>l.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16.7673 6.54284C16.7673 3.91128 14.634 1.77799 12.0024 1.77799C9.37089 1.77799 7.2376 3.91129 7.2376 6.54284L7.2376 13.5647C7.2376 16.1963 9.37089 18.3296 12.0024 18.3296C14.634 18.3296 16.7673 16.1963 16.7673 13.5647L16.7673 6.54284ZM12.0024 3.28268C13.803 3.28268 15.2626 4.7423 15.2626 6.54284L15.2626 13.5647C15.2626 15.3652 13.803 16.8249 12.0024 16.8249C10.2019 16.8249 8.74229 15.3652 8.74229 13.5647L8.74229 6.54284C8.74229 4.7423 10.2019 3.28268 12.0024 3.28268Z",fill:"currentColor"}),l.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M20.0274 8.79987C19.6119 8.79987 19.2751 9.1367 19.2751 9.55221V13.5647C19.2751 17.5813 16.019 20.8374 12.0024 20.8374C7.98587 20.8374 4.72979 17.5813 4.72979 13.5647L4.72979 9.55221C4.72979 9.1367 4.39295 8.79987 3.97744 8.79987C3.56193 8.79987 3.2251 9.1367 3.2251 9.55221L3.2251 13.5647C3.2251 18.4123 7.15485 22.3421 12.0024 22.3421C16.85 22.3421 20.7798 18.4123 20.7798 13.5647V9.55221C20.7798 9.1367 20.443 8.79987 20.0274 8.79987Z",fill:"currentColor"})),D_e=Object.freeze(Object.defineProperty({__proto__:null,default:Z3},Symbol.toStringTag,{value:"Module"}));let _l=null;async function J3(){return _l||(_l=Promise.all([N(()=>import("./character-talk-CAJD506h.js"),__vite__mapDeps([464,1,465,466,2])),N(()=>import("./appearance-component-wrapper-Bo7fv97Z.js"),__vite__mapDeps([467,1,468,465,433,15,13,14,16,17,37,35,38,39,40,41,42,43,44,45,46,47,48,49,50,51,24,18,25,54,22,23,26,27,28,29,30,31,32,33,34,36,21,52,53,203,224,69,70,150,165,183,182,195,194,138,135,136,144,142,160,157,159,149,163,166,270,211,72,190,277,269,271,122,299,2]))]).then(()=>{}),_l)}function Npe(e){const{onClick:t}=e;if(!Ba())return c.jsx(Ppe,{triggerComponent:c.jsx(Lpe,{onClick:t})})}function Lpe(e){const{onClick:t}=e,{t:n}=Z(),o=js(),s=q("appr-preload-onhover"),a=q("voice-enable-new-audio-icon"),r=l.useCallback(()=>{o&&s&&J3()},[o,s]);return c.jsx(ee,{title:n("composer.startAudioCall"),"aria-label":n("composer.startAudioCall"),variant:"rect",size:"36-sm",color:"subtle-dimmed",className:O("h-9 select-none gap-1 rounded-2xl p-0"),onClick:t,onFocus:r,onMouseEnter:r,onTouchStart:r,testId:"audio-call-button",children:a?c.jsx(Rpe,{className:"size-6","aria-hidden":!0}):c.jsx(Z3,{className:"size-6","aria-hidden":!0})})}const Q3=({title:e,titleId:t,...n})=>l.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M10.0585 3.97266C10.4313 3.97266 10.7343 4.27467 10.7343 4.64747C10.7341 5.02007 10.4312 5.32227 10.0585 5.32227H8.79092C8.16618 5.3224 7.57586 5.61134 7.19229 6.1045L5.26456 8.58204C5.56062 8.52971 5.86559 8.50196 6.17667 8.50196C8.61742 8.50215 10.6643 10.1823 11.2265 12.4492C11.7204 12.2453 12.2784 12.2455 12.7724 12.4492C13.3345 10.1822 15.3823 8.50207 17.8232 8.50196C18.134 8.50196 18.4384 8.5298 18.7343 8.58204L16.8075 6.1045C16.4239 5.61131 15.8337 5.32236 15.2089 5.32227H13.9413C13.5687 5.32224 13.2658 5.02005 13.2655 4.64747C13.2655 4.27469 13.5686 3.97269 13.9413 3.97266H15.2089C16.2503 3.97275 17.2336 4.45337 17.873 5.2754L21.5917 10.0566C21.6288 10.1044 21.6553 10.1568 21.6776 10.21C22.516 11.1338 23.0272 12.3602 23.0273 13.7061C23.0271 16.5802 20.6973 18.9102 17.8232 18.9102C15.0454 18.91 12.776 16.7337 12.6269 13.9932L12.4774 13.8438C12.2138 13.5802 11.7859 13.5802 11.5224 13.8438L11.372 13.9941C11.2223 16.7341 8.95399 18.9099 6.17667 18.9102C3.30252 18.9101 0.972747 16.5802 0.972566 13.7061C0.972585 12.3604 1.48301 11.1338 2.3212 10.21C2.3436 10.1567 2.37099 10.1045 2.40811 10.0566L6.12686 5.2754C6.76619 4.4534 7.74958 3.97279 8.79092 3.97266H10.0585ZM6.17667 9.85157C4.04802 9.85161 2.32222 11.5774 2.32217 13.7061C2.32236 15.8346 4.0481 17.5605 6.17667 17.5606C8.30508 17.5603 10.031 15.8345 10.0312 13.7061C10.0311 11.5775 8.30517 9.85179 6.17667 9.85157ZM17.8232 9.85157C15.6946 9.85169 13.9687 11.5775 13.9687 13.7061C13.9688 15.8345 15.6947 17.5604 17.8232 17.5606C19.9518 17.5606 21.6775 15.8346 21.6776 13.7061C21.6776 11.5774 19.9518 9.85157 17.8232 9.85157Z"})),O_e=Object.freeze(Object.defineProperty({__proto__:null,default:Q3},Symbol.toStringTag,{value:"Module"}));function Dpe(e){const{onClick:t}=e,n=Ba(),{t:o}=Z();if(!n)return c.jsx(ee,{title:o("composer.startVisionCall"),"aria-label":o("composer.startVisionCall"),variant:"rect",size:"36-sm",color:"subtle-dimmed",className:O("h-9 select-none gap-1 rounded-2xl p-0"),onClick:t,testId:"vision-call-button",children:c.jsx(Q3,{className:"size-6","aria-hidden":!0})})}function bp({config:e}){const{t}=Z();if(e)switch(e.mode){case"stop":return c.jsx(ee,{testId:"stop-button",color:"accent",variant:"circle",size:"36-sm","aria-label":t("composer.stopButton"),title:t("composer.stopButton"),onClick:e.onClick,children:c.jsx("div",{className:"size-3.5 rounded bg-accent-550 contrast-more:border-2 dark:bg-accent-150"})});case"submit":return c.jsx(ee,{testId:"submit-button",color:"strong",variant:"square",size:"36-sm",className:"rounded-2xl","aria-label":t("userInput.submitButtonText"),title:t("userInput.submitButtonText"),onClick:e.onClick,disabled:e.disabled,children:c.jsx(Hr,{className:"size-6"})});case"microphone":return c.jsx(Npe,{onClick:e.onClick});case"vision":return c.jsx(Dpe,{onClick:e.onClick});default:return}}const X3=({title:e,titleId:t,...n})=>l.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2ZM12 3.5C7.30558 3.5 3.5 7.30558 3.5 12C3.5 16.6944 7.30558 20.5 12 20.5C16.6944 20.5 20.5 16.6944 20.5 12C20.5 7.30558 16.6944 3.5 12 3.5ZM12 7C12.4142 7 12.75 7.33579 12.75 7.75V11.25H16.25C16.6642 11.25 17 11.5858 17 12C17 12.4142 16.6642 12.75 16.25 12.75H12.75V16.25C12.75 16.6642 12.4142 17 12 17C11.5858 17 11.25 16.6642 11.25 16.25V12.75H7.75C7.33579 12.75 7 12.4142 7 12C7 11.5858 7.33579 11.25 7.75 11.25H11.25V7.75C11.25 7.33579 11.5858 7 12 7Z"})),U_e=Object.freeze(Object.defineProperty({__proto__:null,default:X3},Symbol.toStringTag,{value:"Module"})),ek=({title:e,titleId:t,...n})=>l.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2ZM15.2197 8.96967L10.75 13.4393L8.78033 11.4697C8.48744 11.1768 8.01256 11.1768 7.71967 11.4697C7.42678 11.7626 7.42678 12.2374 7.71967 12.5303L10.2197 15.0303C10.5126 15.3232 10.9874 15.3232 11.2803 15.0303L16.2803 10.0303C16.5732 9.73744 16.5732 9.26256 16.2803 8.96967C15.9874 8.67678 15.5126 8.67678 15.2197 8.96967Z"})),F_e=Object.freeze(Object.defineProperty({__proto__:null,default:ek},Symbol.toStringTag,{value:"Module"})),v0=({title:e,titleId:t,...n})=>l.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M17.75 3C19.5449 3 21 4.45507 21 6.25V17.75C21 19.5449 19.5449 21 17.75 21H6.25C4.45507 21 3 19.5449 3 17.75V6.25C3 4.45507 4.45507 3 6.25 3H17.75ZM18.3305 19.4014L12.5247 13.7148C12.2596 13.4553 11.8501 13.4316 11.5588 13.644L11.4752 13.7148L5.66845 19.4011C5.8504 19.4651 6.04613 19.5 6.25 19.5H17.75C17.9535 19.5 18.1489 19.4653 18.3305 19.4014L12.5247 13.7148L18.3305 19.4014ZM17.75 4.5H6.25C5.2835 4.5 4.5 5.2835 4.5 6.25V17.75C4.5 17.9584 4.53643 18.1583 4.60326 18.3437L10.4258 12.643C11.2589 11.8273 12.5675 11.7885 13.4458 12.5266L13.5742 12.6431L19.3964 18.3447C19.4634 18.159 19.5 17.9588 19.5 17.75V6.25C19.5 5.2835 18.7165 4.5 17.75 4.5ZM15.2521 6.5C16.4959 6.5 17.5042 7.50831 17.5042 8.75212C17.5042 9.99592 16.4959 11.0042 15.2521 11.0042C14.0083 11.0042 13 9.99592 13 8.75212C13 7.50831 14.0083 6.5 15.2521 6.5ZM15.2521 8C14.8367 8 14.5 8.33673 14.5 8.75212C14.5 9.1675 14.8367 9.50423 15.2521 9.50423C15.6675 9.50423 16.0042 9.1675 16.0042 8.75212C16.0042 8.33673 15.6675 8 15.2521 8Z"})),j_e=Object.freeze(Object.defineProperty({__proto__:null,default:v0},Symbol.toStringTag,{value:"Module"}));function y0(e){return l.useCallback(t=>{if(t.key==="Enter"&&!t.shiftKey||t.key===" "){t.preventDefault();try{const n=e(t);n instanceof Promise&&n.catch(console.error)}catch(n){console.error("Error in useEnterOrSpaceKeyDown:",n)}}},[e])}const f2="ms-auto me-[2px] size-6 flex-none";function Ope(e,t){const{tab:n,onClick:o,showHighlight:s,showActionIcon:a=!0,onFocus:r,className:i,fallbackIcon:d,titleExtra:m,testId:p,role:h="checkbox"}=e,[g,y]=l.useState(!1),{t:b}=Z(),C=l.useCallback(()=>{o?.({...n,addedToTabSelection:!n.addedToTabSelection})},[o,n]),T=y0(C),S=g||!n.favIconUrl,E=d??v0,I=n.addedToTabSelection?"true":"false",x=h==="checkbox"?I:void 0;return c.jsxs(fo.Motion,{className:O(" box-border flex w-full cursor-pointer flex-row items-center rounded-lg p-1.5 active:bg-black/3 safe-hover:bg-black/5 dark:active:bg-white/5 dark:safe-hover:bg-black/30",s&&"bg-black/5 dark:bg-white/8","forced-colors:focus:outline forced-colors:focus:outline-2 forced-colors:focus:outline-black dark:forced-colors:focus:outline-white","contrast-more:focus:outline contrast-more:focus:outline-2 contrast-more:focus:outline-black dark:contrast-more:focus:outline-white",i),onClick:C,tabIndex:0,onKeyDown:T,ref:t,onFocus:r,role:h,tabbable:!0,"aria-label":n.title,"data-testid":p,"aria-checked":x,children:[c.jsx("div",{className:"relative flex size-4 flex-none flex-row items-center rounded-lg bg-black/5","aria-hidden":"true",children:S?c.jsx(E,{className:"size-full"}):c.jsx("img",{src:n.favIconUrl,alt:b("composer.multiTabs.tabFavIconAltText"),className:"size-full rounded-[1px] object-cover",onError:()=>{y(!0)}})}),c.jsxs("span",{className:"font-ligatures-none me-7 ms-2 max-h-full truncate text-foreground-850 text-sm",children:[m??n.title,c.jsx("span",{})]}),a&&(n.addedToTabSelection?c.jsx(ek,{className:f2}):c.jsx(X3,{className:f2}))]})}const Upe=l.forwardRef(Ope);function Fpe(e,t){const{groupTitle:n,tab:o,onClick:s,showHighlight:a,showActionIcon:r,onFocus:i,className:d,fallbackIcon:m,titleExtra:p,testId:h,role:g}=e;return c.jsxs(c.Fragment,{children:[n?c.jsx("span",{className:"font-semibold text-foreground-850 text-sm",children:n}):null,c.jsx(Upe,{ref:t,tab:o,onClick:s,showHighlight:a,showActionIcon:r,onFocus:i,className:d,fallbackIcon:m,titleExtra:p,testId:h,role:g})]})}const jpe=l.forwardRef(Fpe),tk=({title:e,titleId:t,...n})=>l.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M2 9.25C2 5.24594 5.24594 2 9.25 2H12.75C14.102 2 15.2611 2.82552 15.7509 4L13.9747 4C13.6591 3.6907 13.2268 3.5 12.75 3.5H9.25C6.07436 3.5 3.5 6.07436 3.5 9.25V12.75C3.5 13.2268 3.6907 13.6591 4 13.9747V15.75C2.82552 15.2602 2 14.102 2 12.75V9.25ZM5 10.25C5 7.35051 7.35051 5 10.25 5H15.75C17.102 5 18.2611 5.82552 18.7509 7L16.9747 7C16.6591 6.6907 16.2268 6.5 15.75 6.5H10.25C8.17893 6.5 6.5 8.17893 6.5 10.25V15.75C6.5 16.2268 6.6907 16.6591 7 16.9747V18.75C5.82552 18.2602 5 17.102 5 15.75V10.25ZM11.25 8C9.45507 8 8 9.45507 8 11.25V18.75C8 20.5449 9.45507 22 11.25 22H18.75C20.5449 22 22 20.5449 22 18.75V11.25C22 9.45507 20.5449 8 18.75 8H11.25ZM9.5 11.25C9.5 10.2835 10.2835 9.5 11.25 9.5H18.75C19.7165 9.5 20.5 10.2835 20.5 11.25V18.75C20.5 19.7165 19.7165 20.5 18.75 20.5H11.25C10.2835 20.5 9.5 19.7165 9.5 18.75V11.25Z"})),B_e=Object.freeze(Object.defineProperty({__proto__:null,default:tk},Symbol.toStringTag,{value:"Module"})),nk=({title:e,titleId:t,...n})=>l.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M12 4.5C16.1421 4.5 19.5 7.85786 19.5 12C19.5 16.1421 16.1421 19.5 12 19.5C7.85786 19.5 4.5 16.1421 4.5 12C4.5 11.6236 4.52772 11.2538 4.58123 10.8923C4.64845 10.4382 4.31609 10 3.85708 10C3.48623 10 3.161 10.2562 3.10471 10.6228C3.03576 11.0718 3 11.5317 3 12C3 16.9706 7.02944 21 12 21C16.9706 21 21 16.9706 21 12C21 7.02944 16.9706 3 12 3C9.69494 3 7.59227 3.86656 6 5.29168V4.25C6 3.83579 5.66421 3.5 5.25 3.5C4.83579 3.5 4.5 3.83579 4.5 4.25V7.25C4.5 7.66421 4.83579 8 5.25 8H8.25C8.66421 8 9 7.66421 9 7.25C9 6.83579 8.66421 6.5 8.25 6.5H6.90093C8.23907 5.25883 10.0309 4.5 12 4.5ZM12.5 7.75C12.5 7.33579 12.1642 7 11.75 7C11.3358 7 11 7.33579 11 7.75V12.25C11 12.6642 11.3358 13 11.75 13H14.75C15.1642 13 15.5 12.6642 15.5 12.25C15.5 11.8358 15.1642 11.5 14.75 11.5H12.5V7.75Z"})),V_e=Object.freeze(Object.defineProperty({__proto__:null,default:nk},Symbol.toStringTag,{value:"Module"}));function Qc(){const e=M(RK),t=q("edge-multi-tabs-history");return e&&t}const Bpe=4,Vpe=10,Hpe=20,Xi={ADD:"add"};function C0(e){return e.sourceType==="history"}function S0(e){return e.sourceType==="opened"}function ro(e){return S0(e)?(e.id??0).toString():e.url??""}function b0(e){return e.sourceType===void 0||e.sourceType===null}function ok(e,t){const n=new Set(e.map(s=>s.id)),o=new Set(t.map(s=>s.id));if(n.size!==o.size)return!0;for(const s of n)if(!o.has(s))return!0;return!1}function sk(e,t=""){const n=t.trim().toLocaleLowerCase();return n===""||!e.title||e.title.toLocaleLowerCase().includes(n)}function ak(e,t=new Map){return t.has(ro(e))}function rk(e,t){const{selectedTabsSnapshot:n,keyword:o=""}=t??{};return{...e,isInSearchResult:sk(e,o),addedToTabSelection:ak(e,n)}}async function ik(e){const{tabs:t}=await eq.run(e);return t?.map(n=>({...n,sourceType:"history",isInSearchResult:!0}))??[]}async function ck(){const e={maxResults:Vpe,states:[Is.RECENT],queries:[]};return(await ik(e)).slice(0,Bpe)}async function zpe(){const{tabs:e}=await hw.run({});return e?.map(t=>({...t,sourceType:"opened",isInSearchResult:!0}))??[]}async function Gpe({isEdgeHistoryEnabled:e=!1,triggeredByMention:t=!1,setUserOpenedTabs:n,setUserHistoryTabs:o,initialSelectedTabsSnapshot:s=new Map}){const[a,r]=await Promise.all([zpe(),e?ck():Promise.resolve([])]);n?.(a.map(m=>rk(m,{selectedTabsSnapshot:s})));const i=a.length===0;return o?.(i?r:[]),t&&i}function Wpe(e){return new Map(e.map(n=>[ro(n),{...n,addedToTabSelection:!0}]))}function lk(e,t){const n=Wpe(e);return Array.from(t.values()).reduce((o,s)=>{const a=ro(s);return o.set(a,{...o.get(a),...s}),o},new Map(n))}async function $pe(e,t){let n=[];return e===""?n=t?await ck():[]:n=await ik({queries:[e],states:[Is.RECENT,Is.HISTORY],maxResults:Hpe}),n}async function qpe(e,t){let n=[];const o=e.trim(),s=o==="";t.historyTabs&&t.historyTabs.length>0&&(n=t.historyTabs.map(i=>({...i,isInSearchResult:!0,addedToTabSelection:ak(i,t.userAddedTabs)})));const a=new Map([...t.userAddedTabs.values()].map(i=>[ro(i),{...i,isInSearchResult:sk(i,o)}])),r=t.userOpenedTabs.map(i=>rk(i,{selectedTabsSnapshot:t.userAddedTabs,keyword:o}));return{userAddedTabsFiltered:a,userOpenedTabsFiltered:r,historyTabsFiltered:n,isEmptyKeyword:s}}function Kpe(e,t){switch(t.type){case"SET_DRAFT_SELECTED_TABS":return{...e,userDraftSelectedTabs:t.payload};case"SET_TABS_INITIALIZED":return{...e,isTabsInitialized:t.payload};case"SET_USE_RECENT_HISTORY":return{...e,isUseRecentHistoryEnabled:t.payload};case"MERGE_DRAFT_SELECTION":return{...e,userDraftSelectedTabs:lk(t.payload,e.userDraftSelectedTabs)};default:return e}}function Ype(e){const{text:t}=e;return t?c.jsxs(c.Fragment,{children:[c.jsx("span",{className:"-ms-0.5 h-8 leading-8 text-foreground-850 text-sm",children:t}),c.jsx(Ao,{msg:t})]}):null}function Zpe(e){if(b0(e))return tk;if(C0(e))return nk}function h2(e,t=!1){const n=F("composer.multiTabs.openTabs");if(C0(e)){const o=F("composer.multiTabs.recentlyClosedTabs"),s=F("composer.multiTabs.historyTabs");return t?o:s}return S0(e)?n:""}function Jpe(e,t){let n=!1,o=!1;return s=>{if(e){if(C0(s)&&!n)return n=!0,h2(s,t);if(S0(s)&&!o)return o=!0,h2(s,t)}}}function Qpe(e){const{tabs:t,onItemClick:n,highlightedIndex:o,activeMenuItemRef:s,onItemFocus:a,emptyStateText:r,isUseRecentHistoryEnabled:i=!1}=e,d=Qc(),m=M(Ua);if(t.length===0)return c.jsx(Ype,{text:r});const p=Jpe(d,i);return c.jsx(c.Fragment,{children:t.map((h,g)=>c.jsx(jpe,{tab:h,onClick:n,showHighlight:o===g,onFocus:()=>a?.(g),showActionIcon:!m,className:O(!m&&"py-2"),ref:g===o?s:null,groupTitle:p(h),fallbackIcon:Zpe(h),testId:`multi-tabs-menu-item-${g}`,role:m?"option":"checkbox"},ro(h)))})}function uk(e){const{highlightedIndex:t,activeMenuItemRef:n,onMenuItemClick:o,onFocus:s,tabs:a,emptyStateText:r,isUseRecentHistoryEnabled:i=!1}=e,d=M(Ua);return c.jsxs("div",{className:O("relative flex w-full overflow-hidden",d?"mb-0 mt-3":"my-3"),children:[c.jsx("div",{className:O("t-custom-scrollbar flex w-full flex-col gap-y-1 overflow-y-auto overflow-x-hidden p-1"),"data-testid":"multi-tabs-menu-items-container",children:c.jsx(Qpe,{tabs:a,onItemClick:o,highlightedIndex:t,activeMenuItemRef:n,onItemFocus:s,emptyStateText:r,isUseRecentHistoryEnabled:i})}),a.length>=4&&d&&c.jsx("div",{className:O("pointer-events-none absolute inset-x-0 bottom-0 h-8 rounded-b-lg px-4","bg-gradient-composer-tabs-menu-mask-light dark:bg-gradient-composer-tabs-menu-mask-dark")})]})}function dk(e){const{mode:t,disabled:n,onClick:o}=e,{t:s}=Z(),a=s("composer.multiTabs.browserTabMenuShareButton"),r=s("composer.multiTabs.browserTabMenuShareButtonForUpdate"),i=t===Xi.ADD?a:r;return c.jsx(ee,{title:i,className:"mx-auto mt-auto w-full flex-none",disabled:n,testId:"multi-tabs-share-button",onClick:o,color:"strong",size:"48-lg","aria-label":i,children:i})}function mk(e){const{mode:t,onClose:n,id:o}=e,s=M(Ua),{t:a}=Z(),r=Qc(),i=a("common.closeText"),d=l.useMemo(()=>r?t===Xi.ADD?a("composer.multiTabs.browserTabMenuTitleWithHistory"):a("composer.multiTabs.browserTabMenuTitleForUpdateWithHistory"):t===Xi.ADD?a("composer.multiTabs.browserTabMenuTitle"):a("composer.multiTabs.browserTabMenuTitleForUpdate"),[r,t,a]);return c.jsxs("div",{className:"flex w-full items-center justify-between pt-2",children:[c.jsx("span",{className:"text-foreground-900 text-sm",role:"heading","aria-level":2,id:o,children:d}),!s&&c.jsx(ee,{color:"subtle-dimmed",title:i,size:"32-xs",onClick:n,"aria-label":i,children:c.jsx(on,{className:"size-5 cursor-pointer"})})]})}const g2="";function pk(e){const{onChange:t,defaultValue:n}=e,{t:o}=Z(),[s,a]=l.useState(n??g2),r=l.useRef(null),i=Qc(),d=()=>{r.current?.focus(),a(g2)},m=y0(d),p=l.useCallback(y=>{a(y.target.value)},[]);l.useEffect(()=>{t?.(s)},[t,s]),l.useEffect(()=>{r.current&&requestAnimationFrame(()=>{r.current?.focus()})},[r]);const h=o(i?"composer.multiTabs.browserTabMenuSearchPlaceholderWithHistory":"composer.multiTabs.browserTabMenuSearchPlaceholder"),g=o("composer.multiTabs.browserTabMenuSearchClear");return c.jsxs("div",{className:"mt-3 flex h-8 w-full flex-row items-center rounded-3xl bg-white/60 dark:bg-black/60",children:[c.jsx(em,{className:"mx-2 size-4"}),c.jsx("input",{type:"text",id:"browser-tab-search",autoComplete:"off",spellCheck:!1,autoCorrect:"off",className:"w-full flex-1 rounded-lg bg-transparent py-2 text-sm placeholder:text-foreground-450 focus:outline-none dark:placeholder:text-foreground-600",placeholder:h,"aria-label":h,onChange:p,value:s,maxLength:100,ref:r}),s&&c.jsx("div",{role:"button",tabIndex:0,className:"me-1 ms-auto h-6 cursor-pointer rounded-xl border border-midnight-250 bg-midnight-200 px-3 py-1 text-foreground-800 text-xs dark:border-white/50 dark:bg-white/5",onKeyDown:m,onClick:d,"aria-label":g,children:g})]})}function fk(e,t,n){return t.startsWith("top")?e.top-n:window.innerHeight-e.bottom-n}function hk(e,t=1e3){const n=l.useRef(null);return n.current=e,l.useMemo(()=>c1((...a)=>{n.current?.(...a)},t),[t])}const Xpe={id:-1,title:"",addedToTabSelection:!1,isInSearchResult:!0,sourceType:null,active:!1,highlighted:!1,pinned:!1,selected:!1,incognito:!1,autoDiscardable:!0,discarded:!1,index:-1,windowId:-1,groupId:-1};function gk(e={}){return{...Xpe,...e}}const ql=20,efe=gk({sourceType:null});function tfe(e,t){const{t:n}=Z(),o=l.useMemo(()=>e.filter(d=>d.isInSearchResult),[e]),s=l.useMemo(()=>{const i=Math.min(o.length,ql);return t&&i>1&&i<ql?{...efe,title:n("composer.multiTabs.allTabs",{count:i}),isInSearchResult:!0}:null},[o.length,n,t]),a=l.useCallback(()=>e.map(i=>({...i,addedToTabSelection:o.slice(0,ql).some(d=>d.id===i.id)})),[o,e]),r=l.useMemo(()=>s?[s,...o]:o,[o,s]);return{appearedTabs:o,getUpdatedTabsBySpecialTab:a,specialTab:s,appearedTabsWithSpecialTab:r}}function vk(e){const t=l.useRef(0),n=l.useCallback(async()=>{const o=window.innerHeight;o!==t.current&&(t.current=o,await e(o))},[e]);Hs(n,{initialize:!0},document.documentElement)}const nfe=.2,ofe=.2,sfe=50,afe=594,rfe=46,ife=360,cfe=240;function lfe(){Ce.emit("edge:try-grow-content-height",afe)}function ufe(e){const t=new Map;for(const n of e)n.id&&n.addedToTabSelection&&t.set(n.id.toString(),n);return t}function dfe(e){const{styles:t,onRef:n,onSave:o,onClose:s=()=>{},outsideClickElements:a=[],originElement:r,mode:i=Xi.ADD,menuPlacement:d="top-start",id:m}=e,[p,h]=Le(wo),g=l.useRef(new Map(p)),y=l.useRef(null),[b,C]=l.useState([]),[T,S]=l.useState(0),E=l.useRef(null),{t:I}=Z(),x=l.useDeferredValue([...b]),w=M(Ua),{appearedTabsWithSpecialTab:P,getUpdatedTabsBySpecialTab:D}=tfe(x,w),L=g.current,[j,U]=l.useState(0),[$,K]=l.useState(!1),X=l.useCallback(()=>{if(y.current&&r&&r.current){const H=r.current.getBoundingClientRect(),Y=fk(H,d,rfe);U(Y)}},[r,d]);vk(()=>{lfe(),X()}),l.useEffect(()=>{K(!1);async function H(){const{tabs:Y}=await hw.run({});if(Y&&Y.length>0){const ue=[];for(const oe of Y)oe.id&&ue.push({...oe,addedToTabSelection:L.has(oe.id.toString()),isInSearchResult:!0,sourceType:"opened"});C(ue)}}H().catch(console.error).finally(()=>{K(!0)})},[L]),l.useLayoutEffect(()=>{y.current&&$&&X()},[X,$]);const ne=l.useMemo(()=>b.filter(H=>H.addedToTabSelection),[b]),me=l.useMemo(()=>ne.length>ql,[ne]),Se=l.useCallback(H=>{n?.(H),y.current=H},[n]),ge=l.useCallback(H=>{const Y=ufe(H);h(Y);const ue=Array.from(Y.values()),oe=ok(ue,[...L.values()]);o?.(ue,oe)},[L,o,h]),ve=l.useCallback(()=>{me||ge(b)},[me,ge,b]),Pe=l.useCallback(H=>{C(Y=>Y.map(oe=>oe.id===H.id?H:oe))},[]),Me=hk(l.useCallback(H=>{C(Y=>Y.map(ue=>({...ue,isInSearchResult:ue.title?ue.title.toLowerCase().includes(H.toLowerCase().trim()):!0})))},[]),Nw),ye=l.useCallback(H=>{S(Y=>H==="up"?Y>0?Y-1:P.length-1:Y<P.length-1?Y+1:0)},[S,P]);l.useEffect(()=>{E.current&&T>=0&&(E.current.scrollIntoView({block:"nearest"}),w||E.current.focus())},[T,E,w]),l.useEffect(()=>{if(T>=0&&w){const H=P[T]?.title??"";H&&oo({msg:H})}},[T,P,w]);const Ie=l.useCallback(H=>{let Y=[];b0(H)?Y=D():Y=b.map(ue=>ue.id===H.id?{...H,addedToTabSelection:!0}:ue),C(Y),ge(Y)},[D,ge,b]),He=l.useCallback(H=>{if(["ArrowUp","ArrowDown"].includes(H.code))H.preventDefault(),ye(H.code==="ArrowUp"?"up":"down");else if(H.code==="Enter"){H.preventDefault();const Y=P[T];Y&&Ie({...Y,addedToTabSelection:!0})}else H.code==="Tab"&&y.current?.focus()},[ye,T,P,Ie]),Ze=l.useMemo(()=>c1(He,sfe),[He]);l.useEffect(()=>(Ce.on("multi-tabs:search",Me),Ce.on("multi-tabs:key-down",Ze),()=>{Ce.off("multi-tabs:search",Me),Ce.off("multi-tabs:key-down",Ze)}),[Ze,Me]),Xo({onOutsideEvent:s,elements:[y,...a],invokeOnce:!1,shouldAttachListeners:!0,includeFocus:w});const Be=l.useMemo(()=>w?cfe:ife,[w]),be=l.useMemo(()=>({maxHeight:`${j>Be?Be:j}px`,...t}),[j,Be,t]);Ga(H=>{H.key==="Escape"&&(H.stopPropagation(),H.preventDefault(),s())});const te=`${l.useId()}-composer-multi-tabs-menu-header-title`;return c.jsxs(fo.Motion,{className:O(at.modal,"pointer-events-auto relative z-40 box-border flex max-h-[400px] w-full flex-col rounded-b-6xl rounded-t-4xl border border-white p-4 shadow-lg backdrop-blur-2xl backdrop-saturate-150 contrast-more:border-2 dark:border-white/10","bg-gradient-composer-tabs-menu-light dark:bg-gradient-composer-tabs-menu-dark","bg-blend-normal","forced-colors:bg-stroke-150 dark:forced-colors:bg-background-150","contrast-more:bg-stroke-150 dark:contrast-more:bg-background-150",w?"px-4 pb-1.5 pt-4":"p-4"),style:be,tabbable:!0,tabIndex:0,ref:Se,"data-testid":"composer-multi-tabs-menu",initial:"start",animate:"end",variants:{start:je,end:{...rt,transition:{duration:nfe,delay:ofe}}},onKeyDown:w?void 0:He,"data-outside-events-ignore":w?"":void 0,role:w?"listbox":"dialog","aria-labelledby":te,id:m,children:[c.jsx(mk,{mode:i,onClose:s,id:te}),!w&&c.jsx(pk,{onChange:Me}),c.jsx(uk,{highlightedIndex:T,onFocus:S,activeMenuItemRef:E,onMenuItemClick:w?Ie:Pe,tabs:P,emptyStateText:b.length===0?I("composer.multiTabs.noTabsOpen"):I("composer.multiTabs.noTabsFound")}),!w&&c.jsx(dk,{mode:i,disabled:me,onClick:ve})]})}const yk=_([]),Ck=_([]),mfe=_(e=>{const t=e(yk),n=e(Ck),o=new Map;for(const s of t)s.id&&o.set(ro(s),s);for(const s of n)s.url&&!t.some(a=>a.url===s.url)&&o.set(ro(s),s);return[...o.values()]}),pfe=_(e=>{const t=e(mfe),n=e(wo),o=e(Ua),s=new Map;for(const a of t)a.isInSearchResult&&s.set(ro(a),a);if(!o)for(const[a,r]of n)r.isInSearchResult&&s.set(a,r);return[...s.values()]}),qf=20,v2={opened:0,history:1},ffe=gk({sourceType:null});function hfe(){const{t:e}=Z(),t=M(Ua),n=Qc(),[o,s]=Le(yk),a=G(Ck),[r,i]=Le(wo),d=l.useRef(new Map(r)),m=M(pfe),[p,h]=l.useReducer(Kpe,{isTabsInitialized:!1,isUseRecentHistoryEnabled:!1,userDraftSelectedTabs:d.current}),g=e("composer.multiTabs.noTabsOpen"),y=e("composer.multiTabs.noTabsFound"),b=l.useMemo(()=>m.map(w=>({...w,addedToTabSelection:p.userDraftSelectedTabs.has(ro(w))})),[m,p.userDraftSelectedTabs]),C=l.useMemo(()=>{const x=Math.min(b.length,qf);return t&&x>1&&x<qf?{...ffe,title:e("composer.multiTabs.allTabs",{count:x}),isInSearchResult:!0}:null},[b.length,e,t]),T=l.useMemo(()=>{const x=[...b].sort((w,P)=>(w.lastAccessed??0)-(P.lastAccessed??0)).sort((w,P)=>(v2[w.sourceType]??0)-(v2[P.sourceType]??0));return!C||n?x:[C,...x]},[b,C,n]),S=l.useMemo(()=>n?y:m.length===0?g:y,[n,y,g,m.length]),E=l.useCallback(x=>ok(x,[...d.current.values()]),[]),I=l.useCallback(async x=>{const w=n?await $pe(x.trim(),o.length===0):[],{userAddedTabsFiltered:P,userOpenedTabsFiltered:D,historyTabsFiltered:L,isEmptyKeyword:j}=await qpe(x,{userAddedTabs:r,userOpenedTabs:o,historyTabs:w});n&&(h({type:"SET_USE_RECENT_HISTORY",payload:j&&t}),a(L)),i(P),s(D)},[n,i,a,s,t,r,o]);return l.useEffect(()=>{h({type:"SET_USE_RECENT_HISTORY",payload:!1}),Gpe({isEdgeHistoryEnabled:n,triggeredByMention:t,setUserOpenedTabs:s,setUserHistoryTabs:a,initialSelectedTabsSnapshot:d.current}).then(x=>{h({type:"SET_USE_RECENT_HISTORY",payload:x})}).catch(x=>{}).finally(()=>{h({type:"SET_TABS_INITIALIZED",payload:!0})})},[n,a,s,t]),l.useEffect(()=>()=>{a([]),s([])},[a,s]),{triggeredByMention:t,isEdgeHistoryEnabled:n,checkSelectedTabsHaveChanged:E,appearedTabsWithSpecialTab:T,userOpenedTabs:o,menuContentEmptyStateText:S,setUserAddedTabs:i,searchTabs:I,appearedTabs:b,specialTab:C,isUseRecentHistoryEnabled:p.isUseRecentHistoryEnabled,isTabsInitialized:p.isTabsInitialized,userDraftSelectedTabs:p.userDraftSelectedTabs,setUserDraftSelectedTabs:x=>{h({type:"SET_DRAFT_SELECTED_TABS",payload:x})}}}const gfe=.2,vfe=.2;function yfe(e){return Array.from(e.values()).map(t=>({...t,addedToTabSelection:!0,isInSearchResult:!0}))}const Cfe=594,Sfe=46,bfe=360,Ife=240;function Efe(){Ce.emit("edge:try-grow-content-height",Cfe)}function Tfe(e){const{styles:t,onRef:n,onSave:o,onClose:s=()=>{},originElement:a,mode:r=Xi.ADD,outsideClickElements:i=[],menuPlacement:d="top-start",id:m}=e,p=l.useRef(null),[h,g]=l.useState(0),y=l.useRef(null),[b,C]=l.useState(0),{t:T}=Z(),{appearedTabsWithSpecialTab:S,isUseRecentHistoryEnabled:E,triggeredByMention:I,menuContentEmptyStateText:x,searchTabs:w,setUserAddedTabs:P,checkSelectedTabsHaveChanged:D,userDraftSelectedTabs:L,isTabsInitialized:j,setUserDraftSelectedTabs:U,appearedTabs:$}=hfe(),K=L.size>qf,X=l.useCallback(be=>{n?.(be),p.current=be},[n]),ne=l.useCallback(be=>{const re=yfe(be);P(new Map(re.map(H=>[ro(H),H])));const te=D(re);o?.(re,te)},[D,o,P]),me=l.useCallback(()=>{K||ne(L)},[K,ne,L]),Se=hk(w,Nw),ge=l.useCallback(()=>{if(p.current&&a&&a.current){const be=a.current.getBoundingClientRect(),re=fk(be,d,Sfe);C(re)}},[a,d]);vk(()=>{Efe(),ge()}),l.useLayoutEffect(()=>{p.current&&j&&ge()},[ge,j]),l.useEffect(()=>{y.current&&h>=0&&y.current.scrollIntoView({block:"nearest"})},[h,y]),l.useEffect(()=>{if(h>=0&&I){const be=S[h]?.title??"";be&&oo({msg:be})}},[h,S,I]);const ve=l.useCallback(be=>{g(re=>be==="up"?re>0?re-1:S.length-1:re<S.length-1?re+1:0)},[g,S]),Pe=l.useCallback(be=>{const re=ro(be),te=L.has(re),H=be.addedToTabSelection;if(te!==H){const Y=new Map(L);H?Y.set(re,be):Y.delete(re),U(Y)}oo({msg:T(H?"composer.multiTabs.tabStatus.added":"composer.multiTabs.tabStatus.removed")})},[U,T,L]),Me=l.useCallback(be=>{const re=b0(be)?$:[be],te=lk(re,L);U(te),ne(te),oo({msg:T("composer.multiTabs.tabStatus.added")})},[$,U,T,ne,L]),ye=l.useCallback(be=>{if(["ArrowUp","ArrowDown"].includes(be.code))be.preventDefault(),ve(be.code==="ArrowUp"?"up":"down");else if(be.code==="Enter"){be.preventDefault();const re=S[h];re&&Me({...re,addedToTabSelection:!0})}else be.code==="Tab"&&p.current?.focus()},[ve,h,S,Me]);l.useEffect(()=>(Ce.on("multi-tabs:search",Se),Ce.on("multi-tabs:key-down",ye),()=>{Ce.off("multi-tabs:search",Se),Ce.off("multi-tabs:key-down",ye)}),[ye,Se]);const Ie=l.useMemo(()=>I?Ife:bfe,[I]),He=l.useMemo(()=>({maxHeight:`${b>Ie?Ie:b}px`,...t}),[b,Ie,t]),Be=`${l.useId()}-composer-multi-tabs-menu-header-title`;return Xo({onOutsideEvent:s,elements:[p,...i],invokeOnce:!1,shouldAttachListeners:!0,includeFocus:I}),c.jsxs(fo.Motion,{className:O(at.modal,"pointer-events-auto relative z-40 box-border flex max-h-[400px] w-full flex-col rounded-b-6xl rounded-t-4xl border border-white bg-gradient-composer-tabs-menu-light p-4 bg-blend-normal shadow-lg backdrop-blur-2xl backdrop-saturate-150 contrast-more:border-2 contrast-more:bg-stroke-150 dark:border-white/10 dark:bg-gradient-composer-tabs-menu-dark dark:contrast-more:bg-background-150 forced-colors:bg-stroke-150 dark:forced-colors:bg-background-150",I?"px-4 pb-1.5 pt-4":"p-4"),style:He,tabbable:!0,tabIndex:0,"data-testid":"composer-multi-tabs-menu",initial:"start",animate:"end",ref:X,variants:{start:je,end:{...rt,transition:{duration:gfe,delay:vfe}}},onKeyDown:I?void 0:ye,role:I?"listbox":"dialog","aria-labelledby":Be,id:m,children:[c.jsx(mk,{mode:r,onClose:s,id:Be}),!I&&c.jsx(pk,{onChange:Se}),c.jsx(uk,{highlightedIndex:h,onFocus:g,activeMenuItemRef:y,onMenuItemClick:I?Me:Pe,tabs:S,emptyStateText:x,isUseRecentHistoryEnabled:E}),!I&&c.jsx(dk,{mode:r,disabled:K,onClick:me})]})}function wfe(e){return Qc()?c.jsx(Tfe,{...e}):c.jsx(dfe,{...e})}const Afe=(e,t)=>{if(e==="light"){const n=J.instance().config().composer?.shadowBoxStyleOverride?.outerLargeBoxShadowLight;if(n)return n;if(t)return Ame}else if(e==="dark"){const n=J.instance().config().composer?.shadowBoxStyleOverride?.outerLargeBoxShadowDark;if(n)return n;if(t)return xme}return Tme},xfe=e=>{if(e==="light"){const t=J.instance().config().composer?.shadowBoxStyleOverride?.outerSmallBoxShadowLight;return t?`${t.offset} ${t.color}`:_me}if(e==="dark"){const t=J.instance().config().composer?.shadowBoxStyleOverride?.outerSmallBoxShadowDark;return t?`${t.offset} ${t.color}`:kme}return wme},_fe=e=>e==="dark"?p0:m0;function kl(e){return e?Mme:Pme}function kfe(e){return e?Nme:Rme}function Pfe(e,t,n){const o=t?DB:OB;let s;if(e==="default"){const r=J.instance().config().composer?.shadowBoxStyleOverride,i=n==="dark"?r?.outerSmallBoxShadowDark?.color:r?.outerSmallBoxShadowLight?.color;i?s=`${o} ${i}`:s=`${o} ${n==="dark"?z3:H3}`}else{const r=`rgba(${wy[e]}, ${Fm})`;s=`${o} ${r}`}let a;if(e==="default")a=n==="dark"?p0:m0;else{const r=t?Fm*LB:Fm;a=`0px 0px 0px 1px ${`rgba(${wy[e]}, ${r})`} inset`}return{outerSmallBoxShadow:s,innerBoxShadow:a,shouldAnimateShadow:!0}}const Mfe=new Set(["smart","smart-latest"]);function Sk(){const e=q("personality-studio-v1"),t=Zt(),o=!!M(Rt)?.group,s=!Mfe.has(t),a=Vt(),r=ao(a),i=a==="/",d=l0(),m=a.startsWith("/chats")&&!r;return e&&!o&&!s&&(m||i||d)}function Rfe(e){const t=M(ss),n=M(o0),o=Sk(),s=ba(),{outerSmallBoxShadow:a,innerBoxShadow:r,shouldAnimateShadow:i}=o?Pfe(n,e,t):{outerSmallBoxShadow:xfe(t),innerBoxShadow:_fe(t),shouldAnimateShadow:!1};return i?{outerShadowStyle:{},outerShadowAnimate:{boxShadow:a},outerShadowTransition:o2,innerShadowStyle:{},innerShadowAnimate:{boxShadow:r},innerShadowTransition:o2}:{outerShadowStyle:{boxShadow:s?a:void 0},outerShadowAnimate:void 0,outerShadowTransition:void 0,innerShadowStyle:{boxShadow:s?r:void 0},innerShadowAnimate:void 0,innerShadowTransition:void 0}}function bk(){return M(Bte)}function I0(){const e=M(MK),t=q("edge-multi-tabs-reverse");return e&&!t}const Nfe=ke();function Lfe(){const e=I0(),[t,n]=l.useState("add"),[o,s]=l.useState(!1),[a,r]=Le(NK),[i,d]=l.useState(!1),[m,p]=Le(Ua),h=G(wo),{refs:g,floatingStyles:y,placement:b}=G9({strategy:"absolute",whileElementsMounted:kr,middleware:[nc(()=>({mainAxis:6,crossAxis:0})),W9({allowedPlacements:["bottom-start","top-start"]}),sc({padding:12}),lh({apply({rects:x,elements:w}){Object.assign(w.floating.style,{width:`${x.reference.width}px`})}})]}),C=l.useCallback(async x=>{const{isTrigger:w,keyword:P}=x;p(w),w&&(Ce.emit("multi-tabs:search",P),n("add")),r(w)},[p,r]),T=l.useCallback(()=>{m&&(p(!1),Ce.emit("mention:cancel","ignore")),r(!1)},[m,p,r]),S=l.useCallback(()=>{m&&(Ce.emit("mention:cancel","remove"),p(!1)),r(!1),d(!0),s(!0),Ce.emit("edge:maybe-fetch-page-context","onSaveMultiTabs")},[m,p,r]),E=l.useCallback(x=>e&&a&&m?(Ce.emit("multi-tabs:key-down",x),!0):!1,[m,e,a]),I=()=>m&&a&&e;return l.useEffect(()=>{const x=Nfe.sub(Te,()=>{r(!1),d(!1),p(!1),h(new Map)});return()=>{x()}},[h,p,r]),l.useEffect(()=>{const x=()=>{s(!1)};return Ce.on("edge:multi-tabs-context-fetched-complete",x),()=>{Ce.off("edge:multi-tabs-context-fetched-complete",x)}},[]),{isMultiTabsMenuExpanded:a,floatingStyles:y,edgeTabMenuRefs:g,setIsMultiTabsMenuExpanded:r,isShowMultiTabsPreviewCard:i,setIsShowMultiTabsPreviewCard:d,handleMentionEvent:C,isMentionTriggered:m,handleMultiTabsMenuSaveBtnEvent:S,handleMultiTabsMenuCloseBtnEvent:T,handleUserInputEnterEvent:I,handleUserInputKeydownEvent:E,multiTabsMenuMode:t,setMultiTabsMenuMode:n,isFetchingTabsPageContext:o,menuPlacement:b}}function Dfe(e){const t=M(vt);if(!e?.group||!e.group.owner||!t)return!1;const n=t.id,{group:o}=e,s=o.participants??[];return(n?s.filter(r=>r.userId!==n):s).length>=1}const E0="copilot";function Ik(e,t){return{...e,start:e.start+t,end:e.end+t}}function Ofe(e,t,n){if(e.start===e.end){const s=e.start;if(n>=0)return{changeStart:s,changeEnd:e.end};const a=Math.abs(n);if(t.start<e.start)return{changeStart:t.start,changeEnd:e.start};const r=Math.max(e.start+a,t.end);return{changeStart:e.start,changeEnd:r}}return{changeStart:e.start,changeEnd:e.end}}function Ufe(e,t){const{changeStart:n,changeEnd:o}=t;return n>=e.end?"none":o<=e.start?"adjust":"remove"}function Ffe(e,t,n){return e.length===0?e:e.map(o=>{const s=Ufe(o,t);return s==="none"?o:s==="adjust"?Ik(o,n):null}).filter(o=>o!==null)}function jfe(e){return`@${e.userDisplayName}`}function Bfe(e){return e.userId===E0?{type:"reference",reference:{type:"copilot"}}:{type:"reference",reference:{type:"user",id:e.userId,displayName:e.userDisplayName??e.userId}}}function Vfe(e){const[t,n]=l.useState([]),o=l.useRef(""),s=l.useRef({start:0,end:0}),a=l.useCallback(m=>{const p=m.target;s.current={start:p.selectionStart,end:p.selectionEnd}},[]),r=l.useCallback(m=>{const p=m.target.value,h={start:m.target.selectionStart,end:m.target.selectionEnd},g=o.current;if(p===g){s.current=h;return}const y=p.length-g.length,b=Ofe(s.current,h,y);n(C=>Ffe(C,b,y)),o.current=p,s.current=h},[]);return{mentions:t,insertMentionIntoText:(m,p,h,g)=>{const y=jfe(g),b=m.slice(0,p),C=m.slice(p+h.length),T=`${b}${y} ${C}`,S={start:p,end:p+y.length,participant:g,displayText:y},E=y.length+1-h.length;n(x=>[...x.map(P=>P.start>=p?P.participant.userId===S.participant.userId&&P.start===S.start?void 0:Ik(P,E):P).filter(P=>P!==void 0),S].sort((P,D)=>P.start-D.start)),o.current=T;const I=p+y.length+1;return s.current={start:I,end:I},e(T),I},getTextWithMentions:m=>{const p=o.current.trim();if(p!==m.trim())return{plainText:m,textWithReferences:[{type:"text",text:m}]};if(t.length===0)return{plainText:m,textWithReferences:[{type:"text",text:m}]};const h=[];let g=0;for(const y of t)y.start>g&&h.push({type:"text",text:p.slice(g,y.start)}),h.push(Bfe(y.participant)),g=y.end;return g<p.length&&h.push({type:"text",text:p.slice(g)}),{plainText:m,textWithReferences:h}},handleTextareaChange:r,handleTextareaSelect:a}}function Ek(e){const t=e.selectionStart;return e.value.substring(0,t).lastIndexOf("@")}function Hfe(e){const t=Ek(e),n=window.getComputedStyle(e),o=n.direction==="rtl";if(t===-1){const m=e.getBoundingClientRect();return{x:m.left,y:m.top,isRtl:o}}const s=e.value.substring(0,t),a=e.getBoundingClientRect(),r=document.createElement("div");Object.assign(r.style,{position:"absolute",top:`${a.top+window.scrollY}px`,left:`${a.left+window.scrollX}px`,visibility:"hidden",whiteSpace:n.whiteSpace,overflowWrap:n.overflowWrap,width:`${e.clientWidth}px`,height:`${e.clientHeight}px`,font:n.font,fontSize:n.fontSize,fontFamily:n.fontFamily,fontWeight:n.fontWeight,letterSpacing:n.letterSpacing,lineHeight:n.lineHeight,padding:n.padding,border:n.border,boxSizing:n.boxSizing,direction:n.direction}),r.textContent=s;const i=document.createElement("span");i.textContent="@",r.appendChild(i),document.body.appendChild(r);const d=i.getBoundingClientRect();return document.body.removeChild(r),{x:d.left,y:d.top,isRtl:o}}function zfe({participant:e,mentionKeywordToReplace:t,insertMentionIntoText:n,userInputRef:o}){const s=o.current?.getTextAreaRef().current;if(!s)return;const a=Ek(s);if(a!==-1){const r=`@${t}`,i=n(s.value,a,r,e);requestAnimationFrame(()=>{o.current?.focus(),o.current?.updateSelectionRange(i,i)})}}function Gfe(){const e=M(Rt),t=M(vt),{t:n}=Z();return l.useMemo(()=>{if(!t)return[];const s=(e?.group?.participants??[]).filter(r=>r.userId!==t.id);return[{userId:E0,userDisplayName:n("common.copilotText")},...s]},[e?.group?.participants,t,n])}function Wfe(e,t){return e?t.filter(n=>(n.userDisplayName??n.userId).toLowerCase().includes(e.toLowerCase())):t}function $fe(e,t,n,o){const[s,a]=l.useState(0),r=l.useCallback(()=>{a(0)},[]),i=l.useCallback(d=>{if(!(!t||e.length===0)){if(d.key==="ArrowDown")d.preventDefault(),a(m=>m<e.length-1?m+1:0);else if(d.key==="ArrowUp")d.preventDefault(),a(m=>m>0?m-1:e.length-1);else if(d.key==="Escape")d.preventDefault(),r(),o();else if(d.key==="Enter"||d.key==="Tab"){d.preventDefault(),d.stopImmediatePropagation(),r();const m=e[s];m&&n(m)}}},[t,e,s,n,o,r]);return{selectedIndex:s,handleMentionKeydown:i,resetSelectionInPopup:r}}function qfe(e){const[t,n]=l.useState({x:0,y:0,isRtl:!1}),o=l.useCallback(()=>{const a=e.userInputRef.current?.getTextAreaRef()?.current;if(a){const r=Hfe(a);n(r)}},[e]);return{mentionPopupPosition:t,updateMentionPopupPosition:o}}function Kfe(e,t,n,o){const[s,a]=l.useState(""),[r,i]=l.useState([]),d=l.useCallback(m=>{if(m.isTrigger){const p=m.keyword??"";a(p);const h=Wfe(p,e);h.length>0?(t(),n(!0),sae(o)):n(!1),i(h)}else n(!1),a("")},[e,t,n,o]);return{mentionKeyword:s,filteredParticipants:r,handleMentionTrigger:d}}function Yfe({setInputValue:e,userInputRef:t}){const n=M(Rt),{mentions:o,insertMentionIntoText:s,getTextWithMentions:a,handleTextareaChange:r,handleTextareaSelect:i}=Vfe(e),d=Dfe(n),m=q("groups-mention")&&d,p=Gfe(),[h,g]=l.useState(!1),{mentionPopupPosition:y,updateMentionPopupPosition:b}=qfe({userInputRef:t}),{handleMentionTrigger:C,filteredParticipants:T,mentionKeyword:S}=Kfe(p,b,g,n?.id),E=l.useCallback(()=>{g(!1),requestAnimationFrame(()=>{t.current?.focus()})},[g,t]),I=l.useCallback(L=>{zfe({participant:L,mentionKeywordToReplace:S,insertMentionIntoText:s,userInputRef:t}),aae(n?.id,L.userId===E0),E()},[S,s,t,E,n?.id]),{handleMentionKeydown:x,selectedIndex:w,resetSelectionInPopup:P}=$fe(T,h,I,E),D=l.useCallback(L=>{C(L),P()},[C,P]);return{isGroupsMentionEnabled:m,mentionPopup:{isMentionPopupOpen:h,position:y,mentionPopupParticipants:T,mentionPopupSelectedIndex:w,closeMentionPopup:E,handleMentionSelect:I},handleMentionTriggerEvent:D,handleMentionKeydown:x,mentions:o,hasSelectedMentions:o.length>0,handleTextareaChange:r,handleTextareaSelect:i,getTextWithMentions:a}}function Zfe(){const[e,t]=l.useState(!1),n=Vt(),o=U1(n==="/"),s=W("zi-autosuggest")&&o,a=M(Yt),r=M(BA),d=Zt()==="computerUse",m=o&&!a&&!d,p=l.useRef(r);l.useEffect(()=>{p.current&&!r&&t(!1),p.current=r},[r]);const h=M(Bc);return{autoSuggestOnInputClick:C=>{e||!s||C!==""||r||(t(!0),wf(""))},autoSuggestOnInputFocus:(C,T)=>{Pne()||!m||T||r||wf(C)},autoSuggestOnInputChange:C=>{!C&&h&&Yi()}}}function Jfe(){const{contentPageType:e}=Ro(),t=M(fc),n=l.useCallback(()=>{de({pageName:e,source:"streamlinedComposer",scenario:"clickComposer",customData:JSON.stringify({isChatSidePaneOpened:t})})},[e,t]),o=l.useCallback(()=>{de({pageName:e,source:"newsComposerInput",scenario:"newsClickNavigateToChat",customData:JSON.stringify({isChatSidePaneOpened:t})})},[e,t]);return{trackConsumptionPageComposerClick:n,trackConsumptionPageComposerSubmit:o}}const Qfe=["en"],Xfe=["en-US","en-GB"];function ehe(){const{i18n:e}=Z(),t=Q_(),o=(e.resolvedLanguage??"").split("-")[0]??"",s=Qfe.includes(o),a=Xfe.includes(t);return s&&a}function the(){return Vt().startsWith("/daily")}const Tk=_(0),wk=_(),Ak=_();_({});const H_e=_({lastPosition:0,wasPlaying:!1}),Zr="daily";function z_e(){R.trackEvent({name:"interaction",data:{eventName:"copilotClick",eventInfo_clickSource:"personalizeButton",eventInfo_clickScenario:"",eventInfo_pageName:Zr}})}function G_e(e){R.trackEvent({name:"interaction",data:{eventName:"copilotClick",eventInfo_clickSource:"TopicSettings_Select",eventInfo_clickScenario:e,eventInfo_pageName:Zr}})}function W_e(e){R.trackEvent({name:"interaction",data:{eventName:"copilotClick",eventInfo_clickSource:"TopicSettings_UnSelect",eventInfo_clickScenario:e,eventInfo_pageName:Zr}})}function $_e(e){R.trackEvent({name:"interaction",data:{eventName:"copilotClick",eventInfo_clickSource:"TopicSettings_Save",eventInfo_clickScenario:e.join(","),eventInfo_pageName:Zr}})}function q_e(){R.trackEvent({name:"interaction",data:{eventName:"copilotClick",eventInfo_clickSource:"TopicSettings_Later",eventInfo_clickScenario:"",eventInfo_pageName:Zr}})}const Kf={Podcast:"podcastPlayer",DailyBriefing:"dailyBriefingPlayer"},Di={Daily:Zr,Podcast:"podcast"},fs={Skip:"skip",Rewind:"rewind",Play:"play",Pause:"pause",Next:"next",Previous:"previous",Playback:"playback",Mute:"mute",Unmute:"unmute",Expand:"expand",Collapse:"collapse"};function $s(e,t,n){de({source:e,pageName:e===Kf.Podcast?Di.Podcast:Di.Daily,scenario:t,customData:n})}function xk(e){const{url:t,podcastId:n,schema:o,includeTranscripts:s=!1}=e,a={...n&&{podcastId:n},includeTranscripts:String(!!s)};return pt(t,o,{query:a}).then(r=>r.data)}function nhe(e,t,n,o,s,a){if(o&&n)return{url:`/sharing/podcasts/${n}`,schema:lu};if(a){if(!s&&!o)return null}else if(!e)return null;return t?{url:`/podcasts/${t}/${e}`,schema:lu}:{url:"/daily-briefing",podcastId:e,includeTranscripts:!o,schema:c5}}function ohe(){const{podcastId:e,podcastType:t,shareId:n}=Fu({strict:!1}),o=M(wk),s=e??o,a=Zc(),r=!!e||a,i=the(),d=q("1s-dbrief-fetchall"),m=ehe(),p=G(Ak),h=nhe(s,t,n,r,i,d),g=l.useCallback(()=>{if(!h)throw new Error("Media key is not defined");return xk(h)},[h]),{data:y,isLoading:b,error:C}=ts({queryKey:["dailyBriefingMedia",s,r,n,t,i,d],enabled:!!h&&m,queryFn:g,staleTime:4e3});l.useEffect(()=>{if(y&&r){const E=lu.parse(y);p(E.podcastId)}},[y,r,p]);const T=()=>r?t?`${Di.Podcast}.${t}`:Di.Podcast:Di.Daily;if(y&&r){const E=lu.parse(y),{isAvailable:I,podcastId:x,chapters:w,playback:{positionInSeconds:P,chapterId:D}}=E,L=n?`/sharing/podcasts/${n}/Files`:`/podcasts/${t}/${x}/Files`,j=w.map(({id:K,title:X,image:ne,audio:me})=>({id:K,title:X,image:{landscape:{...ne.landscape,url:`${L}/${ne.landscape.name}`},portrait:{...ne.portrait,url:`${L}/${ne.portrait.name}`}},audio:me})),U={isAvailable:I,podcastId:x,chapters:j.map(K=>({...K,audio:{default:{url:`${L}/${K.audio.name}`,duration:K.audio.duration,transcript:null}},transitionMusic:null,sources:[]})),playback:{position:P,chapterId:D}},$={...E,chapters:j};return{data:U,podcastData:$,isPodcast:r,isLoading:b,error:C,pageImpressionKey:T()}}return{data:!r&&y?c5.parse(y):void 0,isPodcast:r,isLoading:b,error:C,pageImpressionKey:T()}}function K_e(){const{data:e}=ts({queryKey:["dailyBriefingTopics"],queryFn:()=>xk({url:"/daily-briefing/topics",schema:i5})});return{data:e}}async function Y_e(e,t){await Nt({path:"/daily-briefing/topics/unfollow",args:{body:{ids:t}}}),await Nt({path:"/daily-briefing/topics/follow",args:{body:{ids:e}}})}const she=1;function ahe(){const e=Fa(),t=G(Yt),n=G(wk),[o,s]=Le(Tk),a=q("1s-dbrief-fetchall"),{firstStoryId:r,formCode:i}=$9({strict:!1}),d=l.useCallback(async()=>{await e({from:"/daily",to:"/discover"}),n(void 0),t(null)},[n,t,e]),m=l.useCallback(async g=>{if(i&&R.setFormCode(i),r){const y=g.split(",");if(y.length>=2){y[she]=r;const b=y.join(",");n(b)}else n(g)}else n(g);s(0),t("daily-briefing-player"),await e({from:"/",to:"/daily",search:{firstStoryId:r,...a&&g&&{chapterIds:g}}})},[i,r,s,t,e,a,n]),p=l.useCallback(async()=>{s(o),await e({from:"/daily",to:"/topic-selection"}),t(null)},[t,s,o,e]),h=l.useCallback(async()=>{s(o),t("daily-briefing-player"),await e({from:"/topic-selection",to:"/daily"})},[o,s,t,e]);return{navigateToDailyBriefing:m,navigateToTopicSelection:p,exitDailyBriefing:d,returnToDailyBriefing:h,currentChapterIndex:o}}function rhe({media:e,thresholds:t,key:n}){const o=l.useRef(0),s=l.useRef([]),a=l.useRef(new Set);return l.useEffect(()=>{s.current=t?.sort((r,i)=>r.seconds-i.seconds)??[]},[t]),l.useEffect(()=>{o.current=0,a.current=new Set;let r=null;if(!e)return()=>{};function i(){r=performance.now()}function d(g){if(r!==null){const y=(performance.now()-r)/1e3;o.current+=y,r=g?performance.now():null,h()}}function m(){d(!1)}function p(){d(!0)}const h=()=>{for(let g=0;g<s.current.length;g+=1){const y=s.current[g];y&&o.current>=y.seconds&&!a.current.has(g)&&(a.current.add(g),y.callback())}};return e.addEventListener("playing",i),e.addEventListener("pause",m),e.addEventListener("ended",m),e.addEventListener("timeupdate",p),()=>{e.removeEventListener("playing",i),e.removeEventListener("pause",m),e.removeEventListener("ended",m),e.removeEventListener("timeupdate",p)}},[e,n]),{totalTimePlayedRef:o}}function Oi(e){if(!e)return NaN;const t=e.split(":");if(t.length!==2)return NaN;const[n,o]=t,s=Number(n),a=Number(o);return s<0||a<0||a>=60?NaN:s*60+a}function ihe(e,t,n,o){return e===n.length-1&&t===o.length-1?1/0:t===o.length-1?Oi(n[e+1]?.startTime):Oi(o[t+1]?.startTime)}function che(e){let t=-1;return e.map((o,s,a)=>({...o,startTime:Oi(o.startTime),endTime:s<a.length-1?Oi(a[s+1]?.startTime):1/0,words:o.words.map((r,i,d)=>(t+=1,{...r,startTime:Oi(r.startTime),endTime:ihe(s,i,a,d),index:t}))}))}function _k(e,t,n){return{DailyBriefing:`${t}|${n}`,Podcast:t}[e]}function y2(e,t,n){const o=_k(e,t,n);o&&Nt({path:`/media/${e}/${o}/playback/completed`,args:{}}).catch(s=>{Z5(s)})}function lhe(e,t,n,o){const s=_k(e,n,o);s&&Nt({path:`/media/${e}/${s}/playback`,args:{options:{method:"PATCH"},body:{positionInSeconds:t}}}).catch(a=>{Z5(a)})}function Ip(e,t){const n=Object.keys(t);if(n.length!==0)return typeof e<"u"&&n.includes(e)?t[e]:Object.values(t)[0]}const uhe=5,dhe=5e3;function kk(e){const{onSeeked:t}=e??{},{exitDailyBriefing:n}=ahe(),{data:o,isPodcast:s,pageImpressionKey:a}=ohe(),r=s?Kf.Podcast:Kf.DailyBriefing,i=M(Ak),d=M(Or),m=l.useMemo(()=>o?s?o.chapters.map(ie=>[ie.audio.default?.duration??0]):o.chapters.map(ie=>{const we=[Ip(d,ie.audio)?.duration??0];return ie.transitionMusic&&we.push(ie.transitionMusic.duration),we}):[],[o,s,d]),[p,h]=Le(Tk),g=l.useRef(null),[y,b]=l.useState(!1),C=p<m.length-1,T=p>0,S=l.useRef(performance.now()),E=l.useRef(performance.now()),I=l.useMemo(()=>o?.chapters[p]?.id?o.chapters[p].id:i&&i.split(",")[p],[o?.chapters,p,i]),x=l.useMemo(()=>o?s?o.chapters.map(ie=>[ie.audio.default?.url??""]):o.chapters.map(ie=>{const we=[Ip(d,ie.audio)?.url??""];return ie.transitionMusic&&we.push(ie.transitionMusic.url),we}):[],[o,d,s]),[w,P]=l.useState(0),D=l.useRef(null),L=l.useRef(!1),j=l.useRef(p),U=l.useRef(null),[$,K]=l.useState([]),[X,ne]=l.useState(null);l.useEffect(()=>{if(!X)return;const ie=()=>{D.current!==null&&(X.currentTime=D.current,D.current=null),L.current&&(X.pause(),L.current=!1)},we=()=>{if(U.current){const $e=Math.round(U.current.direction==="forward"?X.currentTime-U.current.position:U.current.position-X.currentTime);$e>0&&t?.({direction:U.current.direction,seconds:$e}),U.current=null}};return X.addEventListener("loadedmetadata",ie),X.addEventListener("seeked",we),()=>{X.removeEventListener("loadedmetadata",ie),X.removeEventListener("seeked",we)}},[X,t]);const me=JSON.stringify({podcastId:i,eventInfo_chapterId:o?.chapters[p]?.id,eventInfo_chapterPlayDuration:performance.now()-S.current}),[Se,ge]=Le(nue),ve=l.useCallback(()=>{ge(ie=>{const we=!ie,$e=we?fs.Mute:fs.Unmute;return $s(r,$e,me),we})},[me,r,ge]);rhe({media:X,key:I,thresholds:[{seconds:uhe,callback:()=>{if(I&&!$.includes(I)){try{Nt({path:`/daily-briefing/${I}/viewed`,args:{analytics:{anonymousPath:"/daily-briefing/*/viewed"}}})}catch{}K([...$,I])}}}]}),l.useEffect(()=>{if(!X||!y)return;const ie=setInterval(()=>{const we=X.currentTime;lhe("DailyBriefing",we,i,I)},dhe);return()=>{clearInterval(ie)}},[X,y,I,i]);function Pe(){b(!0),g.current?.playAnimation(),X?.play(),$s(r,fs.Play,me)}function Me(){b(!1),g.current?.pauseAnimation(),X?.pause(),$s(r,fs.Pause,me)}function ye(ie){if(X){const we=X.currentTime+ie,$e=X.duration,wt=x[p]??[];if(we>$e&&w<wt.length-1){const _t=we-$e;D.current=Math.max(_t,0),L.current=!y,P(w+1)}else U.current={direction:"forward",position:X.currentTime},X.currentTime=Math.min(we,$e);$s(r,fs.Skip,JSON.stringify({seconds:ie}))}}function Ie(ie){if(X){const we=X.currentTime-ie;if(we<0&&w>0){const wt=(m[p]?.[w-1]??0)+we;D.current=Math.max(wt,0),L.current=!y,P(w-1)}else U.current={direction:"back",position:X.currentTime},X.currentTime=Math.max(we,0);$s(r,fs.Rewind,JSON.stringify({seconds:ie}))}}function He(){y2("DailyBriefing",i,I),o?.chapters&&R.trackEvent({name:"system",data:{eventName:"chapterPlayDuration",eventInfo_podcastId:i,eventInfo_chapterIndex:p,eventInfo_isCompleted:p===o.chapters.length-1,eventInfo_publisherName:o.chapters[p]?.sources?.map(ie=>ie.publisherName).join(","),eventInfo_impressionElement:a,eventInfo_customData:JSON.stringify({eventInfo_chapterId:o.chapters[p]?.id,eventInfo_chapterPlayDuration:performance.now()-S.current})}})}function Ze(){y2("Podcast",i),R.trackEvent({name:"system",data:{eventName:"podcastPlayDuration",eventInfo_isCompleted:!0,eventInfo_podcastId:i,eventInfo_podcastPlayDuration:performance.now()-E.current,eventInfo_impressionElement:a}})}const Be=l.useCallback(()=>{X&&(X.currentTime=0)},[X]);function be(ie){He(),S.current=performance.now(),Be(),Oe(-1),P(0),h(ie)}function re(){C&&(be(p+1),$s(r,fs.Next,me))}function te(){T&&(be(p-1),$s(r,fs.Previous,me))}function H(ie){X&&(X.playbackRate=ie/100)}function Y(ie){const $e=(Dm.indexOf(ie)+1)%Dm.length;return Dm[$e]??yc}function ue(){b(!0);const ie=x[p]??[];w<ie.length-1?P(we=>we+1):ie.length-1===w&&C?re():(De(),n())}function oe(){S.current=performance.now(),E.current=performance.now()}function De(){s?Ze():He()}const _e=l.useMemo(()=>{if(s)return[];const ie=o?.chapters[p];if(!ie)return[];const we=Ip(d,ie.audio);return che(we?.transcript??[])},[s,d,o?.chapters,p]),ze=l.useMemo(()=>_e.flatMap(ie=>ie.words),[_e]),We=l.useMemo(()=>m[p]??[],[m,p]),Oe=G(oue);l.useEffect(()=>{j.current!==p&&(P(0),D.current=null,L.current=!1,Be(),Oe(-1),S.current=performance.now(),j.current=p)},[p,Be,Oe]);const qe=l.useCallback(ie=>ze.find($e=>ie>=$e.startTime&&ie<$e.endTime)?.index??-1,[ze]),se=l.useCallback(ie=>{const we=ie.currentTarget;let{currentTime:$e}=we;for(let _t=0;_t<w;_t+=1){const An=We[_t];An&&($e+=An)}if($e===0)return;const wt=qe($e);Oe(wt)},[We,w,qe,Oe]);return l.useEffect(()=>{if(!(s||!X))return X.addEventListener("timeupdate",se),()=>{X.removeEventListener("timeupdate",se)}},[X,se,s]),{isPlaying:y,currentChapterId:I,currentChapterIndex:p,chapterDurations:m,currentChapterPartIndex:w,audioElement:X,setAudioElement:ne,audioChaptersProgressBarRef:g,currentChapterAudioSrc:x[p]?.[w]??"",isPlayerMuted:Se,currentChapterTranscript:_e,play:o?Pe:void 0,pause:o?Me:void 0,skipForward:o?ie=>ye(ie):()=>{},skipBack:o?ie=>Ie(ie):()=>{},goToNextChapter:C?re:void 0,goToPreviousChapter:T?te:void 0,getNextPlaybackSpeed:o?ie=>Y(ie):void 0,applyPlaybackRate:o?ie=>H(ie):()=>{},onChapterEnded:ue,resetAllTimers:oe,trackPlayerEndEvents:De,togglePlayerMuted:ve}}function mhe(){const{currentChapterId:e}=kk();return l.useMemo(()=>{if(e)return{type:"dailyBriefing",chapterId:e}},[e])}function phe(e,t){const[n,o]=l.useState(0);return l.useEffect(()=>{if(!e)return()=>{};const s=m=>{m.preventDefault(),o(p=>p+1)},a=m=>{m.preventDefault(),o(p=>Math.max(0,p-1))},r=m=>{m.preventDefault(),o(0),t?.(m)},i=()=>{document.hidden&&o(0)},d=m=>{m.preventDefault()};return window.addEventListener("dragenter",s,!0),window.addEventListener("dragleave",a,!0),window.addEventListener("drop",r,!0),document.addEventListener("visibilitychange",i),t&&window.addEventListener("dragover",d),()=>{window.removeEventListener("dragenter",s,!0),window.removeEventListener("dragleave",a,!0),window.removeEventListener("drop",r,!0),document.removeEventListener("visibilitychange",i),t&&window.removeEventListener("dragover",d)}},[e,t]),n>0}function Pk(e){function t(n,o){return!n||o.length===0?null:Mk(n.text,o.sort((s,a)=>s.position-a.position))}return e.map(n=>{if(n.author!=="ai"||!n.content.find(i=>i.type==="citation"))return n;let s=null,a=[];for(const i of n.content)if(i.type==="text"){const d=t(s,a);d&&s&&(s.text=d.text,s.citations=d.citationMetadata),a=[],s=i}else i.type==="citation"&&a.push(i);const r=t(s,a);return r&&s&&(s.text=r.text,s.citations=r.citationMetadata),n})}function Mk(e,t){if(!t)return{text:e,citationMetadata:[]};let n=e;const o=[];let s=0;const a=new Map;for(const i of t){const d=i.url;if(!a.has(d)){s+=1;const m=`${s}`;a.set(d,m),o.push({index:m,title:i.title,url:i.url,iconUrl:i.iconUrl??null,publisher:i.publisher??null,snippet:i.snippet??null,label:i.label??null})}}const r=t.map((i,d)=>({citation:i,originalIndex:d})).sort((i,d)=>{const m=d.citation.position-i.citation.position;return m!==0?m:d.originalIndex-i.originalIndex}).map(i=>i.citation);for(const i of r){const d=i.url,m=a.get(d);m!==void 0&&(n=tZ(n,h_(m,i.url),i.position))}return{text:n,citationMetadata:o}}function Z_e(e){if(!e.some(r=>r.type==="citation"))return e;const n=e.map(r=>({...r}));let o=null,s=[];function a(){if(o===null||s.length===0)return;const r=n[o];if(r?.type!=="text")return;const{text:i,citationMetadata:d}=Mk(r.text,s.sort((m,p)=>m.position-p.position));r.text=i,r.citations=d}for(let r=0;r<n.length;r+=1){const i=n[r];i?.type==="text"?(a(),s=[],o=r):i?.type==="citation"&&s.push(i)}return a(),n.filter(r=>r.type!=="citation")}function fhe(){const e=R_(),{conversationId:t}=Fu({strict:!1}),{data:n,error:o,isLoading:s}=ts({queryKey:["sharePage",t],queryFn:()=>hhe(`/conversations/shares/${t}`),staleTime:1/0,enabled:e&&!!t});return{data:n,error:o,isLoading:s}}async function hhe(e){const{data:t,response:n}=await pt(e,oz,{parseOptions:{safe:!0},analytics:{anonymousPath:"/conversations/shares/*"}});if(n.status>=400&&n.status<500)throw new ghe(n.status.toString());return{...t,messages:Pk(t.messages.reverse())}}class ghe extends Error{}function vhe(){const e=R_(),{isMediaViewerOpen:t}=Ro(),n=M(Yt),o=!it("kill-share-continue"),{error:s}=fhe();return e?s?!1:o||t||!!n:!0}function T0(){return _h("(hover: hover) and (pointer: fine)")}function yhe(){const e=q("deep-research"),t=q("deep-research-nano"),n=Dt(),o=M(bd);return e&&(o||!1||!o&&n&&t)&&!J.instance().config().disableDeepResearch}const Rk=()=>{const e=M(Er);return Dt()&&e.length>0},Che=()=>{const e=Rk(),t=n3(),n=s3(),o=a3(),s=r3(),a=o3(),r=i3();return(t||n||o||s||a||r)&&e};function Bn(e){const t=i1(),n=Zt(),o=Sse(),s=yhe(),a=q("page-in-create-drawer"),r=q("onedrive-file-upload"),i=q("homework-helper"),d=Che();if(!t)switch(e){case"researchReport":return s;case"actions":return o;case"page":return a;case"oneDriveFileUpload":return r;case"homeworkHelper":return n==="study"&&i;case"connector":return d;case"quiz":case"image":case"voice":case"uploadFile":default:return!0}switch(e){case"uploadFile":case"image":return!0;case"connector":case"podcast":case"researchReport":case"quiz":case"actions":case"voice":case"page":case"oneDriveFileUpload":case"homeworkHelper":default:return!1}}const She={h550:"550",h600:"600",h700:"700",h760:"760",h840:"840"};function w0(e){const{breakpoint:t}=e,n=She[t];return!_h(`(min-height: ${n}px)`)}const Nk=_(),J_e=_(!1),Q_e=_(!1),bhe=/\/(?:.*\/)?(ar|vi|gm)-([a-zA-Z0-9]{6,10})/,Ihe="gemSnapshotKey";function Ehe(){const e=M(Nk),{contentPageType:t}=Ro();return l.useMemo(()=>{if(!(!e||!t))try{const o=e.pathname.match(bhe)?.[2]??null;if(!o)return;switch(t){case"newsGem":{const s=e.searchParams.get(Ihe);return s?{type:"newsGem",gemId:o,snapshotKey:s}:void 0}case"newsArticle":return{type:"news",articleId:o};default:return}}catch{return}},[e,t])}function The(e){l.useEffect(()=>{const{visualViewport:t}=window;if(!$5()||!t)return;const n=()=>{e.current?.contains(document.activeElement)&&t.height<window.innerHeight&&e.current.scrollIntoView({behavior:"smooth",block:"end"})};return t.addEventListener("resize",n),()=>t.removeEventListener("resize",n)},[e])}const C2=new Map;function whe(){const{createConversation:e}=$r(),t=M(kg),[n,o]=Le(Te),s=M(Nk);return{switchMsnConversation:l.useCallback(async()=>{if(!s||!n)return;const r=s.toString();let i=C2.get(r);if(!i){i=t,n!==t&&(i=await e({shouldNavigateToChat:!1})),i&&(o(i),C2.set(r,i));return}i!==n&&wd({id:i,shouldNavigateToChat:!1})},[s,n,t,e,o])}}function Lk(e,t,n){const o=ke();return new Promise((s,a)=>{let r=null;t(o.get(e))&&s(o.get(e));const i=o.sub(e,()=>{const m=o.get(e);t(m)&&(i(),s(m))}),d=()=>{i(),r&&clearTimeout(r)};n&&(r=setTimeout(()=>{d(),a(new Error("Timeout waiting for atom to be ready"))},n))})}function Ahe(e){return e.some(t=>t.author==="human"&&t.content.some(n=>n.type==="image"||n.type==="document"))}function X_e(e){const t=e.filter(n=>n.author==="human");if(t.length===1){const n=t[0]?.content.find(o=>o.type==="image"||o.type==="document")?.type;return n==="image"?"image":n==="document"?"file":void 0}return Ahe(e)?"image|file":void 0}function xhe(e){const n=new URL(e).pathname.split("/").filter(Boolean);return n[n.length-1]??null}async function S2(){Yne();const e=ke(),t=xhe(window.location.href);let n;e.set(df,!0);try{const o=await _he(`/conversations/shares/${t}/continue`),{id:s,title:a}=o.conversation;n=s;const r=new Date().toISOString(),i={id:s,updatedAt:r,isNew:!1,title:a,history:[],continuedAt:r,group:null};e.set(bt,d=>{const m=new Map(d);return m.set(s,i),m}),e.set(Te,s),await Phe(s)}catch(o){throw Fo({title:st.t("composer.errors.continue.title"),message:st.t("composer.errors.continue.message")}),Zne({shareId:t??"",conversationId:n,error:o instanceof Error?o:new Error(String(o))}),o}finally{e.set(df,!1)}}async function _he(e){return(await pt(e,VH,{options:{method:"POST"}})).data}const khe=1e4;async function Phe(e){await Lk(bt,t=>(t.get(e)?.history??[]).length>0,khe)}function Mhe(e,t,n){if(!e||!t)return!1;const o=e.getTime(),s=t.getTime(),a=n?n.getTime():null;return s<=o||a===null?!1:a<=o}function Yf(e,t){const n=Eo(e),o=Eo(t);return n.getTime()>o.getTime()}function ec(e,t){return pc(e,-t)}const Rhe=11,Nhe=7,Lhe=2,Dhe=10,Ohe=21,Uhe=21,Fhe=10,b2=f({daysActive:A(hr())}),Zf=f({result:z(["dismissed","positive","negative"]),date:hr(),dismissCounter:k()});function jhe(e){const t=new Date;let n=e;return e.some(o=>Gr(o,t))||(n=[...e,t]),n.length>Fhe?n.slice(-10):n}function Bhe(){const t=qt(ly,b2)?.daysActive??[],n=jhe(t),o=ec(new Date,Nhe),s=n.filter(a=>Yf(a,o)||Gr(a,o)).length;return n!==t&&Jo(ly,b2,{daysActive:n}),s}function Vhe(){const e=qt(Hp,Zf);if(!e)return!1;const t=e.result==="positive",n=e.result==="negative"&&Yf(e.date,ec(new Date,Uhe)),o=e.result==="dismissed"&&Yf(e.date,ec(new Date,e.dismissCounter>5?Ohe:Dhe));return t||n||o}function Hhe(e,t){let n="popUpDismiss";t==="negative"?n="appThumbDown":t==="positive"&&(n="appThumbUp"),en({source:n,conversationId:e});const o=qt(Hp,Zf),s=o?.result==="dismissed"?o.dismissCounter:0,a={result:t,date:new Date,dismissCounter:t==="dismissed"?s+1:0};Jo(Hp,Zf,a)}function Jf(){return Jf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)({}).hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},Jf.apply(null,arguments)}function zhe(e,t){if(e==null)return{};var n={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(t.indexOf(o)!==-1)continue;n[o]=e[o]}return n}var Ghe=l.useLayoutEffect,Whe=function(t){var n=xp.useRef(t);return Ghe(function(){n.current=t}),n},I2=function(t,n){if(typeof t=="function"){t(n);return}t.current=n},$he=function(t,n){var o=xp.useRef();return xp.useCallback(function(s){t.current=s,o.current&&I2(o.current,null),o.current=n,n&&I2(n,s)},[n])},E2={"min-height":"0","max-height":"none",height:"0",visibility:"hidden",overflow:"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0",display:"block"},qhe=function(t){Object.keys(E2).forEach(function(n){t.style.setProperty(n,E2[n],"important")})},T2=qhe,un=null,w2=function(t,n){var o=t.scrollHeight;return n.sizingStyle.boxSizing==="border-box"?o+n.borderSize:o-n.paddingSize};function Khe(e,t,n,o){n===void 0&&(n=1),o===void 0&&(o=1/0),un||(un=document.createElement("textarea"),un.setAttribute("tabindex","-1"),un.setAttribute("aria-hidden","true"),T2(un)),un.parentNode===null&&document.body.appendChild(un);var s=e.paddingSize,a=e.borderSize,r=e.sizingStyle,i=r.boxSizing;Object.keys(r).forEach(function(g){var y=g;un.style[y]=r[y]}),T2(un),un.value=t;var d=w2(un,e);un.value=t,d=w2(un,e),un.value="x";var m=un.scrollHeight-s,p=m*n;i==="border-box"&&(p=p+s+a),d=Math.max(p,d);var h=m*o;return i==="border-box"&&(h=h+s+a),d=Math.min(h,d),[d,m]}var A2=function(){},Yhe=function(t,n){return t.reduce(function(o,s){return o[s]=n[s],o},{})},Zhe=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","boxSizing","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","tabSize","textIndent","textRendering","textTransform","width","wordBreak","wordSpacing","scrollbarGutter"],Jhe=!!document.documentElement.currentStyle,Qhe=function(t){var n=window.getComputedStyle(t);if(n===null)return null;var o=Yhe(Zhe,n),s=o.boxSizing;if(s==="")return null;Jhe&&s==="border-box"&&(o.width=parseFloat(o.width)+parseFloat(o.borderRightWidth)+parseFloat(o.borderLeftWidth)+parseFloat(o.paddingRight)+parseFloat(o.paddingLeft)+"px");var a=parseFloat(o.paddingBottom)+parseFloat(o.paddingTop),r=parseFloat(o.borderBottomWidth)+parseFloat(o.borderTopWidth);return{sizingStyle:o,paddingSize:a,borderSize:r}},Xhe=Qhe;function A0(e,t,n){var o=Whe(n);l.useLayoutEffect(function(){var s=function(r){return o.current(r)};if(e)return e.addEventListener(t,s),function(){return e.removeEventListener(t,s)}},[])}var ege=function(t,n){A0(document.body,"reset",function(o){t.current.form===o.target&&n(o)})},tge=function(t){A0(window,"resize",t)},nge=function(t){A0(document.fonts,"loadingdone",t)},oge=["cacheMeasurements","maxRows","minRows","onChange","onHeightChange"],sge=function(t,n){var o=t.cacheMeasurements,s=t.maxRows,a=t.minRows,r=t.onChange,i=r===void 0?A2:r,d=t.onHeightChange,m=d===void 0?A2:d,p=zhe(t,oge),h=p.value!==void 0,g=l.useRef(null),y=$he(g,n),b=l.useRef(0),C=l.useRef(),T=function(){var I=g.current,x=o&&C.current?C.current:Xhe(I);if(x){C.current=x;var w=Khe(x,I.value||I.placeholder||"x",a,s),P=w[0],D=w[1];b.current!==P&&(b.current=P,I.style.setProperty("height",P+"px","important"),m(P,{rowHeight:D}))}},S=function(I){h||T(),i(I)};return l.useLayoutEffect(T),ege(g,function(){if(!h){var E=g.current.value;requestAnimationFrame(function(){var I=g.current;I&&E!==I.value&&T()})}}),tge(T),nge(T),l.createElement("textarea",Jf({},p,{onChange:S,ref:y}))},age=l.forwardRef(sge);function rge(e,t){const n=l.useRef(null);l.useEffect(()=>{const o=e?.current;if(!o)return;const s=r=>{const i=o.selectionStart,d=o.selectionEnd;if(i!==d&&r.key!=="Backspace"&&r.key!=="Delete")n.current={type:"replace",char:r.key,index:i};else if(r.key==="Backspace"&&i>0){const p=o.value[i-1];p!==void 0&&(n.current={char:p,index:i-1,type:"delete"})}else if(r.key==="Delete"&&i<o.value.length){const p=o.value[i];p!==void 0&&(n.current={char:p,index:i,type:"delete"})}else n.current=null},a=()=>{t&&t(n.current),n.current=null};return o.addEventListener("keydown",s),o.addEventListener("input",a),()=>{o.removeEventListener("keydown",s),o.removeEventListener("input",a)}},[e,t])}const Qf="@",ige=new RegExp(`${Qf}([^${Qf}]*)`,"g");function cge(e,t){return[...e.slice(0,t).matchAll(ige)].map(o=>({keyword:o[1],start:o.index,end:o.index+o[0].length}))}function lge(e,t){const n=cge(e,t);if(n.length===0)return;const o=n[n.length-1];return o?.end===t?o:void 0}function uge(e){const{className:t,textAreaRef:n,onMentionChange:o,textAreaValue:s,onCancelMention:a,hideMentionPlaceholder:r}=e,[i,d]=l.useState(void 0),{t:m}=Z(),p=l.useRef(!1),h=l.useRef(o),g=l.useRef(null),y=l.useRef(new Set),b=l.useCallback(I=>{I&&I.char===Qf&&I.type!=="insert"&&y.current.delete(I.index)},[]),C=l.useCallback(()=>{d(void 0),g.current=null},[d]);rge(n,b),l.useEffect(()=>{h.current=o},[o]);const T=l.useCallback(()=>{const I=n?.current;if(!I)return;const x=I.selectionStart,w=I.selectionEnd;if(x===w){const P=lge(s,x);P?y.current.has(P.start)?C():(g.current=P,d(D=>D!==P.keyword?P.keyword:D)):C()}},[C,n,s]),S=l.useCallback((I="remove")=>{const x=g.current;if(!x)return;if(I==="ignore"){y.current.add(x.start),h.current?.({isTrigger:!1}),d(void 0);return}const w=s.slice(0,x.start),P=s.slice(x.end),D=w+P;g.current=null,h.current?.({isTrigger:!1}),a?.(D)},[a,s]);l.useEffect(()=>{s===""?(C(),y.current.clear()):T()},[T,s,d,C]),l.useEffect(()=>{if(!p.current){p.current=!0;return}i!==void 0?h.current?.({isTrigger:!0,keyword:i}):h.current?.({isTrigger:!1})},[i,h]),l.useEffect(()=>(Ce.on("mention:cancel",S),()=>{Ce.off("mention:cancel",S)}),[S]);const E=i===""&&!r;return c.jsxs("div",{className:Ae("pointer-events-none absolute z-0 overflow-auto contrast-more:-z-10 contrast-less:-z-10 forced-colors:-z-10",t),"aria-hidden":"true",children:[c.jsx("span",{className:"invisible select-none whitespace-pre-wrap break-words",children:s}),E&&c.jsx("span",{className:"text-foreground-550 dark:text-foreground-600",children:m("userInput.mentionPlaceholderText")})]})}function dge(e,t){const n=l.useCallback(async o=>{o.key==="Enter"&&!o.shiftKey&&!t&&await e(o)},[e,t]);Ga(n)}function mge(e,t,n){const o=l.useRef(!1),s=l.useCallback(()=>{o.current=!0},[]),a=l.useCallback(()=>{setTimeout(()=>{o.current=!1},100)},[]);return dge(async r=>{e.current?.contains(document.activeElement)&&!o.current&&(r.preventDefault(),await t())},n),{handleCompositionStart:s,handleCompositionEnd:a}}function Xf(e){return J.instance().config().styleOverrides?.typography?.[e]}function _u(e){return J.instance().config().styleOverrides?.padding?.[e]}const pge="pointer-events-none cursor-not-allowed select-none shadow-none",fge="opacity-40",hge=.25,x0=l.forwardRef((e,t)=>{const{t:n}=Z(),{inputValue:o,errorMessage:s,className:a,inputBoxClassName:r,characterLimit:i,characterLimitErrorMessage:d,disabled:m,placeholder:p=n("userInput.placeholderText"),autoFocus:h=!0,noDesktopAutoFocus:g=!1,testId:y,setInput:b,setError:C,onBlur:T,onTextChange:S,onSelect:E,onFocus:I,onClick:x,onEnter:w,onKeyDown:P,onPaste:D,onMentionIfEnabled:L,hideMentionPlaceholder:j,rightButtons:U,isMultiLines:$,"aria-autocomplete":K,"aria-controls":X,disabledClassName:ne,inputContainerClassName:me}=e,Se=sn(),ge=l.useRef(null),ve=l.useRef(null),Pe=T0()||J.instance().config().enterKeyButtonEnabled,Me=n("userInput.characterLimitText",{maxCharacters:i.toString()}),[ye,Ie]=l.useState(h);l.useEffect(()=>{Pe&&!g&&(Ie(!0),ve.current?.focus())},[Se,Pe,g]);const He=l.useCallback(re=>{const{value:te}=re.target;b(te),S&&S(re),te.length>i?C(d??Me):C(null)},[b,S,i,C,d,Me]);l.useImperativeHandle(t,()=>({updateInputValue:re=>{const te=re(o);b(te)},focus:()=>{ve.current?.focus()},blur:()=>{ve.current?.blur()},contains:re=>ve.current?.contains(re)??!1,updateSelectionRange:(re,te)=>{ve.current?.setSelectionRange(re,te)},getTextAreaRef(){return ve}}),[o,b]),Ga(re=>{re.key==="Escape"&&ge.current?.contains(document.activeElement)&&ve.current?.blur(),P?.(re)});const{handleCompositionStart:Ze,handleCompositionEnd:Be}=mge(ge,w,!Pe),be=m?ne??fge:"";return c.jsxs(he.div,{className:O("flex grow items-end",m&&pge,be,a),onClick:()=>{x?.(),ve.current?.focus()},ref:ge,onBlur:re=>T?.(re),layout:"preserve-aspect",children:[c.jsx(he.div,{className:"relative grow overflow-hidden",layout:!0,children:c.jsx(he.div,{className:"relative flex size-full cursor-text overflow-hidden text-black dark:text-white",layout:!0,children:c.jsxs(he.div,{className:"flex grow flex-col gap-4 py-user-input",layout:!0,transition:{duration:0},children:[c.jsx("div",{className:O("t-custom-scrollbar scrollbar-stable overflow-y-auto px-4",J.instance().config().showScrollbarOnHover?"scrollbar-container":"",me),children:c.jsxs("div",{className:"relative",children:[c.jsx("label",{className:O(["invisible block h-0 w-0 overflow-hidden",{"whitespace-nowrap":!$}]),htmlFor:"userInput",children:p}),c.jsx(age,{className:O("font-ligatures-none inline-block h-user-input w-full resize-none overflow-y-hidden whitespace-pre-wrap bg-transparent align-top text-black outline-none placeholder:text-foreground-450 dark:text-white dark:placeholder:text-foreground-600/90",Xf("composer")??"text-base-dense",_u("composerVertical"),r),disabled:m,placeholder:p,ref:ve,id:Cc,role:"textbox","aria-autocomplete":K,"aria-controls":X,spellCheck:!1,value:o,enterKeyHint:"enter",onChange:He,onSelect:E,onFocus:()=>{I?.(o,ye),ye&&Ie(!1)},onCompositionStart:Ze,onCompositionEnd:Be,onPaste:D,autoFocus:h,"data-testid":y}),L&&c.jsx(uge,{className:O("font-ligatures-none inline-block min-h-user-input w-full resize-none overflow-y-hidden whitespace-pre-wrap bg-transparent align-top text-black outline-none placeholder:text-foreground-450 dark:text-white dark:placeholder:text-foreground-600",Xf("composer")??"text-base",_u("composerVertical"),"inset-0"),textAreaRef:ve,textAreaValue:o,onMentionChange:L,hideMentionPlaceholder:j,onCancelMention:re=>{b(re),C(null)}})]})}),s&&c.jsx("div",{className:"flex min-h-6 select-none items-center px-4 text-foreground-600 text-sm",children:s})]})})}),c.jsx(he.div,{className:O("relative bottom-0 my-1.5 flex h-9 items-center",U?.length?"mx-1.5 w-auto gap-1":"w-0"),children:U?.map((re,te)=>c.jsx(It,{children:c.jsx(he.div,{initial:je,animate:{...rt,transition:{delay:hge}},transition:{duration:Wn.default},children:re})},te))})]})});x0.displayName="UserInput";const gge=({title:e,titleId:t,...n})=>l.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M12 8V2H6C4.89543 2 4 2.89543 4 4V20C4 21.1046 4.89543 22 6 22H18C19.1046 22 20 21.1046 20 20V10H14C12.8954 10 12 9.10457 12 8ZM8.25 11.5H15.75C16.1642 11.5 16.5 11.8358 16.5 12.25C16.5 12.6642 16.1642 13 15.75 13H8.25C7.83579 13 7.5 12.6642 7.5 12.25C7.5 11.8358 7.83579 11.5 8.25 11.5ZM8.25 14.25H15.75C16.1642 14.25 16.5 14.5858 16.5 15C16.5 15.4142 16.1642 15.75 15.75 15.75H8.25C7.83579 15.75 7.5 15.4142 7.5 15C7.5 14.5858 7.83579 14.25 8.25 14.25ZM8.25 17H15.75C16.1642 17 16.5 17.3358 16.5 17.75C16.5 18.1642 16.1642 18.5 15.75 18.5H8.25C7.83579 18.5 7.5 18.1642 7.5 17.75C7.5 17.3358 7.83579 17 8.25 17ZM13.5 8V2.5L19.5 8.5H14C13.7239 8.5 13.5 8.27614 13.5 8Z"})),vge=({title:e,titleId:t,...n})=>l.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M12 2V8C12 9.10457 12.8954 10 14 10H20V20C20 21.1046 19.1046 22 18 22H6C4.89543 22 4 21.1046 4 20V4C4 2.89543 4.89543 2 6 2H12ZM13.5 2.5V8C13.5 8.27614 13.7239 8.5 14 8.5H19.5L13.5 2.5Z"})),yge="/static/cmc/assets/pdf-CBlMXyWV.svg",Cge=({title:e,titleId:t,...n})=>l.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"none","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M3 2.5C3 2.22386 3.22386 2 3.5 2H11.5C11.7761 2 12 2.22386 12 2.5V4.5C12 4.77614 11.7761 5 11.5 5C11.2238 5 11 4.77614 11 4.5V3H7.99997L7.99998 13H9C9.27614 13 9.5 13.2239 9.5 13.5C9.5 13.7761 9.27614 14 9 14H6C5.72386 14 5.5 13.7761 5.5 13.5C5.5 13.2239 5.72386 13 6 13H6.99998L6.99997 3H4V4.5C4 4.77614 3.77614 5 3.5 5C3.22386 5 3 4.77614 3 4.5V2.5Z",fill:"currentColor"}));function Sge(e){const{fileType:t,className:n}=e;switch(t){case"application/pdf":return c.jsx(St,{url:yge,className:n});case"application/vnd.openxmlformats-officedocument.wordprocessingml.document":case"application/msword":return c.jsx(gge,{className:n});case"text/plain":return c.jsx(Cge,{className:n});case"application/json":case"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":case"application/vnd.ms-excel":case"application/vnd.openxmlformats-officedocument.presentationml.presentation":case"application/vnd.ms-powerpoint":case"text/csv":case"text/markdown":default:return c.jsx(vge,{className:n})}}const bge=l.lazy(()=>N(()=>import("./document-code-32-DP9DM_oy.js"),__vite__mapDeps([469,1]))),Ige=l.lazy(()=>N(()=>import("./document-csv-32-DxXguZ3z.js"),__vite__mapDeps([470,1]))),Ege=l.lazy(()=>N(()=>import("./document-dotx-32-DFAEJ-W6.js"),__vite__mapDeps([471,1]))),Tge=l.lazy(()=>N(()=>import("./document-excel-32-DkDhauqH.js"),__vite__mapDeps([472,1]))),wge=l.lazy(()=>N(()=>import("./document-generic-32-yyut672N.js"),__vite__mapDeps([473,1]))),Age=l.lazy(()=>N(()=>import("./document-html-32-gu-6QF85.js"),__vite__mapDeps([474,1]))),xge=l.lazy(()=>N(()=>import("./document-onenote-32-Cq_ga7y1.js"),__vite__mapDeps([475,1]))),_ge=l.lazy(()=>N(()=>import("./document-pdf-32-B1cYARBr.js"),__vite__mapDeps([476,1]))),kge=l.lazy(()=>N(()=>import("./document-photo-32-BJAw2m8C.js"),__vite__mapDeps([477,1]))),Pge=l.lazy(()=>N(()=>import("./document-potx-32-Cl3X85Gf.js"),__vite__mapDeps([478,1]))),Mge=l.lazy(()=>N(()=>import("./document-ppsx-32-8jZ9oal9.js"),__vite__mapDeps([479,1]))),Rge=l.lazy(()=>N(()=>import("./document-ppt-32-CMiLCw8X.js"),__vite__mapDeps([480,1]))),Nge=l.lazy(()=>N(()=>import("./document-project-32-Dz7c3bjL.js"),__vite__mapDeps([481,1]))),Lge=l.lazy(()=>N(()=>import("./document-rtf-32-Cl0Bfldz.js"),__vite__mapDeps([482,1]))),Dge=l.lazy(()=>N(()=>import("./document-toc-32-DdoxrI8u.js"),__vite__mapDeps([483,1]))),Oge=l.lazy(()=>N(()=>import("./document-txt-32-B6fpeHEp.js"),__vite__mapDeps([484,1]))),Uge=l.lazy(()=>N(()=>import("./document-word-32-BADTqaKC.js"),__vite__mapDeps([485,1]))),Fge=l.lazy(()=>N(()=>import("./document-xltx-32-smtzvNFL.js"),__vite__mapDeps([486,1]))),jge=l.lazy(()=>N(()=>import("./document-xml-32-CevQm9oF.js"),__vite__mapDeps([487,1])));function Bge(e){const{fileType:t,className:n}=e;switch(t){case"application/pdf":return c.jsx(_ge,{className:n});case"application/vnd.openxmlformats-officedocument.wordprocessingml.document":case"application/msword":case"application/vnd.ms-word.document.macroEnabled.12":case"application/vnd.google-apps.document":return c.jsx(Uge,{className:n});case"application/vnd.openxmlformats-officedocument.wordprocessingml.template":case"application/vnd.ms-word.template.macroEnabled.12":return c.jsx(Ege,{className:n});case"text/plain":return c.jsx(Oge,{className:n});case"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":case"application/vnd.ms-excel":case"application/vnd.ms-excel.sheet.binary.macroEnabled.12":case"application/vnd.ms-excel.sheet.macroEnabled.12":case"application/vnd.google-apps.spreadsheet":return c.jsx(Tge,{className:n});case"application/vnd.openxmlformats-officedocument.spreadsheetml.template":case"application/vnd.ms-excel.template.macroEnabled.12":return c.jsx(Fge,{className:n});case"text/csv":return c.jsx(Ige,{className:n});case"application/vnd.openxmlformats-officedocument.presentationml.presentation":case"application/vnd.ms-powerpoint":case"application/vnd.ms-powerpoint.presentation.macroEnabled.12":case"application/vnd.google-apps.presentation":return c.jsx(Rge,{className:n});case"application/vnd.openxmlformats-officedocument.presentationml.template":case"application/vnd.ms-powerpoint.template.macroEnabled.12":return c.jsx(Pge,{className:n});case"application/vnd.openxmlformats-officedocument.presentationml.slideshow":case"application/vnd.ms-powerpoint.slideshow.macroEnabled.12":return c.jsx(Mge,{className:n});case"application/json":case"text/markdown":case"image/svg+xml":case"application/xml":case"application/x-sql":case"text/javascript":case"text/css":return c.jsx(bge,{className:n});case"application/onenote":return c.jsx(xge,{className:n});case"application/rtf":return c.jsx(Lge,{className:n});case"application/msonenote":return c.jsx(Dge,{className:n});case"text/html":return c.jsx(Age,{className:n});case"text/xml":return c.jsx(jge,{className:n});case"application/vnd.ms-project":return c.jsx(Nge,{className:n});case"image/png":case"image/jpeg":return c.jsx(kge,{className:n});default:return c.jsx(wge,{className:n})}}function Vge(e){const{fileType:t,className:n}=e;return c.jsx(l.Suspense,{fallback:c.jsx("svg",{className:n}),children:c.jsx(Bge,{fileType:t,className:n})})}function Hge(e){switch(e){case"application/pdf":return"bg-system-red-350";case"application/vnd.openxmlformats-officedocument.wordprocessingml.document":case"application/msword":return"bg-midnight-300";case"text/plain":return"bg-spot-blue-300";case"application/json":case"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":case"application/vnd.ms-excel":case"application/vnd.openxmlformats-officedocument.presentationml.presentation":case"application/vnd.ms-powerpoint":case"text/csv":case"text/markdown":default:return"bg-neutral-300"}}function zge(e){const{t}=Z();switch(e){case"application/pdf":return t("fileUpload.fileTypeDisplayPdf");case"application/vnd.openxmlformats-officedocument.wordprocessingml.document":case"application/msword":return t("fileUpload.fileTypeDisplayDoc");case"text/plain":return t("fileUpload.fileTypeDisplayTxt");case"application/json":return t("fileUpload.fileTypeDisplayJson");case"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":case"application/vnd.ms-excel":return t("fileUpload.fileTypeDisplayXlsx");case"application/vnd.openxmlformats-officedocument.presentationml.presentation":case"application/vnd.ms-powerpoint":return t("fileUpload.fileTypeDisplayPptx");case"text/csv":return t("fileUpload.fileTypeDisplayCsv");case"text/markdown":return t("fileUpload.fileTypeDisplayMarkdown");default:return t("fileUpload.fileTypeDisplayDefault")}}const Dk="absolute end-0.5 top-0.5 m-1 border border-black/20 bg-acrylic-thin-fallback-light/60 fill-black text-foreground-900 dark:bg-midnight-800/80 forced-colors:[forced-color-adjust:none] forced-colors:focus-visible:shadow-[inset_0_0_0_2px_Canvas] forced-colors:focus-visible:outline forced-colors:focus-visible:outline-1 forced-colors:focus-visible:outline-[CanvasText]",Ok="forced-colors:focus-visible:shadow-[inset_0_0_0_2px_Canvas] forced-colors:focus-visible:outline forced-colors:focus-visible:outline-1 forced-colors:focus-visible:outline-[CanvasText]",Gge=l.lazy(()=>N(()=>Promise.resolve().then(()=>Cx),void 0));function Uk(e){const{onRemove:t,fileName:n,fileType:o,isUploading:s,role:a,ariaLabel:r,layout:i="grid",index:d,total:m}=e,{t:p}=Z(),h=Hge(o),g=zge(o),y=i==="list",b=l.useCallback(()=>{t?.(),oo({msg:p("fileUpload.fileRemoved")})},[t,p]),C=q("file-upload-card-v2"),T=!!J.instance().config().composer?.smallAttachmentCard||C,S=c.jsx(jt,{className:O("absolute inset-0 grid place-items-center ",{"bg-white/80 dark:bg-white/45":!y,"bg-transparent":y}),children:s?c.jsxs(c.Fragment,{children:[c.jsx(l.Suspense,{fallback:c.jsx("div",{"aria-hidden":!0}),children:c.jsx(Gge,{type:"spinnerThemed",className:y?"size-8":"size-11"})}),c.jsx(Ao,{msg:p("fileUpload.uploadingFile"),type:"polite"})]}):null});return c.jsxs(he.div,{className:Ae("relative flex justify-center gap-2 overflow-hidden rounded-xl",{"mt-1 h-small-attachment w-auto flex-row items-center pe-8":T,"h-32 w-44 flex-col":!T,"w-full bg-transparent !pe-0":y,"border border-black/8 bg-acrylic-thin-fallback-light/60 p-3 dark:border-white/8 dark:bg-midnight-800/80 sm:w-56":!y}),layout:"position",initial:je,animate:rt,exit:je,role:a,"aria-label":r,children:[C?c.jsx("div",{className:O("relative",{"h-8 w-8":T&&y}),children:y&&s?S:c.jsx(Vge,{fileType:o,className:"size-8"})}):c.jsx("div",{className:Ae("grid aspect-square size-8 place-items-center self-start rounded-full text-black",h),children:c.jsx(Sge,{fileType:o,className:"size-5"})}),c.jsxs("div",{className:Ae({"min-w-0 flex-1":T}),children:[c.jsx("p",{className:Ae("font-ligatures-none truncate text-sm",{"overflow-hidden whitespace-nowrap":T}),children:n}),c.jsx("p",{className:"line-clamp-1 text-foreground-600 text-xs",children:g})]}),t&&!s&&c.jsx("button",{type:"button",title:p("fileUpload.removeFileWithName",{name:n}),"aria-label":d!==void 0&&m!==void 0?p("fileUpload.removeFileWithPosition",{name:n,index:d,total:m}):p("fileUpload.removeFileWithName",{name:n}),onClick:b,className:O("rounded-full p-1",{[Dk]:!y,[Ok]:y}),children:c.jsx(on,{className:"size-3","aria-hidden":!0})}),y?null:S]})}const Wge=({title:e,titleId:t,...n})=>{const[o,s]=l.useState("");return l.useEffect(()=>{s(Math.random().toString(36).slice(2,10))},[]),l.createElement("svg",{viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M3.556 6.708C3.556 4.989 4.949 3.596 6.667 3.596H22.222C25.659 3.596 28.444 6.382 28.444 9.818V25.374C28.444 27.092 27.052 28.485 25.333 28.485H9.778C6.341 28.485 3.556 25.699 3.556 22.263V6.708Z",fill:`url(#${o}-paint0_linear_393_48941)`}),l.createElement("path",{d:"M4.444 6.708C4.444 5.480 5.439 4.485 6.667 4.485H22.222C25.168 4.485 27.556 6.873 27.556 9.818V25.374C27.556 26.602 26.561 27.596 25.333 27.596H9.778C6.832 27.596 4.444 25.208 4.444 22.263V6.708Z",fill:`url(#${o}-paint1_linear_393_48941)`}),l.createElement("path",{d:"M4.444 6.708C4.444 5.480 5.439 4.485 6.667 4.485H22.222C25.168 4.485 27.556 6.873 27.556 9.818V25.374C27.556 26.602 26.561 27.596 25.333 27.596H9.778C6.832 27.596 4.444 25.208 4.444 22.263V6.708Z",fill:`url(#${o}-paint2_radial_393_48941)`}),l.createElement("path",{d:"M14.900 15.109L9.514 20.497C8.534 21.477 9.228 23.152 10.614 23.152H21.389C22.774 23.152 23.468 21.477 22.488 20.497L17.100 15.109C16.493 14.502 15.507 14.502 14.900 15.109Z",fill:`url(#${o}-paint3_linear_393_48941)`}),l.createElement("circle",{cx:20.889,cy:11.152,r:2.222,fill:`url(#${o}-paint4_linear_393_48941)`}),l.createElement("defs",null,l.createElement("linearGradient",{id:o+"-paint0_linear_393_48941",x1:11.593,y1:3.596,x2:14.944,y2:28.729,gradientUnits:"userSpaceOnUse"},l.createElement("stop",{stopColor:"#BBBBBB"}),l.createElement("stop",{offset:1,stopColor:"#888888"})),l.createElement("linearGradient",{id:o+"-paint1_linear_393_48941",x1:10.864,y1:4.485,x2:13.787,y2:27.873,gradientUnits:"userSpaceOnUse"},l.createElement("stop",{stopColor:"white"}),l.createElement("stop",{offset:1,stopColor:"#EBEBEB"})),l.createElement("radialGradient",{id:o+"-paint2_radial_393_48941",cx:0,cy:0,r:1,gradientTransform:"matrix(12.198 18.296 -18.296 6.861 11.827 10.504)",gradientUnits:"userSpaceOnUse"},l.createElement("stop",{offset:.177083,stopColor:"white"}),l.createElement("stop",{offset:1,stopColor:"#EFEFEF"})),l.createElement("linearGradient",{id:o+"-paint3_linear_393_48941",x1:8.935,y1:11.488,x2:15.591,y2:29.836,gradientUnits:"userSpaceOnUse"},l.createElement("stop",{offset:1e-4,stopColor:"#597493"}),l.createElement("stop",{offset:1,stopColor:"#0F2F56"})),l.createElement("linearGradient",{id:o+"-paint4_linear_393_48941",x1:18.667,y1:6.152,x2:23.495,y2:15.396,gradientUnits:"userSpaceOnUse"},l.createElement("stop",{offset:1e-4,stopColor:"#597493"}),l.createElement("stop",{offset:1,stopColor:"#0F2F56"}))))},$ge=[{canHandle:e=>e.startsWith("https://"),getImageSrc:e=>e,shouldReleaseOnLoad:!1},{canHandle:pA,getImageSrc:e=>ose(e),shouldReleaseOnLoad:!0},{canHandle:e=>e.startsWith("blob:"),getImageSrc:e=>e,shouldReleaseOnLoad:!1}];function qge(e){return $ge.find(t=>t.canHandle(e))??null}function Fk(e){const{uploadedFile:t,url:n}=e,[o,s]=l.useState({src:null,releaseOnLoad:!1});return l.useEffect(()=>{if(t&&(t.size>0||!n)){const r=URL.createObjectURL(t);return s({src:r,releaseOnLoad:!0}),()=>{URL.revokeObjectURL(r)}}if(n){const r=qge(n);if(!r){s({src:null,releaseOnLoad:!1});return}let i=!1;return(async()=>{const m=await r.getImageSrc(n);if(!i){if(m===null){s({src:null,releaseOnLoad:!1});return}s({src:m,releaseOnLoad:r.shouldReleaseOnLoad})}})(),()=>{i=!0}}s({src:null,releaseOnLoad:!1})},[t,n]),o}function Kge(e){const{uploadedFile:t,url:n,onRemove:o,scenario:s,isUploading:a,role:r,ariaLabel:i,layout:d="grid",index:m,total:p}=e,{t:h}=Z(),{src:g,releaseOnLoad:y}=Fk({uploadedFile:t,url:n}),[b,C]=l.useState(!1),[T,S]=l.useState(!1);l.useEffect(()=>{C(!1),S(!1)},[g]);const E=s==="screenshot"?h("composer.screenshotAdded"):void 0,I=d==="list",x=K=>{C(!0),S(!1),y&&kf(K)},w=K=>{C(!0),S(!0),y&&kf(K)},P=l.useCallback(()=>{o?.(),oo({msg:h("fileUpload.imageRemoved")})},[o,h]),D=q("file-upload-card-v2"),L=t.name,j=!!J.instance().config().composer?.smallAttachmentCard||D,U=a?c.jsxs(jt,{className:O("absolute inset-0 grid place-items-center ",{"bg-transparent":I,"bg-white/80 dark:bg-white/45":!I}),children:[c.jsx(l.Suspense,{fallback:c.jsx("div",{"aria-hidden":!0}),children:c.jsx(xt,{type:"spinnerThemed",className:I?"size-8":"size-11"})}),c.jsx(Ao,{msg:h("fileUpload.uploadingImage"),type:"polite"})]}):null,$={"h-small-attachment w-full object-cover":j&&!I,"h-8 w-8 object-cover":j&&I,"h-32":!j};return c.jsxs(he.div,{className:Ae("relative flex max-w-fit shrink-0",{"mt-1 min-w-[58px]":j,"min-h-32":!j,"flex h-small-attachment w-full max-w-full items-center gap-2":I}),layout:"position",initial:je,animate:b||I?rt:je,exit:je,transition:{delay:MA},role:r,"aria-label":i,children:[c.jsxs("div",{className:O("relative",{"h-8 w-8":j&&I,"flex w-full justify-center rounded-xl border border-black/8 bg-acrylic-thin-fallback-light/60 dark:border-white/8 dark:bg-midnight-800/80":!I}),children:[I&&a&&U,(!I||!a)&&(T||!g)&&c.jsx(Wge,{className:Ae("w-auto rounded-xl border border-black/8 object-contain shadow-inner dark:border-white/8",$),role:"presentation","aria-hidden":!0}),(!I||!a)&&!T&&g&&c.jsx(he.img,{className:Ae("size-auto rounded-xl border-none object-contain shadow-inner",$),src:g,role:"presentation",onLoad:x,onError:w,alt:"",draggable:!1})]}),I?c.jsxs("div",{className:"min-w-0 flex-1",children:[c.jsx("p",{className:O("font-ligatures-none overflow-hidden truncate whitespace-nowrap text-sm"),children:t.name||h("library.itemTypes.image")}),c.jsx("p",{className:"line-clamp-1 uppercase text-foreground-600 text-xs",children:L.split(".").pop()})]}):null,E&&c.jsx(Ao,{msg:E}),o&&!a&&c.jsx(he.button,{type:"button",title:h("fileUpload.removeImageWithName",{name:L}),"aria-label":m!==void 0&&p!==void 0?h("fileUpload.removeImageWithPosition",{name:L,index:m,total:p}):h("fileUpload.removeImageWithName",{name:L}),onClick:P,className:O("rounded-full p-1",{[Dk]:!I,[Ok]:I}),children:c.jsx(on,{className:"size-3","aria-hidden":!0})}),I?null:U]})}const _0=l.memo(e=>{const{attachment:t,onRemove:n,role:o,ariaLabel:s,layout:a="grid",index:r,total:i}=e,{file:d,processing:m,error:p,scenario:h}=t;if(p||!d)return null;const g=xo(d);if(Wc(g))return c.jsx(Uk,{onRemove:n,fileName:d.name,fileType:g,isUploading:m,role:o,ariaLabel:s,layout:a,index:r,total:i});const y=t.attachment?.item.type==="image"?t.attachment.item.url:void 0;return c.jsx(Kge,{uploadedFile:d,onRemove:n,scenario:h,isUploading:m,role:o,ariaLabel:s,layout:a,url:y,index:r,total:i})});_0.displayName="AttachmentItem";function Yge(e){const t=l.useRef(null);l.useEffect(()=>{t.current=document.activeElement;const n=e?.current;return()=>{n?n.focus():t.current&&t.current.focus()}},[e])}function Zge(e){const{fileName:t,fileType:n,role:o,layout:s="grid"}=e,a=n!==""?n:x1(t);return Wc(a)?c.jsx(Uk,{fileName:t,fileType:a,role:o,layout:s}):null}function Jge({url:e,layout:t="grid",fileName:n}){const{t:o}=Z(),{src:s,releaseOnLoad:a}=Fk({url:e}),r=t==="list";return s?c.jsx("img",{className:O("block h-full overflow-hidden bg-background-static-250 object-cover object-center shadow-inner dark:bg-background-static-900",{"w-full rounded-xl":r,"rounded-2xl":!r}),alt:n??o("chat.uploadedImageAltText"),src:s,onLoad:a?kf:void 0}):null}function x2(e){const{messageItem:t,imageClassName:n,role:o,layout:s="grid",size:a="md"}=e,{t:r}=Z(),i=s==="list";return t.type==="document"?c.jsx(Zge,{fileType:t.contentType,fileName:t.fileName,role:o,layout:s}):t.type==="image"?c.jsxs("div",{className:O("inline-block h-full max-w-[min(80%,256px)]",n,{"mt-1 h-small-attachment":a==="sm","flex w-full max-w-full items-center gap-2":i,"align-top":!i}),role:o,children:[c.jsx("div",{className:O("h-full w-fit min-w-0",{"h-8 w-8":i&&a==="sm"}),children:c.jsx(Jge,{fileName:t.fileName,url:t.localUrl??t.url,layout:s})}),i&&c.jsxs("div",{className:"min-w-0 flex-1",children:[c.jsx("p",{className:O("font-ligatures-none overflow-hidden truncate whitespace-nowrap text-sm"),children:t.fileName??r("library.itemTypes.image")}),c.jsx("p",{className:"line-clamp-1 uppercase text-foreground-600 text-xs",children:(t.url||"").split(".").pop()})]})]}):null}function jk(e){const{messageItem:t,onClick:n}=e,{t:o}=Z(),s=l.useCallback(()=>{n&&n(t)},[n,t]);return n?c.jsx("button",{type:"button",onClick:s,className:"contents text-start","aria-label":o("common.view"),children:c.jsx(x2,{...e})}):c.jsx(x2,{...e})}function Bk(e){const{onRemove:t,onClose:n,messages:o=[],attachments:s=[],restoreFocusRef:a}=e;Yge(a);const r=q("file-upload-card-v2"),{t:i}=Z(),{openMediaViewer:d}=Ro(),m=J.instance().config().composer?.smallAttachmentCard||r?"sm":"md",p=o.filter(g=>g.type==="image"),h=l.useCallback(g=>{const y=p.findIndex(b=>b===g);d({currentMediaIndex:y,media:p.map(b=>({type:"image",url:b.localUrl??b.url,altText:b.fileName??i("chat.uploadedImageAltText"),downloadable:!0})),source:"attachmentModal"}),n?.()},[p,d,n,i]);return s.length===0&&o.length===0?null:c.jsxs(_s,{isOpen:!0,fullBleed:!0,className:O("max-h-[580px] min-h-[480px] w-full justify-between p-6",{"sm:w-[640px]":!r,"sm:w-[500px]":r}),onClose:n,dialogName:i("userInput.filePreviewModalTitle"),children:[c.jsx("h2",{className:"w-full shrink-0 text-center leading-8 text-2xl",children:i("userInput.filePreviewModalTitle")}),c.jsx("div",{className:"max-h-[450px] min-h-0 flex-1 overflow-y-auto p-4",children:c.jsx("div",{role:"list",className:O("flex  gap-y-1",{"flex-wrap content-start gap-x-2":!r,"flex-col":r}),children:s.length>0?s.map((g,y)=>c.jsx(_0,{layout:r?"list":"grid",attachment:g,onRemove:()=>t?.(y),role:"listitem",ariaLabel:i("fileUpload.ariaLabel.listitem",{index:y+1,total:s.length}),index:y+1,total:s.length},`attachment-${y}`)):o.map((g,y)=>c.jsx(jk,{layout:r?"list":"grid",messageItem:g,imageClassName:"h-32",role:"listitem",size:m,onClick:g.type==="image"?h:void 0},`message-${y}`))})}),c.jsx(ee,{color:r?"subtle-dimmed-inverted":"strong",className:"w-full shrink-0",title:i("common.dismiss"),onClick:n,children:i("common.dismiss")})]})}function Qge(e){const{attachments:t,onRemove:n,onVisibilityChange:o}=e,{t:s}=Z(),a=l.useRef(null),r=l.useMemo(()=>t.filter(E=>!E.error),[t]),i=l.useMemo(()=>r.slice(0,ru),[r]),d=l.useMemo(()=>r.slice(ru),[r]),m=d.filter(E=>E.processing).length,[p,h]=l.useState(!1),g=l.useCallback(E=>{t[E]?.file&&(n(E),r.length<=1&&(h(!1),o?.(!1)))},[t,n,r,o]),y=l.useCallback(()=>{oo({msg:s("userInput.seeAll"),type:"polite"}),h(!0),o?.(!0)},[h,s,o]),b=l.useCallback(()=>{h(!1),o?.(!1)},[h,o]),C=m>0?s("userInput.uploadingProcess",{uploadingCount:m,totalCount:d.length}):s("userInput.seeAll"),T=q("file-upload-card-v2"),S=!!J.instance().config().composer?.smallAttachmentCard||T;return c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"relative flex max-h-64 min-w-0 max-w-full flex-wrap gap-2 overflow-y-auto overflow-x-hidden p-1",children:[i.map((E,I)=>c.jsx(_0,{attachment:E,onRemove:()=>g(t.indexOf(E)),ariaLabel:s("fileUpload.ariaLabel.listitem",{index:I+1,total:r.length}),index:I+1,total:r.length},E.id??`file-${I}`)),d.length>0&&c.jsx(ee,{ref:a,"aria-label":C,title:C,color:"overlay-dimmed-inverted",onClick:y,className:O("flex cursor-pointer items-center justify-center rounded-xl border-none px-3.5 py-1 text-sm",{"mt-1 h-small-attachment":S,"h-32":!S}),children:m>0?c.jsxs(c.Fragment,{children:[c.jsx(xt,{className:"size-6"}),s("userInput.uploadingProcess",{uploadingCount:m,totalCount:d.length})]}):c.jsx(c.Fragment,{children:s("userInput.seeAll")})})]}),p&&c.jsx(Bk,{onClose:b,attachments:t,onRemove:g,restoreFocusRef:a})]})}function Xge(e){const{item:t,onClick:n,focusRef:o}=e,s=M(Te),a=l.useRef(void 0);return l.useEffect(()=>{s&&a.current!==s&&t.onImpression&&(a.current=s,t.onImpression(s))},[s,t]),c.jsxs(ee,{title:t.title,"aria-label":t.ariaLabel??`${t.title}. ${t.description}`,variant:"rect",color:"subtle-dimmed-inverted",onClick:n,size:"40-base",alignment:"start",className:"min-w-[230px] gap-3 px-3 py-2",testId:t.testId,role:"menuitem",ref:o,children:[c.jsx("div",{children:t.icon}),c.jsxs("div",{className:"grow text-left",children:[c.jsxs("div",{className:"line-clamp-1 inline-flex gap-1.5 text-sm",children:[t.title,t.tags?.map(r=>c.jsx("div",{className:"flex items-center",children:c.jsx(I3,{color:r.color,children:c.jsx("span",{className:"leading-4",children:r.label})},r.label)},r.label))]}),t.description&&c.jsx("p",{className:"line-clamp-1 leading-4 text-foreground-600 text-xs dark:text-foreground-650",children:t.description})]})]},t.key)}const Vk="/static/cmc/assets/dismiss-strong-C4wQ_QdN.svg";function e1e(e){const{portalContainerRef:t,selector:n,children:o}=e,s=l.useRef(null),[a,r]=l.useState(!1);l.useEffect(()=>{n&&(s.current=document.querySelector(n)??document.body),r(!0)},[n]);const i=t?.current??s.current;return a&&i?ch.createPortal(o,i):null}function t1e(e){const{renderTrigger:t,renderSurface:n,containerClassNames:o,color:s="default",onOutsideEvent:a,placement:r="bottom",floatingOffset:i=10,portalContainerRef:d,role:m="dialog",constrainToViewport:p=!1}=e,h=Y9(),[g,y]=l.useState(!1),b=l.useRef(null),C=l.useRef(null),T=l.useCallback(w=>{w.stopPropagation(),w.preventDefault(),y(P=>!P)},[]),S=l.useCallback(()=>{y(!1),a?.()},[a]),{refs:E,floatingStyles:I,context:x}=ac({nodeId:h,placement:r,strategy:"fixed",middleware:[nc(i),oc(),sc(),...p?[lh({padding:10,apply({availableHeight:w,elements:P}){Object.assign(P.floating.style,{maxHeight:`${w}px`})}})]:[]],whileElementsMounted:kr,open:g,onOpenChange:(w,P,D)=>{w?y(!0):D!=="ancestor-scroll"&&S()}});return rc(x,{outsidePressEvent:"pointerdown",ancestorScroll:!0,outsidePress:w=>{if(w.target instanceof Element){const P=w.target;if(P instanceof Element&&P.closest("[data-outside-events-ignore]")!==null)return!1}return!0}}),Ga(w=>{w.key==="Escape"&&g&&S()}),c.jsxs("div",{ref:E.setReference,className:O("relative",o?.trigger),children:[t({openPopover:T,isOpen:g,ref:b}),c.jsx(Z9,{id:h,children:c.jsx(e1e,{...d?{portalContainerRef:d}:{selector:"#popoverPortal"},children:c.jsx(It,{children:g&&c.jsx(dh,{context:x,modal:m==="dialog",returnFocus:!0,initialFocus:C,children:c.jsx(he.div,{ref:E.setFloating,className:O("rounded-2xl p-3 shadow-lg",p&&"flex flex-col",s==="thin"?oa:lo,o?.surface,at.modal),style:{...I,...MI},role:m,tabIndex:-1,initial:"initial",animate:"animate",exit:"exit",variants:{initial:je,animate:rt,exit:{...je,transition:{duration:Wn.default}}},transition:{duration:Wn.default,ease:"easeInOut"},onKeyDown:w=>{w.key==="Escape"&&(w.preventDefault(),w.stopPropagation(),S())},children:c.jsx("div",{className:O("pointer-events-auto relative",p&&"t-custom-scrollbar -m-1 min-h-0 flex-1 overflow-auto p-1",!p&&"max-h-expanded-section overflow-visible",at.modal),children:n({closePopover:S,isOpen:g,focusRef:C})})})})})})})]})}function nm(e){const{renderTrigger:t,renderSurface:n,containerClassNames:o,color:s,onOutsideEvent:a,placement:r,floatingOffset:i,portalContainerRef:d,role:m,constrainToViewport:p}=e,h=q9(),g=c.jsx(t1e,{renderTrigger:t,renderSurface:n,containerClassNames:o,color:s,onOutsideEvent:a,placement:r,floatingOffset:i,portalContainerRef:d,role:m,constrainToViewport:p});return h===null?c.jsx(K9,{children:g}):g}const n1e="composer-dropdown-button-menu-contents";function k0(e){const{items:t,value:n,defaultValue:o,onSelect:s,onReset:a,onMenuClick:r,disabled:i,showDefaultItemInDropdown:d=!1,renderHeader:m,renderFooter:p,alwaysShowDefault:h=!1,floatingOffset:g=4}=e,y=M(Te),b=l.useRef(void 0),{selectedItem:C,dropdownItems:T,selectedNonDefault:S}=l.useMemo(()=>({selectedItem:t.find(E=>E.key===(h?o:n)),dropdownItems:d?t:t.filter(E=>E.key!==o),selectedNonDefault:n!==o&&!h}),[t,n,o,d,h]);return l.useEffect(()=>{y&&b.current!==y&&C&&C.onImpression&&(b.current=y,C.onImpression(y))},[y,C]),c.jsx(nm,{color:"default",role:"menu",renderTrigger:({openPopover:E})=>C&&c.jsxs(ee,{id:C.id,title:C.title,"aria-label":C.title,variant:"rect",size:"36-sm",disabled:i,color:S?"composer-selected":"subtle-dimmed",className:O("h-9 select-none gap-1 rounded-2xl border border-black/8 dark:border-white/8",C.isIconEnabledInButton?"pe-3 ps-2":"pe-3.5 ps-2.5",C.isChevronEnabledInButton&&"pe-2.5",C.hideButtonTitle&&"p-0"),onClick:I=>{r?.(),C.beforeClick?.(y??""),S?a():E(I)},testId:C.testId,children:[S?c.jsx(St,{url:Vk,className:"size-3.5"}):C.isIconEnabledInButton&&C.icon,!C.hideButtonTitle&&c.jsx("span",{className:"text-sm",children:C.buttonTitle??C.title}),!S&&C.isChevronEnabledInButton&&c.jsx(po,{className:"size-4 rotate-90"})]}),renderSurface:({closePopover:E,focusRef:I})=>{const x=m&&m({closePopover:E,focusRef:I});return c.jsxs(fo,{id:n1e,className:"flex flex-col","data-testid":"composer-dropdown-button-menu-contents",children:[x,T.map((w,P)=>c.jsx(Xge,{item:w,onClick:D=>{w.beforeClick?.(y??""),s(w.key),E(D)},focusRef:!x&&P===0?I:void 0},w.key)),p&&p({closePopover:E})]})},containerClassNames:{surface:"p-1.5 border-white/25 dark:border-stroke-400/25 shadow-tinted-xl"},placement:"bottom-start",floatingOffset:g,constrainToViewport:!0})}k0.displayName="ComposerDropdownButton";const o1e="/static/cmc/assets/analyst-D8sXpiav.svg",s1e="/static/cmc/assets/coco-BiXU4q_c.svg",a1e="/static/cmc/assets/quick-DbAdyS8q.svg",r1e="/static/cmc/assets/study-BpnC_q84.svg",i1e="/static/cmc/assets/think-wWCa40yF.svg",c1e="/static/cmc/assets/cursor-click-9t1_mFob.svg",l1e="/static/cmc/assets/search-BjOz_Dmt.svg";function u1e(){const e=M(bd),t=W("kill-composer-reasoning-button");return!e&&t}const d1e=_(null);function P0(){const e=!it("kill-coco-isolation"),[t,n]=Le(d1e),o=Kr(),a=(M(Rt)?.history.length??0)>0,r=e&&a,i=t!==null,d=(h,g)=>{n({targetMode:h,onModalConfirm:g})},m=()=>{n(null)};return{isOpen:i,hasConversationHistory:a,shouldAskForConfirmation:r,onConfirm:async()=>{t&&(await o(),t.onModalConfirm(),m())},onOpen:d,onClose:m,targetMode:t?.targetMode??null}}const m1e=new Set(yg);function p1e(){return m1e}const f1e=["smart-mode-default","remove-qr"];function h1e(){return Pc(f1e,"any")}const g1e=[new Set(["analyst","chat","smart","smart-latest","study","reasoning","research","computerUse","search","browserAction"]),new Set(["coco"])];function eh(e,t){let n=null;for(const o of g1e)o.has(e)&&(n=o);return n?n.has(t):!1}function v1e(e){const{disabled:t=!1}=e,n=y1e(),o=Zt(),s=Ra(),{onOpen:a,shouldAskForConfirmation:r}=P0(),i=l.useCallback(g=>{hn(g),Rf()},[]),d=l.useCallback(g=>{if(r&&!eh(o,g)){a(g,()=>{i(g)});return}i(g)},[i,r,o,a]),m=l.useCallback(()=>{hn(Ft()),Rf()},[]),p=l.useCallback(()=>{const g=Ft();if(r&&!eh(o,g)){a(g,()=>{m()});return}m()},[m,r,o,a]),h=GA().includes(o)?o:Ft();return s?c.jsx(k0,{items:n,onSelect:d,value:h,defaultValue:Ft(),showDefaultItemInDropdown:!0,onReset:p,disabled:t,onMenuClick:()=>de({source:"composerChatModeDropdownButton",pageName:"chatPage",customData:JSON.stringify({currentMode:o})})}):null}function qs(e){return()=>Lt({element:"composerModeButton",scenario:e,page:"chatPage"})}function Ks(e){return t=>de({source:"composerModeButton",scenario:e,conversationId:t})}function Ys(e){return t=>de({source:"composerDrawerTypeSheet",scenario:e,conversationId:t})}function y1e(){const{t:e}=Z("translation"),n=Vt().startsWith("/projects"),o=h1e(),s=q("remove-qr"),a=Kx()&&!n,r=q("smart-mode-52"),d=q("smart-mode-52-dropdown")&&!r,m=qx(),p=u$(),h=u1e(),g=p1e(),y=Ef("smart"),b={key:"smart",title:y.title,icon:c.jsx(St,{url:y.icon,className:"size-5"}),description:y.description,testId:"composer-chat-mode-smart-button",isChevronEnabledInButton:!0,onImpression:qs("smart"),beforeSelect:Ys("smart"),beforeClick:Ks("exitSmart"),tags:y.tags},C=Ef("smart-latest"),T={key:"smart-latest",title:C.title,icon:c.jsx(St,{url:C.icon,className:"size-5"}),description:C.description,testId:"composer-chat-mode-smart-latest-button",isChevronEnabledInButton:!0,onImpression:qs("smartLatest"),beforeSelect:Ys("smartLatest"),beforeClick:Ks("exitSmartLatest"),tags:C.tags},S={key:"browserAction",title:e("composer.chatModes.browserAction.title"),icon:c.jsx(St,{url:c1e,className:"size-5"}),description:e("composer.chatModes.browserAction.description"),testId:"composer-chat-mode-browser-action-button"},E={key:"chat",title:e("composer.chatModes.chat.title"),buttonTitle:e("composer.chatModes.chat.title"),icon:c.jsx(St,{url:a1e,className:"size-5"}),description:e("composer.chatModes.chat.description"),testId:"composer-chat-mode-quick-button",onImpression:qs("quick"),beforeSelect:Ys("quickResponse"),beforeClick:Ks("showDrawer"),isChevronEnabledInButton:!0,isIconEnabledInButton:!1},I={key:"coco",title:e("composer.chatModes.coco.title"),icon:c.jsx(St,{url:s1e,className:"size-5"}),description:e("composer.chatModes.coco.description"),testId:"composer-chat-mode-coco-button",onImpression:qs("coco"),beforeSelect:Ys("coco"),beforeClick:Ks("exitCoco")},x={key:"reasoning",title:e("composer.chatModes.reasoning.title"),icon:c.jsx(St,{url:i1e,className:"size-5"}),description:e("composer.chatModes.reasoning.description"),testId:"composer-chat-mode-reasoning-button",onImpression:qs("thinkDeeper"),beforeSelect:Ys("thinkDeeper"),beforeClick:Ks("exitThinkDeeper")},w={key:"study",title:e("composer.chatModes.study.title"),icon:c.jsx(St,{url:r1e,className:"size-5"}),description:e("composer.chatModes.study.description"),testId:"composer-chat-mode-study-button",onImpression:qs("study"),beforeSelect:Ys("study"),beforeClick:Ks("exitStudy")},P={key:"search",title:e("composer.chatModes.search.title"),icon:c.jsx(St,{url:l1e,className:"size-5"}),description:e("composer.chatModes.search.description"),testId:"composer-chat-mode-search-button",onImpression:qs("search"),beforeSelect:Ys("search"),beforeClick:Ks("exitSearch")},D={key:"analyst",title:"Analyst",icon:c.jsx(St,{url:o1e,className:"size-5"}),description:"Analyze your data and generate insights",testId:"composer-chat-mode-analyst-button",onImpression:()=>{},beforeSelect:()=>{},beforeClick:()=>{},isChevronEnabledInButton:!0,isIconEnabledInButton:!1},L=[];return o||s?(L.push(b),d&&L.push(T),m&&L.push(S),s||L.push(E),a&&L.push(I),h||L.push(x),L.push(w),L.push(P),p&&L.push(D)):(L.push(E),m&&L.push(S),a&&L.push(I),h||L.push(x),L.push(w),L.push(b),d&&L.push(T),L.push(P),p&&L.push(D)),L.filter(j=>g.has(j.key))}const C1e="/static/cmc/assets/tab-add-6wnFKKVV.svg";function S1e(e){const{onSelectUserOpenedTabs:t}=e,{t:n}=Z();return c.jsx(ee,{title:n("composer.multiTabs.addTab"),"aria-label":n("composer.multiTabs.addTab"),variant:"rect",color:"subtle-dimmed-inverted",onClick:t,size:"40-base",alignment:"start",className:"min-w-[230px] rounded-xl p-0",testId:"add-tabs-button",children:c.jsxs("div",{className:"flex h-10 w-full items-center gap-3 rounded-xl px-3 py-2",children:[c.jsx(St,{url:C1e,className:"size-5"}),c.jsx("div",{className:"grow text-left",children:c.jsx("div",{className:"line-clamp-1 inline-flex gap-1.5 text-sm",children:n("composer.multiTabs.addTab")})})]})})}const Hk=({title:e,titleId:t,...n})=>{const[o,s]=l.useState("");return l.useEffect(()=>{s(Math.random().toString(36).slice(2,10))},[]),l.createElement("svg",{viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M9.29079 9.1001C4.70421 9.1002 1.2758 12.8547 1.0177 17.0373C1.17748 17.9385 1.70262 19.7181 2.52502 19.6268C3.553 19.5125 6.14201 19.6268 8.35029 15.6289C9.96344 12.7085 13.2818 9.10001 9.29079 9.1001Z",fill:`url(#${o}-paint0_radial_105551_302)`}),l.createElement("path",{d:"M8.23018 10.6611C6.68846 13.1022 4.61317 16.5999 3.91275 17.7006C3.08017 19.0089 0.875229 18.4531 1.05789 16.5777C1.03989 16.73 1.02606 16.8835 1.01652 17.038C0.714885 21.9171 4.58327 25.9691 9.39699 25.9691C14.7024 25.9691 27.3553 19.3586 26.0748 12.7352C24.7252 8.84183 20.9318 6.04932 16.6328 6.04932C12.3338 6.04932 9.57858 8.52613 8.23018 10.6611Z",fill:`url(#${o}-paint1_radial_105551_302)`}),l.createElement("path",{d:"M8.23018 10.6611C6.68846 13.1022 4.61317 16.5999 3.91275 17.7006C3.08017 19.0089 0.875229 18.4531 1.05789 16.5777C1.03989 16.73 1.02606 16.8835 1.01652 17.038C0.714885 21.9171 4.58327 25.9691 9.39699 25.9691C14.7024 25.9691 27.3553 19.3586 26.0748 12.7352C24.7252 8.84183 20.9318 6.04932 16.6328 6.04932C12.3338 6.04932 9.57858 8.52613 8.23018 10.6611Z",fill:`url(#${o}-paint2_radial_105551_302)`,fillOpacity:.4}),l.createElement("path",{d:"M8.23018 10.6611C6.68846 13.1022 4.61317 16.5999 3.91275 17.7006C3.08017 19.0089 0.875229 18.4531 1.05789 16.5777C1.03989 16.73 1.02606 16.8835 1.01652 17.038C0.714885 21.9171 4.58327 25.9691 9.39699 25.9691C14.7024 25.9691 27.3553 19.3586 26.0748 12.7352C24.7252 8.84183 20.9318 6.04932 16.6328 6.04932C12.3338 6.04932 9.57858 8.52613 8.23018 10.6611Z",fill:`url(#${o}-paint3_radial_105551_302)`}),l.createElement("path",{d:"M8.23018 10.6611C6.68846 13.1022 4.61317 16.5999 3.91275 17.7006C3.08017 19.0089 0.875229 18.4531 1.05789 16.5777C1.03989 16.73 1.02606 16.8835 1.01652 17.038C0.714885 21.9171 4.58327 25.9691 9.39699 25.9691C14.7024 25.9691 27.3553 19.3586 26.0748 12.7352C24.7252 8.84183 20.9318 6.04932 16.6328 6.04932C12.3338 6.04932 9.57858 8.52613 8.23018 10.6611Z",fill:`url(#${o}-paint4_radial_105551_302)`,fillOpacity:.6}),l.createElement("path",{d:"M8.23018 10.6611C6.68846 13.1022 4.61317 16.5999 3.91275 17.7006C3.08017 19.0089 0.875229 18.4531 1.05789 16.5777C1.03989 16.73 1.02606 16.8835 1.01652 17.038C0.714885 21.9171 4.58327 25.9691 9.39699 25.9691C14.7024 25.9691 27.3553 19.3586 26.0748 12.7352C24.7252 8.84183 20.9318 6.04932 16.6328 6.04932C12.3338 6.04932 9.57858 8.52613 8.23018 10.6611Z",fill:`url(#${o}-paint5_radial_105551_302)`,fillOpacity:.9}),l.createElement("path",{d:"M9.31824 25.9703C9.31824 25.9703 21.986 25.9952 24.1347 25.9952C28.0342 25.9952 30.999 22.8115 30.9991 19.0966C30.9991 15.3817 27.9747 12.2173 24.1348 12.2173C20.2949 12.2173 18.0836 15.0901 16.4227 18.2259C14.4764 21.9005 11.9937 25.9262 9.31824 25.9703Z",fill:`url(#${o}-paint6_linear_105551_302)`}),l.createElement("path",{d:"M9.31824 25.9703C9.31824 25.9703 21.986 25.9952 24.1347 25.9952C28.0342 25.9952 30.999 22.8115 30.9991 19.0966C30.9991 15.3817 27.9747 12.2173 24.1348 12.2173C20.2949 12.2173 18.0836 15.0901 16.4227 18.2259C14.4764 21.9005 11.9937 25.9262 9.31824 25.9703Z",fill:`url(#${o}-paint7_radial_105551_302)`,fillOpacity:.4}),l.createElement("path",{d:"M9.31824 25.9703C9.31824 25.9703 21.986 25.9952 24.1347 25.9952C28.0342 25.9952 30.999 22.8115 30.9991 19.0966C30.9991 15.3817 27.9747 12.2173 24.1348 12.2173C20.2949 12.2173 18.0836 15.0901 16.4227 18.2259C14.4764 21.9005 11.9937 25.9262 9.31824 25.9703Z",fill:`url(#${o}-paint8_radial_105551_302)`,fillOpacity:.9}),l.createElement("defs",null,l.createElement("radialGradient",{id:o+"-paint0_radial_105551_302",cx:0,cy:0,r:1,gradientTransform:"matrix(6.05863 7.25975 -10.1194 12.3526 1.58653 10.1963)",gradientUnits:"userSpaceOnUse"},l.createElement("stop",{stopColor:"#4894FE"}),l.createElement("stop",{offset:.695072,stopColor:"#0934B3"})),l.createElement("radialGradient",{id:o+"-paint1_radial_105551_302",cx:0,cy:0,r:1,gradientTransform:"matrix(-26.6342 30.7229 -23.4745 -18.9187 26.9705 -0.690804)",gradientUnits:"userSpaceOnUse"},l.createElement("stop",{offset:.165327,stopColor:"#23C0FE"}),l.createElement("stop",{offset:.534,stopColor:"#1C91FF"})),l.createElement("radialGradient",{id:o+"-paint2_radial_105551_302",cx:0,cy:0,r:1,gradientTransform:"matrix(-6.33129 -5.31528 -11.8431 14.7663 7.72211 10.7344)",gradientUnits:"userSpaceOnUse"},l.createElement("stop",{stopColor:"white"}),l.createElement("stop",{offset:.660528,stopColor:"#ADC0FF",stopOpacity:0})),l.createElement("radialGradient",{id:o+"-paint3_radial_105551_302",cx:0,cy:0,r:1,gradientTransform:"matrix(-7.11293 -6.01877 9.14061 -10.8028 16.711 20.5051)",gradientUnits:"userSpaceOnUse"},l.createElement("stop",{stopColor:"#033ACC"}),l.createElement("stop",{offset:1,stopColor:"#368EFF",stopOpacity:0})),l.createElement("radialGradient",{id:o+"-paint4_radial_105551_302",cx:0,cy:0,r:1,gradientTransform:"matrix(8.12906 18.7598 -20.2526 8.77435 7.17496 5.4191)",gradientUnits:"userSpaceOnUse"},l.createElement("stop",{offset:.592618,stopColor:"#3464E3",stopOpacity:0}),l.createElement("stop",{offset:1,stopColor:"#033ACC"})),l.createElement("radialGradient",{id:o+"-paint5_radial_105551_302",cx:0,cy:0,r:1,gradientTransform:"matrix(-21.2655 21.266 33.3159 33.3166 26.6427 1.43264)",gradientUnits:"userSpaceOnUse"},l.createElement("stop",{stopColor:"#4BFDE8"}),l.createElement("stop",{offset:.543937,stopColor:"#4BFDE8",stopOpacity:0})),l.createElement("linearGradient",{id:o+"-paint6_linear_105551_302",x1:20.1654,y1:25.9812,x2:20.1654,y2:12.3807,gradientUnits:"userSpaceOnUse"},l.createElement("stop",{stopColor:"#0086FF"}),l.createElement("stop",{offset:.49,stopColor:"#00BBFF"})),l.createElement("radialGradient",{id:o+"-paint7_radial_105551_302",cx:0,cy:0,r:1,gradientTransform:"matrix(12.6678 5.02394 -16.0514 21.3963 13.0585 13.8376)",gradientUnits:"userSpaceOnUse"},l.createElement("stop",{stopColor:"white"}),l.createElement("stop",{offset:.785262,stopColor:"white",stopOpacity:0})),l.createElement("radialGradient",{id:o+"-paint8_radial_105551_302",cx:0,cy:0,r:1,gradientTransform:"matrix(-14.1522 12.1976 -16.7761 -10.2898 30.5753 11.1494)",gradientUnits:"userSpaceOnUse"},l.createElement("stop",{stopColor:"#4BFDE8"}),l.createElement("stop",{offset:.584724,stopColor:"#4BFDE8",stopOpacity:0}))))},b1e="/static/cmc/assets/paperclip-CMVChwA7.svg";function _2(e){const{onClick:t,uploadButtonDisabled:n,title:o,icon:s,focusRef:a}=e,r=l.useRef(null),i=yA(r,a);return c.jsx(ee,{ref:i,title:o,"aria-label":o,variant:"rect",color:"subtle-dimmed-inverted",onClick:t,size:"40-base",alignment:"start",className:"min-w-[230px] rounded-xl p-0",testId:"add-images-files",disabled:n,children:c.jsxs("div",{className:"flex h-10 w-full items-center gap-3 rounded-xl px-3 py-2",children:[s,c.jsx("div",{className:"grow text-left",children:c.jsx("div",{className:"line-clamp-1 inline-flex gap-1.5 text-sm",children:o})})]})})}function I1e(e){const{onSelectFile:t,uploadButtonDisabled:n,onSelectOneDriveFile:o,focusRef:s}=e,{t:a}=Z();return c.jsxs(c.Fragment,{children:[c.jsx(_2,{onClick:t,uploadButtonDisabled:n,title:a("composer.connector.addImagesFiles"),icon:c.jsx(St,{url:b1e,className:"size-5"}),focusRef:s}),o&&c.jsx(_2,{onClick:o,uploadButtonDisabled:n,title:a("composer.addFromOneDrive"),icon:c.jsx(Hk,{className:"size-5"})})]})}const zk=({title:e,titleId:t,...n})=>l.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M7.87869 8.5858C7.48348 8.84756 7.00954 9 6.5 9C5.11929 9 4 7.88071 4 6.5C4 5.11929 5.11929 4 6.5 4C7.88071 4 9 5.11929 9 6.5C9 7.00954 8.84756 7.48348 8.5858 7.8787L10.6213 9.9142C11.0165 9.65244 11.4905 9.5 12 9.5C12.5095 9.5 12.9835 9.65244 13.3787 9.9142L15.4142 7.87869C15.1524 7.48348 15 7.00954 15 6.5C15 5.11929 16.1193 4 17.5 4C18.8807 4 20 5.11929 20 6.5C20 7.88071 18.8807 9 17.5 9C16.9905 9 16.5165 8.84756 16.1213 8.5858L14.0858 10.6213C14.3476 11.0165 14.5 11.4905 14.5 12C14.5 12.5095 14.3476 12.9835 14.0858 13.3787L16.1213 15.4142C16.5165 15.1524 16.9905 15 17.5 15C18.8807 15 20 16.1193 20 17.5C20 18.8807 18.8807 20 17.5 20C16.1193 20 15 18.8807 15 17.5C15 16.9905 15.1524 16.5165 15.4142 16.1213L13.3787 14.0858C12.9835 14.3476 12.5095 14.5 12 14.5C11.4905 14.5 11.0165 14.3476 10.6213 14.0858L8.5858 16.1213C8.84756 16.5165 9 16.9905 9 17.5C9 18.8807 7.88071 20 6.5 20C5.11929 20 4 18.8807 4 17.5C4 16.1193 5.11929 15 6.5 15C7.00954 15 7.48348 15.1524 7.87869 15.4142L9.9142 13.3787C9.65244 12.9835 9.5 12.5095 9.5 12C9.5 11.4905 9.65244 11.0165 9.9142 10.6213L7.87869 8.5858ZM8 6.5C8 5.67157 7.32843 5 6.5 5C5.67157 5 5 5.67157 5 6.5C5 7.32843 5.67157 8 6.5 8C7.32843 8 8 7.32843 8 6.5ZM19 6.5C19 5.67157 18.3284 5 17.5 5C16.6716 5 16 5.67157 16 6.5C16 7.32843 16.6716 8 17.5 8C18.3284 8 19 7.32843 19 6.5ZM6.5 19C7.32843 19 8 18.3284 8 17.5C8 16.6716 7.32843 16 6.5 16C5.67157 16 5 16.6716 5 17.5C5 18.3284 5.67157 19 6.5 19ZM19 17.5C19 16.6716 18.3284 16 17.5 16C16.6716 16 16 16.6716 16 17.5C16 18.3284 16.6716 19 17.5 19C18.3284 19 19 18.3284 19 17.5ZM13.5 12C13.5 11.1716 12.8284 10.5 12 10.5C11.1716 10.5 10.5 11.1716 10.5 12C10.5 12.8284 11.1716 13.5 12 13.5C12.8284 13.5 13.5 12.8284 13.5 12Z",fill:"currentColor",stroke:"currentColor",strokeWidth:.2}));function ku(e){const{isChecked:t,label:n,description:o,onChange:s,accessory:a,disabled:r,testId:i,className:d,labelClassName:m,descriptionClassName:p}=e,h=l.useId(),[g,y]=l.useState(!1),b=Hc(),C=I=>{I.currentTarget.matches(":focus-visible")&&y(!0)},T=()=>y(!1),{focusable:S}=kd({autoRestoreFocus:!0,forceFocus:!0});let E=t?"bg-system-green-400":"bg-black/20 dark:bg-white/20";return r&&(E="bg-black/20 after:bg-white/40 dark:bg-white/20 dark:after:bg-black/40"),c.jsxs("label",{className:O("flex min-w-0 items-center justify-between gap-4",!r&&"cursor-pointer",d),htmlFor:h,ref:S.ref,"data-testid":i,children:[c.jsxs("div",{className:"flex min-w-0 flex-1 flex-col",children:[c.jsx("span",{className:O("text-foreground-800 text-sm",m),children:n}),o&&c.jsx("span",{className:O("font-medium text-foreground-450 text-sm",p),children:o})]}),c.jsxs("span",{className:"flex flex-row items-center gap-2",children:[a,c.jsx("input",{id:h,type:"checkbox",title:n,checked:t,onChange:I=>s(I.target.checked),onFocus:C,onBlur:T,className:"sr-only",disabled:r}),c.jsx("div",{className:O("relative h-6 w-10 rounded-full","after:absolute after:size-5 after:rounded-full after:transition-all contrast-more:forced-color-adjust-none",b?"rotate-180 after:bottom-[2px] after:end-[2px]":"after:start-[2px] after:top-[2px]",E,!r&&"after:bg-white after:shadow-switch after:hover:scale-110 after:active:w-6",t&&"after:translate-x-4",t&&!r&&"after:active:translate-x-3",g&&"outline outline-2 outline-offset-2")})]})]})}function Gk(e){const{isInComposer:t=!1,IconComponent:n,title:o,isToggleOn:s,showToggle:a,showConnect:r=!1,isDisConnected:i=!1,onClickToggle:d,onClickMore:m,onClickConnect:p,description:h,isModal:g}=e,y=O("flex items-center ",t?"gap-3":"gap-2"),b=O("shrink-0",t?"size-4":"size-5"),C=l.useId(),T=l.useId(),S=i?F("connector.connect"):F("connector.reconnect");function E(){return!g||t?null:c.jsx(ee,{"aria-label":F("connector.moreDetailsAriaLabel",{description:h}),title:F("connector.moreDetails"),className:"mx-0 shrink-0 px-0",size:"28-xxs",color:"subtle-dimmed",onClick:m,children:c.jsx(po,{className:"size-4"})})}return c.jsxs("div",{className:O(t?"py-1.5 ps-3.5 text-sm":"flex flex-col gap-2 p-2",t&&a?"pe-2.5":"pe-1"),children:[r&&c.jsxs("div",{className:"flex items-center justify-between gap-2",children:[c.jsxs("div",{className:y,children:[c.jsx(n,{className:b}),c.jsx("span",{id:C,className:"text-foreground-800 text-sm",children:o})]}),c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx(ee,{className:O("px-2 text-sm",t&&"opacity-65 focus-visible:opacity-100 safe-hover:opacity-100"),"aria-labelledby":`${C} ${T}`,title:S,size:"28-xxs",color:t?"subtle-dimmed-inverted":"default",onClick:p,children:c.jsx("span",{id:T,children:S})}),E()]})]}),a&&c.jsxs("div",{className:y,children:[c.jsx(n,{className:b}),c.jsx(ku,{className:"w-full",labelClassName:"text-sm",label:o,isChecked:s,onChange:d}),E()]}),!t&&c.jsxs("div",{className:"text-foreground-700 text-xs",children:[c.jsx("span",{className:"me-1",children:h}),!g&&c.jsx(ee,{"aria-label":F("connector.moreDetailsAriaLabel",{description:h}),title:F("connector.moreDetails"),className:"inline-block h-auto min-h-0 whitespace-nowrap p-0 leading-none text-foreground-700 underline text-xs",onClick:m,color:"subtle-bright",children:F("connector.moreDetails")})]})]})}const Wk=(e,t,n)=>{R.trackEvent({name:"interaction",data:{eventName:"connectorPlatformConnectionManagementImpression",eventInfo_connectorPlatformConnectorType:e,eventInfo_connectorPlatformConnectionStatus:t,eventInfo_connectorPlatformConnectionStartSource:n}})},Ui=(e,t,n,o)=>{R.trackEvent({name:"interaction",data:{eventName:"connectorPlatformConnectionManagementAction",eventInfo_connectorPlatformConnectorType:e,eventInfo_connectorPlatformConnectionStatus:t,eventInfo_connectorPlatformConnectionStartSource:n,eventInfo_connectorPlatformConnectionActionType:o}})},e3e=(e,t)=>{R.trackEvent({name:"interaction",data:{eventName:"connectorPlatformConnectionStartPageImpression",eventInfo_connectorPlatformConnectionStartSource:t,eventInfo_connectorPlatformConnectorType:e}})},t3e=(e,t,n)=>{R.trackEvent({name:"interaction",data:{eventName:"connectorPlatformConnectionStartPageAction",eventInfo_connectorPlatformConnectionStartSource:t,eventInfo_connectorPlatformConnectorType:e,eventInfo_connectorPlatformConnectionActionType:n}})},n3e=(e,t)=>{R.trackEventAfterUserReady({name:"interaction",data:{eventName:"connectorPlatformConnectionSetupFailureEvent",eventInfo_connectorPlatformConnectorType:e,eventInfo_connectorPlatformConnectorErrorType:t??"",eventInfo_source:"Component"}})},o3e=e=>{R.trackEventAfterUserReady({name:"interaction",data:{eventName:"connectorPlatformConnectionSetupSuccessEvent",eventInfo_connectorPlatformConnectorType:e,eventInfo_source:"Component"}})},E1e=({title:e,titleId:t,...n})=>{const[o,s]=l.useState("");return l.useEffect(()=>{s(Math.random().toString(36).slice(2,10))},[]),l.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M20.051 16.8869C19.7881 17.0247 19.5135 17.148 19.2281 17.2552C18.3702 17.5775 17.4227 17.7602 16.4233 17.7602C12.7264 17.7602 9.50588 15.2171 9.50588 11.9537C9.50588 11.0361 10.0368 10.2407 10.7892 9.82178C7.44572 9.96193 6.58623 13.4468 6.58623 15.4882C6.58623 21.2596 11.9057 21.8453 13.052 21.8453C13.6696 21.8453 14.602 21.6654 15.1637 21.4892C15.198 21.4778 15.2321 21.4663 15.2661 21.4545C17.4348 20.7066 19.2653 19.2352 20.4685 17.328C20.641 17.0544 20.3375 16.7367 20.051 16.8869Z",fill:`url(#${o}-paint0_linear_11766_2366)`}),l.createElement("path",{d:"M10.2588 20.8619C9.56389 20.4312 8.96067 19.8633 8.48255 19.192C7.7427 18.1532 7.30039 16.8755 7.30039 15.4882C7.30039 13.4468 8.25099 11.6386 9.71629 10.4929C10.0491 10.2328 10.4752 9.97036 10.7892 9.82176C11.0329 9.70633 11.4499 9.49851 12.0036 9.50636C12.9218 9.51937 13.6154 9.98746 14.0103 10.519C14.3137 10.9275 14.5008 11.4307 14.507 11.9769C14.5072 11.9605 16.4183 5.75781 8.25313 5.75781C4.82396 5.75781 2 9.01327 2 11.8684C2 13.6795 2.42026 15.1255 2.94646 16.246C4.1184 18.7422 6.29164 20.6741 8.95009 21.5252C9.91281 21.8335 10.9384 22.0015 12.0036 22.0015C13.1084 22.0015 14.1701 21.8198 15.1637 21.4892C14.602 21.6654 14.0064 21.7619 13.3888 21.7619C12.2426 21.7619 11.1742 21.4295 10.2588 20.8619Z",fill:`url(#${o}-paint1_linear_11766_2366)`}),l.createElement("path",{d:"M13.9001 13.6309C13.8369 13.7129 13.6421 13.8261 13.6421 14.0734C13.6421 14.2769 13.7749 14.4732 14.0109 14.638C15.1345 15.422 17.2521 15.3164 17.2578 15.3164C18.132 15.3134 18.9184 15.073 19.6229 14.6611C19.9433 14.4737 20.24 14.2512 20.5074 13.997C21.4251 13.1249 21.9847 11.8959 22.0002 10.5303C22.0201 8.77913 21.3783 7.61489 21.1145 7.09937C19.4589 3.86354 15.8849 2.00134 11.9989 2.00134C6.52112 2.00134 2.07446 6.40343 2.00096 11.8608C2.03809 9.0059 4.87549 6.7005 8.24835 6.7005C8.52183 6.7005 10.0814 6.72717 11.53 7.4875C12.8061 8.15725 13.4752 8.96655 13.9402 9.76937C14.4231 10.603 14.509 11.6558 14.509 12.0756C14.509 12.4954 14.2973 13.1168 13.9001 13.6309Z",fill:`url(#${o}-paint2_linear_11766_2366)`}),l.createElement("defs",null,l.createElement("linearGradient",{id:o+"-paint0_linear_11766_2366",x1:6.58623,y1:15.8336,x2:20.5188,y2:15.8336,gradientUnits:"userSpaceOnUse"},l.createElement("stop",{stopColor:"#094987"}),l.createElement("stop",{offset:.245021,stopColor:"#0C59A4"}),l.createElement("stop",{offset:1,stopColor:"#114A8B"})),l.createElement("linearGradient",{id:o+"-paint1_linear_11766_2366",x1:8,y1:5.99998,x2:5.22878,y2:19.2687,gradientUnits:"userSpaceOnUse"},l.createElement("stop",{stopColor:"#117FBA"}),l.createElement("stop",{offset:.223416,stopColor:"#1797E0"}),l.createElement("stop",{offset:.947917,stopColor:"#0078D4"})),l.createElement("linearGradient",{id:o+"-paint2_linear_11766_2366",x1:22,y1:10,x2:8,y2:5.50003,gradientUnits:"userSpaceOnUse"},l.createElement("stop",{stopColor:"#48D566"}),l.createElement("stop",{offset:1,stopColor:"#35C1F1"}))))},T1e=({title:e,titleId:t,...n})=>{const[o,s]=l.useState("");return l.useEffect(()=>{s(Math.random().toString(36).slice(2,10))},[]),l.createElement("svg",{viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M21.0063 5.41416L4.42759 15.9228L3.00183 13.6735V11.7353C3.00183 11.0297 3.35909 10.372 3.95105 9.98784L13.5882 3.73443C15.0565 2.78169 16.9478 2.78155 18.4162 3.73406L21.0063 5.41416Z",fill:`url(#${o}-paint0_linear_105551_397)`}),l.createElement("path",{d:"M18.2683 3.64233C18.3181 3.67198 18.3676 3.70268 18.4165 3.73444L25.9378 8.61321L7.28914 20.4339L4.42749 15.9193L18.1138 7.22729C19.4101 6.40398 19.4669 4.55187 18.2683 3.64233Z",fill:`url(#${o}-paint1_linear_105551_397)`}),l.createElement("path",{d:"M18.2683 3.64233C18.3181 3.67198 18.3676 3.70268 18.4165 3.73444L25.9378 8.61321L7.28914 20.4339L4.42749 15.9193L18.1138 7.22729C19.4101 6.40398 19.4669 4.55187 18.2683 3.64233Z",fill:`url(#${o}-paint2_linear_105551_397)`,fillOpacity:.2}),l.createElement("path",{d:"M14.7293 22.6909L7.28894 20.4338L23.1079 10.4064C24.4401 9.5619 24.4367 7.61694 23.1014 6.77722L23.0302 6.73242L23.2353 6.86006L28.0498 9.98306C28.6419 10.3672 28.9993 11.0249 28.9993 11.7307V13.6066L14.7293 22.6909Z",fill:`url(#${o}-paint3_linear_105551_397)`}),l.createElement("path",{d:"M14.7293 22.6909L7.28894 20.4338L23.1079 10.4064C24.4401 9.5619 24.4367 7.61694 23.1014 6.77722L23.0302 6.73242L23.2353 6.86006L28.0498 9.98306C28.6419 10.3672 28.9993 11.0249 28.9993 11.7307V13.6066L14.7293 22.6909Z",fill:`url(#${o}-paint4_linear_105551_397)`,fillOpacity:.2}),l.createElement("path",{d:"M18.4162 3.73406C16.9478 2.78155 15.0565 2.78169 13.5882 3.73443L3.95105 9.98784C3.35909 10.372 3.00183 11.0297 3.00183 11.7353V11.8301C3.02507 12.5385 3.39786 13.1914 3.99995 13.571L15.9829 21.1256L27.996 13.5825C28.6198 13.1907 28.9985 12.5058 28.9985 11.7691V13.6068L28.9988 11.7307C28.9988 11.025 28.6414 10.3672 28.0493 9.98309L18.4162 3.73406Z",fill:`url(#${o}-paint5_radial_105551_397)`}),l.createElement("path",{d:"M13.8709 29.0012H24.4983C26.9836 29.0012 28.9983 26.9865 28.9983 24.5012L28.9983 11.6782C28.9983 12.4715 28.5905 13.2092 27.9186 13.631L12.2086 23.4955C11.357 24.0302 10.8401 24.9652 10.8402 25.9707C10.8404 27.6444 12.1972 29.0012 13.8709 29.0012Z",fill:`url(#${o}-paint6_linear_105551_397)`}),l.createElement("path",{d:"M13.8709 29.0012H24.4983C26.9836 29.0012 28.9983 26.9865 28.9983 24.5012L28.9983 11.6782C28.9983 12.4715 28.5905 13.2092 27.9186 13.631L12.2086 23.4955C11.357 24.0302 10.8401 24.9652 10.8402 25.9707C10.8404 27.6444 12.1972 29.0012 13.8709 29.0012Z",fill:`url(#${o}-paint7_radial_105551_397)`,fillOpacity:.4}),l.createElement("path",{d:"M13.8709 29.0012H24.4983C26.9836 29.0012 28.9983 26.9865 28.9983 24.5012L28.9983 11.6782C28.9983 12.4715 28.5905 13.2092 27.9186 13.631L12.2086 23.4955C11.357 24.0302 10.8401 24.9652 10.8402 25.9707C10.8404 27.6444 12.1972 29.0012 13.8709 29.0012Z",fill:`url(#${o}-paint8_radial_105551_397)`,fillOpacity:.5}),l.createElement("path",{d:"M18.1862 29.0003H7.5004C5.01512 29.0003 3.0004 26.9856 3.0004 24.5003V11.7129C3.0004 12.4774 3.3927 13.1885 4.03946 13.5963L19.7712 23.5142C20.6346 24.0586 21.1583 25.0079 21.1582 26.0286C21.158 27.6699 19.8274 29.0003 18.1862 29.0003Z",fill:`url(#${o}-paint9_radial_105551_397)`}),l.createElement("path",{d:"M18.1862 29.0003H7.5004C5.01512 29.0003 3.0004 26.9856 3.0004 24.5003V11.7129C3.0004 12.4774 3.3927 13.1885 4.03946 13.5963L19.7712 23.5142C20.6346 24.0586 21.1583 25.0079 21.1582 26.0286C21.158 27.6699 19.8274 29.0003 18.1862 29.0003Z",fill:`url(#${o}-paint10_linear_105551_397)`}),l.createElement("rect",{x:2,y:14,width:12,height:12,rx:2.75,fill:`url(#${o}-paint11_radial_105551_397)`}),l.createElement("rect",{x:2,y:14,width:12,height:12,rx:2.75,fill:`url(#${o}-paint12_radial_105551_397)`,fillOpacity:.5}),l.createElement("path",{d:"M7.96826 23.3589C7.0318 23.3589 6.263 23.0568 5.66185 22.4526C5.0607 21.8485 4.76013 21.06 4.76013 20.0873C4.76013 19.0602 5.06524 18.2295 5.67544 17.5951C6.28565 16.9607 7.08466 16.6436 8.07248 16.6436C9.00591 16.6436 9.76565 16.9471 10.3517 17.5543C10.9408 18.1615 11.2353 18.962 11.2353 19.9559C11.2353 20.9769 10.9302 21.8001 10.32 22.4254C9.71279 23.0477 8.92888 23.3589 7.96826 23.3589ZM7.99544 22.0765C8.50597 22.0765 8.9168 21.8968 9.22794 21.5373C9.53909 21.1778 9.69466 20.6779 9.69466 20.0375C9.69466 19.3699 9.54362 18.8503 9.24154 18.4787C8.93945 18.1071 8.53617 17.9214 8.03169 17.9214C7.51211 17.9214 7.09373 18.1132 6.77654 18.4968C6.45935 18.8775 6.30076 19.3819 6.30076 20.0103C6.30076 20.6477 6.45935 21.1521 6.77654 21.5237C7.09373 21.8923 7.50003 22.0765 7.99544 22.0765Z",fill:"white"}),l.createElement("defs",null,l.createElement("linearGradient",{id:o+"-paint0_linear_105551_397",x1:5.88149,y1:14.8183,x2:21.0063,y2:5.43718,gradientUnits:"userSpaceOnUse"},l.createElement("stop",{stopColor:"#20A7FA"}),l.createElement("stop",{offset:.4,stopColor:"#3BD5FF"}),l.createElement("stop",{offset:1,stopColor:"#C4B0FF"})),l.createElement("linearGradient",{id:o+"-paint1_linear_105551_397",x1:11.0876,y1:18.0175,x2:19.5075,y2:4.53529,gradientUnits:"userSpaceOnUse"},l.createElement("stop",{stopColor:"#165AD9"}),l.createElement("stop",{offset:.5008,stopColor:"#1880E5"}),l.createElement("stop",{offset:1,stopColor:"#8587FF"})),l.createElement("linearGradient",{id:o+"-paint2_linear_105551_397",x1:17.2286,y1:18.2009,x2:7.88049,y2:10.584,gradientUnits:"userSpaceOnUse"},l.createElement("stop",{offset:.236946,stopColor:"#448AFF",stopOpacity:0}),l.createElement("stop",{offset:.792113,stopColor:"#0032B1"})),l.createElement("linearGradient",{id:o+"-paint3_linear_105551_397",x1:16.0387,y1:21.1339,x2:30.8121,y2:11.6789,gradientUnits:"userSpaceOnUse"},l.createElement("stop",{stopColor:"#1A43A6"}),l.createElement("stop",{offset:.492267,stopColor:"#2052CB"}),l.createElement("stop",{offset:1,stopColor:"#5F20CB"})),l.createElement("linearGradient",{id:o+"-paint4_linear_105551_397",x1:20.2091,y1:20.5687,x2:11.2319,y2:12.8005,gradientUnits:"userSpaceOnUse"},l.createElement("stop",{stopColor:"#0045B9",stopOpacity:0}),l.createElement("stop",{offset:.669859,stopColor:"#0D1F69"})),l.createElement("radialGradient",{id:o+"-paint5_radial_105551_397",cx:0,cy:0,r:1,gradientUnits:"userSpaceOnUse",gradientTransform:"translate(16.0012 3.59051) rotate(-90) scale(19.5009 21.1067)"},l.createElement("stop",{offset:.568182,stopColor:"#275FF0",stopOpacity:0}),l.createElement("stop",{offset:.992424,stopColor:"#002177"})),l.createElement("linearGradient",{id:o+"-paint6_linear_105551_397",x1:28.9983,y1:20.2914,x2:15.8933,y2:20.2914,gradientUnits:"userSpaceOnUse"},l.createElement("stop",{stopColor:"#4DC4FF"}),l.createElement("stop",{offset:.196145,stopColor:"#0FAFFF"})),l.createElement("radialGradient",{id:o+"-paint7_radial_105551_397",cx:0,cy:0,r:1,gradientUnits:"userSpaceOnUse",gradientTransform:"translate(18.9562 26.0462) rotate(-45) scale(8.35708)"},l.createElement("stop",{offset:.259477,stopColor:"#0060D1"}),l.createElement("stop",{offset:.908166,stopColor:"#0383F1",stopOpacity:0})),l.createElement("radialGradient",{id:o+"-paint8_radial_105551_397",cx:0,cy:0,r:1,gradientTransform:"matrix(17.2076 -22.5536 15.8577 21.5059 6.34585 32.2282)",gradientUnits:"userSpaceOnUse"},l.createElement("stop",{offset:.732317,stopColor:"#F4A7F7",stopOpacity:0}),l.createElement("stop",{offset:1,stopColor:"#F4A7F7"})),l.createElement("radialGradient",{id:o+"-paint9_radial_105551_397",cx:0,cy:0,r:1,gradientUnits:"userSpaceOnUse",gradientTransform:"translate(12.0794 18.5501) rotate(123.339) scale(14.9678 38.8433)"},l.createElement("stop",{stopColor:"#49DEFF"}),l.createElement("stop",{offset:.724349,stopColor:"#29C3FF"})),l.createElement("linearGradient",{id:o+"-paint10_linear_105551_397",x1:1.16485,y1:26.0177,x2:13.7825,y2:26.0086,gradientUnits:"userSpaceOnUse"},l.createElement("stop",{offset:.205882,stopColor:"#6CE0FF"}),l.createElement("stop",{offset:.535,stopColor:"#50D5FF",stopOpacity:0})),l.createElement("radialGradient",{id:o+"-paint11_radial_105551_397",cx:0,cy:0,r:1,gradientUnits:"userSpaceOnUse",gradientTransform:"translate(1.95718 14.4615) rotate(46.9242) scale(15.7964)"},l.createElement("stop",{offset:.038877,stopColor:"#0091FF"}),l.createElement("stop",{offset:.919119,stopColor:"#183DAD"})),l.createElement("radialGradient",{id:o+"-paint12_radial_105551_397",cx:0,cy:0,r:1,gradientUnits:"userSpaceOnUse",gradientTransform:"translate(8 21.3079) rotate(90) scale(8.4 9.68913)"},l.createElement("stop",{offset:.557796,stopColor:"#0FA5F7",stopOpacity:0}),l.createElement("stop",{offset:1,stopColor:"#74C6FF"}))))},w1e=({title:e,titleId:t,...n})=>{const[o,s]=l.useState("");return l.useEffect(()=>{s(Math.random().toString(36).slice(2,10))},[]),l.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 32 32","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("g",{id:o+"-g11171"},l.createElement("g",{id:o+"-g11137"},l.createElement("g",{id:o+"-g11135"},l.createElement("path",{id:o+"-path11133",d:"M16.4 2.2c0 1.2-1 2.2-2.2 2.2-1.2 0-2.2-1-2.2-2.2C12 1 13 0 14.2 0c1.2 0 2.2 1 2.2 2.2zm-2.2 4c-1.3 0-2.3 1-2.3 2.3 0 1.3 1 2.3 2.3 2.3 1.3 0 2.3-1 2.3-2.3 0-1.3-1-2.3-2.3-2.3zm0 6.2c-1.3 0-2.4 1.1-2.4 2.4 0 1.3 1.1 2.4 2.4 2.4 1.3 0 2.4-1.1 2.4-2.4 0-1.3-1.1-2.4-2.4-2.4zm0 6.3c-1.3 0-2.3 1-2.3 2.3 0 1.3 1 2.3 2.3 2.3 1.3 0 2.3-1 2.3-2.3 0-1.2-1-2.3-2.3-2.3zm0 6.4c-1.2 0-2.2 1-2.2 2.2 0 1.2 1 2.2 2.2 2.2 1.2 0 2.2-1 2.2-2.2 0-1.2-1-2.2-2.2-2.2zm6.1-19.2c-1.4 0-2.6 1.2-2.6 2.6 0 1.4 1.2 2.6 2.6 2.6 1.4 0 2.6-1.2 2.6-2.6 0-1.4-1.2-2.6-2.6-2.6zm0 6.2c-1.5 0-2.7 1.2-2.7 2.7 0 1.5 1.2 2.7 2.7 2.7 1.5 0 2.7-1.2 2.7-2.7 0-1.5-1.2-2.7-2.7-2.7zm0 6.3c-1.4 0-2.6 1.2-2.6 2.6 0 1.4 1.2 2.6 2.6 2.6 1.4 0 2.6-1.2 2.6-2.6 0-1.4-1.2-2.6-2.6-2.6zm6.3-6.6c-1.6 0-3 1.3-3 3 0 1.6 1.3 3 3 3s3-1.3 3-3c-.1-1.7-1.4-3-3-3zM8 6.5c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6.2c-1.2 0-2.1.9-2.1 2.1 0 1.2.9 2.1 2.1 2.1 1.2 0 2.1-.9 2.1-2.1 0-1.2-.9-2.1-2.1-2.1zM8 19c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm-6.2-6c-1 0-1.8.8-1.8 1.8s.8 1.8 1.8 1.8 1.8-.8 1.8-1.8S2.8 13 1.8 13z",fill:"#00b0b9"})))))},A1e=({title:e,titleId:t,...n})=>l.createElement("svg",{viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M23.3686 8.63379H8.63184V23.3704H23.3686V8.63379Z",fill:"white"}),l.createElement("path",{d:"M23.3688 30.0008L30.0004 23.3695L26.6846 22.8037L23.3688 23.3695L22.7637 26.4023L23.3688 30.0008Z",fill:"#EA4335"}),l.createElement("path",{d:"M2 23.3695V27.7904C2 29.0117 2.9892 30.0008 4.2105 30.0008H8.63152L9.31239 26.6851L8.63152 23.3695L5.01863 22.8037L2 23.3695Z",fill:"#188038"}),l.createElement("path",{d:"M30.0004 8.63147V4.21049C30.0004 2.98919 29.0112 2 27.7898 2H23.3688C22.9653 3.64452 22.7637 4.85476 22.7637 5.63073C22.7637 6.40668 22.9653 7.40691 23.3688 8.63147C24.8355 9.05145 25.9407 9.26145 26.6846 9.26145C27.4284 9.26145 28.5336 9.05145 30.0004 8.63147Z",fill:"#1967D2"}),l.createElement("path",{d:"M30.0007 8.63379H23.3691V23.3704H30.0007V8.63379Z",fill:"#FBBC04"}),l.createElement("path",{d:"M23.3686 23.3662H8.63184V29.9977H23.3686V23.3662Z",fill:"#34A853"}),l.createElement("path",{d:"M23.3681 2H4.2105C2.9892 2 2 2.98919 2 4.21049V23.3681H8.63152V8.63147H23.3681V2Z",fill:"#4285F4"}),l.createElement("path",{d:"M11.6544 20.0633C11.1036 19.6912 10.7223 19.1478 10.5142 18.4293L11.7926 17.9025C11.9086 18.3446 12.1112 18.6872 12.4005 18.9304C12.6878 19.1735 13.0378 19.2933 13.4468 19.2933C13.8649 19.2933 14.2241 19.1662 14.5244 18.912C14.8247 18.6578 14.9757 18.3335 14.9757 17.9412C14.9757 17.5396 14.8173 17.2117 14.5005 16.9575C14.1836 16.7033 13.7857 16.5762 13.3105 16.5762H12.5718V15.3107H13.2349C13.6438 15.3107 13.9884 15.2002 14.2684 14.9792C14.5484 14.7581 14.6884 14.456 14.6884 14.0711C14.6884 13.7284 14.563 13.4557 14.3126 13.2513C14.062 13.0467 13.7451 12.9436 13.3601 12.9436C12.9845 12.9436 12.686 13.0432 12.4649 13.244C12.244 13.4453 12.0779 13.6994 11.9823 13.9825L10.7168 13.4557C10.8844 12.9805 11.1921 12.5605 11.6434 12.1976C12.0947 11.8347 12.6712 11.6523 13.3713 11.6523C13.8888 11.6523 14.3549 11.7518 14.7676 11.9526C15.1801 12.1534 15.5044 12.4315 15.7384 12.7852C15.9723 13.1407 16.0884 13.5386 16.0884 13.9807C16.0884 14.4321 15.9796 14.8134 15.7623 15.1265C15.5449 15.4396 15.2778 15.6792 14.9609 15.8467V15.9223C15.37 16.0909 15.7255 16.3679 15.9888 16.7235C16.2559 17.0829 16.3905 17.512 16.3905 18.0131C16.3905 18.5141 16.2634 18.9616 16.009 19.3541C15.7549 19.7464 15.403 20.056 14.9573 20.2806C14.5097 20.5053 14.0068 20.6195 13.4486 20.6195C12.802 20.6214 12.2052 20.4353 11.6544 20.0633ZM19.5073 13.7192L18.1036 14.7342L17.4017 13.6694L19.9198 11.8531H20.885V20.4206H19.5073V13.7192Z",fill:"#4285F4"})),x1e=({title:e,titleId:t,...n})=>l.createElement("svg",{viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M16.0038 11.0319L11.0706 2.48113C11.2344 2.31734 11.4229 2.20991 11.6113 2.1377C10.1566 2.60794 9.48907 4.21242 9.48907 4.21242L0.476883 19.8292C0.350075 20.3188 0.314848 20.7609 0.330699 21.1501H10.1671L16.0038 11.0319Z",fill:"#34A853"}),l.createElement("path",{d:"M16.0034 11.0319L21.8401 21.1501H31.6766C31.6924 20.7609 31.6572 20.3188 31.5304 19.8292L22.5182 4.21242C22.5182 4.21242 21.8489 2.60794 20.3959 2.1377C20.5826 2.20991 20.7728 2.31734 20.9366 2.48113L16.0034 11.0319Z",fill:"#FBBC05"}),l.createElement("path",{d:"M16.0035 11.0308L20.9367 2.48001C20.7729 2.31622 20.5827 2.20878 20.396 2.13657C20.1811 2.06789 19.9504 2.02209 19.7003 2.00977H19.4396H12.5674H12.3067C12.0584 2.02033 11.8259 2.06612 11.611 2.13657C11.4243 2.20878 11.2341 2.31622 11.0703 2.48001L16.0035 11.0308Z",fill:"#188038"}),l.createElement("path",{d:"M10.1687 21.1494L5.29186 29.6033C5.29186 29.6033 5.12982 29.5258 4.90967 29.3655C5.60183 29.8886 6.27462 29.9996 6.27462 29.9996H25.4279C26.4847 29.9996 26.7048 29.6033 26.7048 29.6033C26.7083 29.6015 26.7101 29.5998 26.7136 29.598L21.8403 21.1494H10.1687Z",fill:"#4285F4"}),l.createElement("path",{d:"M10.169 21.1494H0.33252C0.381834 22.2977 0.889067 22.9688 0.889067 22.9688L1.25893 23.5993C1.28534 23.6363 1.30119 23.6574 1.30119 23.6574L2.10607 25.0452L3.91309 28.1344C3.96592 28.2595 4.02757 28.374 4.09273 28.4832C4.11739 28.5201 4.14028 28.5606 4.1667 28.5959C4.17375 28.6064 4.18079 28.617 4.18784 28.6276C4.41151 28.9375 4.66161 29.1771 4.9117 29.3655C5.13186 29.5276 5.29389 29.6033 5.29389 29.6033L10.169 21.1494Z",fill:"#1967D2"}),l.createElement("path",{d:"M21.8403 21.1494H31.6768C31.6275 22.2977 31.1202 22.9688 31.1202 22.9688L30.7504 23.5993C30.7239 23.6363 30.7081 23.6574 30.7081 23.6574L29.9032 25.0452L28.0962 28.1344C28.0434 28.2595 27.9817 28.374 27.9166 28.4832C27.8919 28.5201 27.869 28.5606 27.8426 28.5959C27.8355 28.6064 27.8285 28.617 27.8214 28.6276C27.5978 28.9375 27.3477 29.1771 27.0976 29.3655C26.8774 29.5276 26.7154 29.6033 26.7154 29.6033L21.8403 21.1494Z",fill:"#EA4335"})),_1e=({title:e,titleId:t,...n})=>l.createElement("svg",{viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M24.251 6.70996L16.087 12.9318L7.73633 6.70996V6.71164L7.74642 6.72005V15.4322L15.9928 21.7886L24.251 15.6778V6.70996Z",fill:"#EA4335"}),l.createElement("path",{d:"M26.3955 5.19615L24.2515 6.70956V15.6774L30.9979 10.6192V7.5722C30.9979 7.5722 30.179 3.22031 26.3955 5.19615Z",fill:"#FBBC05"}),l.createElement("path",{d:"M24.2515 15.6783V27.3097H29.4223C29.4223 27.3097 30.8936 27.1617 30.9996 25.5238V10.6201L24.2515 15.6783Z",fill:"#34A853"}),l.createElement("path",{d:"M7.74642 27.3192V15.4322L7.73633 15.4238L7.74642 27.3192Z",fill:"#C5221F"}),l.createElement("path",{d:"M7.73635 6.71107L5.60413 5.20607C1.8206 3.23023 1 7.58044 1 7.58044V10.6274L7.73635 15.4233V6.71107Z",fill:"#C5221F"}),l.createElement("path",{d:"M7.73633 6.71191V15.4241L7.74642 15.4325V6.72032L7.73633 6.71191Z",fill:"#C5221F"}),l.createElement("path",{d:"M1 10.6289V25.5326C1.10426 27.1721 2.57731 27.3184 2.57731 27.3184H7.74812L7.73635 15.423L1 10.6289Z",fill:"#4285F4"})),k1e=({title:e,titleId:t,...n})=>l.createElement("svg",{width:27,height:27,viewBox:"0 0 27 27",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M15.6667 0C17.2113 0 18.4832 1.16731 18.6485 2.66788C18.6484 2.66722 18.6483 2.66658 18.6483 2.66592L21 2.66667C22.6569 2.66667 24 4.00981 24 5.66667V14.6667H22V5.66667C22 5.11438 21.5523 4.66667 21 4.66667L18.1613 4.66693C17.6231 5.4708 16.7067 6 15.6667 6H11C9.95996 6 9.04352 5.47075 8.50533 4.66689L5.66667 4.66667C5.11438 4.66667 4.66667 5.11438 4.66667 5.66667V14.6667H2.66667V5.66667C2.66667 4.00981 4.00981 2.66667 5.66667 2.66667L8.01839 2.66592C8.18455 1.1663 9.45607 0 11 0H15.6667ZM18.6597 2.7946L18.6667 3C18.6667 2.93097 18.6643 2.86247 18.6597 2.7946ZM15.6667 2H11C10.4477 2 10 2.44772 10 3C10 3.55228 10.4477 4 11 4H15.6667C16.219 4 16.6667 3.55228 16.6667 3C16.6667 2.44772 16.219 2 15.6667 2ZM22 19.3333H24V23.6667C24 25.3235 22.6569 26.6667 21 26.6667H5.66667C4.00981 26.6667 2.66667 25.3235 2.66667 23.6667V19.3333H4.66667V23.6667C4.66667 24.219 5.11438 24.6667 5.66667 24.6667H21C21.5523 24.6667 22 24.219 22 23.6667V19.3333ZM11.9594 8.71779C11.8434 8.32352 11.498 8.04034 11.0887 8.0039C10.6793 7.96745 10.2894 8.18516 10.1056 8.55274L6.38197 16H1C0.447715 16 0 16.4477 0 17C0 17.5522 0.447715 18 1 18H7C7.37877 18 7.72504 17.786 7.89443 17.4472L10.7578 11.7204L13.374 20.6155C13.4899 21.0097 13.8353 21.2929 14.2447 21.3293C14.654 21.3658 15.044 21.1481 15.2278 20.7805L17.7464 15.7432L18.8092 17.5145C18.9899 17.8157 19.3154 18 19.6667 18H25.6667C26.219 18 26.6667 17.5522 26.6667 17C26.6667 16.4477 26.219 16 25.6667 16H20.2329L18.5242 13.1521C18.3364 12.8392 17.993 12.6534 17.6283 12.6674C17.2636 12.6814 16.9355 12.893 16.7722 13.2194L14.5755 17.6128L11.9594 8.71779Z",fill:"#3F3935"})),P1e={outlook:{"./outlook.readonly":"connector.scopes.outlook.readonly","./outlook.write":"connector.scopes.outlook.write"},"one-drive":{"./onedrive.readonly":"connector.scopes.oneDrive.readonly"},"google-calendar":{"https://www.googleapis.com/auth/calendar":"connector.scopes.googleCalendar.calendar","https://www.googleapis.com/auth/calendar.events.readonly":"connector.scopes.googleCalendar.calendarEventsReadonly","https://www.googleapis.com/auth/calendar.readonly":"connector.scopes.googleCalendar.calendarReadonly"},gmail:{"https://www.googleapis.com/auth/gmail.send":"connector.scopes.gmail.gmailSend","https://www.googleapis.com/auth/gmail.readonly":"connector.scopes.gmail.gmailReadonly","https://www.googleapis.com/auth/gmail.compose":"connector.scopes.gmail.gmailCompose"},"google-contacts":{"https://www.googleapis.com/auth/contacts.readonly":"connector.scopes.googleContacts.contactsReadonly"},"google-drive":{"https://www.googleapis.com/auth/drive.readonly":"connector.scopes.googleDrive.driveReadonly"}};function Xc(){const e=M(Er),t=G(Er),n=G(yG),{t:o}=Z(),s=cb(),a=Rk(),r=q("connector-dynamic-scope"),i=l.useCallback(S=>{switch(S){case"google-drive":return{type:"google-drive",title:o("connector.googleDrive.title"),description:o("connector.googleDrive.description"),details:o("connector.googleDrive.details"),websiteLink:"https://drive.google.com",privacyLink:dn,developer:o("connector.developerMicrosoft"),category:o("connector.productivity"),IconComponent:x1e};case"one-drive":return{type:"one-drive",title:o("connector.oneDrive.title"),description:o("connector.oneDrive.description"),details:o("connector.oneDrive.details"),websiteLink:"https://onedrive.com",privacyLink:dn,developer:o("connector.developerMicrosoft"),category:o("connector.productivity"),IconComponent:Hk};case"outlook":return{type:"outlook",title:o("outlook.title"),description:o("outlook.description"),details:o("connector.outlook.details"),websiteLink:"https://outlook.com",privacyLink:dn,developer:o("connector.developerMicrosoft"),category:o("connector.productivity"),IconComponent:T1e};case"google-calendar":return{type:"google-calendar",title:o("connector.googleCalendar.title"),description:o("connector.googleCalendar.description"),details:o("connector.googleCalendar.details"),websiteLink:"https://calendar.google.com",privacyLink:dn,developer:o("connector.developerMicrosoft"),category:o("connector.productivity"),IconComponent:A1e};case"gmail":return{type:"gmail",title:o("connector.googleMail.title"),description:o("connector.googleMail.description"),details:o("connector.googleMail.details"),websiteLink:"https://mail.google.com",privacyLink:dn,developer:o("connector.developerMicrosoft"),category:o("connector.productivity"),IconComponent:_1e};case"google-contacts":return{type:"google-contacts",title:o("connector.googleContacts.title"),description:o("connector.googleContacts.description"),details:o("connector.googleContacts.details"),websiteLink:"https://contacts.google.com",privacyLink:dn,developer:o("connector.developerMicrosoft"),category:o("connector.productivity"),IconComponent:e0};case"edge-browser":return{type:"edge-browser",title:o("connector.edgeBrowser.title"),description:o("connector.edgeBrowser.description"),details:o("connector.edgeBrowser.details"),websiteLink:"https://microsoft.com/edge",privacyLink:dn,developer:o("connector.developerMicrosoft"),category:o("connector.productivity"),IconComponent:E1e};case"fitbit":return{type:"fitbit",title:o("connector.fitbit.title"),description:o("connector.fitbit.description"),details:o("connector.fitbit.details"),websiteLink:"https://fitbit.com",privacyLink:dn,developer:o("connector.developerMicrosoft"),category:o("sidebar.health.title"),IconComponent:w1e};case"health-ex":return{type:"health-ex",title:o("connector.healthEx.title"),description:o("connector.healthEx.description"),details:o("connector.healthEx.details"),websiteLink:"https://www.healthex.io/",privacyLink:dn,developer:o("connector.developerMicrosoft"),category:o("sidebar.health.title"),IconComponent:k1e};default:return null}},[o]),d=l.useCallback(S=>{if(!S)return null;const E=e.find(x=>x.type===S);if(!E)return null;const I=i(S);return I?{id:E.id,status:E.status,scopes:E.scopes,...I}:null},[e,i]),m=l.useCallback((S,E)=>{if(!S)return null;const I=P1e[S]?.[E];return I?o(I):null},[o]),p=(S,E,I)=>{const x=i(S);n({type:S,title:x?.title,IconComponent:x?.IconComponent,visible:!0,startSource:E,scopes:r?I:void 0})},h=async S=>{if(!S)return;const E=await Nt({path:`/connections/${S}`,args:{options:{method:"DELETE"},body:{}}});E.ok&&E.status===204&&(t(e.map(I=>I.id===S?{...I,status:"disconnected"}:I)),await s.invalidateQueries({queryKey:[NS]}))},g=async(S,E)=>{const I=e.find(P=>P.id===S);if(!S||!I)return;const x=P=>{t(D=>D.map(L=>L.id===S?{...L,status:P}:L))};x(E),(await Nt({path:`/connections/${S}/${E==="ready"?"enable":"disable"}`,args:{options:{method:"POST"},body:{connectionStatus:E}}})).ok?await s.invalidateQueries({queryKey:[NS]}):x(I.status)},y=l.useCallback(()=>e.filter(E=>E.status==="ready").length,[e]),b=l.useCallback(S=>S==="one-drive"||S==="outlook"||S==="edge-browser",[]),C=(S,E)=>{const I=S.status==="ready"||S.status==="disabled",x=E.status==="ready"||E.status==="disabled";return I&&!x?-1:!I&&x?1:0},T=l.useCallback(()=>{const S=[],E=[];for(const w of e)b(w.type)?S.push(w):E.push(w);E.sort(C);const I=E.filter(w=>w.status==="ready"||w.status==="disabled");I.unshift(...S);const x=E.filter(w=>w.status==="disconnected"||w.status==="sign-in-required");return[I,x]},[e,b]);return{isConnectorsAvailable:a,getConnectorAppInfo:d,getSortedConnectors:T,isFirstParty:b,handleConnect:p,handleDisconnect:h,handleToggle:g,getAvailableConnectorsCount:y,getConnectorAccessLabel:m}}function M1e({connectorType:e,triggerSource:t,isModal:n}){const{pushPage:o}=as(),s=G(vT),{getConnectorAppInfo:a,handleToggle:r}=Xc(),{id:i,status:d,title:m,IconComponent:p,description:h}=a(e)??{},g=t==="composer";return l.useEffect(()=>{Wk(e,d??"unavailable",g?"composer":"settingsConnectorList")},[e,d,g]),!d||!m||!p||!h?null:c.jsx(Gk,{isInComposer:g,IconComponent:p,title:m,description:h,showToggle:d==="disconnected"||d==="ready"||d==="disabled",isToggleOn:d==="ready",showConnect:!1,isDisConnected:!1,onClickConnect:()=>{},onClickToggle:()=>{Ui(e,d,g?"composer":"settingsConnectorList",d==="ready"?"toggleOff":"toggleOn"),r(i,d==="ready"?"disabled":"ready")},onClickMore:()=>{s(e),Ui(e,d,"settingsConnectorList","goToDetail"),o("connector-detail")},isModal:n})}function R1e({connectorType:e,triggerSource:t,closePage:n,isModal:o}){const{pushPage:s,closeSettings:a}=as(),r=G(vT),{getConnectorAppInfo:i,handleConnect:d,handleToggle:m}=Xc(),p=i(e),{id:h,status:g,title:y,IconComponent:b,description:C,scopes:T}=p??{},S=t==="composer",E=l.useRef(null),I=wh(E,{amount:"all",once:!0});l.useEffect(()=>{I&&Wk(e,g??"unavailable",S?"composer":"settingsConnectorList")},[e,g,S,I]);const x=l.useCallback(D=>{const L=T?.map(j=>j.name);d(e,S?"composer":"settingsConnectorList",L),Ui(e,g,S?"composer":"settingsConnectorList","connect"),a(),n?.(D)},[e,g,T,d,a,n,S]),w=l.useCallback(()=>{Ui(e,g,S?"composer":"settingsConnectorList",g==="ready"?"toggleOff":"toggleOn"),m(h,g==="ready"?"disabled":"ready")},[e,g,m,h,S]),P=l.useCallback(()=>{r(e),Ui(e,g,S?"composer":"settingsConnectorList","goToDetail"),s("connector-detail")},[e,g,s,r,S]);return!g||!y||!b||!C?null:c.jsx("div",{ref:E,children:c.jsx(Gk,{isInComposer:S,IconComponent:b,title:y,description:C,showToggle:g==="ready"||g==="disabled",isToggleOn:g==="ready",showConnect:g==="disconnected"||g==="sign-in-required",isDisConnected:g==="disconnected",onClickConnect:x,onClickToggle:w,onClickMore:P,isModal:o})})}const M0=({title:e,titleId:t,...n})=>l.createElement("svg",{viewBox:"0 0 20 20",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M6.25 10C6.25 10.6904 5.69036 11.25 5 11.25C4.30964 11.25 3.75 10.6904 3.75 10C3.75 9.30964 4.30964 8.75 5 8.75C5.69036 8.75 6.25 9.30964 6.25 10ZM11.25 10C11.25 10.6904 10.6904 11.25 10 11.25C9.30964 11.25 8.75 10.6904 8.75 10C8.75 9.30964 9.30964 8.75 10 8.75C10.6904 8.75 11.25 9.30964 11.25 10ZM15 11.25C15.6904 11.25 16.25 10.6904 16.25 10C16.25 9.30964 15.6904 8.75 15 8.75C14.3096 8.75 13.75 9.30964 13.75 10C13.75 10.6904 14.3096 11.25 15 11.25Z"})),s3e=Object.freeze(Object.defineProperty({__proto__:null,default:M0},Symbol.toStringTag,{value:"Module"})),R0=()=>{const e=q("settings-as-modal"),t=ws({key:"useDialogLayout",default:!1}),n=gt({breakpoint:"sm"});return e&&!n&&!t},N1e={default:"border-black/10 dark:border-white/10",weak:"border-black/5 dark:border-white/5",accent:"border-stroke-300"},es=l.forwardRef((e,t)=>{const{horizontalMargin:n=!0,verticalMargin:o=!0,color:s="default",className:a,style:r,vertical:i=!1}=e;return c.jsx("div",{ref:t,className:O(i?"border-s-[1px]":"border-t-[1px]",n&&"mx-2",o&&"my-2",N1e[s],a),style:r})});es.displayName="Divider";function L1e(e,t){R.trackEvent({name:"system",data:{eventName:"copilotImpression",eventInfo_impressionElement:"composerCreateButton",eventInfo_impressionScenario:e??"off",eventInfo_conversationId:t}})}function D1e(e){R.trackEvent({name:"system",data:{eventName:"copilotImpression",eventInfo_impressionElement:"composerScreenshotButton",eventInfo_conversationId:e}})}function O1e(e,t){R.trackEvent({name:"interaction",data:{eventName:"copilotClick",eventInfo_clickSource:"composerCreateButton",eventInfo_clickScenario:U1e(e),eventInfo_conversationId:t}})}function U1e(e){if(!e)return"showDrawer";switch(e){case"actions":return"exitActions";case"image":return"exitImage";case"page":return"exitPage";case"podcast":return"exitPodcast";case"researchReport":return"exitResearchReport";case"quiz":return"exitQuiz";case"video":return"exitVideo";case"homeworkHelper":return"exitHomeworkHelper";default:return"showDrawer"}}function F1e(e){R.trackEvent({name:"interaction",data:{eventName:"copilotClick",eventInfo_clickSource:"composerScreenshotButton",eventInfo_conversationId:e}})}function $k(e,t){R.trackEvent({name:"interaction",data:{eventName:"copilotClick",eventInfo_clickSource:e,eventInfo_clickScenario:t}})}function th(e,t){const n=t?.dataset.spatialFocusKey;n&&e?.setFocus(n,{})}function qk(e){l.useEffect(()=>(window.addEventListener("keyup",e),()=>{window.removeEventListener("keyup",e)}),[e])}function N0(e){const{title:t,onClickBack:n,rightView:o,onClickClose:s}=e,a=l.useRef(null),r=_d(),i=R0(),d=s&&!i?c.jsx(ee,{title:F("common.closeText"),variant:"circle",size:"32-xs",onClick:s,className:"col-start-3 justify-self-end",color:"subtle-bright-inverted",testId:"close-settings-button",children:c.jsx(on,{className:"size-5","aria-hidden":!0})}):null;return qk(m=>{m.key==="Enter"&&a.current&&a.current.focus();const{isDismissEvent:p}=oq.run({event:m});(m.key==="Enter"||p)&&th(r,a.current)}),c.jsxs("div",{className:O("flex items-center",i?"py-4":"pb-4"),children:[c.jsx(ee,{ref:a,variant:"square",color:"subtle-dimmed-inverted",size:"32-xs",title:F("common.backText"),onClick:n,testId:"nav-header-back-button",children:c.jsx(Hr,{className:"size-5 -rotate-90"})}),c.jsx("h2",{className:O("mt-px grow text-center uppercase text-foreground-450 text-xs dark:text-foreground-600",!o&&"pe-8"),children:t}),o??d]})}function Kk({triggerSource:e="settings",closePage:t}){const n=e==="composer",o=R0(),s=!o&&!n,{goBackOrClose:a}=as(),{getSortedConnectors:r,isFirstParty:i}=Xc(),[d,m]=r(),p=gt({breakpoint:"md"}),h=g=>i(g.type)?c.jsx(M1e,{connectorType:g.type,triggerSource:e,isModal:o},g.type):c.jsx(R1e,{connectorType:g.type,triggerSource:e,closePage:t,isModal:o},g.type);return c.jsxs("div",{className:n?"min-w-60":"pb-3",children:[s&&c.jsx(N0,{title:F("settings.connectedAppsTitle"),onClickBack:a}),c.jsxs("div",{className:O("flex flex-col",!n&&"gap-1.5"),children:[d.map(h),d.length>0&&m.length>0&&c.jsx(es,{className:n?"mx-2 my-1":"my-2",horizontalMargin:!1,color:"default"}),m.map(h),n&&!p&&c.jsxs(ee,{variant:"rect",title:F("connector.composer.settings"),color:"subtle-dimmed-inverted",className:"h-6 w-full justify-start gap-2.5 px-3 py-1.5 text-sm",onClick:g=>{$k("composer","connectorSettings"),t?.(g),setTimeout(()=>{k_("connector-list")},200)},children:[c.jsx(M0,{className:"size-5 shrink-0"}),c.jsx("div",{className:"text-foreground-800 text-sm",children:F("connector.composer.settings")})]})]})]})}function j1e(e){const{t}=Z(),{closeDropdown:n}=e,o=gt({breakpoint:"sm"});return c.jsx(nm,{color:"default",renderTrigger:({openPopover:s})=>c.jsx(ee,{title:t("composer.connector.useConnector"),"aria-label":t("composer.connector.useConnector"),variant:"rect",color:"subtle-dimmed-inverted",onClick:a=>{s(a),$k("composer","useConnectors")},size:"40-base",alignment:"start",className:"w-full rounded-xl p-0",testId:"dropdown-connector-button",children:c.jsxs("div",{className:"flex h-10 w-full items-center gap-3 rounded-xl pe-2 ps-3",children:[c.jsx(zk,{className:"size-5"}),c.jsxs("div",{className:"flex grow items-center justify-between text-left",children:[c.jsx("div",{className:"line-clamp-1 inline-flex gap-1.5 text-sm",children:t("composer.connector.useConnector")}),c.jsx(po,{className:"size-4"})]})]})}),renderSurface:({closePopover:s})=>c.jsx("div",{className:"flex flex-col",children:c.jsx(Kk,{triggerSource:"composer",closePage:a=>{s(a),n(a)}})}),containerClassNames:{surface:`p-1.5 border-white/25 dark:border-stroke-400/25 shadow-tinted-xl ${o?"":"-ml-2.5"}`},placement:o?"top-start":"right-end"})}const B1e="/static/cmc/assets/screenshot-DXZDs5NE.svg";function V1e(e){const{onTakeScreenshot:t}=e,{t:n}=Z(),o=M(Te),s=l.useRef(void 0);return l.useEffect(()=>{s.current!==o&&D1e(o)},[o]),c.jsx(ee,{title:n("composer.takeScreenshot"),"aria-label":n("composer.takeScreenshot"),variant:"rect",color:"subtle-dimmed-inverted",onClick:a=>{t(a),F1e(o)},size:"40-base",alignment:"start",className:"min-w-[230px] rounded-xl p-0",testId:"take-screenshot-button",children:c.jsxs("div",{className:"flex h-10 w-full items-center gap-3 rounded-xl px-3 py-2",children:[c.jsx(St,{url:B1e,className:"size-5"}),c.jsx("div",{className:"grow text-left",children:c.jsx("div",{className:"line-clamp-1 inline-flex gap-1.5 text-sm",children:n("composer.takeScreenshot")})})]})})}const H1e="/static/cmc/assets/add-BTcFT5ig.svg",z1e="/static/cmc/assets/camera-DYwg6Clj.svg",G1e="/static/cmc/assets/image-zMo0jLdY.svg",W1e="/static/cmc/assets/podcast-BQmBU8ew.svg",$1e="/static/cmc/assets/research-DLTQx7hg.svg",q1e="/static/cmc/assets/video-clip-9pviB4uv.svg",K1e="/static/cmc/assets/edit-line-horizontal-CFFP_Xzl.svg",Y1e="/static/cmc/assets/quiz-new-fGeLWOyT.svg";function Z1e(){const{t:e}=Z(),t=Vt();return{setComposerCreateModeWithPrefill:l.useCallback(o=>{const s=a_(o,e);Ar(o),s&&Zi({prompt:s,prefillSource:"create"},t==="/")},[e,t])}}const J1e=_(null);function L0(){const e=G(J1e),t=l.useCallback(o=>{e(o)},[e]),n=l.useCallback(o=>{e(o)},[e]);return{handleFeatureUpsell:t,handleFeatureLimitReached:n}}function Q1e(){const{t:e}=Z(),{handleFeatureUpsell:t,handleFeatureLimitReached:n}=L0(),o=Gd();return l.useCallback(()=>{if(o.disabledReason??o.eligibleSubscriptionUpgrades.length===0){n({allowUpsell:!1,title:e("proSubscription.modal.featureLimitReached.deepResearch.title"),subtitle:e("proSubscription.modal.featureLimitReached.deepResearch.subtitleIneligible"),payflowEntryPoint:"DeepResearchLimit",dismissButton:e("common.dismiss"),subscriptions:o.eligibleSubscriptionUpgrades,upsellReason:"DailyLimit",disabledReason:o.disabledReason??""});return}const{eligibleSubscriptionUpgrades:s}=o;let a;s.includes("m365-personal")?a="proSubscription.modal.featureLimitReached.deepResearch.subtitleFree":s.includes("m365-premium")?a="proSubscription.modal.featureLimitReached.deepResearch.subtitleUpgradable":a="proSubscription.modal.featureLimitReached.deepResearch.subtitleIneligible",t({allowUpsell:!0,title:e("proSubscription.modal.featureLimitReached.deepResearch.title"),subtitle:e(a),payflowEntryPoint:"DeepResearchLimit",confirmButton:e("actions.proSubscription.subscribeToPro"),dismissButton:e("common.dismiss"),subscriptions:o.eligibleSubscriptionUpgrades,upsellReason:"DailyLimit"})},[o,t,e,n])}function X1e(){const{t:e}=Z(),{handleFeatureUpsell:t,handleFeatureLimitReached:n}=L0(),o=Gd();return l.useCallback(()=>{if(o.disabledReason??o.eligibleSubscriptionUpgrades.length===0){n({allowUpsell:!1,title:e("proSubscription.modal.featureLimitReached.podcast.title"),subtitle:e("proSubscription.modal.featureLimitReached.podcast.subtitleIneligible"),payflowEntryPoint:"PodcastLimit",dismissButton:e("common.dismiss"),subscriptions:o.eligibleSubscriptionUpgrades,upsellReason:"DailyLimit",disabledReason:o.disabledReason??""});return}const{eligibleSubscriptionUpgrades:s}=o;let a;s.includes("m365-personal")?a="proSubscription.modal.featureLimitReached.podcast.subtitleFree":s.includes("m365-premium")?a="proSubscription.modal.featureLimitReached.podcast.subtitleUpgradable":a="proSubscription.modal.featureLimitReached.podcast.subtitleIneligible",t({allowUpsell:!0,title:e("proSubscription.modal.featureLimitReached.podcast.title"),subtitle:e(a),payflowEntryPoint:"PodcastLimit",confirmButton:e("actions.proSubscription.subscribeToPro"),dismissButton:e("common.dismiss"),subscriptions:o.eligibleSubscriptionUpgrades,upsellReason:"DailyLimit"})},[o,t,e,n])}function e0e(){const{t:e}=Z(),{handleFeatureUpsell:t,handleFeatureLimitReached:n}=L0(),o=Gd();return l.useCallback(()=>{if(o.disabledReason??o.eligibleSubscriptionUpgrades.length===0){n({allowUpsell:!1,title:e("proSubscription.modal.featureLimitReached.video.title"),subtitle:e("proSubscription.modal.featureLimitReached.video.subtitleIneligible"),payflowEntryPoint:"VideoGenLimit",dismissButton:e("common.dismiss"),subscriptions:o.eligibleSubscriptionUpgrades,upsellReason:"DailyLimit",disabledReason:o.disabledReason??""});return}const{eligibleSubscriptionUpgrades:s}=o;let a;s.includes("m365-personal")?a="proSubscription.modal.featureLimitReached.video.subtitleFree":s.includes("m365-premium")?a="proSubscription.modal.featureLimitReached.video.subtitleUpgradable":a="",t({allowUpsell:!0,title:e("proSubscription.modal.featureLimitReached.video.title"),subtitle:e(a),payflowEntryPoint:"VideoGenLimit",confirmButton:e("actions.proSubscription.subscribeToPro"),dismissButton:e("common.dismiss"),subscriptions:o.eligibleSubscriptionUpgrades,upsellReason:"DailyLimit"})},[o,t,e,n])}function Yk(){const{getSortedConnectors:e}=Xc(),[t]=e(),[n,o]=l.useState(!1),[s,a]=l.useState(null),r=l.useMemo(()=>t.find(p=>p.type==="one-drive")?.status==="ready",[t]),i=l.useCallback(()=>{r&&o(!0)},[r]),d=l.useCallback(p=>{a(p)},[a]),m=l.useCallback(()=>{o(!1)},[o]);return{isOneDriveFilePickerOpen:n,setIsOneDriveFilePickerOpen:o,pickedOneDriveItems:s,setPickedOneDriveItems:a,oneDriveConnectorReady:r,selectOneDriveFile:i,onPickCallback:d,onCloseCallback:m}}const k2="create",t0e="composer-create-button";function n0e(e){const{disabled:t=!1,onSelectFile:n,onSelectUserOpenedTabs:o,onTakeScreenshot:s,onSelectOneDriveFile:a,uploadButtonDisabled:r}=e,i=M(vd),d=M(yd),m=M(Cd),p=M(Er),h=M(Na),g=Zt(),y=M(bd),b=Dt(),C=G(Us),T=G(yT),S=X1e(),E=Q1e(),I=e0e(),w=Bn("connector")&&p.length>0,P=Zk({remainingPodcastGeneration:i,remainingResearchReportGeneration:d,remainingVideoGeneration:m,isUpgradedUser:y}),{oneDriveConnectorReady:D}=Yk(),L=l1(),{shouldAskForConfirmation:j,onOpen:U}=P0(),$=Bw(),K=l.useRef($),X=l.useRef(!1);l.useEffect(()=>{K.current.length>0&&(X.current=!0),K.current=$},[$]);const{setComposerCreateModeWithPrefill:ne}=Z1e(),me=l.useCallback(ye=>{switch(ye){case"image":ne("image");break;case"page":ne("page");break;case"homeworkHelper":Ar("homeworkHelper"),T(!0);break;case"podcast":if(i===0){b?S():C({isOpen:!0,scenario:"podcast",reason:"createPodcast"});return}ne("podcast");break;case"researchReport":if(d===0){b?E():C({isOpen:!0,scenario:"researchReport",reason:"createResearchReport"});return}ne("researchReport");break;case"quiz":ne("quiz");break;case"actions":ne("actions");break;case"video":if(m===0){I();return}ne("video");break;default:ne(null);break}},[ne,T,b,i,d,m,C,S,E,I]),Se=l.useCallback(ye=>{if(ye==="create")return;const Ie=Lw(ye);if(Ie&&j&&!eh(g,Ie)){U(Ie,()=>{me(ye)});return}me(ye)},[g,U,j,me]),ge=l.useCallback(()=>{Ar(null),Td(),hn(Ft())},[]);l.useEffect(()=>{$.length===0&&X.current&&L!==null&&g!=="research"&&g!=="computerUse"&&g!=="study"&&ge()},[$,ge,g,L]);const ve=!!s||!!o||w,Pe=P.length>1||ve,Me=!Bn("uploadFile");return c.jsx(k0,{items:P,onSelect:Se,value:L??k2,defaultValue:k2,onReset:ge,disabled:t,onMenuClick:()=>de({source:"composerCreateButton",pageName:"chatPage"}),alwaysShowDefault:!0,renderHeader:({closePopover:ye,focusRef:Ie})=>h||Me?null:c.jsxs(c.Fragment,{children:[c.jsx(I1e,{onSelectFile:He=>{ye(He),n()},uploadButtonDisabled:r,focusRef:Ie,onSelectOneDriveFile:a&&D?()=>{a()}:void 0}),Pe&&c.jsx(es,{verticalMargin:!1,className:"my-1.5"})]}),renderFooter:({closePopover:ye})=>c.jsxs(c.Fragment,{children:[ve&&c.jsx(es,{verticalMargin:!1,className:"my-1.5"}),s&&c.jsx(V1e,{onTakeScreenshot:Ie=>{ye(Ie),s()}}),o&&c.jsx(S1e,{onSelectUserOpenedTabs:Ie=>{ye(Ie),o()}}),w&&c.jsx(j1e,{closeDropdown:ye})]}),floatingOffset:{mainAxis:4,crossAxis:-10}})}function hs(e,t){return n=>{L1e(e,n),e==="podcast"&&t===0?Hm({entryPoint:"ComposerV4",featureName:"Podcast"}):e==="researchReport"&&t===0?Hm({entryPoint:"ComposerV4",featureName:"DeepResearch"}):e==="video"&&t===0&&Hm({entryPoint:"ComposerV4",featureName:"Video"})}}function gs(e,t){return n=>{O1e(e,n),e==="podcast"&&t===0?zm({entryPoint:"ComposerV4",featureName:"Podcast"}):e==="researchReport"&&t===0?zm({entryPoint:"ComposerV4",featureName:"DeepResearch"}):e==="video"&&t===0&&zm({entryPoint:"ComposerV4",featureName:"Video"})}}function Zk({remainingPodcastGeneration:e,remainingResearchReportGeneration:t,remainingVideoGeneration:n,isUpgradedUser:o}){const s=Bn("podcast"),a=Bn("researchReport"),r=Bn("quiz"),i=Bn("image"),d=Bn("homeworkHelper"),m=Dt(),p=q("video-gen")&&m,h=Bn("page"),{t:g}=Z("translation",{keyPrefix:"composer.create"});return l.useMemo(()=>{const b={key:"create",title:g("buttonTitle"),icon:c.jsx(St,{url:H1e,className:"size-6"}),hideButtonTitle:!0,id:t0e,testId:"composer-create-button",onImpression:hs(null),beforeClick:gs(null),isIconEnabledInButton:!0},C={key:"image",title:g("image.title"),icon:c.jsx(St,{url:G1e,className:"size-5"}),testId:"composer-create-image-button",onImpression:hs("image"),beforeClick:gs("image")};function T(){return{key:"podcast",title:g("podcast.title"),ariaLabel:e!==null&&!o?g("podcast.ariaLabelWithRemainingCalls",{remainingCalls:e.toString()}):g("podcast.title"),icon:c.jsx(St,{url:W1e,className:"size-5"}),testId:"composer-create-podcast-button",onImpression:hs("podcast",e),beforeClick:gs("podcast",e),tags:e!==null&&!o?[{label:g("podcast.remainingCalls",{remainingCalls:e.toString()}),color:e>0?"neutral":"accent"}]:void 0}}function S(){return{key:"researchReport",title:g("researchReport.title"),ariaLabel:t!==null&&!o?g("researchReport.ariaLabelWithRemainingCalls",{remainingCalls:t.toString()}):g("researchReport.title"),icon:c.jsx(St,{url:$1e,className:"size-5"}),testId:"composer-create-research-report-button",onImpression:hs("researchReport",t),beforeClick:gs("researchReport",t),tags:t!==null&&!o?[{label:g("researchReport.remainingCalls",{remainingCalls:t.toString()}),color:t>0?"neutral":"accent"}]:void 0}}function E(){return{key:"quiz",title:g("quiz.title"),icon:c.jsx(St,{url:Y1e,className:"size-5"}),testId:"composer-create-quiz-button",onImpression:hs("quiz"),beforeClick:gs("quiz")}}function I(){return{key:"page",title:g("page.title"),icon:c.jsx(St,{url:K1e,className:"size-5"}),testId:"composer-create-page-button",onImpression:hs("page"),beforeClick:gs("page")}}function x(){return{key:"video",title:g("video.title"),ariaLabel:n!==null&&!o?g("video.ariaLabelWithRemainingCalls",{remainingCalls:n.toString()}):g("video.title"),icon:c.jsx(St,{url:q1e,className:"size-5"}),testId:"composer-create-video-button",onImpression:hs("video",n),beforeClick:gs("video",n),tags:n!==null&&!o?[{label:g("video.remainingCalls",{remainingCalls:n.toString()}),color:n>0?"neutral":"accent"}]:void 0}}function w(){return{key:"homeworkHelper",title:g("homeworkHelper.title"),icon:c.jsx(St,{url:z1e,className:"size-5"}),hideButtonTitle:!0,testId:"composer-homework-helper-button",onImpression:hs("homeworkHelper"),beforeClick:P=>{gs("homeworkHelper")(P)},isIconEnabledInButton:!0}}return[b,i?C:void 0,d?w():void 0,h?I():void 0,p?x():void 0,a?S():void 0,s?T():void 0,r?E():void 0].filter(P=>P!==void 0)},[g,i,h,a,s,r,p,d,e,o,t,n])}function o0e(e){const{t}=Z(),{createMode:n,onReset:o}=e,s=t(`composer.create.${n}.selectedText`);return c.jsxs(ee,{title:s,"aria-label":s,variant:"rect",size:"36-sm",color:"composer-selected",className:O("h-9 select-none gap-1 rounded-2xl border border-black/8 pe-3.5 ps-2.5 dark:border-white/8"),onClick:o,testId:`composer-${n}-mode-selected`,children:[c.jsx(St,{url:Vk,className:"size-3.5"}),c.jsx("span",{className:"text-sm",children:s})]})}const s0e=e=>e==="coco"?{headerI18nKey:"composer.chatModes.coco.newChatConfirmationModal.switchToCocoHeader",descriptionI18nKey:"composer.chatModes.coco.newChatConfirmationModal.switchToCocoDescription"}:{headerI18nKey:"composer.chatModes.coco.newChatConfirmationModal.switchFromCocoHeader",descriptionI18nKey:"composer.chatModes.coco.newChatConfirmationModal.switchFromCocoDescription"};function a0e(){const{t:e}=Z(),{onClose:t,onConfirm:n,isOpen:o,targetMode:s}=P0(),{headerI18nKey:a,descriptionI18nKey:r}=s0e(s),i=e(a),d=e("composer.chatModes.coco.newChatConfirmationModal.continueButtonText"),m=e("composer.chatModes.coco.newChatConfirmationModal.stayHereButtonText");return c.jsxs(_s,{isOpen:o,headerText:i,className:"w-full max-w-[448px]",children:[c.jsx("p",{children:c.jsx(mn,{i18nKey:r,components:{bold:c.jsx("strong",{}),br:c.jsx("br",{})}})}),c.jsxs("div",{className:"mt-5 flex flex-col gap-2",children:[c.jsx(ee,{title:d,color:"strong",size:"56-xl",variant:"rect",className:"w-full",onClick:n,children:d}),c.jsx(ee,{title:m,color:"subtle-dimmed",size:"56-xl",variant:"rect",className:"w-full",onClick:t,children:m})]})]})}function r0e(){const[e,t]=l.useState(!1);return l.useEffect(()=>{async function n(){const{uiOverrides:{showScreenshotButton:o=()=>Promise.resolve(!1)}={}}=J.instance().config(),s=await o();t(s)}n().catch(()=>{})},[]),e}const i0e=new Set(["research"]);function c0e(){const{t:e}=Z(),{getAvailableConnectorsCount:t}=Xc(),n=t(),o=Zt(),s=i0e.has(o),a=n>0,r=s||a,i=s&&!a;return c.jsx(It,{children:r&&c.jsx(he.div,{initial:{...je},animate:{...rt},exit:{...je},transition:{duration:.1,ease:"easeInOut"},children:c.jsx(nm,{color:"default",renderTrigger:({openPopover:d})=>c.jsx(ee,{title:e("connector.composer.buttonTitle"),"aria-label":e("connector.composer.buttonTitle"),variant:"rect",size:"36-sm",color:"subtle-dimmed",className:"h-9 select-none gap-1 rounded-2xl border border-black/8 dark:border-white/8",onClick:d,children:c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx(zk,{className:"size-6"}),i&&c.jsx("span",{className:"text-sm",children:e("connector.composer.buttonTitle")}),c.jsx(It,{mode:"popLayout",initial:!1,children:a&&c.jsx(he.span,{className:"min-w-4 rounded-full bg-background-700 px-1 text-foreground-100 text-xs-medium",initial:{...je,scale:.5},animate:{...rt,scale:1},exit:{...je,scale:.5},transition:Eee,children:n})}),c.jsx(po,{className:"size-4 rotate-90"})]})}),renderSurface:({closePopover:d})=>c.jsx("div",{className:"flex flex-col",children:c.jsx(Kk,{triggerSource:"composer",closePage:d})}),containerClassNames:{surface:"p-1.5 border-white/25 dark:border-stroke-400/25 shadow-tinted-xl"},placement:"bottom-start",floatingOffset:{mainAxis:4,crossAxis:-4}})})})}const l0e=["chat","smart"];function u0e(e){const{onSelectFile:t,onSelectUserOpenedTabs:n,onTakeScreenshot:o,onSelectOneDriveFile:s,uploadButtonDisabled:a,disabled:r=!1}=e,i=l1(),d=Bn("connector"),m=M(vd),p=M(yd),h=M(Cd),g=M(bd),b=Zk({remainingPodcastGeneration:m,remainingResearchReportGeneration:p,remainingVideoGeneration:h,isUpgradedUser:g}).find(D=>D.key===i),C=l.useCallback(()=>{Ar(null),Td(),hn(Ft())},[]),T=r0e(),S=i1(),E=Zt(),I=q("dr-connectors"),x=[...l0e,...I?["research"]:[]],w=i!==null&&b?c.jsx(o0e,{createMode:i,onReset:C}):!S&&c.jsx(v1e,{disabled:r}),P=d&&x.includes(E);return c.jsxs(c.Fragment,{children:[c.jsx(n0e,{disabled:r,onSelectFile:t,onSelectOneDriveFile:s,onSelectUserOpenedTabs:n,onTakeScreenshot:T?o:void 0,uploadButtonDisabled:a}),w,P&&c.jsx(c0e,{}),c.jsx(J9,{children:c.jsx(a0e,{})})]})}function d0e(){const e=js(),t=M(io),n=M(a1);return e&&!t&&n}function m0e(){const e=M(Bc),n=Zt()==="computerUse",{userInput:o}=Fw(),s=M(zc),a=q("attachment-suggestions");l.useEffect(()=>{e?yi("autosuggest"):n?yi("actions-autosuggest"):a&&!o&&s.length>0?yi("file-upload-autosuggest"):yi("starter-prompts")},[e,o,n,a,s])}function p0e(){const e=G(Yt),[t,n]=Le(Us),o=M(LK),s=M(lT),a=Gc();l.useEffect(()=>{o&&(e(a?"prompt-3p-sign-in":"prompt-sign-in"),t.isOpen&&n({...t,isOpen:!1,reason:t.reason??(s?"overTurnLimit":null)}),_i(!0))},[e,n,o,t,a,s])}function f0e(){const e=G(Yt),t=M(Kee),n=Vt(),o=Zc(),s=aA(),a=ao(n),r=n.endsWith("/daily"),i=n.startsWith("/chats")&&!a,d=r||o,m=s?.type==="computerUse"&&i,p=m&&!C1(s.status),h=m&&lA(s);l.useEffect(()=>{e(d?"daily-briefing-player":h?"safety-risk-card":p?"computer-use-task-closed":t?"dialog":null)},[e,p,h,d,t])}function h0e(){const e=q("remove-qr");l.useEffect(()=>{let t=Ft();t=WA()??Ft(),hn(t)},[e])}function g0e(){p0e(),f0e(),h0e(),m0e()}const Jk=typeof document<"u"?l.useLayoutEffect:l.useEffect;var Zs={},fi={},Js={},P2;function Qk(){if(P2)return Js;P2=1,Object.defineProperty(Js,"__esModule",{value:!0}),Js.Node=Js.NodeType=void 0;var e;(function(a){a[a.element=1]="element",a[a.text=3]="text"})(e||(Js.NodeType=e={}));let t=class{constructor({nodeType:r,namespace:i,selfCloseTag:d,text:m,nodeName:p,childNodes:h,parentNode:g,attributes:y}){this.namespace=i||null,this.nodeType=r,this.isSelfCloseTag=!!d,this.text=m||null,this.nodeName=r===e.element?p:"#text",this.childNodes=h||[],this.parentNode=g,this.attributes=y||[]}get firstChild(){return this.childNodes[0]||null}get lastChild(){return this.childNodes[this.childNodes.length-1]||null}get innerHTML(){return this.childNodes.reduce((r,i)=>r+(i.nodeType===e.text?i.text:i.outerHTML),"")}get outerHTML(){if(this.nodeType===e.text)return this.textContent;const r=s(this.attributes),i=`<${this.nodeName}${r.length?" ":""}${r}${this.isSelfCloseTag?"/":""}>`;if(this.isSelfCloseTag)return i;const d=this.childNodes.map(p=>p.outerHTML).join(""),m=`</${this.nodeName}>`;return[i,d,m].join("")}get textContent(){return this.nodeType===e.text?this.text:this.childNodes.map(r=>r.textContent).join("").replace(/\x20+/g," ")}getAttribute(r){const i=this.attributes.find(d=>d.name===r);return i?i.value:null}getElementsByTagName(r){return n(this,i=>i.nodeName.toUpperCase()===r.toUpperCase())}getElementsByClassName(r){const i=new RegExp(`^(.*?\\s)?${r}(\\s.*?)?$`);return n(this,d=>!!(d.attributes.length&&i.test(d.getAttribute("class")||"")))}getElementsByName(r){return n(this,i=>!!(i.attributes.length&&i.getAttribute("name")===r))}getElementById(r){return o(this,i=>!!(i.attributes.length&&i.getAttribute("id")===r))}};Js.Node=t,t.ELEMENT_NODE=e.element,t.TEXT_NODE=e.text;function n(a,r){return a.nodeType===e.text?[]:a.childNodes.reduce((i,d)=>d.nodeType!==e.text&&r(d)?[...i,d,...n(d,r)]:[...i,...n(d,r)],[])}function o(a,r){for(let i=0,d=a.childNodes.length;i<d;i++){const m=a.childNodes[i];if(r(m))return m;const p=o(m,r);if(p)return p}return null}function s(a){return a.map(r=>r.name+(r.value?`="${r.value}"`:"")).join(" ")}return Js}var hi={},M2;function v0e(){if(M2)return hi;M2=1,Object.defineProperty(hi,"__esModule",{value:!0}),hi.NodeAttribute=void 0;let e=class{constructor({name:n,value:o}){this.name=n,this.value=o}};return hi.NodeAttribute=e,hi}var R2;function N2(){if(R2)return fi;R2=1,Object.defineProperty(fi,"__esModule",{value:!0}),fi.Dom=void 0;const e=Qk(),t=v0e(),n=/(<\/?(?:[a-z][a-z0-9]*:)?[a-z][a-z0-9-_.]*?[a-z0-9]*\s*(?:\s+[a-z0-9-_:]+(?:=(?:(?:'[\s\S]*?')|(?:"[\s\S]*?")))?)*\s*\/?>)|([^<]|<(?![a-z/]))*/gi,o=/\s[a-z0-9-_:]+\b(\s*=\s*('|")[\s\S]*?\2)?/gi,s=/(\s[a-z0-9-_:]+\b\s*)(?:=(\s*('|")[\s\S]*?\3))?/gi,a=/^<[a-z]/,r=/\/>$/,i=/^<\//,d=/^[^<]/,m=/<\/?((?:([a-z][a-z0-9]*):)?(?:[a-z](?:[a-z0-9-_.]*[a-z0-9])?))/i,p=/^('|")|('|")$/g,h=/^(?:area|base|br|col|command|embed|hr|img|input|link|meta|param|source)/i;let g=class{constructor(P){this.rawHTML=P}find(P,D){const L=y(this.rawHTML,P,D);return D?L[0]||null:L}getElementsByClassName(P){const D=new RegExp(`^(.*?\\s)?${P}(\\s.*?)?$`);return this.find(L=>!!(L.attributes.length&&D.test(L.getAttribute("class")||"")))}getElementsByTagName(P){return this.find(D=>D.nodeName.toUpperCase()===P.toUpperCase())}getElementById(P){return this.find(D=>D.getAttribute("id")===P,!0)}getElementsByName(P){return this.find(D=>D.getAttribute("name")===P)}getElementsByAttribute(P,D){return this.find(L=>L.getAttribute(P)===D)}};fi.Dom=g;function y(w,P,D=!1){const L=b(w),j=[];for(const U of L)if(U&&P(U)&&(j.push(U),D))return j;return j}function*b(w){const P=T(w);let D=null;for(let L=0,j=P.length;L<j;L++){const U=P[L];D=S(U,D)||D,C(D,U)&&(yield D,D=D.parentNode)}for(;D;)yield D,D=D.parentNode}function C(w,P){if(!P)return!1;const D=i.test(P),[,L]=P.match(m)||[];return D&&w.nodeName===L||w.isSelfCloseTag||w.nodeType===e.NodeType.text}function T(w){return w.match(n)||[]}function S(w,P){const D=d.test(w),L=a.test(w);return D?x(w,P):L?E(w,P):null}function E(w,P){var D;const[,L,j]=w.match(m)||[],U=r.test(w)||h.test(L),$=I(w),K=new e.Node({nodeType:e.NodeType.element,nodeName:L,namespace:j,attributes:$,childNodes:[],parentNode:P,selfCloseTag:U});return(D=P?.childNodes)===null||D===void 0||D.push(K),K}function I(w){return(w.match(o)||[]).map(P=>{s.lastIndex=0;const D=s.exec(P)||[],[,L="",j=""]=D;return new t.NodeAttribute({name:L.trim(),value:j.trim().replace(p,"")})})}function x(w,P){var D;const L=new e.Node({nodeType:e.NodeType.text,nodeName:"#text",text:w,parentNode:P});return(D=P?.childNodes)===null||D===void 0||D.push(L),L}return fi}var L2;function y0e(){return L2||(L2=1,function(e){var t=Zs&&Zs.__createBinding||(Object.create?function(a,r,i,d){d===void 0&&(d=i);var m=Object.getOwnPropertyDescriptor(r,i);(!m||("get"in m?!r.__esModule:m.writable||m.configurable))&&(m={enumerable:!0,get:function(){return r[i]}}),Object.defineProperty(a,d,m)}:function(a,r,i,d){d===void 0&&(d=i),a[d]=r[i]}),n=Zs&&Zs.__exportStar||function(a,r){for(var i in a)i!=="default"&&!Object.prototype.hasOwnProperty.call(r,i)&&t(r,a,i)};Object.defineProperty(e,"__esModule",{value:!0}),e.parseFromString=void 0;const o=N2();function s(a){return new o.Dom(a)}e.parseFromString=s,n(N2(),e),n(Qk(),e)}(Zs)),Zs}var D2=y0e();function Xk(e){const t=[];let n="",o=!1;for(const s of e)s===" "||s===`
`?o=!0:o&&(t.push(n),n="",o=!1),n+=s;return n.length>0&&t.push(n),t}function c3e(e){const n=D2.parseFromString(`<html>${e}</html>`).getElementsByTagName("html")[0];let o=[];for(const s of n.childNodes)s.nodeType===D2.NodeType.text?s.textContent&&(o=o.concat(Xk(s.textContent))):o.push(s.outerHTML);return o}function C0e(e){return e===" "||e===`
`||e==="	"}function l3e(e,t,n={}){if(e.length<=t)return e;function o(i){const d=i.trim();return n.ellipsis?`${d}...`:d}const s=e.indexOf(`
`,0);if(s>=0&&s<t){const i=e.slice(0,s);return o(i)}let a=t;for(;a>0;){const i=e[a];if(i&&!C0e(i))a-=1;else break}let r=e.slice(0,t);return a>0&&(r=e.slice(0,a)),o(r)}function S0e(e){return!!(e&&e.trim().length>0)}function O2(e){return!S0e(e)}function b0e(e,t,n){const o=t+n,s=l.useRef({autocompleteValue:n,userInputValue:o});return s.current={autocompleteValue:n,userInputValue:o},Jk(()=>{!e.current||O2(n)||e.current.updateSelectionRange(t.length,t.length+n.length)},[e,t,n]),l.useEffect(()=>{const a=()=>{if(!e.current)return;const{autocompleteValue:d,userInputValue:m}=s.current;O2(d)||e.current.updateInputValue(()=>m)},r=e.current?.getTextAreaRef().current,i=()=>{!e.current||!r||document.activeElement===r&&r.selectionStart===r.selectionEnd&&a()};return document.addEventListener("selectionchange",i),r?.addEventListener("focusout",a),()=>{document.removeEventListener("selectionchange",i),r?.removeEventListener("focusout",a)}},[e]),o}const e4=async(e,t)=>{B(ia)&&e?.();try{await Lk(ia,n=>!n)}catch{}t?.()},u3e=({onTurnstileDisplaying:e,onTurnstileClosed:t})=>l.useCallback(async()=>{await e4(e,t)},[e,t]);function I0e(e){return e.filter(t=>t.type!=="miniShowroom").filter(t=>t.type!=="mainShowroom"||t.action).map(t=>{let n="";return t.type==="mainShowroom"?n=t.action?.url??"":t.type==="product"?n=t.offer.link.url:n=t.link.url,{type:t.type,rLink:n}})}function E0e(e){return I0e(e).some(({rLink:t})=>t==="")}function T0e(e){return e.map(t=>t.author==="ai"?{...t,content:t.content.filter(n=>{if(n.type==="card"&&n.card.type==="ads"){const{ads:o}=n.card;return o&&!E0e(o)}return!0})}:t)}function w0e(e){const t=e[0]?.createdAt;if(!t)return;const n=new Date(t).getTime();if(!Number.isNaN(n))return n.toString()}function t4(){const e=VA(),t=M(Te),n=M(Rg),o=M(Rt),s=w0e(o?.history??[]);return n0({queryKey:["history",t],queryFn:async r=>{const{pageParam:i}=r,{url:d,args:m,conversationId:p}=i,h=await pt(d,U5,{query:{...m,"api-version":"2"},analytics:{anonymousPath:"/conversations/*/history"},parseOptions:{safe:!0}}).then(g=>g.data);if(h.results.length>0){const g=h.results,y=Dae(g),b=Pk(y),C=T0e(b);e(p,T=>{T.length===0&&Wz(o,C.at(0)?.createdAt),C.reverse(),T.unshift(...C)})}return h},initialPageParam:{url:t?`/conversations/${t}/history`:"",conversationId:t??"",...s?{args:{cursor:s}}:{}},getNextPageParam:r=>r.next&&t?{url:`/conversations/${t}/history`,args:{cursor:r.next},conversationId:t}:null,enabled:!!t&&!n?.prompt})}function A0e(){const e=!it("kill-cf-turnstile");return q("cf-turnstile-voice")&&e}function x0e(e){const[t,n]=l.useState("not_started"),o=l.useRef(null),s=l.useCallback(()=>{try{let r=o.current;n("not_started"),r?r.currentTime=0:(r=new Audio(e),o.current=r,r.addEventListener("ended",()=>{n("finished"),o.current&&(o.current.src=""),o.current=null},{once:!0})),n("playing"),r.play()}catch{}},[e,n]),a=l.useCallback(()=>{n("not_started")},[n]);return{playSound:s,playState:t,resetPlayState:a}}function _0e(){}function k0e({inputValue:e,handleChange:t,className:n=""}){const[o,s]=l.useState(""),{t:a}=Z();return it("kill-free-form-text")?null:c.jsx(x0,{disabled:!1,className:O(n,"max-h-[8rem] grow-0 basis-[8rem] !items-start overflow-auto rounded-xl border-2 border-foreground-700 bg-black/5 px-0.5"),inputBoxClassName:"placeholder:text-foreground-550 dark:placeholder:text-foreground-550",inputValue:e,characterLimit:xR,autoFocus:!1,noDesktopAutoFocus:!0,setInput:i=>{t(i)},placeholder:a("chat.feedback.placeholder"),errorMessage:o,setError:s,onEnter:_0e,isMultiLines:!0})}function D0(e){const{feedbackOptions:t,onSubmit:n,shouldHideTextbox:o=!1}=e,{t:s}=Z(),[a,r]=l.useState(new Set),[i,d]=l.useState(""),m=a.size===0,p=g=>{r(y=>{const b=new Set(y);return a.has(g)?b.delete(g):b.add(g),b})},h=async()=>{n(a,i),r(new Set)};return t?c.jsxs("div",{className:"flex flex-col gap-2 pt-2",children:[c.jsx("ul",{role:"list",className:"mt-0 flex list-none flex-col gap-4",children:t.map((g,y)=>c.jsx("li",{children:c.jsx($_,{label:g.label,setChecked:()=>p(g.type),checked:a.has(g.type),spatialNavigationAutofocus:y===0})},g.type))}),m||o?null:c.jsx(k0e,{inputValue:i,handleChange:d}),c.jsx(ee,{title:s("chat.feedback.submitFeedbackButton"),size:"48-lg",color:"strong",className:"mt-4 max-h-12",disabled:m,onClick:h,children:s("chat.feedback.submitFeedbackButton")})]}):null}function n4(e){const{onSubmit:t}=e,{t:n}=Z(),[o,s]=l.useState(!1),a=async r=>{s(!0),await t(r),s(!1)};return c.jsxs("div",{children:[c.jsx("p",{children:n("voice.feedback.reviewReasonV2")}),c.jsx(ee,{title:n("voice.feedback.okay"),size:"48-lg",color:"strong",className:"mt-4 max-h-12 w-full",disabled:o,onClick:()=>a(!0),children:n("voice.feedback.okay")}),c.jsx(ee,{title:n("voice.feedback.noThanks"),size:"48-lg",color:"default",className:"mt-3 w-full",onClick:()=>a(!1),children:n("voice.feedback.noThanks")})]})}function Ep({conversationId:e,callId:t,status:n,durationMs:o,fileSizeBytes:s,scenario:a,errorCode:r,errorMessage:i,serverResponseCallId:d}){R.trackEvent({name:"system",data:{eventName:"CopilotUploadDiagnosticAudio",eventInfo_conversationId:e,eventInfo_callId:t,eventInfo_duration:o,eventInfo_scenario:a,eventInfo_errorCode:r,eventInfo_errorMessage:i,eventInfo_customData:JSON.stringify({status:n,fileSize:s,serverCallId:d})}})}async function P0e(e,t){const n=new FormData;n.append("file",e,`${t}-audio.wav`);try{const o=await pt(`/conversations/${t}/upload-diagnostic-audio`,SV,{options:{method:"POST",body:n},analytics:{anonymousPath:"/conversations/*/upload-diagnostic-audio"}}).then(s=>s.data);if("errorCode"in o)throw new Error(o.errorCode);return o.callId}catch(o){throw console.error("Error uploading audio",o),o}}const M0e=5*60*1e3;class R0e{firstEventProcessed=null;events=[];aiMessageNeedsPadding=!1;aiPcmParts=[];totalAIBytes=0;userPcmParts=[];totalUserBytes=0;voiceCallId=null;scenario=void 0;conversationId=null;reset(){this.firstEventProcessed=null,this.events=[],this.aiMessageNeedsPadding=!1,this.aiPcmParts=[],this.totalAIBytes=0,this.userPcmParts=[],this.totalUserBytes=0,this.conversationId=null,this.voiceCallId=null,this.scenario=void 0}setCallId(t){this.voiceCallId=t}setScenario(t){this.scenario=t}recordEvent(t){const n=Date.now();this.firstEventProcessed??=n;const o=n-this.firstEventProcessed;o>M0e||this.events.push({...t,timestamp:o})}async download(){}async upload(){if(!W("voice-upload-diagnostic-audio")||!this.conversationId)return;const t={conversationId:this.conversationId,callId:this.voiceCallId??"",scenario:this.scenario,status:"start"},n=performance.now();try{this.processEvents();const o=this.combineTracks();t.fileSizeBytes=o.size,Ep(t);const s=await P0e(o,this.conversationId);Ep({...t,status:"success",durationMs:Math.round(performance.now()-n),serverResponseCallId:s}),this.reset()}catch(o){Ep({...t,status:"fail",durationMs:Math.round(performance.now()-n),errorMessage:o instanceof Error?o.message:"Unknown error"})}}saveFile(t,n){const o=URL.createObjectURL(n),s=document.createElement("a");s.href=o,s.download=t,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(o)}processEvents(){for(const t of this.events)t.event==="userAudio"?this.addUserAudioData(t.audio):t.event==="audioEnd"?this.trimAiToUser():t.event==="startMessage"?this.onNewAiMessage():t.event==="audio"?this.addAIAudioData(t.audio):t.event==="interruptAudio"&&this.trimAiToUser()}onNewAiMessage(){this.aiMessageNeedsPadding=!0}padAiAudioData(){if(!this.aiMessageNeedsPadding)return;this.aiMessageNeedsPadding=!1;const t=2;let n=this.totalUserBytes-this.totalAIBytes;if(n<=0)return;n%t!==0&&(n+=t-n%t);const o=new Uint8Array(n);this.aiPcmParts.push(o),this.totalAIBytes+=n}trimAiToUser(){const t=this.totalUserBytes;let n=this.totalAIBytes-t;if(!(n<=0))for(let o=this.aiPcmParts.length-1;o>=0&&n>0;o-=1){const s=this.aiPcmParts[o];if(s)if(s.length<=n)n-=s.length,this.totalAIBytes-=s.length,this.aiPcmParts.pop();else{const a=s.length-n;this.aiPcmParts[o]=s.subarray(0,a),this.totalAIBytes-=n,n=0}}}addAIAudioData(t){this.padAiAudioData();const n=atob(t),o=new Uint8Array(n.length);for(let s=0;s<n.length;s+=1)o[s]=n.charCodeAt(s);this.aiPcmParts.push(o),this.totalAIBytes+=o.length}addUserAudioData(t){const n=atob(t),o=new Uint8Array(n.length);for(let s=0;s<n.length;s+=1)o[s]=n.charCodeAt(s);this.userPcmParts.push(o),this.totalUserBytes+=o.length}bytesToWavBlob(t,n,o,s){const a=t.length,r=new ArrayBuffer(44),i=new DataView(r),d=(g,y)=>{let b=0;for(const C of y)i.setUint8(g+b,C.charCodeAt(0)),b+=1};d(0,"RIFF"),i.setUint32(4,36+a,!0),d(8,"WAVE"),d(12,"fmt "),i.setUint32(16,16,!0),i.setUint16(20,1,!0),i.setUint16(22,o,!0),i.setUint32(24,n,!0);const m=Math.trunc(o*s/8);i.setUint32(28,n*m,!0),i.setUint16(32,m,!0),i.setUint16(34,s,!0),d(36,"data"),i.setUint32(40,a,!0);const p=new Uint8Array(44+a);return p.set(new Uint8Array(r),0),p.set(t,44),new Blob([p],{type:"audio/wav"})}combineTracks(){const o=Math.trunc(2),s=this.concatParts(this.userPcmParts,this.totalUserBytes),a=this.concatParts(this.aiPcmParts,this.totalAIBytes),r=Math.floor(s.length/o),i=Math.floor(a.length/o),d=Math.max(r,i),m=new Int16Array(s.buffer,s.byteOffset,r),p=new Int16Array(a.buffer,a.byteOffset,i),h=new Int16Array(d*2);for(let g=0;g<d;g+=1){const y=g<r?m[g]:0;typeof y=="number"&&(h[g*2]=y);const b=g<i?p[g]:0;typeof b=="number"&&(h[g*2+1]=b)}return this.bytesToWavBlob(new Uint8Array(h.buffer),24e3,2,16)}concatParts(t,n){const o=new Uint8Array(n);let s=0;for(const a of t)o.set(a,s),s+=a.length;return o}processTextLog(){let t=!1,n=`Audio Recorder Log for conversation ${this.conversationId}:

`;for(const o of this.events){const{event:s,timestamp:a}=o;if(s==="userAudio")continue;if(s==="audio"){t||(n+=`${a}ms  server-to-client  ai audio stream
`,t=!0);continue}t=!1,n+=`${a}ms  ${s==="audioEnd"||s==="audioStart"?"client-to-server":"server-to-client"}  ${s}`,s==="audioStartFailed"&&(n+=`  ${o.reason}`),n+=`
`}return n}}const tc=new R0e,fr=Object.freeze(Object.defineProperty({__proto__:null,AUDIO_RECORDER:tc},Symbol.toStringTag,{value:"Module"}));async function nh(e,t,n){try{await Nt({path:`/conversations/${e}/react`,args:{body:{[n]:t},analytics:{anonymousPath:"/conversations/*/react"}}})}catch{}}async function o4(e,t,n){try{await Nt({path:`/conversations/${e}/feedback`,args:{body:{types:Array.from(t),text:n},analytics:{anonymousPath:"/conversations/*/feedback"}}})}catch{}}const N0e="voice",L0e="appearance",D0e="vision";function O0(e){const{feedbackType:t="voice"}=e??{},n=M(Te),o=q1(),s=t==="vision",a=()=>s?{destination:D0e,telemetrySource:"visionFeedback",reactionTarget:"visionReaction"}:o?{destination:L0e,telemetrySource:"voiceFeedback",reactionTarget:"audioReaction"}:{destination:N0e,telemetrySource:"voiceFeedback",reactionTarget:"audioReaction"},{destination:r,telemetrySource:i,reactionTarget:d}=a(),m=M(Tr),p=G(Tr),h=G(UT),g=q("voice-upload-diagnostic-audio"),y=I=>{const x=Al.getCurrentOrLastCallId();R.trackEvent({name:"interaction",data:{eventName:"copilotClick",eventInfo_clickSource:"voiceConsentDialog",eventInfo_clickScenario:I,eventInfo_conversationId:n,...x&&{eventInfo_callId:x},eventInfo_clickDestination:r}})};return{sendPositiveFeedback:()=>{const I=Al.getCurrentOrLastCallId();R.trackEvent({name:"interaction",data:{eventName:"copilotClick",eventInfo_clickSource:i,eventInfo_clickScenario:"thumbsUp",eventInfo_conversationId:n,...I&&{eventInfo_callId:I},eventInfo_clickDestination:r}}),n&&nh(n,"thumbs-up",d),Ce.emit("feedback:ai-message-reaction","positive")},sendNegativeFeedback:()=>{const I=Al.getCurrentOrLastCallId();R.trackEvent({name:"interaction",data:{eventName:"copilotClick",eventInfo_clickSource:i,eventInfo_clickScenario:"thumbsDown",eventInfo_conversationId:n,...I&&{eventInfo_callId:I},eventInfo_clickDestination:r}}),n&&nh(n,"thumbs-down",d),m&&g&&tc.upload()},sendFeedbackOptions:async(I,x)=>{const w=Al.getCurrentOrLastCallId();R.trackEvent({name:"interaction",data:{eventName:"copilotClick",eventInfo_clickSource:i,eventInfo_clickScenario:"feedbackSubmit",eventInfo_conversationId:n,...w&&{eventInfo_callId:w},eventInfo_clickDestination:r,eventInfo_customData:JSON.stringify({selectedOptionsCount:I.size,feedbackTypes:[...I].join(",")})}}),n&&I.size>0&&o4(n,I,x)},handleReviewRequestShown:()=>{y("show")},handleReviewRequestSubmitted:async I=>{I?(p(!0),await tx({optInToVoiceTraining:!0}),g&&tc.upload()):h(!0),y(I?"allow":"disallow")}}}function O0e(e){const{type:t,setType:n}=e,{t:o}=Z(),s=M(fd),[a,r]=Le(Tr),i=q("voice-upload-diagnostic-audio"),d=q1(),{sendFeedbackOptions:m}=O0(),p=G(yt),h=async(b,C)=>{await m(b,C),a?(y(),i&&tc.upload()):n("review-request")},g=async b=>{b&&(r(!0),await tx({optInToVoiceTraining:!0}),i&&tc.upload()),y()},y=()=>{n(null),p(null)};return t==="feedback-options"?c.jsx(_s,{isOpen:!0,onClose:()=>y(),headerText:o("voice.feedback.chooseWhatHappened"),className:"z-[60] w-full max-w-[400px]",children:c.jsx(D0,{onSubmit:h,feedbackOptions:d?s?.appearance:s?.call})}):t==="review-request"?c.jsx(_s,{isOpen:!0,onClose:()=>y(),headerText:o("voice.feedback.canMicrosoftReview"),className:"z-[60] w-full max-w-[400px]",children:c.jsx(n4,{onSubmit:g})}):null}const U0=({title:e,titleId:t,...n})=>l.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.7939 22.5C13.4857 22.4999 14.1313 22.154 14.5151 21.5786L14.54 21.5405C15.3284 20.3578 15.7499 18.9687 15.75 17.5474C15.75 16.8701 15.6551 16.196 15.4673 15.5464L15.3809 15.2695L15.2915 15H19.0781C20.9676 15 22.5 13.4676 22.5 11.5781C22.5 11.3687 22.4811 11.1597 22.4429 10.9541L22.3975 10.749L20.6543 3.77197C20.3204 2.43673 19.12 1.50018 17.7437 1.5H10.6772C9.60719 1.5 8.55025 1.71953 7.57031 2.1416C7.16475 1.74558 6.61162 1.5 6 1.5H3.75C2.50736 1.5 1.5 2.50736 1.5 3.75V11.25C1.5 12.4926 2.50736 13.5 3.75 13.5H6C6.51972 13.5 6.9975 13.3228 7.37842 13.0269L8.92383 14.8799L9.10986 15.1128C10.0102 16.2948 10.5 17.7421 10.5 19.2334V20.2837C10.5 21.5073 11.4927 22.5 12.7163 22.5H12.7939ZM3.75 12C3.33579 12 3 11.6642 3 11.25V3.75C3 3.33579 3.33579 3 3.75 3H6C6.41421 3 6.75 3.33579 6.75 3.75V11.25C6.75 11.6642 6.41421 12 6 12H3.75ZM12.7163 21C12.3211 21 12 20.6789 12 20.2837V19.2334C12 17.4131 11.4012 15.6473 10.3022 14.2046L10.0767 13.9204L8.20752 11.6792C8.23439 11.5402 8.25 11.3969 8.25 11.25V3.75C8.25 3.6622 8.24221 3.5759 8.23242 3.49072C9.00588 3.16824 9.83642 3 10.6772 3H17.7437C18.4318 3.00018 19.0313 3.4691 19.1982 4.13672L20.9429 11.1123L20.9854 11.3438C20.9949 11.4214 21 11.4997 21 11.5781C21 12.6392 20.1392 13.5 19.0781 13.5H14.25C14.2397 13.5 14.2295 13.5025 14.2192 13.5029C14.1856 13.5043 14.152 13.5071 14.1182 13.5132C14.0986 13.5167 14.08 13.5229 14.061 13.5278C14.0452 13.532 14.0284 13.5328 14.0127 13.5381C14.0021 13.5416 13.9923 13.5473 13.9819 13.5513C13.9639 13.5582 13.9466 13.5664 13.9292 13.5747C13.9038 13.5868 13.8794 13.5997 13.856 13.6143C13.8409 13.6236 13.8263 13.6332 13.812 13.6436C13.7873 13.6614 13.7638 13.6802 13.7417 13.7007C13.73 13.7115 13.719 13.7228 13.708 13.7344C13.6878 13.7557 13.6698 13.7784 13.6523 13.8018C13.6421 13.8154 13.6309 13.8284 13.6216 13.8428C13.6055 13.8677 13.5921 13.8938 13.5791 13.9204C13.5434 13.993 13.5194 14.0713 13.5088 14.1548C13.5056 14.1796 13.5021 14.2043 13.5015 14.2295C13.5013 14.2363 13.5 14.2431 13.5 14.25C13.5 14.2653 13.502 14.2804 13.5029 14.2954C13.5038 14.31 13.5041 14.3247 13.5059 14.3394L13.5103 14.3628C13.5148 14.3928 13.5213 14.4219 13.5293 14.4507L13.5381 14.4873L13.957 15.7441L14.0845 16.1851C14.194 16.6302 14.25 17.0879 14.25 17.5474C14.2499 18.6726 13.9161 19.7722 13.292 20.7085L13.2671 20.7466C13.1614 20.9047 12.9841 20.9999 12.7939 21H12.7163Z"})),d3e=Object.freeze(Object.defineProperty({__proto__:null,default:U0},Symbol.toStringTag,{value:"Module"})),F0=({title:e,titleId:t,...n})=>l.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.7939 1.5C13.4857 1.50008 14.1313 1.84595 14.5151 2.42139L14.54 2.45947L14.8184 2.91211C15.4271 3.98985 15.7499 5.20889 15.75 6.45264C15.75 7.2266 15.6256 7.99622 15.3809 8.73047L15.2915 9H19.0781C20.9676 9 22.5 10.5324 22.5 12.4219C22.5 12.6313 22.4811 12.8403 22.4429 13.0459L22.3975 13.251L20.6543 20.228C20.3204 21.5633 19.12 22.4998 17.7437 22.5H10.6772C9.61047 22.5 8.55647 22.2823 7.5791 21.8628L7.57031 21.8584C7.16475 22.2544 6.61162 22.5 6 22.5H3.75C2.50736 22.5 1.5 21.4926 1.5 20.25V12.75C1.5 11.5074 2.50736 10.5 3.75 10.5H6C6.51972 10.5 6.9975 10.6772 7.37842 10.9731L8.92383 9.12012L9.10986 8.88721C10.0102 7.70524 10.5 6.2579 10.5 4.7666V3.71631C10.5 2.49265 11.4927 1.5 12.7163 1.5H12.7939ZM3.75 12C3.33579 12 3 12.3358 3 12.75V20.25C3 20.6642 3.33579 21 3.75 21H6C6.41421 21 6.75 20.6642 6.75 20.25V12.75C6.75 12.3358 6.41421 12 6 12H3.75ZM12.7163 3C12.3211 3 12 3.32108 12 3.71631V4.7666C12 6.58686 11.4012 8.35271 10.3022 9.79541L10.0767 10.0796L8.20752 12.3208C8.23439 12.4598 8.25 12.6031 8.25 12.75V20.25C8.25 20.3378 8.24221 20.4241 8.23242 20.5093C9.00584 20.8318 9.83643 21 10.6772 21H17.7437C18.4318 20.9998 19.0313 20.5309 19.1982 19.8633L20.9429 12.8877L20.9854 12.6562C20.9949 12.5786 21 12.5003 21 12.4219C21 11.3608 20.1392 10.5 19.0781 10.5H14.25C14.2382 10.5 14.2266 10.4961 14.2148 10.4956C14.1855 10.4942 14.1564 10.4918 14.127 10.4868C14.102 10.4827 14.0778 10.4772 14.0537 10.4707C14.0403 10.467 14.026 10.4664 14.0127 10.4619C14.0035 10.4589 13.9953 10.4536 13.9863 10.4502C13.9606 10.4405 13.936 10.4289 13.9116 10.4165C13.8915 10.4063 13.8719 10.3961 13.853 10.3843C13.8325 10.3714 13.8136 10.3566 13.7944 10.3418C13.7742 10.3262 13.7542 10.3109 13.7358 10.2935C13.719 10.2775 13.7043 10.2597 13.689 10.2422C13.6733 10.2243 13.6574 10.2072 13.6436 10.188C13.6284 10.167 13.6155 10.1446 13.6025 10.1221C13.5914 10.1027 13.5797 10.0838 13.5703 10.0635C13.5589 10.0388 13.5497 10.0133 13.541 9.9873C13.5337 9.96547 13.5258 9.94388 13.5205 9.92139C13.5159 9.90169 13.5133 9.88159 13.5103 9.86133C13.5058 9.83177 13.5024 9.80214 13.5015 9.77197C13.5013 9.76466 13.5 9.75736 13.5 9.75C13.5 9.73818 13.5024 9.72653 13.5029 9.71484C13.5043 9.68556 13.5068 9.65636 13.5117 9.62695C13.5158 9.60203 13.5213 9.57774 13.5278 9.55371C13.5315 9.54019 13.5336 9.52615 13.5381 9.5127L13.957 8.25586C14.1508 7.67456 14.25 7.06538 14.25 6.45264C14.2499 5.46789 13.9952 4.5022 13.5132 3.64893L13.292 3.2915L13.2671 3.25342C13.1614 3.09528 12.9841 3.00008 12.7939 3H12.7163Z"})),m3e=Object.freeze(Object.defineProperty({__proto__:null,default:F0},Symbol.toStringTag,{value:"Module"})),s4="voice-feedback-toast",U0e=3e3;function F0e(){const{t:e}=Z(),[t,n]=Le(yt),[o,s]=l.useState(null),{sendPositiveFeedback:a,sendNegativeFeedback:r}=O0(),i=()=>{a(),n({title:e("chat.feedback.postSubmitHeader"),subtitle:e("chat.feedback.postSubmitDescription"),dismissable:!1,dismissAfter:U0e})},d=()=>{r(),s("feedback-options"),t?.id===s4&&n({...t,dismissAfter:void 0})};return c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex flex-row items-center gap-2 py-2 pe-12 ps-5 text-foreground-800",children:[e("voice.feedback.howWasVoiceConversation"),c.jsx(ee,{title:e("reviewPrompt.negative"),onClick:d,children:c.jsx(U0,{})}),c.jsx(ee,{title:e("reviewPrompt.positive"),onClick:i,children:c.jsx(F0,{})}),c.jsx(Ao,{msg:e("voice.feedback.howWasVoiceConversation"),type:"polite"})]}),c.jsx(O0e,{type:o,setType:s})]})}function j0e(){return q("voice-feedback-toast")?c.jsx(F0e,{}):null}const B0e=_(null),V0e="/static/cmc/assets/tool_chime-DhDie0AZ.mp3";function H0e(){const e=_n(),t=B(Bq);return e&&!t}const U2=null;function z0e(e){return e instanceof Error&&(e.name==="NotFoundError"||e.name==="OverconstrainedError")}function Pl(){if(co()==="study"&&W("study-mode-voice"))return"study"}function G0e({initAudio:e,getAudioConstraints:t,onCallTerminated:n,onSpeechEndDetected:o,shouldRefetchHistory:s=!0,eventListeners:a=[]}){const r=G(ra),i=G(CG),d=G(io),m=q("voice-disable-greeting-for-reconnected"),p=W1(),h=G(Ny),g=G(cn),y=M(Te),b=M(Nc),C=M(Or),[T,S]=Le(Qs),E=G(oG),I=G(ma),x=G(Ir),w=G(KC),P=M(B0e),D=VA(),{refetch:L}=t4(),{showBoundary:j}=AI(),U=l.useRef(new Set),{isPortraitEnabled:$,isPortraitV2Enabled:K,portraitId:X,portraitVoiceId:ne,portraitScenario:me}=zd(),Se=G(Mre),ge=G(f3),ve=G(Vq),Pe=j0e(),Me=l.useRef(null),ye=l.useRef(void 0),Ie=l.useRef(null),He=Pde(),Ze=l.useRef(0),Be=l.useRef(!1),[be,re]=Le(dp),te=u0.getInstance(),H=A0e(),Y=l.useRef(!1),ue=G(yt),oe=W("voice-upload-diagnostic-audio"),De=G(bG),_e=W("voice-start-message-timeout-fix"),ze=l.useRef(null),We=l.useRef(null);l.useEffect(()=>{e||(re(!0),S("waiting-for-user-interaction"))},[e,re,S]),l.useEffect(()=>{et.AudioIn.toggleMute(be)},[be]);const Oe=l.useCallback(()=>{Me.current&&clearTimeout(Me.current),_e&&(Me.current=null)},[_e]);l.useEffect(()=>_e?()=>{}:(T!=="checking-availability"&&Oe(),Oe),[Oe,_e,T]);const qe=l.useCallback(async()=>{y&&(D(y,ce=>ce.splice(0)),await L())},[L,y,D]),se=l.useCallback(()=>{et.AudioOut.stopAudioPlayback(),_n()&&et.Animation.stopAnimation()},[]),ie=l.useCallback((ce,ae,Ue)=>{const pe=Pl();te.onEndCall({numMessages:Ze.current,audioChatMode:pe,availabilityStatus:ce,endReason:ae,notReceivedStartMessage:Ue}),Ze.current=0},[te]),we=l.useCallback(()=>ce=>{switch(ce.event){case"callEnded":{g("inactive");break}}},[g]),$e=l.useCallback(async(ce,ae)=>{const{reason:Ue,disableFeedbackToast:pe}=ae;ce.setOnEvent(we()),g("ending"),await et.AudioIn.stopAudioCapture(),Ie.current&&(Ie.current(),Ie.current=null),se(),re(!1);let tt=!1;_e?Me.current&&(tt=!0,Oe()):Oe();const xe=await Si.endSession({reason:Ue});if(ce.sendAudioEnd(),oe){const{AUDIO_RECORDER:dt}=await N(async()=>{const{AUDIO_RECORDER:Ot}=await Promise.resolve().then(()=>fr);return{AUDIO_RECORDER:Ot}},void 0);dt.recordEvent({event:"audioEnd"})}h("idle"),DS();const Xe=B(Qs);if(ie(Xe,Ue,tt),Xe==="available"){B(Qy)||et.AudioOut.playCallEndJingle(),s&&await qe();let dt;if(!Y.current&&Pte(Ue)){const Ot=B(KC);dt=xe||Ot?"vision":"voice"}x(dt),Pe&&!pe&&ue({id:s4,children:Pe,dismissAfter:5e3,bringToFrontOnDialog:!1}),$&&Se(!0)}if(w(!1),await et.AudioOut.cleanUpAudioContextAfterCallIfNeeded(),!Be.current){Be.current=!0;const dt=qt(au,k())??0;Jo(au,k(),dt+1)}},[se,re,g,h,s,x,$,qe,Se,oe,ue,ie,Oe,_e,Pe,we,w]),wt=l.useCallback(async ce=>{const{AudioIn:ae}=et,Ue=xe=>{xe instanceof CustomEvent&&typeof xe.detail=="string"&&ce.sendAudio(xe.detail)},pe=async()=>{B(cn)==="active"&&wt(ce),ae.removeEventListener("audioData",Ue),ae.removeEventListener("audioTrackEnded",pe),Ie.current=null};let tt;try{if(ae.setOnClientSideVoiceStartDetected(async()=>{if(te.onClientSpeechStartDetected(),y){const xe=await Si.getContext();xe&&ce.sendContext(xe,y)}}),ae.setOnClientSideVoiceEndDetected(()=>{const xe=ae.getLastClientVoiceEndTime();xe!==null&&te.onClientSpeechEndDetected(xe)}),tt=performance.now(),te.trackAudioPermission("mic-request"),Y.current=!0,await ae.startAudioCapture(t,()=>B(cn)!=="active"),ae.addEventListener("audioData",Ue),ae.addEventListener("audioTrackEnded",pe),Ie.current=()=>{ae.removeEventListener("audioData",Ue),ae.removeEventListener("audioTrackEnded",pe)},te.trackAudioPermission("mic-granted",tt),y){const xe=await Si.getContext();xe&&ce.sendContext(xe,y)}return!0}catch(xe){const Xe=async dt=>{const Ot=B(Qs)==="available";S(dt),Ot?await $e(ce,{reason:{category:"client-terminated",detail:dt}}):g("inactive")};return xe instanceof Error&&(xe.name==="NotAllowedError"||xe.name==="NotSupportedError")?(await Xe("microphone-denied"),R.trackEvent({name:"system",data:{eventName:"copilotNoMicrophoneAccess"}}),te.trackAudioPermission("mic-denied",tt,"no_permission",xe.message)):z0e(xe)?(await Xe("microphone-not-found"),R.trackEvent({name:"system",data:{eventName:"copilotMicrophoneNotFound"}}),te.trackAudioPermission("mic-denied",tt,"no_microphone_found",xe instanceof Error?xe.message:String(xe))):xe instanceof JA?R.trackEvent({name:"system",data:{eventName:"copilotChatCancelledAfterMicrophoneAccess"}}):xe instanceof Error&&xe.name==="InvalidStateError"?R.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"AudioWorkletInvalidStateError",eventInfo_details:JSON.stringify({error:xe}),eventInfo_errorMessage:xe.message}}):(j(new Error(`Error starting audio capture: ${xe}`)),te.trackAudioPermission("mic-denied",tt,"other_start_fail",xe instanceof Error?xe.message:String(xe))),!1}finally{Y.current=!1}},[t,S,g,$e,j,te,y]),_t=l.useCallback(ce=>{re(ce==="mute")},[re]);l.useEffect(()=>(Ce.on("voice:toggle-mute",_t),()=>{Ce.off("voice:toggle-mute",_t)}),[_t]);const An=l.useCallback(async ce=>{et.currentTurnIndex+=1,W("start-audio-capture-before-voice-call")||et.AudioIn.audioContext||wt(ce),await et.AudioOut.initialize(),await et.Animation.initialize(_n())},[wt]),No=l.useCallback(()=>{if($)return"portrait";const ce=J.instance().config().audioConfigClientType;if(ce)return ce;if(_n())return"character"},[$]),Lo=l.useCallback(()=>ne??C??b[0]?.id,[ne,C,b]),xn=l.useCallback(()=>X?[{type:"portrait",portraitId:X,scenario:K?me:void 0}]:void 0,[K,X,me]),go=l.useCallback(()=>{const ce=B(SG);if(_n()&&ce)return[{type:"campaign",id:ce}]},[]),ft=l.useCallback(()=>{const ce=xn(),ae=go(),Ue=[...ce??[],...ae??[],...P?[P]:[]];return Ue.length>0?Ue:void 0},[xn,go,P]),ct=l.useCallback((ce,ae,Ue)=>{if(B(cn)!=="active")return;const pe=No(),tt=Lo(),xe=Pl(),Xe=ft();ye.current=pe,ce.sendAudioStart({conversationId:ae,options:{voice:tt,initiator:Ue},clientType:pe,mode:xe,context:Xe}),n1.run({inputMethod:"voice"}),ce.resetConversationState(ae,performance.now(),performance.now()),ce.setInputMethodForConversation(ae,"voice");const dt=1e4;Oe(),Me.current=setTimeout(()=>{_e?(W("disable-start-message-timeout-ban")||S("start-timeout"),te.onAudioStartTimeout(dt),Oe()):B(Qs)==="checking-availability"&&B(cn)==="active"&&(W("disable-start-message-timeout-ban")||S("start-timeout"),te.onAudioStartTimeout(dt))},dt)},[No,Lo,S,te,ft,Oe,_e]),Kn=l.useCallback(async()=>{const ce=performance.now();te.trackAudioPermission("mic-request"),Y.current=!0;const ae=await XA({onPrompt:()=>{S("microphone-denied")}});switch(Y.current=!1,ae.state){case"granted":return S("available"),te.trackAudioPermission("mic-granted",ce),!0;case"denied":return S("microphone-denied"),te.trackAudioPermission("mic-denied",ce,ae.errorType,ae.errorMessage),!1;default:return S("microphone-denied"),!1}},[S,te]),is=l.useCallback(async(ce,ae)=>{if(!ae||!e||B(cn)==="ending")return;if(S("checking-availability"),W("start-audio-capture-before-voice-call")){if(!await wt(ce)||B(cn)!=="active")return;S("available")}else if(!await Kn()||B(cn)!=="active"){g("inactive");return}if(E(null),(H0e()||W("cf-turnstile-voice"))&&await e4(),ct(ce,ae),et.currentTurnIndex=0,oe){const{AUDIO_RECORDER:pe}=await N(async()=>{const{AUDIO_RECORDER:tt}=await Promise.resolve().then(()=>fr);return{AUDIO_RECORDER:tt}},void 0);pe.reset(),pe.conversationId=ae,pe.recordEvent({event:"audioStart"})}const Ue=Pl();te.onStartCall(ae,Ue),B(Qy)||await et.AudioOut.playCallStartJingle(),rr("onStartVoiceChat")},[e,S,g,E,ct,oe,te,Kn,wt]),Do=l.useCallback(async(ce,ae)=>{const Ue=B(Xn),pe=Ue!==null,tt=Ue?.limitReached===!0;if(pe&&!tt&&ae==="time-expired"){Ee(Xn,xe=>xe?{...xe,limitReached:!0}:null);try{await Si.dropVisionToVoice();const xe=B(Te);xe&&ct(ce,xe,"human")}catch{await $e(ce,{reason:{category:"server-terminated",detail:ae}}),n(ae)}return}await $e(ce,{reason:{category:"server-terminated",detail:ae}}),n(ae)},[$e,n,ct]),cs=l.useRef(null),ls=l.useCallback(async ce=>{try{if(!ce.length)return;let ae;const Ue=[];for(const Xe of ce){if(Xe.op==="replace"&&Xe.path==="/selectedComponentPath"&&Xe.value!==null){ae=Xe.value;continue}Ue.push(Xe)}if(ae!==void 0&&Ee(tue,ae),!cs.current){const{applyPatch:Xe}=await N(async()=>{const{applyPatch:dt}=await import("./index-DS1hydBz.js");return{applyPatch:dt}},[]);cs.current={applyPatch:Xe}}const pe=B(LS)??[],{applyPatch:tt}=cs.current,{newDocument:xe}=tt(pe,Ue);Ee(LS,xe)}catch{}},[]),Qr=(ce,ae)=>{if(!ce)return null;switch(ce.type){case"topicList":return Array.isArray(ce.topics)?{...ce,selectedIndex:ce.selectedIndex??-1}:{...ce,topics:ae?.type==="topicList"?ae.topics:null};case"summary":return ce;default:return null}},Wa=l.useCallback((ce,ae)=>{const Ue=Qr(ce,ae);Ee(zf,Ue),p&&i(null)},[p,i]),{playSound:Xr,playState:ei,resetPlayState:ti}=x0e(V0e),el=l.useRef(a);el.current=a;const an=l.useCallback(ce=>ae=>{const Ue=Pl();switch(ae.event){case"startMessage":{const{messageId:pe}=ae;if(te.onStartMessage(pe),se(),ti(),B(cn)==="inactive")break;ze.current=pe,An(ce),S("available"),h("listening"),_e&&Oe();break}case"transcriptEvent":{const{text:pe}=ae;te.onTranscriptReceived(pe.length);break}case"appendText":{const{messageId:pe}=ae;te.onTextReceived(pe),p&&i("responding");break}case"audioStartFailed":{const{reason:pe}=ae,{success:tt}=NT.safeParse(pe);S(tt?pe:"error"),te.onAudioStartFailed(pe,Ue);break}case"audioTimeRemaining":{const{seconds:pe}=ae;E(pe);break}case"audio":{if(B(cn)==="inactive")break;te.onAudioReceived(Ue),et.AudioOut.appendAudioData(ae.audio),ei==="playing"&&y&&ze.current&&We.current&&R.trackEvent({name:"system",data:{eventName:"voiceCallToolChimeOverlap",eventInfo_conversationId:y,eventInfo_callId:te.getCurrentOrLastCallId(),eventInfo_messageId:ze.current,eventInfo_type:We.current}});break}case"characterAnimation":{te.onCharacterAnimationReceived(),_n()&&et.Animation.setFrameData(ae);break}case"characterAnimationEnd":{te.onCharacterAnimationEnd(),_n()&&et.Animation.setAnimationDone();break}case"callUI":{const{callUI:pe}=ae,tt=B(zf);Wa(pe,tt),te.onCallUIEventReceived(Ue);break}case"callUIUpdate":{const{update:pe}=ae;ls(pe);break}case"characterAppearance":{_n()&&He&&(te.onCharacterAppearanceReceived({body:ae.body,props:ae.props}),et.Animation.setCharacterAppearance({body:ae.body,props:ae.props}),ve(!0));break}case"characterEmotion":{_n()&&(te.onCharacterEmotionReceived(ae.emotion,ae.bodyReaction),et.Animation.setEmotionData({emotion:ae.emotion,bodyReaction:ae.bodyReaction}));break}case"interruptAudio":{h("listening"),r("listening"),p&&i("listening"),te.onAudioInterrupt(Ue),se(),ti(),Ce.emit("portrait:interrupt-audio");break}case"speechEndDetected":{te.onSpeechEndDetected(Ue),Ce.emit("portrait:end-speech"),r("thinking"),p&&i("thinking");const pe=et.AudioIn.onServerSpeechEndDetected();pe!==null&&te.onServerVADLatencyMeasured(pe),o?.();break}case"callTerminated":{const{reason:pe}=ae;Do(ce,pe),te.onTerminated(pe,Ue);break}case"error":{const{errorCode:pe}=ae;switch(pe){case"over-turn-limit":{I(0);break}case"character-out-of-capacity":{ce.setCallType("standard");break}case"chat-service-unavailable":{S("chat-service-unavailable"),te.onAudioStartFailed(pe,Ue);break}}te.onError(pe,Ue);break}case"done":{const{messageId:pe}=ae;Ze.current+=1,et.AudioOut.setAudioDone(),te.onMessageDone({messageId:pe,voiceType:C??b[0]?.id,audioChatMode:Ue});break}case"banned":{const{expiresAt:pe}=ae,tt=V1(pe);tt&&(H1(tt,"voice",pe),se(),$e(ce,{reason:{category:"server-banned"}}));break}case"callTypeChanged":{const{callType:pe}=ae;ye.current=pe,pe==="character"?(b3(Jc.CallTypeChanged),d(Da)):(DS(),d(void 0));break}case"challenge":{H&&(g("inactive"),S("waiting-for-user-interaction"),h("waiting-for-user-interaction"),Ee(dp,!0),se());break}case"consentRequired":{const{type:pe,version:tt}=ae,{success:xe}=ug.safeParse(pe);De(xe?pe:null),h("waiting-for-user-interaction"),te.onConsentRequired(pe,tt);break}case"toolExecuting":{if(B(cn)==="inactive")break;const{messageId:pe,tool:tt}=ae;ei==="not_started"&&!U.current.has(pe)&&ze.current===pe&&(Xr(),We.current=tt.type,U.current.add(pe),y&&ze.current&&R.trackEvent({name:"system",data:{eventName:"voiceCallToolChimePlayed",eventInfo_conversationId:y,eventInfo_callId:te.getCurrentOrLastCallId(),eventInfo_messageId:ze.current,eventInfo_type:tt.type}}));break}}for(const pe of el.current)try{pe(ae,ye.current)}catch{}oe&&N(async()=>{const{AUDIO_RECORDER:pe}=await Promise.resolve().then(()=>fr);return{AUDIO_RECORDER:pe}},void 0).then(({AUDIO_RECORDER:pe})=>{pe.recordEvent(ae)})},[te,se,An,S,g,h,p,i,E,Wa,ls,He,ve,r,o,Do,I,C,b,$e,d,H,oe,De,Oe,_e,Xr,ei,ti,y]),vo=l.useCallback(async(ce,ae)=>{const Ue=an(ce);ce.setOnEvent(Ue),ce.setOnOpen(()=>{B(cn)==="active"&&ae&&B(Qs)==="available"?(ce.setOnEvent(Ue),ct(ce,ae,m?"human":void 0),te.onConnected()):(g("inactive"),B(Qs)==="available"&&S("checking-availability"))}),ce.setOnClose(()=>{te.onConnectionClosed()}),_n()&&He&&await et.Animation.initSyncHandler()},[an,g,ct,te,S,m,He]),zs=l.useCallback(async({action:ce,options:ae})=>{const Ue=ce==="start",{force:pe=!1,disableFeedbackToastOnEnd:tt=!1}=ae??{},xe=ce==="end"?ae.endReason:{category:"unknown"},Xe=B(Te);ga.onVoiceChatToggled(ce,Xe),_e||Oe();const dt=B(cn);if(ce==="end"&&(dt==="inactive"||dt==="ending")&&!pe)return;let Ot;try{if(Ot=await wn({useMockConnection:!!U2}),Ue&&B(cn)!=="inactive"&&!pe){await vo(Ot,Xe);return}if(Ue&&(Be.current=!1,te.onBeforeStartCall(_n(),$)),g(Ue&&e?"active":"inactive"),Ue){const Yn=Ot.status();Yn.readyState!==WebSocket.OPEN&&R.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"WebSocketNotOpen",eventInfo_inputMethod:"voice",eventInfo_details:JSON.stringify(Yn)}})}}catch(Yn){throw Ue&&R.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"submitMessage",eventInfo_inputMethod:"voice",eventInfo_errorMessage:Yn instanceof Error?Yn.message:"",eventInfo_details:Yn instanceof Error?Yn.stack??"":""}}),Yn}Ue?(await vo(Ot,Xe),await is(Ot,Xe)):(await $e(Ot,{disableFeedbackToast:tt,reason:xe}),Ce.emit("voice:call-ended"))},[e,te,vo,is,g,$e,$,_e,Oe]);l.useEffect(()=>{async function ce(){if(!H||!e)return;B(dp)&&_t("unmute"),B(Ny)==="waiting-for-user-interaction"&&((await wn()).sendAudioEnd(),await zs({action:"start",options:{force:!0}}))}return Ce.on("challenge:success",ce),()=>{Ce.off("challenge:success",ce)}},[e,_t,zs,H]),l.useEffect(()=>{const{AudioOut:ce}=et,ae=()=>{ge(!0),h("responding"),r("responding"),te.onAudioStart()},Ue=()=>{ge(!1),h("listening"),r("listening"),te.onAudioEnd()};return ce.addEventListener("audioStart",ae),ce.addEventListener("audioEnd",Ue),()=>{ce.removeEventListener("audioStart",ae),ce.removeEventListener("audioEnd",Ue)}},[r,ge,h,te]);const rm=l.useCallback(async ce=>{if(B(cn)!=="active")return;const ae=await wn({useMockConnection:!!U2});ce==="start"?await wt(ae):await et.AudioIn.stopAudioCapture()},[wt]);return{toggleVoiceChat:zs,toggleMute:_t,isInputMuted:be,inputVolume:et.AudioIn.volume,toggleAudioCapture:rm}}const W0e=3,$0e=10,q0e=3,F2={SUCCESS:"success",FAILED:"failed"};function K0e({toggleVoiceChat:e,enabled:t=!1,enabledForCallTypes:n}){const o=l.useRef(e);o.current=e;const s=l.useRef({hasAudio:!0,hasText:!0,retryCount:0,consecutiveErrors:0,isFirstTurn:!0}),[a,r]=l.useState(!1),i=M(Te),d=l.useCallback(b=>{const C=s.current;let T="initialAutoRetry";a?T="userManualRetry":C.isFirstTurn?T="initialAutoRetry":C.consecutiveErrors>0&&(T="backendAutoRecover");const S=JSON.stringify({retryCount:C.retryCount,consecutiveErrors:C.consecutiveErrors});R.trackEvent({name:"system",data:{eventName:"voiceRecoveryEventData",eventInfo_result:b,eventInfo_scenario:T,eventInfo_customData:S,eventInfo_conversationId:i??""}})},[a,i]),m=l.useCallback(async()=>{o.current({action:"end",options:{force:!0,endReason:{category:"client-restarted",detail:"auto-recovery"}}}),await Vd(),o.current({action:"start",options:{force:!0}}),s.current.isFirstTurn=!0,s.current.retryCount+=1},[]),p=l.useCallback(()=>{d(F2.FAILED),o.current({action:"end",options:{force:!0,endReason:{category:"client-terminated",detail:"auto-recovery-failed"}}}),s.current.retryCount=0,s.current.consecutiveErrors=0,r(!0)},[d,r]),h=l.useCallback(()=>{(s.current.retryCount>0||s.current.consecutiveErrors>0||a)&&d(F2.SUCCESS),s.current.retryCount=0,s.current.consecutiveErrors=0,r(!1)},[r,d,a]),g=l.useCallback(()=>{const b=s.current;if(!a&&b.isFirstTurn&&b.retryCount<$0e){m();return}if(!(!b.isFirstTurn&&!a&&(b.consecutiveErrors+=1,b.consecutiveErrors<q0e))){if(a&&b.retryCount<W0e){m();return}p()}},[a,m,p]);return{voiceRecoveryHandler:l.useCallback((b,C="standard")=>{if(t&&!(n&&!n.includes(C)))switch(b.event){case"startMessage":s.current.hasAudio=!1,s.current.hasText=!1;break;case"appendText":s.current.hasText=!0;break;case"audio":s.current.hasAudio=!0,h();break;case"done":s.current.hasText&&!s.current.hasAudio&&g(),s.current.isFirstTurn=!1;break}},[h,g,t,n]),isNoAudioErrorVisible:t?a:!1}}function Y0e(e,t){return ao(e)&&ao(t)&&e.endsWith("/vision")!==t.endsWith("/vision")}async function j2(){const e=ke(),t=e.get(vl),n=t==="open"?"close":"open";e.set(vl,n);try{const o=await ar.run({});o.onToggleScreenPicker&&await o.onToggleScreenPicker(n)!=="Success"&&e.set(vl,t)}catch{e.set(vl,t)}}function Z0e({isAudioCall:e,onCallTerminated:t,onMute:n,onUnmute:o}){const s=Vt(),a=iA(),[r,i]=Hd(),d=r==="audioCall",[m,p]=l.useState(!1),{noModalToShow:h}=R3(),g=Dt(),y=bk(),b=M(Ci),{state:C,setState:T}=d3({defaultValue:!d}),S=q("voice-no-audio-recovery"),E=G(Qs),I=l.useRef(!1),x=l.useRef(async()=>{}),{voiceRecoveryHandler:w,isNoAudioErrorVisible:P}=K0e({toggleVoiceChat:x.current,enabled:S,enabledForCallTypes:["standard"]}),D=l.useMemo(()=>[w],[w]),{toggleVoiceChat:L,toggleMute:j,inputVolume:U,isInputMuted:$}=G0e({initAudio:C,onCallTerminated:t,eventListeners:D});x.current=L,l.useEffect(()=>{const ve=s.endsWith("/vision");e?!d&&(h||ve)&&!b&&x.current({action:"start"}):x.current({action:"end",options:{endReason:{category:"client-terminated",detail:"navigate-away"}}})},[s,e,d,h,b]);const K=l.useCallback(ve=>{L({action:"start",options:{force:ve}}),C&&!m&&(p(!0),j("unmute"))},[L,C,m,j]),X=l.useCallback(ve=>{T(!d),i(),L({action:"end",options:ve})},[i,d,T,L]),ne=l.useCallback(()=>{T(!0),j($?"unmute":"mute"),$?o?.():n?.()},[T,j,$,n,o]);l.useEffect(()=>{e&&d&&C&&K()},[C,e,d,K]),l.useEffect(()=>{P&&E("error")},[P,E]);async function me(){return(await B$.run({onAudioCall:async()=>"NotSupported"})).onAudioCall()}const Se=l.useCallback(async(ve=!1)=>{(!e||ve)&&await me()!=="NotSupported"||await a({talkType:"talk"})},[e,a]);l.useEffect(()=>{d&&Se(!0)},[d,Se]);const ge=l.useCallback(ve=>{const{toLocation:Pe,fromLocation:Me}=ve,ye=Pe.pathname,Ie=Me?.pathname??"";if(e&&Y0e(Ie,ye)){(async()=>{try{const He=fw.run({conversationId:"",options:{}}),Ze=ye.endsWith("/vision")?He.clientType??"standard":"standard";(await wn()).setCallType(Ze)}catch{}})();return}e&&!ao(ye)&&x.current({action:"end",options:{endReason:{category:"client-terminated",detail:"navigate-away"}}})},[e]);return K1(ge),l.useEffect(()=>{const ve=()=>{K(!0),Ce.off("voice:call-ended",ve),I.current=!1,Ce.emit("voice:call-restarted")},Pe=Me=>{switch(Me.action){case"start":K();break;case"end":X({disableFeedbackToastOnEnd:!0,endReason:{category:"client-terminated",detail:Me.reason}});break;case"restart":{I.current=!0,X({force:!0,disableFeedbackToastOnEnd:!0,endReason:{category:"client-restarted",detail:Me.reason}});break}}};return Ce.on("composer:request-voice",Pe),I.current&&Ce.on("voice:call-ended",ve),()=>{Ce.off("composer:request-voice",Pe),I.current&&Ce.off("voice:call-ended",ve)}},[X,K]),l.useEffect(()=>{async function ve(){if(!y||!g)return;await(await ar.run({})).getAndClearPendingScreenPickerToggle?.()&&j2()}ve()},[g,y]),{launchAudioCall:Se,startAudioCallIfNotStartedAlready:K,endAudioCall:X,toggleAudioInput:ne,toggleVisionScreenPicker:j2,inputVolume:U,isInputMuted:$,isAudioDeepLink:d,canInitAudio:C}}function J0e(e){const[t,n]=l.useState(!1),{tab:o,className:s=""}=e,{t:a}=Z();return t||!o.favIconUrl?c.jsx(v0,{className:Ae("size-5",s)}):c.jsx("img",{src:o.favIconUrl,alt:a("composer.multiTabs.tabFavIconAltText"),className:Ae("size-4 rounded bg-white",s),onError:()=>{n(!0)}})}function Q0e(e){try{return new URL(e).hostname.replace(/^www\./,"")}catch{return null}}function X0e(e,t=5){const n=new Set;for(const o of e){if(n.size>=t)break;if(o.url){const s=Q0e(o.url);s&&n.add(s)}}return Array.from(n).join(", ")}function eve(e,t=5){const n=new Set;for(const o of e){if(n.size>=t)break;o.title&&n.add(o.title)}return Array.from(n).join(", ")}function tve(e){const{tabs:t}=e,n=l.useMemo(()=>eve(t,5),[t]),o=t.length-1;return c.jsxs("div",{className:"flex",children:[c.jsx("span",{className:"min-w-0 truncate font-semibold text-foreground-750 text-sm",children:n}),o>0&&c.jsxs("span",{className:"ms-1 font-semibold text-foreground-750 text-sm",children:["+",o]})]})}function nve(e){const{tabs:t}=e,n=l.useMemo(()=>X0e(t,5),[t]);return c.jsx("span",{className:"truncate text-foreground-450 opacity-95 text-xs dark:text-foreground-600 dark:opacity-90",children:n})}function ove(e,t){return`${e.id}-${e.url??""}-${t}`}function a4(e){const{tabs:t,onRemove:n,showRemoveIcon:o,onClick:s,isLoading:a=!1,ariaLabel:r}=e,{t:i}=Z(),d=l.useMemo(()=>t.slice(0,3),[t]),m=g=>{g.stopPropagation(),n?.()},p=g=>{g.stopPropagation(),s?.()},h=y0(()=>{s?.()});return c.jsxs(he.div,{className:"relative flex h-[58px] w-full flex-row items-center justify-center gap-2 overflow-hidden rounded-xl border border-black/8 bg-white/90 p-3 dark:border-white/8 dark:bg-background-200/80",layout:"position",initial:je,animate:rt,exit:je,onClick:p,tabIndex:s?0:void 0,onKeyDown:h,role:s?"button":void 0,"aria-label":r,children:[c.jsx("div",{className:Ae("flex h-5 min-w-5 flex-none items-center justify-center rounded bg-white/90 dark:bg-background-200/80"),children:d.map((g,y)=>c.jsx(J0e,{tab:g,className:Ae(y>0&&"-ms-[6px]")},ove(g,y)))}),c.jsxs("div",{className:"me-7 flex min-w-0 flex-1 flex-col",children:[c.jsx(tve,{tabs:t}),c.jsx(nve,{tabs:t})]}),a&&c.jsx(jt,{className:"absolute inset-0 grid place-items-center bg-white/80 dark:bg-white/45","data-testid":"multi-tabs-loading",children:c.jsx(l.Suspense,{fallback:c.jsx("div",{"aria-hidden":!0}),children:c.jsx(xt,{type:"spinnerThemed",className:"size-11"})})}),o&&c.jsx("button",{type:"button",title:i("common.closeText"),"aria-label":i("common.closeText"),onClick:m,tabIndex:0,className:"absolute end-0.5 top-0.5 m-1 rounded-full p-1 text-foreground-850 safe-hover:bg-black/5 dark:safe-hover:bg-black/30",children:c.jsx(on,{className:"size-3"})})]})}function sve({onClick:e,showRemoveIcon:t=!0,isLoading:n=!1}){const[o,s]=Le(wo),a=l.useMemo(()=>Array.from(o.values()),[o]),{t:r}=Z();return o.size===0?null:c.jsx("div",{className:"flex min-h-[60px] cursor-pointer flex-col gap-2","data-testid":"manual-multi-tabs-preview-card",children:c.jsx(a4,{showRemoveIcon:t,tabs:a,onRemove:()=>{s(new Map)},onClick:e,isLoading:n,ariaLabel:r("composer.multiTabs.browserTabMenuTitleForUpdate")})})}const r4=crypto.randomUUID();function ave(e){return e?{"zh-Hans":"zh-CN","zh-Hant":"zh-TW"}[e]??e:"en-US"}function rve(){return{sdk:"8.0",messaging:{origin:window.location.origin,channelId:r4},selection:{mode:"multiple"},accessibility:{showFocusOnLoad:!1,enableFocusTrap:!0},authentication:{},entry:{oneDrive:{recent:{}}},typesAndSources:{mode:"files",filters:[...Uoe(),...Foe()],pivots:{oneDrive:!0,recent:!0,photos:!1}},commands:{upload:{enabled:!1},createFolder:{enabled:!1}}}}function ive(){const e=new URLSearchParams({app:"CMC",scenario:"AnalyzeDoc",filePicker:JSON.stringify(rve()),locale:ave(st.resolvedLanguage)});return`${i4}/picker?${e.toString()}`}const i4="https://onedrive.live.com";async function c4(){return(await pq())?.accessToken??""}function cve(e){return e!==null&&typeof e=="object"&&"type"in e&&e.type==="initialize"&&"channelId"in e&&typeof e.channelId=="string"}function lve({port:e,onClose:t,onPick:n,setIsLoading:o,onError:s}){return async a=>{let r;switch(a.data.type){case"notification":a.data.data.notification==="page-loaded"&&o(!1);break;case"command":switch(e.postMessage({type:"acknowledge",id:a.data.id}),a.data.data.command){case"authenticate":r=await c4(),typeof r<"u"?e.postMessage({type:"result",id:a.data.id,data:{result:"token",token:r}}):(e.postMessage({type:"result",id:a.data.id,data:{result:"error",error:{code:"authTokenError",message:"Could not get OneDrive authentication token."}}}),o(!1),s(),t());break;case"close":t();break;case"pick":a.data.data.items!==void 0&&a.data.data.items.length>0&&a.data.data.items[0]!==void 0&&(n(a.data.data.items),e.postMessage({type:"result",id:a.data.id,data:{result:"success"}}),t());break;default:o(!1),e.postMessage({result:"error",error:{code:"unsupportedCommand",message:a.data.data.command},isExpected:!0}),s(),t();break}break}}}function uve({onClose:e,onPick:t,onError:n}){const o=l.useRef(null),{t:s}=Z(),[a,r]=l.useState(!0);return l.useEffect(()=>{const i=()=>{const h={title:s("composer.errors.attachmentOneDrive.title"),message:s("composer.errors.attachmentOneDrive.message")};n(h),R.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"submitMessage",eventInfo_errorMessage:h.message,eventInfo_details:"Error submitting message"}})},d=o.current?.contentWindow;let m,p;return d&&(async()=>{const g=d.document.createElement("form");g.method="POST",g.action=ive(),d.document.body.appendChild(g);const y=d.document.createElement("input");y.type="hidden",y.name="access_token",y.value=await c4(),g.appendChild(y),window.addEventListener("message",b=>{if(b.origin&&b.origin===i4){const C=b.data;if(cve(C)&&C.channelId===r4){if([p]=b.ports,!p){r(!1),i(),e();return}m=lve({port:p,onClose:e,onPick:t,onError:i,setIsLoading:r}),p.addEventListener("message",m),p.start(),p.postMessage({type:"activate"})}}}),g.submit()})(),()=>{m&&window.removeEventListener("message",m),p&&p.close()}},[e,t,n,s]),c.jsxs(_s,{isOpen:!0,onClose:e,className:"flex h-[90vh] max-h-[680px] w-[90vw] max-w-[1080px]",fullBleed:!0,children:[a&&c.jsxs("div",{className:"flex size-full items-center justify-center","aria-live":"polite",role:"status","aria-label":s("oneDrive.pickerLoading"),children:[c.jsx("span",{className:"sr-only",children:s("oneDrive.pickerLoading")}),c.jsx(xt,{className:"size-20"})]}),c.jsx("iframe",{title:s("onedrive.filePicker"),ref:o,hidden:a,width:"100%",height:"100%"})]})}const p3e="h-conversation-modal w-[88vw] max-w-conversation-modal bg-background-200",dve="Auto-detect";function B2(e){const{name:t,i18nCode:n,isSelected:o,onChange:s}=e,a=n.split("-")[0];return c.jsx("li",{role:"presentation",className:"w-full",children:c.jsx(ee,{role:"option","aria-selected":o,variant:"rect",color:"subtle-dimmed-inverted",className:"w-full",title:void 0,onClick:()=>s(n),children:c.jsxs("div",{className:"flex grow cursor-pointer items-center",children:[c.jsxs("span",{className:"flex items-center",children:[c.jsx("span",{className:"truncate font-light",children:t}),c.jsx("span",{className:"mt-px ps-4 uppercase text-foreground-600 text-xs",children:a})]}),o&&c.jsx("div",{className:"ms-auto flex size-4 items-center justify-center rounded-full bg-background-900",children:c.jsx(Yd,{className:"size-3 text-foreground-100 contrast-more:text-current"})})]})})})}function mve(e){const{onClickBack:t,onSpeechLanguageSelected:n,className:o}=e,{t:s}=Z(),a=M(Pg),[r,i]=Le(Bg),d=a0({axis:"vertical",circular:!0,memorizeCurrent:!0}),m=async p=>{n&&n(p),Og({settingName:"voiceLanguage",oldValue:r,newValue:p}),i(p),await Nt({path:"/user/settings",args:{options:{method:"PATCH"},query:{"api-version":"2"},body:{preferredVoiceLanguage:p}}})};return c.jsxs(c.Fragment,{children:[t&&c.jsx(N0,{title:s("settings.voiceLanguageTitle"),onClickBack:t}),c.jsxs("ul",{className:O("t-custom-scrollbar flex max-h-96 flex-col gap-1 overflow-y-auto p-1.5",o),role:"listbox","data-tabster":d["data-tabster"],children:[c.jsx(B2,{name:s("settings.voiceLanguageAutoDetect"),i18nCode:"",isSelected:!r,onChange:m},dve),c.jsx(es,{}),a.map(p=>c.jsx(B2,{name:p.label,i18nCode:p.language,isSelected:r===p.language,onChange:m},p.language))]})]})}function pve({onLanguageSelected:e}){const{t}=Z(),n=M(Bg),o=M(Pg),s=l.useMemo(()=>n?o.find(r=>r.language===n)?.label:t("settings.voiceLanguageAutoDetect"),[n,o,t]),a=l.useRef(null);return c.jsxs("div",{className:"flex items-center justify-between gap-2 p-2",ref:a,children:[c.jsx("h3",{className:"shrink-0 text-sm-strong",children:t("settings.languageTitle")}),c.jsx(nm,{portalContainerRef:a,renderTrigger:({openPopover:r,isOpen:i})=>c.jsxs(ee,{title:s,onClick:r,size:"32-xs",color:"overlay-dimmed",className:"min-w-20 max-w-full justify-between","aria-haspopup":"listbox","aria-expanded":i?"true":"false","aria-label":t("settings.voiceLanguageButtonAriaLabel",{language:s}),children:[c.jsx("span",{className:"truncate",children:s}),c.jsx(po,{className:"size-4 rotate-90"})]}),renderSurface:()=>c.jsx(mve,{className:"max-h-64 min-w-60 max-w-72",onSpeechLanguageSelected:e}),placement:"bottom-end",containerClassNames:{surface:"p-1.5 bg-white/95 dark:bg-muted-200/95",trigger:"py-0.5"}})]})}function fve(e){const[t,n]=l.useState(!1);l.useEffect(()=>{if(!e)return;(async()=>{try{const{micPermissionAllowed:a=!1}=await O$.run({});n(a)}catch{}})()},[e]);const o=l.useCallback(async s=>{n(s);try{const{isSwitchDone:a}=await U$.run({isChecked:s});a||n(!s)}catch{n(!s)}},[]);return{isMicPermissionAllowed:t,handleMicAccessChange:o}}function hve(e){const{isChecked:t,label:n,onChange:o,disabled:s}=e,[a,r]=l.useState(!1),i=l.useId(),d=()=>r(!0),m=()=>r(!1),p=g=>{(g.key==="Enter"||g.key===" ")&&!s&&o(!t)};let h=t?"bg-system-green-400":"bg-black/20 dark:bg-white/20";return s&&(h="bg-black/20 after:bg-white/40 dark:bg-white/20 dark:after:bg-black/40"),c.jsxs("span",{className:"flex flex-row items-center gap-2",children:[c.jsx("input",{role:"switch",id:i,type:"checkbox",title:n,"aria-label":n,checked:t,onChange:g=>o(g.target.checked),onKeyDown:p,onFocus:d,onBlur:m,className:"sr-only",disabled:s}),c.jsx("label",{htmlFor:i,className:Ae("relative flex h-6 w-10 cursor-pointer items-center rounded-full","after:absolute after:start-[2px] after:top-[2px] after:size-5 after:rounded-full after:transition-all contrast-more:forced-color-adjust-none",h,!s&&"after:bg-white after:shadow-switch after:hover:scale-110 after:active:w-6",t&&"after:translate-x-4",t&&!s&&"after:active:translate-x-3",a&&"outline",!s&&"cursor-pointer")})]})}function gve(e){const{className:t,onVoiceSelected:n}=e,{t:o}=Z(),s=l.useRef(null),a=l.useRef(null),r=M(Nc),i=M(bW),d=G(Or),[m,p]=l.useState(!1),[h,g]=l.useState(!1),b=M(IW)/yc,C=_d(),{portraitVoiceId:T}=zd(),S=T??i?.id;async function E(I){n&&n(I),s.current&&(m?s.current.pause():await s.current.play()),R.setSettings({userSettingVoiceType:I.id}),Og({settingName:"voiceType",oldValue:S,newValue:I.id}),d(I.id),g(!0),await Nt({path:"/user/settings",args:{options:{method:"PATCH"},query:{"api-version":"2"},body:{preferredVoice:I.id}}})}return l.useEffect(()=>{s.current&&(s.current.playbackRate=b,s.current.defaultPlaybackRate=b)},[b,h]),qk(I=>{if(I.key==="Enter"&&a.current){const x=r.findIndex(w=>w.name===i?.name);if(x!==-1){const w=a.current.children[x];w?.focus(),th(C,w)}else{const w=a.current.firstChild;w?.focus(),th(C,w)}}}),c.jsxs("div",{className:Ae("grid grid-cols-2 gap-2 pt-1",t),"data-testid":"voice-selector",ref:a,role:"radiogroup","aria-label":o("settings.voiceSelection"),children:[r.map((I,x)=>c.jsx(B3,{className:Ae("flex h-16 items-center justify-center",S===I.id&&m&&"bg-black dark:bg-background-300"),isSelected:S===I.id,onClick:()=>E(I),ariaSetSize:r.length,ariaPosInSet:x+1,ariaLabel:o("settings.voiceOptionPosition",{voiceName:I.name,position:x+1,total:r.length}),children:I.name},I.id)),h&&i?.previewUrl&&c.jsx("audio",{autoPlay:!0,ref:s,src:i.previewUrl,onPlay:()=>p(!0),onPause:()=>p(!1),onEnded:()=>p(!1)})]})}const l4={voice:"change-voice-tone",language:"change-voice-language"};function vve(){return c.jsxs("div",{className:"flex w-0 flex-auto items-center gap-2",children:[c.jsx(c0,{className:"size-6 rounded-2xl"}),c.jsx("span",{className:"shrink truncate text-sm",children:F("settings.appearanceSettingsTitle")})]})}function yve(e){const{selectedVoiceAppearance:t,handleCharacterToggleClick:n,isAppearancePreloadEnabled:o}=e,s=l.useCallback(()=>{o&&J3()},[o]);return c.jsx("div",{className:"flex flex-none items-center gap-2",onFocus:s,onMouseEnter:s,onTouchStart:s,children:c.jsx(hve,{label:F("settings.appearanceToggleLabel"),isChecked:!!t,onChange:n})})}const Cve="px-2 pb-5 pt-2 text-sm-strong";function Sve(e){const{onClickBack:t,onVoiceSettingChanged:n,onAppearanceEnabled:o,hideAppearanceControls:s=!1,hideVoiceLanguageControls:a=!1,className:r}=e,[i,d]=Le(io),m=G(Yt),{createConversation:p}=$r(),h=js(),g=M(Pw),y=()=>{Li(q3)},b=q("appr-preload-onhover"),C=ws({key:"shouldShowMicAccess",default:!1}),T=ws({key:"shouldShowVoiceContent",default:!0}),S=q("voice-live-caption"),E=q("speech-language-setting"),I=ws({key:"shouldShowLiveCaptionAccess",default:!1})&&S,[x,w]=Le(TW),P=K=>{w(K)},{isMicPermissionAllowed:D,handleMicAccessChange:L}=fve(C??!1),j=async()=>{de({source:"characterTalkToggleButton",customData:JSON.stringify({changedToEnabled:!i})});const K=i?void 0:Da;!K&&g&&y(),Ce.emit("composer:request-voice",{action:"end",reason:i?"disable-appearance":"enable-appearance"}),await p({shouldNavigateToChat:!1,characterId:K}),d(K),Ce.emit("composer:request-voice",{action:"start"}),K&&(ga.onUserInteract(Jc.CharacterTalkToggleButton),o?.())};Ga(K=>{K.key==="Escape"&&(K.stopPropagation(),m(null))});const U=E&&!a,$=c.jsx("h3",{className:Cve,children:F("settings.voiceTitle")});return c.jsxs(c.Fragment,{children:[t&&c.jsx(N0,{title:F("settings.voiceTitle"),onClickBack:t}),c.jsxs("div",{className:O("overflow-y-auto pb-2",r),children:[h&&!s&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex items-center justify-between gap-2 p-2",children:[c.jsx(vve,{}),c.jsx(yve,{selectedVoiceAppearance:i,handleCharacterToggleClick:j,isAppearancePreloadEnabled:b})]}),c.jsx("div",{className:"px-2 pb-2",children:c.jsx("span",{className:"block w-full text-foreground-600 text-xs-medium",children:F("settings.appearanceSettingsDiscoveryDescription")})}),!U&&$]}),T&&c.jsxs(c.Fragment,{children:[U&&c.jsxs(c.Fragment,{children:[c.jsx(pve,{onLanguageSelected:K=>{n?.({type:"language",language:K})}}),c.jsx("p",{className:"px-2 text-center text-foreground-600 text-xs",children:F("settings.voiceLanguageDescription")}),$]}),c.jsx(gve,{className:"px-2 pb-2",onVoiceSelected:K=>{n?.({type:"voice",voice:K})}}),c.jsx("p",{className:"mt-2 px-2 text-center text-foreground-600 text-xs",children:F("voice.voiceChangeDescription")}),(I??C)&&c.jsx(es,{})]}),C&&c.jsxs("div",{className:"px-2 py-1",children:[c.jsx(ku,{label:F("settings.micAccessLabel"),isChecked:D,onChange:L}),c.jsx("div",{className:"mt-2 text-foreground-600 text-xs",children:F("settings.micAccessDescription")})]}),I&&c.jsxs("div",{className:O("px-2 py-1",C?"pt-4":""),children:[c.jsx(ku,{label:F("settings.liveCaptionAccessLabel"),isChecked:x,onChange:P}),c.jsx("div",{className:"mt-2 text-foreground-600 text-xs",children:F("settings.liveCaptionAccessDescription")})]})]})]})}const bve=Object.freeze(Object.defineProperty({__proto__:null,VOICE_SETTING_TYPE_TO_CLOSE_REASON_MAP:l4,default:Sve},Symbol.toStringTag,{value:"Module"})),Ive=new Set(["prompt-sign-in","prompt-3p-sign-in","prompt-review","confirm-link-navigation","cross-promo-card","shopping-upsell-card","shopping-price-tracking","add-to-page","safety-risk-card","computer-use-task-closed","over-task-quota","biometric-consent"]),u4=64,Eve=8,f3e={opacity:0,translateY:u4},Tve={opacity:1,scale:1,translateY:0};function wve(){return C3()?{opacity:1,scale:1,translateY:0}:{opacity:0,translateY:u4}}const Ave=l.lazy(()=>N(()=>import("./daily-briefing-composer-player-DA2guUmg.js"),__vite__mapDeps([488,1,390,402,454,455,405,2]))),xve=rs(()=>N(()=>import("./composer-voice-ui-B1XwRhmr.js"),__vite__mapDeps([489,1,490,491,325,465,2])),{moduleName:"composer-voice-ui",retryStrategy:mo,exportName:"ComposerVoiceUi"}),V2={coco:"userInput.cocoPlaceholderText",study:"userInput.studyPlaceholderText",search:"userInput.searchPlaceholderText"},H2={concise:"personality.placeholders.concise",imaginative:"personality.placeholders.imaginative",curious:"personality.placeholders.curious",skeptical:"personality.placeholders.skeptical",supportive:"personality.placeholders.supportive",casual:"personality.placeholders.casual"};function om(e){const{banner:t,suppressBottomSection:n,suppressBackgroundFade:o,suppressAcrylicBackground:s,onInputKeydown:a,onTextChange:r,onSubmit:i,onInputSubmitted:d,_limitInputMaxHeight:m}=e,{t:p}=Z();lK(),g0e();const{isPortraitEnabled:h}=zd(),g=G(I_),y=G(E_),b=M(Na),C=Br(),T=Bn("oneDriveFileUpload"),S=!$c(),E=M(jT),I=M(o0),x=Sk(),w=q("dr-nano-single-file-upload"),P=bk(),D=Ba(),L=q("shopping-placeholder"),j=Fa(),U=iA(),$=Vt(),K=M(ut),X=G(fc),ne=gt({breakpoint:"sm"}),me=w0({breakpoint:"h600"}),Se=mK(),ge=dK(),[ve,Pe]=l.useState(null),[Me,ye]=Le(Us),Ie=M(lT),He=M(dT),Ze=M(Rc),Be=M(df),be=pK(),re=d0e(),te=M(Rt),H=!!te?.group,Y=l.useMemo(()=>{if(H&&te?.id)return`/conversations/${te.id}/attachments`},[H,te?.id]),ue=M(Pw),oe=q("file-upload-card-v2"),De=q("ping-on-send"),_e=Ra(),ze=!H&&Ze||be,We=M(ss),[Oe,qe]=l.useState(!1),[se,ie]=Le(Yt),[we,$e]=Le(jc),wt=G(Ng),{isPlaying:_t,pause:An,resetAllTimers:No}=kk(),Lo=mhe(),xn=zre(),go=Ehe(),ft=l.useRef(null),ct=l.useRef(null),Kn=l.useRef(null),is=l.useRef(null),{userInput:Do,autocompleteValue:cs}=Fw(),ls=b0e(ct,Do,cs),{isOneDriveFilePickerOpen:Qr,pickedOneDriveItems:Wa,setPickedOneDriveItems:Xr,selectOneDriveFile:ei,onPickCallback:ti,onCloseCallback:el}=Yk(),{isMediaViewerOpen:an,showOneLineComposerWhenMediaViewerOpen:vo,contentComposerType:zs,contentPageType:rm}=Ro(),{trackConsumptionPageComposerClick:ce,trackConsumptionPageComposerSubmit:ae}=Jfe(),{switchMsnConversation:Ue}=whe(),pe=zs===As.IMAGE_VIEWER,tt=zs===As.CLOSE_BUTTON,xe=ao($),Xe=$.endsWith("/daily"),dt=Zc(),Ot=$==="/",Yn=l0(),im=$.startsWith("/shopping"),cm=$.startsWith("/chats")&&!xe,ni=$.startsWith("/shares"),V4=rm==="weather",tl=$.startsWith("/projects"),nl=k3(),ol=se==="dialog",H4=vhe(),Ln=Zt(),[z4,G4]=l.useState(!1),Dn=I0(),lm=ls.trim().length>0,{outerShadowStyle:W4,outerShadowAnimate:$4,outerShadowTransition:q4,innerShadowStyle:K4,innerShadowAnimate:Y4,innerShadowTransition:Z4}=Rfe(lm),{isAutoSuggestEnabled:J4,isStarterPromptsEnabled:Q4,isAppearanceOnHomeEnabled:X4}=za(),{autoSuggestOnInputClick:e6,autoSuggestOnInputFocus:t6,autoSuggestOnInputChange:n6}=Zfe(),{floatingStyles:o6,edgeTabMenuRefs:um,isMultiTabsMenuExpanded:H0,setIsMultiTabsMenuExpanded:z0,multiTabsMenuMode:s6,setMultiTabsMenuMode:G0,handleMentionEvent:a6,handleMultiTabsMenuSaveBtnEvent:W0,handleMultiTabsMenuCloseBtnEvent:$0,handleUserInputEnterEvent:r6,handleUserInputKeydownEvent:q0,isMentionTriggered:sl,isFetchingTabsPageContext:K0,menuPlacement:i6}=Lfe(),{isGroupsMentionEnabled:us,mentionPopup:ds,handleMentionTriggerEvent:c6,handleMentionKeydown:Y0,hasSelectedMentions:Z0,getTextWithMentions:l6,handleTextareaChange:u6,handleTextareaSelect:d6}=Yfe({setInputValue:du,userInputRef:ct});let dm;Dn?dm=a6:us&&(dm=c6);const J0=M(Yee),Q0=Ln==="computerUse",X0=ge==="autosuggest"&&(J4&&!se&&!Q0),mm=l.useId(),m6=M(t_),p6=Q4&&(!se||se==="biometric-consent")&&!Q0&&!m6&&(!me||ne),al=l.useRef(null),f6=!o&&!xe&&!Xe&&!dt&&!V4,pm=(Yn||cm||Ot||ni||tl||nl||im)&&(!se||se==="biometric-consent")&&!(an&&!vo),h6=X0||Dn&&H0&&pm,g6=M(Bc),ev=M(lG),[fm,tv]=Le(zw),v6=M(PK),rl=aA(),$a=rl?.type==="computerUse"&&cm,nv=$a&&!C1(rl.status),hm=$a&&lA(rl),y6=$a&&LY(rl),C6=Bn("voice"),S6=!$.endsWith("/agents")&&!Xe&&!Ot&&!ni&&!X4&&!an&&!D&&!tl&&!nl&&!im,b6=tl||nl||hm||$a||Xe||an||!C6||!_e,I6=l.useCallback(()=>{const le=[];if(ct.current&&sl){const Ge=ct.current.getTextAreaRef();Ge.current&&le.push(Ge)}return le},[ct,sl]),ov=!(an&&!vo)&&!xe&&!se,il=Ie||!ov||nv||hm||y6,[E6,T6]=l.useState(!1),sv=M(Hw),av=()=>{Li(K3)},rv=()=>{Li(Ipe)},iv=G(yt),cv=Ive.has(se),lv=!xe&&se!=="daily-briefing-player"&&se!=="audioSettings"&&!cv&&!(an&&!vo),w6=wve(),A6=l.useCallback(le=>{Fo(le)},[]),x6=l.useCallback(()=>{ct.current?.focus(),_i(!0)},[]),_6=l.useCallback(()=>{Kn.current&&(Kn.current.value="")},[]),cl=l.useCallback((le,Ge)=>{ye({isOpen:!0,scenario:Ge??null,reason:le})},[ye]),k6=l.useCallback(()=>{cl("fileUpload")},[cl]),{processUploadedFiles:uv,processUploadedLocalFiles:Zn,isUploadingAttachments:P6,uploadedAttachments:ms,resetFileUpload:M6,removeAttachment:gm}=vse(x6,Fo,_6,k6),R6=M(BA),On=ms.filter(({error:le})=>!le),dv=On.length>0||J0,N6=P6||Dn&&K0,oi=ba(),mv=!!(lm||dv)&&!il,pv=!!((ve&&ve.length>0)===!0||N6||ze||Be||!lm&&Ln==="computerUse")||!_e,qa=M(Mo),L6=On.length>=qa.maxFilesPerMessage||!_e,[D6,O6]=l.useState({onSubmitCallback:null,onCancelCallback:null}),U6=l.useCallback(()=>{W0(),ct.current?.focus()},[W0]),F6=l.useCallback(()=>{sl||ft.current?.focus(),$0()},[$0,sl]),j6=l.useCallback(async()=>new Promise(le=>{if(B(of)||On.length===0){le(!0);return}ie("biometric-consent"),O6({onSubmitCallback:()=>{ie(null),le(!0)},onCancelCallback:()=>{ie(null),le(!1)}})}),[On,ie]),B6=l.useCallback(le=>{if(!(a&&ct.current?.contains(document.activeElement)&&(a(le),le.defaultPrevented)||us&&ds.isMentionPopupOpen&&(Y0(le),le.defaultPrevented)||q0(le))&&le.key==="ArrowDown"&&ct.current?.contains(document.activeElement)&&al.current){le.preventDefault();const zt=al.current.querySelector("button");zt&&zt.focus()}},[q0,a,Y0,us,ds]),V6=async()=>{await Wo.stopMessage({connectionType:D?"temporary":"regular"}),ct.current?.focus()},vm=async le=>{const Ge=le??ls;let zt=performance.now();if(i){const Jt=new CustomEvent("submit",{detail:{text:Ge},cancelable:!0});if(i(Jt),Jt.defaultPrevented)return}if(ni&&await S2(),!mv||!ls&&!dv||pv){await Wo.onSubmitMessageBlocked({connectionType:D?"temporary":"regular"});return}if(!(B(of)||On.length===0)){if(!await j6())return;zt=performance.now()}if(Ln==="research"&&v6){const Jt=B(Te);if(Jt){zl(p("error.researchTaskNotAllowedWhileRunningAnother"),Jt),hn(Ft());return}}if(av(),Td(),Y6?ct.current?.focus():ct.current?.blur(),await e9(Ge,zt),d){const Jt=new CustomEvent("inputSubmitted",{detail:{text:Ge,filesWithAttachment:ms},cancelable:!0});d(Jt)}},H6=l.useCallback(async le=>{await U();const{title:Ge,subtitle:zt}=kte(p,le);iv({title:Ge,subtitle:zt,dismissAfter:3e3})},[U,iv,p]),fv=M(f3),hv=Z0e({isAudioCall:xe,onCallTerminated:H6,onMute:()=>en({source:"audioCall",scenario:"mute"})}),{launchAudioCall:z6,startAudioCallIfNotStartedAlready:G6,endAudioCall:ym,toggleVisionScreenPicker:W6}=hv,ll=l.useRef(null),ul=l.useRef(null);The(ll);const $6=Hs(le=>{ul.current&&(le.height===0?ul.current.style.removeProperty("--composer-attachments-height"):ul.current.style.setProperty("--composer-attachments-height",`${le.height+Eve}px`))}),gv=()=>{Oe&&(G6(),qe(!1))},vv=()=>{if(se==="prompt-3p-sign-in"&&(dt||Xe)&&ie("daily-briefing-player"),!(Ie||Xe||dt||hm)){if(nv){ie("computer-use-task-closed");return}if(ol&&sv?.closeDialogCallback){sv.closeDialogCallback();return}se==="prompt-review"&&Hhe(B(Te),"dismissed"),se==="audioSettings"&&gv(),ie(null),se==="prompt-sign-in"&&Me.scenario&&ye({isOpen:!1,scenario:null})}},Cm=l.useCallback(async(le={})=>{const{isHidden:Ge=!1}=le;re&&rv(),ue&&Li(q3),ym({endReason:{category:"client-terminated",detail:Ge?"visibility-hidden":"click-close"}}),h?(y(!1),g(null),await j({to:"/labs/portrait",from:$})):await U()},[h,g,y,re,ue,ym,j,$,U]);l.useEffect(()=>{J.instance().config().endAudioOnVisibilityHidden&&!ev&&(_t?An?.():xe&&Cm({isHidden:!0}))},[Cm,xe,_t,An,ev]);const q6=le=>{le.type==="voice"&&h&&(Ce.emit("portrait:change-voice",le.voice),y(!0)),Xe||dt?An?.():xe&&ym({endReason:{category:"client-restarted",detail:l4[le.type]}}),qe(!0)},Sm=G(kK),bm=(["chat","reasoning","smart","smart-latest","study"].includes(Ln)||Ln==="research"&&w)&&!$a&&!E6,Im=!Bn("uploadFile"),yv=l1();let Ht=M(Va);Ln==="research"?Ht=qa.document.mimeTypes:yv==="video"&&(Ht=qa.image.mimeTypes);const K6=jd(Ht);l.useEffect(()=>{for(const[le,Ge]of ms.entries())A1(Ge.file,{supportedMimeTypes:Ht})||gm(le)},[Ht,ms,gm]);const Y6=T0(),si=!xe&&!an,Z6=s?Kw:KK,Ka=l.useCallback(()=>{Sm(null)},[Sm]);l.useEffect(()=>{Ka()},[lv,Ka]),Xo({onOutsideEvent:()=>{vv()},elements:[ll],includeScroll:!1,invokeOnce:!1}),Xo({onOutsideEvent:Yi,elements:[ll,al],includeScroll:!1,invokeOnce:!1});const Cv=()=>{G4(!0),ie(le=>le==="audioSettings"?(gv(),null):(re&&rv(),"audioSettings"))},J6=()=>{_i(!0),C&&_x("idle")},Q6=(le,Ge)=>{t6(le,Ge)},X6=async()=>{if(S6){const le=$.replace(/^\//,"");de({source:"composerInput",scenario:"clickNavigateToChat",pageName:le}),cm||await c9()}an&&vo&&ce(),e6(ls)},Sv=l.useCallback(le=>{Zi({prompt:le,prefillSource:"promptPassThrough"},Ot),$e(null),wt(null)},[$e,wt,Ot]);l.useEffect(()=>{(we?.source==="promptInUrl"||we?.source==="edgeOnAskCopilot")&&Sv(we.prompt)},[we,Sv]);const bv=l.useCallback((le,Ge)=>{const{scenario:zt,reasonIfSignInError:Un}=Ge;le.message==="not-signed-in"?cl(Un,zt):Fo(Lx(le.message))},[cl]),e9=async(le,Ge)=>{const zt=cae(le),Un=le.trim();let Jt;Ln==="research"?Jt={research:{awaitUserConfirmation:!0}}:Ln==="study"&&yv==="homeworkHelper"&&(Jt={education:{isHomeworkHelperEnabled:!0}}),M6(),_i(!0),jw(void 0),ie(null),Yi(),an&&vo?(await Ue(),X(!0),ae()):!D&&!tl&&!nl&&await U();try{mu(!0);let Fn;Lo&&(Fn=Lo),xn&&(Fn=xn),go&&(Fn=go);const ai=us&&Z0?l6(Un):void 0,p9=iae(ai??Un,ms);await Wo.submitMessage({text:ai??Un,filesWithAttachment:ms,inputMethod:"text",scenario:zt??void 0,customData:p9??void 0,reference:Fn,context:Jt,connectionType:D?"temporary":"regular",messageStartTime:Ge,pingCheck:De})}catch(Fn){if(Fn instanceof Error){let ai={};On.length>0&&(ai={eventInfo_uploadFileSize:On[0]?.file?.size??0,eventInfo_uploadFileType:On[0]?.file?.type??"",eventInfo_numDocumentsUploaded:On.length}),R.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"submitMessage",eventInfo_errorMessage:Fn.message,eventInfo_inputMethod:"text",eventInfo_details:"Error submitting message",...ai}})}else R.trackEvent({name:"system",data:{eventName:"copilotWebError",eventInfo_errorType:"submitMessage",eventInfo_errorMessage:"Unknown error",eventInfo_inputMethod:"text",eventInfo_details:"Error submitting message"}});Fo({title:p("composer.errors.default.title"),message:p("composer.errors.default.message")})}finally{mu(!1),lae()}},t9=l.useCallback(()=>{Kn.current?.click()},[]),Iv=l.useCallback(le=>{const Ge=Woe(le);Zn({rawFiles:[Ge],scenario:"pasteUploadText",supportedMimeTypes:Ht,uploadEndpointOverride:Y})},[Zn,Ht,Y]),n9=l.useCallback(le=>{const Ge=le.clipboardData.getData("text/plain")||"";Ge.length>PI&&(le.preventDefault(),le.stopPropagation(),Iv(Ge))},[Iv]);l.useEffect(()=>{if(il)return()=>{};const le=async Ge=>{const{file:zt,error:Un}=Boe(Ge);(zt??Un)&&(Ge.preventDefault(),Un?bv(Un,{reasonIfSignInError:"fileUpload"}):zt&&Zn({rawFiles:[zt],scenario:"pasteUpload",supportedMimeTypes:Ht,uploadEndpointOverride:Y}))};return document.addEventListener("paste",le),()=>document.removeEventListener("paste",le)},[Zn,il,bv,Ht,Y]),l.useEffect(()=>{fm.length>0&&(Zn({rawFiles:fm,scenario:"fileUpload",supportedMimeTypes:Ht,uploadEndpointOverride:Y}),tv([]))},[fm,Zn,tv,Ht,Y]),l.useEffect(()=>{Wa&&!Qr&&(uv({uploads:Wa.map(le=>({kind:"onedrive",item:le,file:new File([],le.name)})),scenario:"fileUpload",supportedMimeTypes:Ht,uploadEndpointOverride:Y}),Xr(null))},[Wa,Xr,Qr,uv,Ht,Y]),l.useEffect(()=>{Xe&&No()},[Xe]);function o9(le){const Ge=Array.from(le.target.files??[]);Ge.length!==0&&Zn({rawFiles:Ge,scenario:"fileUpload",supportedMimeTypes:Ht,uploadEndpointOverride:Y})}const s9=l.useCallback(le=>{if(!bm||!le.dataTransfer||Im)return;le.preventDefault(),Ka();const Ge=Array.from(le.dataTransfer.files);Ge.length&&Zn({rawFiles:Ge,scenario:"fileUpload",supportedMimeTypes:Ht,uploadEndpointOverride:Y})},[bm,Ka,Zn,Ht,Y,Im]),Em=phe(ov,s9),Tm=(On.length>0||Em)&&!xe;async function a9(){ni&&await S2(),en({source:"audioCallButton",chatMode:Ln}),ga.onUserInteract("audioCallButton"),await z6()}async function r9(){await W6(),de({source:"visionCallButton"})}const i9=l.useCallback(()=>{ct.current?.focus()},[]);l.useEffect(()=>{const le=()=>{ct.current?.focus()};return Ce.on("composer:focus-input",le),()=>{Ce.off("composer:focus-input",le)}},[]);const c9=Kr(),l9=l.useCallback(async()=>{Ka();const{file:le,error:Ge}=await F$.run({});le?Zn({rawFiles:[le],scenario:"screenshot",supportedMimeTypes:Ht,uploadEndpointOverride:Y}):Ge&&Fo(Ge)},[Ka,Y,Zn,Ht]),u9=()=>On.length>0?p("userInput.messageRequiredPlaceholderText"):Em?H&&Im?p("userInput.fileDropNotSupportedInGroupPlaceHolderText"):bm?p("userInput.fileUploadLimit",{imageSizeLimit:qa.image.maxBytes/(1024*1024),documentSizeLimit:qa.document.maxBytes/(1024*1024),maxCount:qa.maxFilesPerMessage}):p("userInput.fileDropNotSupportedPlaceHolderText",{chatMode:dte(Ln)}):ni?p("userInput.continueConversationInputPlaceholderText"):E?.name&&C?p("userInput.characterPlaceholderText",{character:E.name}):Dn?p("userInput.placeholderTextWithMention"):V2[Ln]?p(V2[Ln]):im?p(L?"userInput.shopWithCopilotPlaceholderText":"userInput.shoppingPlaceholderText"):x&&I!=="default"&&H2[I]?p(H2[I]):p("userInput.placeholderText"),d9=({enableActionButtons:le})=>{const Ge=!!J.instance().config().composer?.smallAttachmentCard||oe,Un=se==="daily-briefing-player"&&Xe?"":void 0,Jt=J.instance().config().composer?.reducedUserInputHeight;return c.jsxs(c.Fragment,{children:[c.jsxs(he.div,{className:O("w-full",{"mt-2 h-auto min-h-32 px-2":Tm&&!Dn&&!Ge,"mt-2 h-auto min-h-[58px] px-2":Tm&&!Dn&&Ge,"h-auto":Dn,"h-0":!Tm&&!Dn}),ref:$6,layout:!0,children:[R6&&c.jsx(Qge,{onRemove:gm,attachments:ms,onVisibilityChange:T6}),Dn&&J0&&c.jsx(he.div,{className:"z-10 mt-2 w-full px-2","data-testid":"browser-tabs-preview",children:c.jsx(sve,{onClick:()=>{G0("update"),z0(!0)},isLoading:K0})})]}),c.jsx(x0,{ref:ct,className:O("min-h-0 w-auto grow",!Xe&&"mt-1"),inputContainerClassName:O({"max-h-[15dvh]":Jt,"max-h-user-input-shallow":m&&!Jt,"max-h-user-input":!m&&!Jt}),disabled:il,disabledClassName:Un,inputValue:ls,errorMessage:ve,onClick:X6,onBlur:J6,onTextChange:Fn=>{n6(Fn.target.value),u_({text:Fn.target.value,attachments:On,isLandingRoute:Ot}),av(),r&&r(Fn),us&&Z0&&u6(Fn)},onFocus:Q6,onPaste:n9,onEnter:async()=>{r6()||await vm()},onKeyDown:B6,onMentionIfEnabled:dm,onSelect:us?d6:void 0,hideMentionPlaceholder:us,setInput:du,setError:Pe,placeholder:u9(),characterLimit:He,rightButtons:le?[c.jsx(bp,{config:Ev()},"composer-action-button")]:void 0,testId:"composer-input","aria-autocomplete":"both","aria-controls":h6?mm:void 0,autoFocus:!ld()})]})},Ev=()=>{if(oi){if(ze)return{mode:"stop",onClick:V6};if(mv)return{mode:"submit",disabled:pv,onClick:()=>vm()};if(!b&&!b6)return{mode:"microphone",onClick:a9}}},m9=({enableInputActionButtons:le})=>{const Ge=Dn?()=>{Sm(null),G0("add"),z0(!0)}:void 0,zt=We==="dark"?p0:m0;return c.jsx(he.div,{className:O("relative max-h-full w-expanded-composer max-w-chat bg-gradient-to-b p-1.5",!oi&&"before:pointer-events-none before:absolute before:inset-0 before:rounded-[inherit] before:border before:border-white/100 dark:before:border-white/12","from-background-400/5 to-background-400/8 dark:from-background-200/65 dark:to-background-200/65"),layout:!0,style:{borderRadius:kl(si),boxShadow:oi?zt:void 0},ref:um.setReference,children:c.jsxs(he.div,{className:O(Ome),layout:!0,style:{borderRadius:kfe(si)},children:[c.jsx(he.div,{className:O(Lme,Dme,Em?"before:opacity-100 before:delay-100 before:duration-200":"before:opacity-0"),layout:!0,children:d9({enableActionButtons:le})}),!le&&c.jsxs(he.div,{className:"relative bottom-0 flex justify-between pb-0.5 pe-2.5 ps-1.5",layout:!0,children:[c.jsx("div",{className:"flex h-11 items-center gap-2 ps-1",children:c.jsx(u0e,{onSelectFile:t9,onSelectOneDriveFile:K?.provider==="microsoft"&&T?ei:void 0,uploadButtonDisabled:L6,onSelectUserOpenedTabs:Ge,onTakeScreenshot:l9,disabled:!_e})}),c.jsxs("div",{className:"flex items-center gap-2",children:[P&&c.jsx(bp,{config:{mode:"vision",onClick:r9}}),c.jsx(bp,{config:Ev()})]})]})]})})};return!H4||an&&zs===As.NONE?null:c.jsxs(c.Fragment,{children:[c.jsx(It,{children:f6&&c.jsx(Xde,{dynamicHeight:se===null&&!Yn})}),c.jsxs("div",{"data-testid":"composer",ref:ul,className:O("pointer-events-none relative flex",at.composer),children:[c.jsx(s0,{elementTiming:c3}),c.jsx("input",{type:"file",accept:K6.join(","),className:"hidden",ref:Kn,onChange:o9,"aria-hidden":"true",multiple:!0,"data-testid":"composer-file-input"}),c.jsx(he.div,{className:O("relative flex w-full flex-col-reverse items-center px-3 sm:flex-col",(Xe||dt)&&"min-w-72"),initial:S?"enter":!1,animate:"animate",variants:{enter:w6,animate:Tve},transition:b1,style:MI,children:c.jsxs(Cb,{transition:Se?Cee:{duration:0},children:[c.jsxs(he.div,{layoutId:"composer-inner",className:O("relative max-h-full min-h-composer min-w-16 max-w-chat rounded-5xl",Dn&&"z-40"),children:[C&&lv&&c.jsx(Eme,{}),c.jsx(he.div,{layoutId:"composer-container",className:O("absolute inset-0",!oi&&"hidden"),layout:!0,style:{borderRadius:kl(si),boxShadow:oi?Afe(We,!0):void 0}}),c.jsx(It,{children:fv&&c.jsx(n2,{})}),c.jsx(he.div,{layoutId:"composer-background",className:O("relative shadow-tinted-xl",Z6),layout:!0,style:{borderRadius:kl(si),...W4},animate:$4,transition:q4,children:c.jsxs(he.div,{layoutId:"composer-content",className:O("pointer-events-auto relative flex flex-col overflow-hidden contrast-more:border-2",ol&&"max-w-72"),"data-testid":"composer-content",ref:ll,layout:!0,style:{borderRadius:kl(si),...K4},animate:Y4,transition:Z4,children:[c.jsx(It,{children:fv&&c.jsx(n2,{isNested:!0})}),c.jsxs(It,{children:[se&&se!=="daily-briefing-player"&&se!=="dismiss-audio-call-only"&&c.jsx(Qme,{expandedSection:se,isDialogShown:ol,expandedSectionPromptAction:cv,chatModalRef:is,biometricConsentCallbacks:D6,turnLimitReached:Ie,closeExpandedSection:vv,onVoiceSettingChanged:q6,toggleAudioSettingsVisibility:Cv}),(Xe||dt)&&c.jsx(l.Suspense,{fallback:c.jsx("div",{className:O("flex h-composer items-center justify-center",Xe?"w-daily-briefing-lg":"w-daily-briefing"),children:c.jsx(xt,{className:"size-12"})}),children:c.jsx(Ave,{isPodcast:dt})}),t,xe&&!an&&(!se||se==="audioSettings"||se==="dismiss-audio-call-only")&&c.jsx(l.Suspense,{fallback:c.jsx("div",{"aria-hidden":!0}),children:c.jsx("div",{className:"flex justify-center p-2",children:c.jsx(xve,{exitAudioCall:Cm,toggleAudioSettingsVisibility:Cv,voiceChatController:hv,didInteractWithAudioComposer:z4})})}),pm&&m9({enableInputActionButtons:an&&vo||$a}),an&&(tt||pe)&&c.jsx(spe,{isDialogShown:ol,expandedSection:se}),Qr&&c.jsx(uve,{onPick:ti,onClose:el,onError:A6})]})]})}),us&&ds.isMentionPopupOpen&&c.jsx(Spe,{participants:ds.mentionPopupParticipants,position:ds.position,selectedIndex:ds.mentionPopupSelectedIndex,onSelect:ds.handleMentionSelect,onClose:ds.closeMentionPopup})]}),!n&&c.jsx(jt,{id:ge,className:O("flex h-[150px] w-full max-w-chat flex-none items-end px-2 sm:flex-initial sm:items-start",at.composerBottomSlot),delay:.2,initial:S?"initial":!1,children:c.jsx(Sme,{composerBottomSection:ge,handleSubmit:vm,focusInputHandler:i9,uploadedAttachments:ms,showAutoSuggest:X0,autoSuggestResponse:g6,autoSuggestRef:al,autoSuggestId:mm,isLanding:Ot,shouldShowStarterPrompts:p6})}),Dn&&H0&&pm&&c.jsx(wfe,{onSave:U6,styles:o6,onRef:um.setFloating,onClose:F6,outsideClickElements:I6(),mode:s6,originElement:um.reference,menuPlacement:i6,id:mm})]})})]})]})}const j0=(e,t=0)=>{const n=G(AK);return Hs(s=>{const a=e==="app"?document.getElementById("app"):e.current;a&&(n(s.height),a.style.setProperty("--composer-container-height",`${s.height+t}px`))})};function d4(e){const{children:t}=e,n=j0("app");return c.jsx("div",{ref:n,className:"pointer-events-none absolute bottom-0 w-full",children:c.jsx("div",{className:"mb-4 sm:mb-8",children:t})})}function _ve(){const e=it("kill-cookie-banner"),t=M(Bt),[n,o]=Le(Dg),[s,a]=l.useState("main"),r=Ia(),[i,d]=l.useState(()=>r.analytics),[m,p]=l.useState(r.advertising),[h,g]=l.useState(r.socialMedia),y=Ld(t),b=!!kh(),[C,T]=Le(q_),S=!e&&(!!C||y&&!b&&!n);if(l.useEffect(()=>{S&&R.trackEvent({name:"system",data:{eventName:"cookieBannerShown",eventInfo_region:t}})},[t,S]),Ga(l.useCallback(x=>{x.key==="Escape"&&S&&(x.stopPropagation(),x.preventDefault(),a("main"),T(void 0))},[S,a,T])),!S)return null;const E=x=>{R.trackEvent({name:"interaction",data:{eventName:"cookieBannerChoice",eventInfo_analytics:x.analytics,eventInfo_advertising:x.advertising,eventInfo_socialMedia:x.socialMedia}}),NM(x),a("main"),T(void 0),o(!0)},I=C==="more-options";return c.jsxs("div",{className:"pointer-events-none absolute inset-x-0 top-0 flex w-full justify-center p-3",children:[c.jsx("div",{className:"absolute top-0 h-3.5 w-full bg-background-150 opacity-90 dark:bg-background-150"}),c.jsx("div",{className:Ae("relative w-full max-w-cookie-banner rounded-xl border border-black/5 shadow-xl dark:border-black/40",lo,at.modal),children:c.jsxs("div",{className:"pointer-events-auto relative max-h-[90vh] overflow-auto p-5",id:"cookie-banner",children:[C!=="more-options"&&s==="main"&&c.jsxs("div",{className:"flex flex-col gap-4",children:[c.jsx("h3",{className:"text-lg",children:F("cookies.heading")}),c.jsxs("div",{className:"flex flex-col gap-x-8 gap-y-6 text-xs sm:flex-row",children:[c.jsxs("div",{className:"flex flex-col gap-x-5 gap-y-4 text-xs sm:flex-row",children:[c.jsx("p",{children:F("cookies.bannerIntro")}),c.jsxs("p",{children:[F("cookies.bannerExplanation"),c.jsx(Go,{href:dn,title:F("cookies.privacyLink"),className:"ps-1 underline",children:F("cookies.privacyLink")})]})]}),c.jsxs("div",{className:"flex min-w-44 shrink-0 grow flex-col gap-2",children:[c.jsx(ee,{variant:"rect",size:"32-xs",onClick:()=>E({analytics:!0,advertising:!0,socialMedia:!0}),title:F("cookies.accept"),testId:"cookie-banner-accept-button",children:F("cookies.accept")}),c.jsx(ee,{variant:"rect",size:"32-xs",onClick:()=>E({analytics:!1,advertising:!1,socialMedia:!1}),title:F("cookies.reject"),testId:"cookie-banner-reject-button",children:F("cookies.reject")}),c.jsx(ee,{variant:"rect",color:"subtle-dimmed",size:"32-xs",onClick:()=>{a("more-options")},title:F("cookies.moreOptions"),testId:"cookie-banner-options-button",children:F("cookies.moreOptions")})]})]})]}),(C==="more-options"||s==="more-options")&&c.jsxs("div",{className:"flex flex-col",children:[c.jsxs("div",{className:"flex items-center",children:[!I&&c.jsx(ee,{title:F("common.backText"),variant:"circle",color:"subtle-dimmed",size:"32-xs",onClick:()=>a("main"),children:c.jsx(po,{className:"rotate-180"})}),c.jsx("h3",{className:Ae({"ps-3":!I},"text-lg"),children:F("cookies.moreOptionsHeading")})]}),c.jsx("p",{className:"py-3 text-xs",children:F("cookies.essentialCookiesExplanation")}),c.jsx(Tp,{label:F("cookies.advertisingLabel"),explanation:F("cookies.advertisingDescription"),isChecked:m,onChange:()=>p(x=>!x),testId:"cookie-banner-advertising-option"}),c.jsx(Tp,{label:F("cookies.analyticsLabel"),explanation:F("cookies.analyticsDescription"),isChecked:i,onChange:()=>d(x=>!x),testId:"cookie-banner-analytics-option"}),c.jsx(Tp,{label:F("cookies.socialMediaLabel"),explanation:F("cookies.socialMediaDescription"),isChecked:h,onChange:()=>g(x=>!x),testId:"cookie-banner-social-option"}),c.jsx("div",{className:"flex justify-end",children:c.jsx(ee,{variant:"rect",size:"36-sm",className:"w-fit px-7",onClick:()=>{E({analytics:i,advertising:m,socialMedia:h})},title:F("cookies.savePreferences"),testId:"cookie-banner-save",children:F("cookies.savePreferences")})})]})]})})]})}function Tp(e){const{label:t,explanation:n,isChecked:o,onChange:s,testId:a}=e;return c.jsxs(c.Fragment,{children:[c.jsx(es,{horizontalMargin:!1}),c.jsx(ku,{label:t,className:"w-full py-2 pe-1",isChecked:o,onChange:s,testId:a}),c.jsx("p",{className:"pb-4 pt-1 text-xs",children:n})]})}function kve({icon:e,text:t,buttonText:n,buttonColor:o,buttonOnClick:s,className:a=""}){return c.jsxs("div",{className:Ae("flex items-center justify-between",a),children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"flex size-10 items-center justify-center rounded-[8.5px] border border-black/10 bg-background-200 dark:border-white/10",children:c.jsx("div",{className:"m-1 size-6",children:e})}),c.jsx("p",{className:"text-base",children:t})]}),c.jsx(ee,{className:"h-10 w-24",color:o,title:n,"aria-label":n,variant:"rect",onClick:s,children:n})]})}const Pve="data:image/svg+xml,%3csvg%20viewBox='0%200%2032%2032'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M22.9253%204.97196C22.5214%203.79244%2021.4126%203%2020.1658%203L18.774%203C17.3622%203%2016.1532%204.01106%2015.9033%205.40051L14.4509%2013.4782L15.0163%2011.5829C15.3849%2010.347%2016.5215%209.5%2017.8112%209.5L23.0593%209.5L25.3054%2010.809L27.4705%209.5H26.5598C25.313%209.5%2024.2042%208.70756%2023.8003%207.52804L22.9253%204.97196Z'%20fill='url(%23paint0_radial_262034_2117)'/%3e%3cpath%20d='M9.39637%2027.0147C9.79613%2028.2011%2010.9084%2029%2012.1604%2029H14.5727C16.1772%2029%2017.4805%2027.704%2017.4893%2026.0995L17.5315%2018.4862L16.9699%2020.4033C16.6058%2021.6461%2015.4659%2022.5%2014.1708%2022.5H8.88959L6.96437%2021.0214L4.88007%2022.5H5.78013C7.03206%2022.5%208.14435%2023.299%208.54411%2024.4853L9.39637%2027.0147Z'%20fill='url(%23paint1_radial_262034_2117)'/%3e%3cpath%20d='M19.7501%203H8.81266C5.68767%203%203.81268%207.08916%202.56269%2011.1783C1.08177%2016.0229%20-0.856044%2022.5021%204.75017%2022.5021H9.66051C10.9615%2022.5021%2012.105%2021.6415%2012.4657%2020.3915C13.2784%2017.5759%2014.7501%2012.4993%2015.9014%208.65192C16.4758%206.73249%2016.9543%205.08404%2017.6886%204.05749C18.1003%203.48196%2018.7864%203%2019.7501%203Z'%20fill='url(%23paint2_radial_262034_2117)'/%3e%3cpath%20d='M19.7501%203H8.81266C5.68767%203%203.81268%207.08916%202.56269%2011.1783C1.08177%2016.0229%20-0.856044%2022.5021%204.75017%2022.5021H9.66051C10.9615%2022.5021%2012.105%2021.6415%2012.4657%2020.3915C13.2784%2017.5759%2014.7501%2012.4993%2015.9014%208.65192C16.4758%206.73249%2016.9543%205.08404%2017.6886%204.05749C18.1003%203.48196%2018.7864%203%2019.7501%203Z'%20fill='url(%23paint3_linear_262034_2117)'/%3e%3cpath%20d='M12.2478%2029H23.1852C26.3102%2029%2028.1852%2024.9103%2029.4352%2020.8207C30.9161%2015.9755%2032.854%209.49548%2027.2477%209.49548H22.3375C21.0364%209.49548%2019.893%2010.3562%2019.5322%2011.6062C18.7196%2014.4221%2017.2479%2019.4994%2016.0965%2023.3474C15.5221%2025.2671%2015.0436%2026.9157%2014.3093%2027.9424C13.8976%2028.518%2013.2115%2029%2012.2478%2029Z'%20fill='url(%23paint4_radial_262034_2117)'/%3e%3cpath%20d='M12.2478%2029H23.1852C26.3102%2029%2028.1852%2024.9103%2029.4352%2020.8207C30.9161%2015.9755%2032.854%209.49548%2027.2477%209.49548H22.3375C21.0364%209.49548%2019.893%2010.3562%2019.5322%2011.6062C18.7196%2014.4221%2017.2479%2019.4994%2016.0965%2023.3474C15.5221%2025.2671%2015.0436%2026.9157%2014.3093%2027.9424C13.8976%2028.518%2013.2115%2029%2012.2478%2029Z'%20fill='url(%23paint5_linear_262034_2117)'/%3e%3cdefs%3e%3cradialGradient%20id='paint0_radial_262034_2117'%20cx='0'%20cy='0'%20r='1'%20gradientTransform='matrix(-7.37821%20-8.55084%20-7.96607%207.17216%2025.5747%2013.5466)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0.0955758'%20stop-color='%2300AEFF'/%3e%3cstop%20offset='0.773185'%20stop-color='%232253CE'/%3e%3cstop%20offset='1'%20stop-color='%230736C4'/%3e%3c/radialGradient%3e%3cradialGradient%20id='paint1_radial_262034_2117'%20cx='0'%20cy='0'%20r='1'%20gradientTransform='matrix(6.61516%207.92888%207.80904%20-6.47171%207.1753%2021.9482)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20stop-color='%23FFB657'/%3e%3cstop%20offset='0.633728'%20stop-color='%23FF5F3D'/%3e%3cstop%20offset='0.923392'%20stop-color='%23C02B3C'/%3e%3c/radialGradient%3e%3cradialGradient%20id='paint2_radial_262034_2117'%20cx='0'%20cy='0'%20r='1'%20gradientTransform='matrix(-0.990905%20-17.2799%2098.0282%20-5.51056%208.54161%2022.4952)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0.03'%20stop-color='%23FFC800'/%3e%3cstop%20offset='0.31'%20stop-color='%2398BD42'/%3e%3cstop%20offset='0.49'%20stop-color='%2352B471'/%3e%3cstop%20offset='0.843838'%20stop-color='%230D91E1'/%3e%3c/radialGradient%3e%3clinearGradient%20id='paint3_linear_262034_2117'%20x1='9.52186'%20y1='3'%20x2='10.3572'%20y2='22.5029'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20stop-color='%233DCBFF'/%3e%3cstop%20offset='0.246674'%20stop-color='%230588F7'%20stop-opacity='0'/%3e%3c/linearGradient%3e%3cradialGradient%20id='paint4_radial_262034_2117'%20cx='0'%20cy='0'%20r='1'%20gradientTransform='matrix(-8.64067%2024.4636%20-29.4075%20-10.797%2027.8096%207.58585)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0.0661714'%20stop-color='%238C48FF'/%3e%3cstop%20offset='0.5'%20stop-color='%23F2598A'/%3e%3cstop%20offset='0.895833'%20stop-color='%23FFB152'/%3e%3c/radialGradient%3e%3clinearGradient%20id='paint5_linear_262034_2117'%20x1='28.6736'%20y1='8.30469'%20x2='28.6627'%20y2='13.617'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0.0581535'%20stop-color='%23F8ADFA'/%3e%3cstop%20offset='0.708063'%20stop-color='%23A86EDD'%20stop-opacity='0'/%3e%3c/linearGradient%3e%3c/defs%3e%3c/svg%3e";function Mve(e,t){return e?Date.now()-parseInt(e,10)<=t:!1}function Rve(e,t){return!e||parseInt(e,10)<t}function Nve(e){const{status:t,eventName:n}=e;switch(n){case"copilotMobileCrossSelling":case"crossPromotionProfileBanner":case"crossPromotionProfileMenuItem":return{eventName:n,eventInfo_status:t};default:return{eventName:n,eventInfo_status:t}}}function Ml(e){const{name:t}=e;R.trackEvent({name:t,data:Nve(e)})}const Lve="https://ercz.adj.st/home?network=1g17o7tz&campaign=1gl0zo0u&adj_t=1gl0zo0u&adj_deep_link=sapphirecopilot%3A%2F%2Fhome%3Fnetwork%3D1g17o7tz%26campaign%3D1gl0zo0u&adj_redirect_android=https%3A%2F%2Fplay.google.com%2Fstore%2Fapps%2Fdetails%3Fid%3Dcom.microsoft.copilot&adj_redirect_ios=https%3A%2F%2Fapps.apple.com%2Fus%2Fapp%2Fmicrosoft-copilot%2Fid6472538445%3Fct%3DCMC_Copilot_ContinueChatting%26pt%3D80423",Dve="https://ercz.adj.st/home?adj_t=1ve0j84i",z2={"cross-selling-control":"https://ercz.adj.st/conversation?adj_t=1u5g1il8","cross-selling-triggerlogic-delay":"https://ercz.adj.st/conversation?adj_t=1uiszixy"};function Ove(){const e=R.getFormCode();return e==="MR0031"||e==="MR0032"}function Uve(e){if(Ove())return Dve;for(const[t,n]of Object.entries(e))if(n&&z2[t])return z2[t];return Lve}function Fve(){const e=T0(),t=ld(),n=bz(),o=Iz(),s=l.useRef(null),[a,r]=l.useState(!1),i=M(Dr),d=M(hc),m=M(uT),p=q("cross-selling-triggerlogic-delay"),h=q("cross-selling-control"),g=()=>{r(!0),Ml({name:"system",status:"Shown",eventName:"copilotMobileCrossSelling"})};l.useEffect(()=>{if(!i||d||e||n||o||!t){r(!1);return}if(!m){r(!1);return}const C=kt(sy),T=kt(Nm),S=!Mve(C,3*NI),E=Rve(T,3);S||E?p?setTimeout(()=>{g()},5e3):g():Ml({name:"system",status:"TriggeredButSnoozed",eventName:"copilotMobileCrossSelling"})},[d,e,n,o,i,m,t,p]);const y=()=>{$t(sy,Date.now().toString());const C=kt(Nm);$t(Nm,`${parseInt(C??"0",10)+1}`),r(!1),Ml({name:"interaction",status:"Dismissed",eventName:"copilotMobileCrossSelling"})},b=()=>{const C=Uve({"cross-selling-control":h,"cross-selling-triggerlogic-delay":p});zr(C),r(!1),Ml({name:"interaction",status:"Clicked",eventName:"copilotMobileCrossSelling"})};return a?c.jsx(jt,{mode:"sync",className:Ae("relative",at.modal),children:c.jsx("div",{className:"fixed inset-0 grid bg-background-850/30 dark:bg-background-150/70",onClick:y,role:"button",tabIndex:0,"aria-label":F("common.close"),children:c.jsx("div",{ref:s,className:"mb-0 h-fit w-full self-end justify-self-center rounded-t-3xl border border-white/10 bg-background-200 p-2 contrast-more:border-2 md:mb-5 md:w-fit md:rounded-3xl",onClick:C=>C.stopPropagation(),role:"dialog",children:c.jsxs("div",{className:"mx-3 mb-6 mt-3 flex flex-col gap-4",children:[c.jsx("div",{className:"text-lg md:text-center",children:F("crossSelling.header")}),c.jsx(kve,{icon:c.jsx("img",{src:Pve,alt:"Copilot",className:"size-full"}),text:F("crossSelling.copilotApp"),buttonText:F("common.open"),buttonColor:"strong",buttonOnClick:b,className:"gap-14"})]})})})}):null}function jve(){const{alreadyShown:e,dismissCoachmark:t}=g0(Tpe),[n,o]=l.useState(!1),s=l.useCallback(()=>{o(!1),t()},[t]);return l.useEffect(()=>{if(!e){const a=()=>{o(!0)};return Ce.on("edge:inline-browsing-replace-visible-conversation",a),()=>{Ce.off("edge:inline-browsing-replace-visible-conversation",a)}}},[e]),{showInlineBrowsingPreviousConversationsCoachmark:n,dismissInlineBrowsingPreviousConversationsCoachmark:s}}function Bve(e){const{renderTrigger:t}=e,{t:n}=Z(),{isOpen:o,title:s,description:a,dismiss:r}=Vve(),i=d=>{d.stopPropagation(),r()};return c.jsx(Y3,{className:"max-w-48 cursor-pointer bg-black dark:bg-background-850",arrowClassName:"dark:fill-background-850 fill-black",isOpen:o,placement:"bottom",withArrow:!0,offset:8,renderReferenceElement:d=>c.jsx("div",{ref:d.ref,className:"relative",children:t({onClick:()=>{r()}})}),portalId:"composer-container",onInsideEvent:()=>{r()},children:c.jsxs("div",{className:"flex max-w-[160px] flex-col gap-0.5 bg-black text-white dark:bg-background-850 dark:text-black",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{className:"text-2xs-strong",children:s}),c.jsx("button",{onClick:i,type:"button","aria-label":n("common.dismiss"),children:c.jsx(on,{className:"size-4"})})]}),c.jsx("div",{className:"text-2xs",children:a})]})})}function Vve(){const{t:e}=Z(),{showInlineBrowsingPreviousConversationsCoachmark:t,dismissInlineBrowsingPreviousConversationsCoachmark:n}=jve();return t?{isOpen:!0,title:e("composer.chatModes.inline.myConversations.coachmarkTitle"),description:e("composer.chatModes.inline.myConversations.description"),dismiss:n}:{isOpen:!1,title:"",description:"",dismiss:()=>{}}}function Hve(e){const{className:t}=e,{t:n}=Z(),[o,s]=l.useState(!1),a=M(y3),r=G(To),i=l.useRef(null),d=l.useCallback(p=>{i.current=p},[]),m=l.useCallback(p=>{p.key==="Escape"&&(p.preventDefault(),p.stopPropagation(),s(!1))},[]);return c.jsx(m3,{isOpen:o,onIsOpenChange:s,renderTrigger:p=>c.jsx(Bve,{renderTrigger:h=>c.jsx(ee,{ref:g=>{p.ref(g),d(g)},onClick:g=>{p.onClick(g),h.onClick(g)},color:"subtle-dimmed-inverted",variant:"square",size:"28-xxs",title:n("edgeHeader.dropdownMenuButtonTitle"),className:"ms-auto",testId:"header-dropdown","aria-haspopup":"menu","aria-expanded":o,children:c.jsx(M0,{className:"size-5"})})}),options:{overrideZIndex:at.header,placement:"bottom-end",offset:{mainAxis:4,crossAxis:0},hideOnMenuClick:!0,returnFocus:!1},className:O(lo,"flex p-1",t),children:c.jsxs(fo,{axis:"vertical",className:"flex flex-col items-start gap-1",role:"menu",circular:!0,onKeyDown:m,children:[!a&&c.jsx(ee,{variant:"rect",color:"subtle-dimmed-inverted",className:"w-full justify-start text-sm",onClick:()=>{r(!0),de({source:"sidebarHeader"})},title:n("edgeHeader.conversationHistory"),testId:"header-conversation-history-button",role:"menuitem",children:n("edgeHeader.conversationHistory")}),c.jsx(ee,{variant:"rect",color:"subtle-dimmed-inverted",className:"w-full justify-start text-sm",onClick:p=>{p.stopPropagation(),r(!1),k_("menu",{onPopPageCallback:()=>{i.current?.focus()}}),s(!1)},title:n("settings.settings"),testId:"header-settings-button",role:"menuitem",children:n("settings.settings")}),c.jsx(ee,{variant:"rect",color:"subtle-dimmed-inverted",className:"w-full justify-start text-sm",onClick:()=>{Ce.emit("edge:header-command","sendFeedback")},title:n("settings.feedbackButton"),testId:"header-feedback-button",role:"menuitem",children:n("settings.feedbackButton")})]})})}const m4=({title:e,titleId:t,...n})=>l.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M3.28035 2.21967C2.98746 1.92678 2.51258 1.92677 2.21968 2.21966C1.92678 2.51255 1.92677 2.98742 2.21967 3.28032L8.12461 9.18526L4.81064 10.3301C3.93794 10.6315 3.68202 11.7426 4.3349 12.3954L7.43942 15.4999L3.00009 19.9392L3.00001 20.9999H4.06077L8.50009 16.5605L11.6046 19.665C12.2575 20.3179 13.3686 20.062 13.67 19.1893L14.8148 15.8755L20.7196 21.7803C21.0125 22.0732 21.4874 22.0732 21.7803 21.7803C22.0732 21.4874 22.0732 21.0126 21.7803 20.7197L3.28035 2.21967ZM13.6353 14.696L12.3827 18.3218L5.67816 11.6174L9.30412 10.3648L13.6353 14.696ZM19.6829 10.8201L15.8957 12.7137L17.0137 13.8317L20.3537 12.1617C22.0326 11.3223 22.3957 9.08476 21.0684 7.75751L16.2426 2.93179C14.9153 1.60453 12.6778 1.96763 11.8383 3.6465L10.1684 6.98637L11.2864 8.10441L13.18 4.31731C13.5616 3.55419 14.5786 3.38914 15.1819 3.99244L20.0078 8.81817C20.6111 9.42146 20.446 10.4385 19.6829 10.8201Z"})),h3e=Object.freeze(Object.defineProperty({__proto__:null,default:m4},Symbol.toStringTag,{value:"Module"})),p4=({title:e,titleId:t,...n})=>l.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M16.2425 2.93189L21.0682 7.75765C22.3955 9.08491 22.0324 11.3224 20.3535 12.1619L15.4826 14.5973C15.3073 14.685 15.1732 14.8379 15.1092 15.0232L13.6699 19.1895C13.3684 20.0622 12.2574 20.3181 11.6045 19.6653L8.50002 16.5607L4.06074 21.0001H3L3.00008 19.9394L7.43936 15.5001L4.33487 12.3956C3.682 11.7427 3.93791 10.6317 4.81061 10.3302L8.97688 8.89096C9.16223 8.82694 9.31512 8.69287 9.40281 8.51748L11.8382 3.6466C12.6777 1.96772 14.9152 1.60462 16.2425 2.93189ZM20.0076 8.81831L15.1818 3.99255C14.5785 3.38924 13.5614 3.55429 13.1799 4.31742L10.7445 9.18829C10.4814 9.71446 10.0227 10.1167 9.46666 10.3087L5.67812 11.6175L12.3826 18.322L13.6914 14.5335C13.8835 13.9774 14.2857 13.5188 14.8118 13.2557L19.6827 10.8202C20.4458 10.4387 20.6109 9.42161 20.0076 8.81831Z"})),g3e=Object.freeze(Object.defineProperty({__proto__:null,default:p4},Symbol.toStringTag,{value:"Module"}));function zve(e){const{isPinned:t,showCloseButton:n,showPinButton:o,className:s}=e,{t:a}=Z(),r=Hs(()=>{const i=document.getElementById("app");if(i&&r.current){const d=r.current.clientWidth;i.style.setProperty("--header-controls-inline-end-width",`${d}px`)}});return c.jsxs("div",{className:O("flex items-center",s),"data-testid":"header-controls",ref:r,children:[c.jsx(Hve,{}),o&&c.jsx(ee,{variant:"square",color:"subtle-dimmed-inverted",size:"28-xxs",onClick:()=>{Ce.emit("edge:header-command","togglePinState")},title:a(t?"edgeHeader.unpinButtonTitle":"edgeHeader.pinButtonTitle"),testId:"header-pin-button",children:t?c.jsx(m4,{className:"size-5"}):c.jsx(p4,{className:"size-5"})}),n&&c.jsx(ee,{variant:"square",color:"subtle-dimmed-inverted",size:"28-xxs",onClick:()=>{Ce.emit("edge:header-command","closePane")},title:a(t?"edgeHeader.closeButtonAsPinnedTitle":"edgeHeader.closeButtonAsUnpinnedTitle"),testId:"header-close-button",children:c.jsx(on,{className:"size-5"})})]})}function Gve({pixelUrl:e,onComplete:t}){return l.useEffect(()=>{const n=setTimeout(()=>{t()},3e3);return()=>{clearTimeout(n)}},[e,t]),c.jsx("img",{className:"hidden",src:e,width:"1",height:"1",alt:"",referrerPolicy:"no-referrer-when-downgrade",onLoad:t,onError:t})}function Wve(){const e=q("ads-pixels"),[t,n]=Le(pT),o=M(Dg),s=M(Bt),a=(s&&Zu.includes(s))===!0,r=l.useMemo(()=>Ia(),[o]),i=!a||r.advertising;if(!e||!i)return null;const d=Object.values(t).filter(m=>m.isMounted).map(m=>m.url);return c.jsx("div",{className:"absolute start-[-9999px] top-[-9999px] size-px overflow-hidden",children:d.map(m=>c.jsx(Gve,{pixelUrl:m,onComplete:()=>n(p=>p[m]?{...p,[m]:{...p[m],isMounted:!1}}:p)},m))})}function $ve(e){const{label:t,selected:n,onClick:o,icon:s}=e;return c.jsxs(ee,{className:O("flex w-48 justify-start",{"bg-black/5 contrast-more:bg-[Highlight] dark:bg-background-150":n}),title:t,role:"tab","aria-selected":n,"aria-current":n?"true":void 0,color:"subtle-dimmed",size:"36-sm",onClick:o,children:[c.jsx("span",{className:"w-full truncate text-start",children:t}),s&&c.jsx(s,{className:"size-4"})]})}const f4=({title:e,titleId:t,...n})=>l.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M6.24992 4.5C5.28344 4.5 4.49996 5.2835 4.49996 6.25V17.75C4.49996 18.7165 5.28344 19.5 6.24992 19.5H17.7496C18.7161 19.5 19.4996 18.7165 19.4996 17.75V13.75C19.4996 13.3358 19.8354 13 20.2496 13C20.6638 13 20.9995 13.3358 20.9995 13.75V17.75C20.9995 19.5449 19.5445 21 17.7496 21H6.24992C4.45504 21 3 19.5449 3 17.75V6.25C3 4.45507 4.45504 3 6.24992 3H10.2498C10.664 3 10.9998 3.33579 10.9998 3.75C10.9998 4.16421 10.664 4.5 10.2498 4.5H6.24992ZM12.9997 3.75C12.9997 3.33579 13.3355 3 13.7497 3H20.25C20.6642 3 21 3.33579 21 3.75V10.25C21 10.6642 20.6642 11 20.25 11C19.8358 11 19.5 10.6642 19.5 10.25V5.56074L14.28 10.7804C13.9871 11.0732 13.5123 11.0732 13.2194 10.7803C12.9265 10.4874 12.9265 10.0125 13.2194 9.71964L18.4395 4.5H13.7497C13.3355 4.5 12.9997 4.16421 12.9997 3.75Z"})),v3e=Object.freeze(Object.defineProperty({__proto__:null,default:f4},Symbol.toStringTag,{value:"Module"})),h4="text-neutral-600 dark:text-neutral-350",y3e=O("items-start justify-start text-sm",h4),C3e=O("items-start justify-start text-xs",h4),S3e=O("content-end items-start justify-start text-accent-550 text-sm dark:text-accent-650"),b3e="bg-accent-100 dark:bg-muted-200",I3e="USD",E3e={Visa:{Family:"credit_card",Type:"visa"},Amex:{Family:"credit_card",Type:"amex"},MasterCard:{Family:"credit_card",Type:"mc"},Discover:{Family:"credit_card",Type:"discover"}},T3e="shopify",w3e="commercetools",qve="paypal",A3e="salesforce",x3e="stripe",_3e={paypal:"PayPal",venmo:"Venmo"},k3e=["paypal","venmo"],P3e={PAYPAL_INHOUSE:"paypal-inhouse",ADD_NEW:"addnewpm"},M3e="underline focus-visible:outline focus-visible:outline-current",R3e="https://account.microsoft.com/billing/payments",N3e="https://account.microsoft.com/billing/addresses",L3e="https://www.paypal.com/us/legalhub/paypal/privacy-full",D3e="COPILOT_PRODUCT_DETAILS_PAGE",O3e="paypalNativeCheckout",U3e="walletPaymentFailed",F3e="wallet.checkoutFooterDisclosure",j3e="wallet.checkoutFooterDisclosureWithMerchantTerms",B3e="wallet.checkoutFooterDisclosureWithEtsyTerms",V3e="wallet.PayPalFooterDisclosure",H3e="wallet-button-shipping-address",z3e="wallet-button-shipping-method",G3e="wallet-button-payment-options";function g4(){const t=J.instance().config().shopping?.payment?.isPayPalCheckoutEnabled??!1,n=M(Bt);return t&&n==="US"}function W3e(e){const t=e?.toLowerCase()===qve.toLocaleLowerCase(),n=g4();return t&&n}function v4(){const e=q("copilot-beta"),t=q("memory-settings-v2"),n=M(ud),o=r0(),{t:s}=Z(),a=Dt(),r=M(HT),i=M(Yu),d=q("shopping-card"),m=Pc(["wallet-management-msa","pay-enable-checkout-urban","pay-enable-checkout-etsy"],"any"),p=ws({key:"shouldShowHostSettings",default:!1}),h=g4(),g=m||h,y=[{label:s("settings.preferences.title"),page:"preferences"},{label:s("settings.memory.title"),page:"memory-overview",needSignIn:!0},{label:s("settings.accountTitle"),page:"account"},{label:s("settings.connectedAppsTitle"),page:"connector-list",needSignIn:!0},{label:s("settings.shoppingTitle"),page:"shopping",needSignIn:!0},{label:s("settings.wallet"),page:"wallet",needSignIn:!0},{label:s("subscriptionManage.title"),page:"manage-subscription",needSignIn:!0},{label:s("settings.privacyLink"),page:"privacy",needSignIn:!0},{label:s("settings.titleAbout"),page:"about"},{label:s("settings.copilotBeta.title"),page:"copilot-beta"},{label:s("settings.title.browsing"),page:"host-browsing-settings",icon:f4}];return B(Na)?[{label:s("settings.titleAbout"),page:"about-sandbox"}]:y.filter(C=>{switch(C.page){case"memory-overview":return t&&a;case"copilot-beta":return(e||o)&&n;case"manage-subscription":return r;case"wallet":return a&&i&&g;case"shopping":return a&&d;case"host-browsing-settings":return p;default:return!C.needSignIn||a}})}function Kve(){const{currentPage:e,pushPage:t,parentPageOf:n}=as(),o=v4(),{t:s}=Z();return c.jsx("nav",{"aria-label":s("settings.settings"),className:"flex flex-col",children:c.jsx(fo,{axis:"vertical",circular:!0,children:c.jsx("ul",{role:"tablist","aria-orientation":"vertical",className:"flex list-none flex-col gap-0.5",children:o.map(a=>c.jsx("li",{role:"presentation",children:c.jsx($ve,{label:a.label,selected:e===a.page||e!==void 0&&n[e]===a.page,icon:a.icon,onClick:async()=>{a.page==="host-browsing-settings"?await nq.run({}):t(a.page)}})},a.label))})})})}function Yve(){const{currentPage:e}=as(),o=(v4().find(s=>s.page===e)?.label??"").trim();return o?c.jsxs("div",{className:"sticky top-0 z-10 bg-white py-3 dark:bg-background-150",children:[c.jsx("h3",{className:"flex w-full items-center justify-start p-2 pb-4 text-base-medium",children:o}),c.jsx(es,{verticalMargin:!1})]}):null}const y4=l.createContext(null);function Zve(e){const{value:t,children:n}=e;return c.jsx(y4.Provider,{value:t,children:n})}function $3e(){const e=l.useContext(y4);return e||null}function Jve(){return c.jsx("div",{className:"flex size-full items-center justify-center",children:c.jsx(xt,{className:"size-12"})})}const Qve=l.lazy(()=>N(()=>import("./settings-yeq8-NFE.js"),__vite__mapDeps([326,1,327,328,329,330,331,332,333,334,335,2,336,337,338,339,323,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362])));function Xve(e){const{customSettings:t}=e,n=l.useRef(null);return c.jsx(Zve,{value:n,children:c.jsx("div",{className:"flex h-full min-h-0",ref:n,children:c.jsxs("div",{className:"flex w-full flex-1 gap-3",children:[c.jsx(Kve,{}),c.jsx("div",{className:O("relative flex min-h-0 min-w-0 flex-1 rounded-3xl bg-white will-change-auto dark:bg-background-150","after:pointer-events-none after:absolute after:inset-0 after:z-10 after:rounded-3xl after:border after:border-black/10 dark:border-transparent"),children:c.jsxs("div",{className:"t-custom-scrollbar flex flex-1 flex-col overflow-y-auto rounded-3xl px-3 pb-3",children:[c.jsx(Yve,{}),c.jsx(l.Suspense,{fallback:c.jsx(Jve,{}),children:c.jsx(Qve,{shouldShowHeaderOverride:!1,customSettings:t})})]})})]})})})}function eye(e){const{customSettings:t}=e,n=R0(),{currentPage:o,closeSettings:s}=as(),{t:a}=Z(),r=gt({breakpoint:"sm"}),i=l.useRef(null);return l.useEffect(()=>{i.current===!1&&r&&s(),i.current=r},[r,s]),n?c.jsx(_s,{isOpen:!!o&&o!=="menu",className:"size-full h-conversation-modal p-3 dark:bg-background-150/50 md:w-[728px]",headerTextClassName:"ps-2.5 py-2",headerText:a("settings.settings"),onClose:s,bottomSheetOnSmall:!1,children:c.jsx(Xve,{customSettings:t})}):null}function tye(){const e=J.instance().config().uiOverrides?.showUpgradeAppTopBanner;l.useEffect(()=>{e&&R.trackEvent({name:"system",data:{eventName:"upgradeSurfaceApp",eventInfo_status:"Shown"}})},[e]);const t=()=>{R.trackEvent({name:"interaction",data:{eventName:"upgradeSurfaceApp",eventInfo_status:"Clicked"}}),zr("macappstore://apps.apple.com/app/id6738511300")};return e?c.jsxs("div",{className:"pointer-events-none absolute inset-x-0 top-0 flex w-full justify-center p-3",children:[c.jsx("div",{className:"absolute top-0 h-3.5 w-full bg-background-150 opacity-90 dark:bg-background-150"}),c.jsx("div",{className:Ae("relative w-full max-w-cookie-banner rounded-xl border border-black/5 shadow-xl dark:border-black/40",lo,at.modal),children:c.jsx("div",{className:"pointer-events-auto relative max-h-[90vh] overflow-auto p-5",id:"cookie-banner",children:c.jsxs("div",{className:"flex flex-col gap-4",children:[c.jsx("h3",{className:"text-lg",children:F("upgradeSurface.heading")}),c.jsxs("div",{className:"flex flex-col gap-x-8 gap-y-6 text-xs sm:flex-row",children:[c.jsxs("div",{className:"flex flex-col gap-x-5 gap-y-4 text-xs sm:flex-row",children:[c.jsx("p",{children:F("upgradeSurface.primaryDescription")}),c.jsx("p",{children:F("upgradeSurface.secondaryDescription")})]}),c.jsx("div",{className:"flex min-w-44 shrink-0 grow flex-col justify-center gap-2",children:c.jsx(ee,{variant:"rect",size:"32-xs",onClick:t,title:F("upgradeSurface.buttonText"),children:F("upgradeSurface.buttonText")})})]})]})})})]}):null}const nye=l.lazy(()=>N(()=>Promise.resolve().then(()=>Cx),void 0)),oye=rs(()=>N(()=>import("./settings-wrapper-C9cB8uv8.js"),__vite__mapDeps([492,1,323,324,325,2])),{moduleName:"settings-wrapper",retryStrategy:mo}),sye=rs(()=>N(()=>import("./media-viewer-C1gXUrSm.js"),__vite__mapDeps([493,1,494,495,496,362,2])),{moduleName:"media-viewer",exportName:"MediaViewer",showErrorToast:!0,retryStrategy:mo}),aye=l.lazy(()=>N(()=>import("./picture-in-picture-DQ-K9Vwc.js"),__vite__mapDeps([497,1,455,405,498,499,2])).then(e=>({default:e.PictureInPicture}))),rye=rs(()=>N(()=>import("./app-modals-2Er66Kf3.js").then(e=>e.a),__vite__mapDeps([500,1,383,384,385,386,387,388,381,378,2,389,390,362,397,501,502,503,504,505,328,329,327,506,323,445,507,508,420,509,425,510,511,512,513,405,370,374,448,514,515,516,414,517,518,412,495,496,519,427])),{moduleName:"app-modals",exportName:"AppModals",retryStrategy:mo});function iye(e){const{children:t,customLayout:n,background:o,borderless:s,paddingTop:a,customSettings:r}=e,i=C3(),d=sn(),{isPictureInPictureOpen:m}=N3(),p=J.instance().config().appLayout,h=M(due),g=M(mue),y=M(pue),b=yde();return c.jsxs(c.Fragment,{children:[b&&c.jsx("div",{className:O("pointer-events-none sticky top-0 w-full",at.header),children:c.jsx("div",{className:"pointer-events-auto absolute end-2 top-2",children:c.jsx(zve,{isPinned:y,showCloseButton:h,showPinButton:g})})}),c.jsxs(ide,{borderless:s,background:o,paddingTop:a,children:[i||n?t:c.jsxs(tm,{className:"flex-1",children:[t,c.jsx(cye,{}),c.jsx(lye,{}),c.jsx(sm,{})]}),c.jsx(Y_,{}),m&&c.jsx(l.Suspense,{fallback:c.jsx(Ede,{}),children:c.jsx(aye,{})})]}),p.showMobileCrossSelling&&d.startsWith("/chats")&&!ao(d)&&c.jsx(Fve,{}),p.showCookieBanner&&c.jsx(_ve,{}),c.jsx(tye,{}),c.jsx(hI,{children:c.jsx(l.Suspense,{fallback:null,children:c.jsx(rye,{})})}),c.jsx(eye,{customSettings:r}),c.jsx("div",{id:"inAppFeedbackOcv"}),c.jsx("div",{id:"popoverPortal"}),c.jsx(Wve,{})]})}function cye(){const{isMediaViewerOpen:e}=Ro();return e?c.jsx(l.Suspense,{fallback:c.jsx("div",{className:"pointer-events-auto absolute inset-0 flex items-center justify-center",children:c.jsx(nye,{type:"spinnerThemed",className:"size-12"})}),children:c.jsx(sye,{})}):null}function lye(){return vde()?c.jsx(d4,{children:c.jsx(om,{suppressBottomSection:!0})}):null}function sm(){const t=J.instance().config().appLayout.showSettings,n=Vs(),o=q("sidebar-settings");return t?c.jsx(Cs,{fallback:null,children:c.jsx(oye,{className:O("top-6",n&&"-me-1 -mt-3",o&&"-me-[14px] -mt-[14px]")})}):null}function uye(){typeof window<"u"&&(Object.defineProperty(window,"APP_VERSION",{value:Xu()}),Object.defineProperty(window,"APP_SURFACE",{value:"cmc"}))}function dye(e){const{background:t}=e,n=c.jsxs(c.Fragment,{children:[c.jsx(dd,{children:c.jsx(jle,{})}),c.jsx(iye,{background:t,children:c.jsx(ub,{})})]});return c.jsx(ale,{children:n})}function mye(e){const{onError:t=Y5,background:n}=e,o=hue(),s=gue();return c.jsxs(wI,{fallback:c.jsx(t0,{}),onError:t,children:[c.jsx(TA,{}),o?c.jsx(ub,{}):c.jsx(dye,{background:s?n:void 0})]})}uye();Vle();function pye(){return({search:e,next:t})=>t(e)}ux();const fye=f({"prompt-branch":u().optional(),"use-sxs":Q([V(),u()]).transform(e=>typeof e=="string"?e==="true":e).optional(),branch:u().optional(),picasso_preview:u().optional(),"sxs-feature":u().optional(),renderingType:z(["ssr","csr"]).optional()}),Ye=TM({Root:()=>c.jsx(tR,{routeId:Ye.id,children:c.jsx(mye,{})}),routerConfig:{validateSearch:e=>fye.parse(e),search:{middlewares:[pye(),Q9(["prompt-branch","use-sxs","branch","picasso_preview","sxs-feature","renderingType"])]}}}),hye=Re("/tasks")({}),gye=Re("/shopping")({beforeLoad:()=>({customLayout:!0})}),vye=Re("/shares")({head:()=>Rs(()=>({meta:[{name:"robots",content:EM}]}))}),yye=Re("/library")({beforeLoad:()=>({customLayout:!0})}),Rl={default:{getTitle:e=>e("server.labs.metadata.title"),getDescription:e=>e("server.labs.metadata.description"),image:"/static/copilotlabs/og_image.png"},"copilot-gaming-experiences":{getTitle:e=>e("server.labs.metadata.experiments.copilotGamingExperiences.title"),getDescription:e=>e("server.labs.metadata.experiments.copilotGamingExperiences.description"),image:"/static/copilotlabs/labs-meta-copilot-gaming-experiences.png"},"copilot-3d":{getTitle:e=>e("server.labs.metadata.experiments.copilot3d.title"),getDescription:e=>e("server.labs.metadata.experiments.copilot3d.description"),image:"/static/copilotlabs/labs-meta-copilot-3d.png"},"copilot-appearance":{getTitle:e=>e("server.labs.metadata.experiments.copilotAppearance.title"),getDescription:e=>e("server.labs.metadata.experiments.copilotAppearance.description"),image:"/static/copilotlabs/labs-meta-copilot-appearance.png"},mico:{getTitle:e=>e("server.labs.metadata.experiments.mico.title"),getDescription:e=>e("server.labs.metadata.experiments.mico.description"),image:"/static/copilotlabs/labs-meta-mico.png"},"copilot-vision":{getTitle:e=>e("server.labs.metadata.experiments.copilotVision.title"),getDescription:e=>e("server.labs.metadata.experiments.copilotVision.description"),image:"/static/copilotlabs/labs-meta-copilot-vision.png"},"copilot-podcasts":{getTitle:e=>e("server.labs.metadata.experiments.copilotPodcasts.title"),getDescription:e=>e("server.labs.metadata.experiments.copilotPodcasts.description"),image:"/static/copilotlabs/labs-meta-copilot-podcasts.png"},"think-deeper":{getTitle:e=>e("server.labs.metadata.experiments.thinkDeeper.title"),getDescription:e=>e("server.labs.metadata.experiments.thinkDeeper.description"),image:"/static/copilotlabs/labs-meta-think-deeper.png"},"copilot-actions":{getTitle:e=>e("server.labs.metadata.experiments.copilotActions.title"),getDescription:e=>e("server.labs.metadata.experiments.copilotActions.description"),image:"/static/copilotlabs/labs-meta-copilot-actions.png"},"audio-expression":{getTitle:e=>e("server.labs.metadata.experiments.audioExpression.title"),getDescription:e=>e("server.labs.metadata.experiments.audioExpression.description"),image:"/static/copilotlabs/labs-meta-audio-expression.png"},portrait:{getTitle:e=>e("server.labs.metadata.experiments.portrait.title"),getDescription:e=>e("server.labs.metadata.experiments.portrait.description"),image:"/static/copilotlabs/labs-meta-portrait.png"}},Cye=["/labs","/gaming"];function Sye(e){return Cye.some(t=>e.startsWith(t))}const bye=e=>e==="/gaming"?"copilot-gaming-experiences":e.startsWith("/labs/experiments/3d-generations")?"copilot-3d":e.match(/^\/labs(?:\/experiments)?\/(?<alias>[^/?#]+)/)?.[1],C4=(e,t)=>{const n=t?.t.bind(t)??(s=>s),o={title:Rl.default.getTitle(n),description:Rl.default.getDescription(n),image:Rl.default.image};if(!e)return o;if(Sye(e)){const s=bye(e),a=s?Rl[s]:void 0;if(a)return{title:a.getTitle(n),description:a.getDescription(n),image:a.image}}return o},Iye=()=>N(()=>import("./labs_-SjphyWD9.js"),__vite__mapDeps([520,1,521,2])),Eye=Re("/labs_")({head:e=>Rs(()=>{const{baseUrl:t,canonical:n,i18n:o}=e.match.context,a=e.matches[e.matches.length-1]?.pathname??e.match.pathname,{title:r,description:i,image:d}=C4(a,o),m=`${t}${d}`;return{meta:[...r?[{title:r}]:[],...i?[{name:"description",content:i}]:[],...Ca({title:r,description:i,url:n,imageUrl:m,imageWidth:"1200",imageHeight:"630"}),...Sa({title:r,description:i,card:"summary_large_image",image:m})]}}),component:X9(Iye,"component"),beforeLoad:()=>({customLayout:!0})}),Tye=Re("/health")({beforeLoad:()=>({customLayout:!0})}),wye=Re("/gaming")({beforeLoad:()=>({customLayout:!0}),staticData:{showBackButton:"auto"},head:e=>Rs(()=>{const{baseUrl:t,canonical:n,i18n:o}=e.match.context,{pathname:s}=e.match,{title:a,description:r,image:i}=C4(s,o),d=`${t}${i}`;return{meta:[...a?[{title:a}]:[],...r?[{name:"description",content:r}]:[],...Ca({title:a,description:r,url:n,imageUrl:d,imageWidth:"1200",imageHeight:"630"}),...Sa({title:a,description:r,card:"summary_large_image",image:d})]}})}),Aye=Re("/daily")({beforeLoad:()=>({showSidebarHeaderAcrylicBackplate:!0,customLayout:!0})});function xye(){const e=Dt(),t=M(BT),n=M(Tr),o=M(VT),s=M(Na),a=M(NW),r=!!M(LW),i=!!M(DW),d=!!(ws({key:"shouldShowTextModelTrainingSettings",default:!0})&&r),m=!!(ws({key:"shouldShowVoiceModelTrainingSettings",default:!0})&&i),p="chat.firstTurnDisclaimerBaseAi",h=d||m,g=!h||t&&!n,y=b_(),[b,C]=Le(WT),[T,S]=l.useState(!1);l.useEffect(()=>{if((h||a)&&e&&!s){if(b){S(!0),C(!1);return}if(y<qp){S(!0);return}let x;try{x=Ire()}catch{x=new Date}const w=W_(x,6),P=new Date;P>w&&(S(!0),$t(yr,P.toISOString()))}},[e,h,s,y,a,b,C]);const E=()=>g===void 0||o===void 0||a===void 0?null:s||!e?"chat.unauthenticatedDisclaimer":!a||!T?p:!g&&!o?"chat.firstTurnDisclaimerPersonalizationTraining":g&&!o?"chat.firstTurnPersonalizationDisclaimer":o&&!g?"chat.firstTurnTrainingDisclaimer":p;return(()=>{let x=E();return x?J.instance().config().uiOverrides?.hideTrainingDisclaimer?p:(x=J.instance().config().textOverrides?.(x)??x,x):null})()}const _ye="text-foreground-450 text-sm dark:text-foreground-600",kye="underline",G2={settingsLink:e=>c.jsx(Wd,{pages:["menu","account","privacy"],className:O(e,kye),clickSource:"disclaimerSettingsLink"}),learnMoreLink:c.jsx(sh,{link:wu})},Nl={termsLink:c.jsx(sh,{link:Qi}),privacyLink:c.jsx(sh,{link:dn})},Pye={settingsLink:e=>c.jsx(Wd,{pages:["menu","account","privacy"],className:e,disableLink:!0})};function oh(e){const{forceVisible:t,disableDisclaimerSettingsLink:n,className:o,testId:s,shouldUpdateNewConversationCount:a,textClassName:r}=e,i=r??_ye,d=xye(),m=M(Rt),p=m?.id,g=(m?.isNew??t)&&d;if(l.useEffect(()=>{!a||!g||!p||wre(p)},[a,g,p]),!g)return null;const y=b=>{switch(b){case"chat.unauthenticatedDisclaimer":return c.jsxs(c.Fragment,{children:[c.jsx(mn,{i18nKey:"chat.firstTurnDisclaimerBaseAi"})," ",c.jsx(mn,{i18nKey:b,components:{termsLink:Nl.termsLink,privacyLink:Nl.privacyLink}})]});case"chat.firstTurnTrainingDisclaimer":case"chat.firstTurnPersonalizationDisclaimer":case"chat.firstTurnDisclaimerPersonalizationTraining":return c.jsxs(c.Fragment,{children:[c.jsx(mn,{i18nKey:"chat.firstTurnPersonalizationDisclaimerBaseAi"})," ",c.jsx(mn,{i18nKey:b,components:{settingsLink:n?Pye.settingsLink(i):G2.settingsLink(i)}})]});case"chat.edge.firstTurnPersonalizationDisclaimer":case"chat.edge.firstTurnPersonalizationSettingsDisclaimer":return c.jsxs(c.Fragment,{children:[c.jsx(mn,{i18nKey:"chat.firstTurnPersonalizationDisclaimerBaseAi"})," ",c.jsx(mn,{i18nKey:b,components:{learnMoreLink:G2.learnMoreLink,bold:c.jsx("strong",{})}})]});case"chat.firstTurnDisclaimerBaseAi":case"chat.firstTurnPersonalizationDisclaimerBaseAi":case"chat.tv.firstTurnDisclaimer":return c.jsx(mn,{i18nKey:b});case"chat.livingPortraitDisclaimerAi":return c.jsx(mn,{i18nKey:b,components:{termsLink:Nl.termsLink,privacyLink:Nl.privacyLink}});default:return null}};return c.jsx(jt,{id:d,mode:"wait",className:O("space-y-8 pb-8",i,o),"data-testid":s,children:y(d)})}function sh(e){const{children:t,link:n,className:o}=e;return c.jsx(Go,{className:O("underline",o),href:n,title:"",children:t})}function Mye(e){const{customBottomDisclaimer:t,className:n,textClassName:o}=e,s=q("async-disclaimer-text"),a=Bw(),[r,i]=l.useState(!s);return l.useEffect(()=>{a&&a.length>0&&i(!0)},[a]),t||(r?c.jsx(jt,{className:"absolute bottom-0 flex max-w-chat justify-center px-6 text-center","data-testid":"bottom-disclaimer",children:c.jsx(oh,{shouldUpdateNewConversationCount:!0,className:n,textClassName:o})}):null)}function Rye(){return c.jsx("div",{"aria-hidden":!0,className:"flex size-full flex-col items-center justify-center"})}const er="absolute animate-dot-ellipsis size-2 rounded-full bg-background-450";function Nye(e){const{className:t}=e;return c.jsxs("div",{className:O("flex items-center justify-center gap-3",t),children:[c.jsxs("div",{className:"relative flex items-center justify-center",children:[c.jsx("div",{className:er,style:{animationDelay:"0ms"}}),c.jsx("div",{className:er,style:{animationDelay:"30ms"}})]}),c.jsxs("div",{className:"relative flex items-center justify-center",children:[c.jsx("div",{className:er,style:{animationDelay:"100ms"}}),c.jsx("div",{className:er,style:{animationDelay:"130ms"}})]}),c.jsxs("div",{className:"relative flex items-center justify-center",children:[c.jsx("div",{className:er,style:{animationDelay:"200ms"}}),c.jsx("div",{className:er,style:{animationDelay:"230ms"}})]})]})}const S4=.6;function q3e(e={},t={}){return{start:{...e,opacity:0},end:n=>({...t,opacity:1,transition:{delay:n,ease:"easeInOut",duration:S4}})}}function Lye(e){const{text:t,staggerChildren:n=.018,delayChildren:o=0,initialOpacity:s=0,className:a,style:r}=e;return c.jsx(he.div,{variants:{show:{transition:{staggerChildren:n,delayChildren:o}}},initial:"hidden",animate:"show",className:a,style:r,children:Xk(t).map((i,d)=>c.jsx(he.span,{variants:{hidden:{opacity:s},show:{opacity:1,transition:{duration:S4}}},children:i},d))})}const Dye={sm:"text-lg",md:"text-2xl",lg:"text-4xl"},W2=25;function Oye(e){const{className:t,fontSize:n="lg"}=e,o=M(Bd),s=M(OT),{t:a}=Z(),{greetingKey:r,widgetGreeting:i,shouldAnimateGreeting:d}=s_(),{isCentralComposerEnabled:m,isGreetingCentered:p}=za(),h=d0(),g=cme(),{showShoppingCardInNewChat:y}=Ha(),b=s&&s.length>W2?`${s.slice(0,W2)}`:s,C=r?a(r,{name:b}):"";return h?c.jsx("div",{className:O(t,"flex w-full flex-col items-start justify-start gap-2 sm:mb-6 sm:h-[100px] sm:justify-end"),children:c.jsx("div",{className:"flex justify-start sm:min-h-8",children:!g||o?c.jsx("div",{className:"ms-2 mt-6 flex size-full sm:mt-0",children:c.jsx(Nye,{className:"flex-1"})}):c.jsxs("div",{className:"flex flex-col items-start gap-2",children:[c.jsxs(jt,{className:"flex items-center gap-2 text-foreground-550 dark:text-foreground-750",id:i??C,children:[c.jsx("p",{className:"text-sm-strong",children:a("common.copilotText")}),c.jsx("p",{className:"text-sm",children:fn(new Date,"h:mm aa")})]}),c.jsx("h1",{className:"text-xl",children:c.jsx(ah,{text:i??C},i)})]})})}):c.jsx("div",{className:O("flex w-full flex-col items-start justify-start sm:justify-end",!y&&"sm:mb-8 sm:h-[100px]",p&&"sm:items-center",!m&&"sm:justify-start",Dye[n],t),"data-testid":"launch-greeting",children:c.jsx("h1",{children:d?c.jsx(ah,{text:C},C):C})})}const ah=l.memo(e=>{const{text:t}=e;return c.jsx(Lye,{text:t,staggerChildren:.02,delayChildren:.1},t)});ah.displayName="AnimatedTextMemo";function Uye(e){const{customLaunchGreeting:t,className:n}=e;return t||c.jsx(Oye,{className:n,fontSize:"md"})}function b4(e){const{className:t}=e,n=M(Na),o="top-disclaimer";return n?c.jsx(oh,{forceVisible:!0,className:t,testId:o,shouldUpdateNewConversationCount:!0}):c.jsx(oh,{className:t,testId:o,shouldUpdateNewConversationCount:!0})}const rh="long-animation-frame";function Fye(e){return e.entryType===rh}function jye(e){const{pageName:t,scenario:n}=e,o=l.useRef(null),s=ba();l.useEffect(()=>{if(!(!s||typeof PerformanceObserver>"u"||!PerformanceObserver.supportedEntryTypes.includes(rh)))return o.current=new PerformanceObserver(a=>{try{const r="deviceMemory"in navigator?navigator.deviceMemory:void 0,i="hardwareConcurrency"in navigator?navigator.hardwareConcurrency:void 0;for(const d of a.getEntries())if(Fye(d)){const m={eventName:"longAnimationFrame",eventInfo_pageName:t,eventInfo_scenario:n,eventInfo_duration:d.duration,eventInfo_conversationId:B(Te),eventInfo_customData:JSON.stringify({...r!==void 0&&{deviceMemory:r},...i!==void 0&&{hardwareConcurrency:i},blockingDuration:d.blockingDuration})};R.trackEvent({name:"system",data:m})}}catch(r){Je({feature:"performance",scenario:"longAnimationFrame",errorType:"LongAnimationFrameTrackingFailed",errorMessage:r instanceof Error?r.message:"unknown",customData:JSON.stringify({pageName:t,scenario:n})})}}),o.current.observe({type:rh,buffered:!0}),()=>{o.current&&(o.current.disconnect(),o.current=null)}},[s,t,n])}function I4(){const{isAppearanceOnHomeEnabled:e}=za(),t=w0({breakpoint:"h600"}),n=q("appr-home-toggle"),o=M(EW),s=M(io);return{shouldDisplay:e&&(!n||!o)&&!!s&&!t,isAppearanceOnHomeEnabled:e}}function Bye({characterId:e,className:t}){const n=M(Rt),[o,s]=Le(rT),{t:a}=Z();return l.useEffect(()=>{n?.isNew===!1&&s(!1)},[s,n?.isNew]),n?.isNew?c.jsxs(jt,{id:"character-disclaimer",mode:"wait",className:Ae("pb-2 text-foreground-550/90 text-sm dark:text-foreground-750/60",t),children:[a("characterAnimation.characterDisclaimerTextV2",{characterName:zz(e,a)})," ",o&&c.jsx(mn,{i18nKey:"characterAnimation.characterSettingDisclaimerText",components:{settingsLink:c.jsx(Wd,{pages:["menu","character-options"],className:"text-foreground-550/90 underline text-sm dark:text-foreground-750/60"})}})]}):null}function Vye(){return c.jsx(m1,{size:"sm",stroke:!0,className:"mt-4 flex h-[172px] w-full max-w-sm cursor-pointer flex-col p-3 sm:max-w-md",children:c.jsx("div",{className:"flex flex-1",children:c.jsx(f0,{className:"size-full",style:{clipPath:"var(--clip-path-squircle-36)"}})})})}const Hye=l.lazy(()=>N(()=>import("./shopping-starter-card-Cxvhy6qo.js"),__vite__mapDeps([522,1,523,352,348,332,524,350,444,525,526,527,351,528,445,381,378,347,529,354,323,389,390,396,397,530,531,532,533,534,535,536,2,359,537,349])).then(e=>({default:e.ShoppingStarterCard})));function zye(e){const{customLaunchGreeting:t,postContent:n}=e,{isCentralComposerEnabled:o,isGreetingCentered:s,showLaunchGreeting:a}=za(),r=gt({breakpoint:"sm"}),{shouldDisplay:i,isAppearanceOnHomeEnabled:d}=I4(),m=Br(),p=Wr(),h=M(aT),g=!$c(),y=m&&h!==null,b=M(hT),{showShoppingCardInNewChat:C}=Ha(),T=a&&!y,E=!!J.instance().config().smallScreenShowTopDisclaimerAfterSendingMessage?!p:!T,I=y||r&&E;jye({pageName:"chat-welcome",scenario:i?"chat-welcome-with-appearance":"chat-welcome-without-appearance"});const x=T&&"pb-2",w=l.useMemo(()=>l.lazy(()=>d?N(()=>import("./appearance-chat-beopTOCJ.js"),__vite__mapDeps([538,1,466,2])).then(D=>({default:D.AppearanceChat})):Promise.resolve({default:()=>null})),[d]);return c.jsxs(jt,{delay:.2,initial:g?"initial":!1,className:O(o?"mt-2 flex flex-col items-start text-pretty pe-0 sm:absolute sm:inset-x-0 sm:inset-y-0 sm:mx-auto sm:mt-0 sm:max-w-chat sm:px-4 sm:pb-[calc(var(--composer-container-height))]":x,C&&"mx-auto mt-2 max-w-sm sm:relative sm:max-w-md sm:px-4",i&&r&&"flex grow flex-col"),children:[i&&o&&c.jsx("div",{className:O("order-2 flex w-full flex-col items-center justify-center sm:absolute sm:h-[calc(50%-var(--composer-container-height)/2)]",r&&"grow"),children:c.jsx(l.Suspense,{fallback:c.jsx(Rye,{}),children:c.jsx(w,{voiceAppearanceId:Da},"appearance-chat-home")})}),c.jsxs("div",{className:"order-1 flex w-full flex-col gap-2 sm:top-0 sm:h-full sm:justify-center",children:[T&&c.jsx(Uye,{customLaunchGreeting:t,className:O(i&&["relative",at.launchGreeting],s?"sm:text-center":"sm:ps-2")}),y&&c.jsx(Bye,{characterId:h}),C&&!b&&c.jsx(l.Suspense,{fallback:c.jsx(Vye,{}),children:c.jsx(Hye,{})}),I&&c.jsx(b4,{}),n]})]},"chat-welcome")}function Gye(e){const{customData:t}=e;R.trackEvent({name:"system",data:{eventName:"copilotImpression",eventInfo_impressionScenario:"featureDiscovery",eventInfo_impressionPage:"landingPage",eventInfo_customData:JSON.stringify(t)}})}function $2(e){const{source:t,customData:n}=e;R.trackEvent({name:"interaction",data:{eventName:"copilotClick",eventInfo_clickScenario:"featureDiscovery",eventInfo_clickSource:t,eventInfo_customData:JSON.stringify(n)}})}function Wye(e){const{className:t,onBannerClick:n,onDismiss:o,bannerData:s}=e,{t:a}=Z(),r=Vt(),{title:i,description:d,thumbnail:m,id:p,action:h}=s,[g,y]=l.useState(!1),C=M(ss)==="dark";l.useEffect(()=>{Gye({customData:{widgetId:p}})},[p,r]);const T=()=>{$2({source:"tryIt",customData:{widgetId:p}});const w=V3(h,{id:p,source:"banner"});n(w)},[S,E]=l.useState(!1),I=w=>{w.stopPropagation(),$2({source:"dismiss",customData:{widgetId:p}}),E(!0)},x=()=>{S&&o()};return c.jsx(he.div,{initial:{opacity:0},animate:{opacity:S?0:1},transition:{duration:.1,ease:"linear"},onAnimationComplete:x,className:O("relative flex w-full",t),children:c.jsxs("div",{className:O("relative flex max-w-md flex-row items-center gap-2.5 rounded-3xl border border-black/10 p-2.5 pe-10 dark:border-white/10",at.toastNotification),children:[c.jsx(ee,{className:"absolute end-1 top-1",title:a("common.dismiss"),"aria-label":a("common.dismiss"),variant:"rect",color:"subtle-dimmed-inverted",size:"36-sm",onClick:I,children:c.jsx(on,{className:"size-3"})}),c.jsxs("div",{className:"flex size-[72px] shrink-0 items-center justify-center",children:[!g&&c.jsx(f0,{className:"aspect-square w-full rounded-xl"}),c.jsx("img",{className:O("aspect-square w-full rounded-xl object-cover",g?"opacity-100":"opacity-0"),src:C&&m.urlDark?m.urlDark:m.url,alt:m.altText,onLoad:()=>y(!0),onError:()=>y(!1)})]}),c.jsxs("div",{className:"flex flex-1 select-none flex-col gap-0.5",children:[c.jsx("div",{className:"text-sm-strong",children:i}),d&&c.jsx("div",{className:"text-xs",children:d})]}),c.jsx(ee,{title:a("widgets.featureDiscovery.tryIt"),"aria-label":a("widgets.featureDiscovery.tryIt"),variant:"rect",color:"default",size:"36-sm",onClick:T,children:c.jsx("div",{className:"text-xs",children:a("widgets.featureDiscovery.tryIt")})})]})})}function $ye(){const{createConversation:e}=$r(),t=Wr(),n=sn(),o=l.useRef(null);l.useEffect(()=>{const s=o.current;o.current=n,n==="/"&&s!=="/"&&(t||(h3(),e({shouldNavigateToChat:!1})))},[t,n,e])}function am(){const e=M(Yt),{isCentralComposerEnabled:t}=za();return t&&(!e||e==="biometric-consent")}function qye(){const e=Vt(),t=q("feature-discovery"),n=w0({breakpoint:"h760"}),o=gt({breakpoint:"sm"}),s=M(Nse),[a,r]=l.useState(!1),i=w_(),d=Zt(),m=i&&d==="study",p=am(),h=t&&s?.type==="banner"&&p&&!n&&!o&&!a&&!m,g=h?s:void 0,y=l.useCallback(()=>{s?.type==="banner"&&Kye(s.id),r(!0)},[s]),b=l.useCallback(async C=>{r(!0),Eu(C,e==="/")},[e]);return{showFeatureDiscoveryBanner:h,bannerData:g,onDismiss:y,onBannerClick:b}}async function Kye(e){try{const t=`/activations/banner/${e}/dismiss`;return(await ko(t,{options:{method:"POST"},analytics:{anonymousPath:t}})).ok}catch{return Je({feature:"featureDiscovery",scenario:"dismissFeatureDiscoveryBannerFailed",customData:JSON.stringify({eventInfo_widgetId:e})}),!1}}const E4={"56-default":"h-14","64-legacy":"h-16"},Yye={100:"bg-background-100/95 dark:bg-background-100/90",150:"bg-background-150/95 dark:bg-background-150/90",200:"bg-background-200/95 dark:bg-background-200/90"},Zye={100:"dark:bg-background-100/90",150:"dark:bg-background-150/90",200:"dark:bg-background-200/90"};function B0(e){const{middle:t,start:n,end:o,className:s,sectionHeight:a="56-default",backgroundColor:r="150",backgroundDarkColor:i,hideBackground:d,showBottomBorder:m,disableFadeInOut:p,sectionClassName:h,startClassName:g,middleClassName:y,endClassName:b,secondaryStart:C,secondaryMiddle:T,secondaryEnd:S,secondarySectionClassName:E}=e,x=!gt({breakpoint:"md"}),w=!!n||!!t||!!o,P=!!C||!!T||!!S,D=w||P;return c.jsx(jt,{className:O("pointer-events-none sticky top-0 w-full",at.stickyHeader),duration:p?0:Wn.default,children:c.jsxs("div",{className:O("absolute flex w-full flex-col",m&&"border-b border-foreground-250/80 dark:border-foreground-250",s),"data-testid":"sticky-header",children:[c.jsx(jt,{duration:x?0:Wn.default,children:!d&&c.jsx("div",{className:O("pointer-events-auto absolute inset-0",!D&&E4[a],lo,Yye[r],i&&Zye[i])})}),w&&c.jsx(q2,{start:n,middle:t,end:o,height:a,sectionClassName:h,startClassName:g,middleClassName:y,endClassName:b}),P&&c.jsx(q2,{start:C,middle:T,end:S,height:a,sectionClassName:E,isSubtitleSection:!0})]})})}function q2(e){const{start:t,middle:n,end:o,height:s="64-legacy",isSubtitleSection:a,sectionClassName:r,startClassName:i,middleClassName:d,endClassName:m}=e;return c.jsxs("section",{className:O("relative flex w-full gap-2 px-2.5",a?"pb-2.5":"py-2.5",E4[s],r),children:[c.jsx("div",{className:O("flex flex-1 items-center justify-start sm:gap-2",i),children:c.jsx("div",{className:"pointer-events-auto contents",children:t})}),n&&c.jsx("div",{className:O("flex items-center overflow-hidden sm:gap-2",d),children:c.jsx("div",{className:"pointer-events-auto contents",children:n})}),c.jsx("div",{className:O("flex flex-1 items-center justify-end sm:gap-2",m),children:c.jsx("div",{className:"pointer-events-auto contents",children:o})})]})}const Jye=l.lazy(()=>N(()=>import("./entry-button-D49OGEMR.js"),__vite__mapDeps([539,1,540,2])).then(e=>({default:e.TemporaryModeEntryButton})));function Qye(){const e=am();return c.jsx(om,{suppressBottomSection:!e,suppressBackgroundFade:e,_limitInputMaxHeight:e})}function Xye(e){const{className:t,conversationContainerClassName:n,customLaunchGreeting:o,customBottomDisclaimer:s,disableHeaderActions:a,postWelcomeContent:r}=e;$ye();const i=gt({breakpoint:"sm"}),d=Vs(),m=!$c(),{showShoppingCardInNewChat:p}=Ha(),{shouldDisplay:h}=I4(),g=!i,{showFeatureDiscoveryBanner:y,bannerData:b,onDismiss:C,onBannerClick:T}=qye(),S=a?null:c.jsx(Cs,{fallback:null,children:c.jsx(Jye,{})});return c.jsxs("div",{className:O("scrollbar-stable flex size-full flex-col items-center overflow-y-auto overflow-x-hidden overscroll-contain text-foreground-800 sm:min-w-secondary-panel-slim lg:min-w-secondary-panel",J.instance().config().showScrollbarOnHover&&"scrollbar-container",t),"data-testid":"landing-page",children:[c.jsx(l.Suspense,{fallback:c.jsx("div",{"aria-hidden":!0}),children:c.jsx(B0,{hideBackground:h,end:S})}),c.jsx(fo.Motion,{circular:!1,tabbable:!0,initial:m?"start":!1,animate:"end",variants:{start:je,end:{...rt,transition:{duration:.2,delay:.2}}},className:O(n,"grow",h&&i&&"flex flex-col","px-6"),layout:"position",transition:zn,children:c.jsxs(l.Suspense,{fallback:c.jsx("div",{"aria-hidden":!0}),children:[c.jsx("div",{className:O("relative",d||!h?"pt-10":"pt-6","min-h-[60px]",!p&&"sm:min-h-[120px]")}),c.jsx(It,{mode:"wait",initial:!1,children:c.jsx(zye,{customLaunchGreeting:o,postContent:r})})]})}),y&&b&&c.jsx(Wye,{className:"pointer-events-auto mb-20 flex justify-center",bannerData:b,onBannerClick:T,onDismiss:C}),g&&c.jsx(Mye,{customBottomDisclaimer:s})]})}function eCe(e){const{composer:t=c.jsx(Qye,{}),className:n,conversationContainerClassName:o="mb-[var(--composer-container-height)]",customLaunchGreeting:s,customBottomDisclaimer:a,disableHeaderActions:r,postWelcomeContent:i}=e,d=am(),p=!M1(),h=j0("app");return c.jsxs(tm,{className:"size-full overflow-hidden",children:[c.jsxs(dd,{children:[c.jsx(Xye,{className:n,conversationContainerClassName:o,customLaunchGreeting:s,customBottomDisclaimer:a,disableHeaderActions:r,postWelcomeContent:i}),c.jsx(sm,{})]}),p&&c.jsx("div",{ref:h,className:O("pointer-events-none absolute bottom-0 w-full",{"sm:bottom-1/2 sm:translate-y-1/2 sm:pt-36":d}),children:c.jsx("div",{className:O("mb-4 sm:mb-8",{"sm:mb-0":d}),children:t})})]})}const tCe=Re("/")({component:()=>c.jsx(eCe,{}),beforeLoad:()=>({customLayout:!0})}),nCe=Re("/imagine/")({head:e=>Rs(()=>{const{baseUrl:t,canonical:n,i18n:o}=e.match.context,s=o?.t("server.imagine.metadata.title"),a=o?.t("server.imagine.metadata.description"),i=`${t}/static/cmc/images/imagine-meta-image.jpg`;return{meta:[...s?[{title:s}]:[],...a?[{name:"description",content:a}]:[],...Ca({title:s,description:a,url:n,imageUrl:i,imageWidth:"1200",imageHeight:"630"}),...Sa({title:s,description:a,card:"summary_large_image",image:i})]}})}),oCe=Re("/tasks_/$conversationId")({beforeLoad:()=>({customLayout:!0})}),sCe=()=>N(()=>import("./shares._conversationId-BenWw7n8.js"),__vite__mapDeps([541,508,1])),aCe=Re("/shares/$conversationId")({beforeLoad:()=>({customLayout:!0}),loader:db(sCe,"loader"),head:e=>Rs(()=>{const{match:t,loaderData:n,params:o}=e,{baseUrl:s,i18n:a}=t.context,{title:r}=n??{},{conversationId:i}=o,d=a?.t("server.share.metadata.description"),m=`${s}/c/api/conversations/shares/${i}/preview`;return{meta:[...r?[{title:r},...Ca({title:r,description:d,siteName:r,url:`${s}/shares/${i}`,imageUrl:m,imageWidth:"1200",imageHeight:"630"}),...Sa({title:r,description:d,card:"summary_large_image",image:m})]:[]]}})}),rCe=Re("/projects/$projectId")({beforeLoad:()=>({customLayout:!0})}),iCe=Re("/partners/feedback")({beforeLoad:()=>({standalonePage:!0})}),cCe=Re("/pages/$pageId")({beforeLoad:()=>({customLayout:!0})}),lCe=()=>N(()=>import("./_galleryItemId-BIYcaNzN.js"),__vite__mapDeps([542,543,1])),uCe=Re("/imagine/$galleryItemId")({loader:db(lCe,"loader"),head:e=>Rs(()=>{const{baseUrl:t,i18n:n,canonical:o}=e.match.context,s=n?.t("server.imagine.metadata.title"),a="/static/cmc",{title:r=s,imageUrl:i=`${t}${a}/images/imagine-meta-image.jpg`}=e.loaderData??{},d=n?.t("server.imagine.metadata.description");return{meta:[...s?[{title:s}]:[],...d?[{name:"description",content:d}]:[],...Ca({title:r,description:d,url:o,imageUrl:i,imageWidth:"1200",imageHeight:"630"}),...Sa({title:r,description:d,card:"summary_large_image",image:i})]}})});function dCe(){const e=new Map;function t({root:n,rootMargin:o,threshold:s}){let a=e.get(n);a||(a=new Map,e.set(n,a));const r=JSON.stringify({rootMargin:o,threshold:s});let i=a.get(r);if(!i){const d=new Map;i={observer:new IntersectionObserver(p=>{p.forEach(h=>{d.get(h.target)?.(h)})},{root:n,rootMargin:o,threshold:s}),entryCallbacks:d},a.set(r,i)}return{observe:(d,m)=>{i.entryCallbacks.set(d,m),i.observer.observe(d)},unobserve:d=>{i.entryCallbacks.delete(d),i.observer.unobserve(d)}}}return{getObserver:t}}var mCe="0px",pCe=[0],fCe=dCe();function hCe(e){const t=e?.rootMargin??mCe,n=e?.threshold??pCe,o=l.useRef(null),s=l.useRef(null),a=l.useRef(null),[r,i]=l.useState(),d=l.useCallback(()=>{function h(){const y=a.current,b=o.current;b&&(y?.unobserve(b),i(void 0)),a.current=null}function g(){const y=o.current;if(!y)return;const b=fCe.getObserver({root:s.current,rootMargin:t,threshold:n});b.observe(y,C=>{i(C)}),a.current=b}h(),g()},[t,n]),m=l.useCallback(h=>(o.current=h,d(),()=>{o.current=null,d()}),[d]),p=l.useCallback(h=>(s.current=h,d(),()=>{s.current=null,d()}),[d]);return[m,{entry:r,rootRef:p}]}var gCe=hCe;function vCe(e){const{once:t,...n}=e??{},[o,s]=gCe(n),a=!!s.entry?.isIntersecting,[r,i]=l.useState(a);return t&&a&&!r&&i(!0),[o,{...s,isVisible:t?r:a}]}var yCe=vCe,CCe=100;function SCe({loading:e,hasNextPage:t,onLoadMore:n,rootMargin:o,disabled:s,delayInMs:a=CCe}){const r=l.useRef(n),[i,{rootRef:d,isVisible:m}]=yCe({rootMargin:o});l.useEffect(()=>{r.current=n},[n]);const p=!s&&!e&&m&&t;return l.useEffect(()=>{if(p){const h=setTimeout(()=>{r.current()},a);return()=>{clearTimeout(h)}}},[p,a]),[i,{rootRef:d}]}var bCe=SCe;function T4(e){const{titleText:t,subtitleText:n,positiveButtonText:o,negativeButtonText:s,positiveButtonTitle:a,negativeButtonTitle:r,modalHeaderText:i,onPositiveClick:d,onNegativeClick:m,isModalOpen:p,onModalClose:h,modalContent:g,className:y="",isDebugAudioRecorderEnabled:b=!1}=e;return c.jsxs("div",{className:y,children:[c.jsx("div",{className:"relative w-full pb-6 after:absolute after:mt-3 after:w-full after:border-b after:border-stroke-300"}),c.jsx("h2",{className:"mt-5 text-foreground-600 text-sm",children:c.jsx("strong",{children:t})}),c.jsx("p",{className:"mt-1 text-foreground-600 text-sm",children:n}),c.jsxs("div",{className:Ae("mt-3.5 grid w-fit min-w-72 grid-rows-1 gap-2",b?"grid-cols-3":"grid-cols-2"),children:[c.jsxs(ee,{onClick:d,title:a,variant:"rect",size:"36-sm",children:[c.jsx(F0,{className:"size-5"})," ",o]}),c.jsxs(ee,{onClick:m,title:r,variant:"rect",size:"36-sm",children:[c.jsx(U0,{className:"size-5"})," ",s]}),b&&c.jsx(ee,{onClick:async()=>{const{AUDIO_RECORDER:C}=await N(async()=>{const{AUDIO_RECORDER:T}=await Promise.resolve().then(()=>fr);return{AUDIO_RECORDER:T}},void 0);await C.download()},title:"Download audio debug",variant:"rect",size:"36-sm",children:"Download audio debug"})]}),p&&c.jsx(_s,{isOpen:!0,onClose:h,headerText:i,className:"w-full max-w-[400px]",children:g})]})}function ICe(e){const{className:t}=e,n=M(fd),[o,s]=Le(r1),[a,r]=l.useState(!1),[i,d]=l.useState(),m=q("ads-showroom-picasso-feedback"),{t:p}=Z(),h=S=>{en({source:"feedback",scenario:_z[S],conversationId:o?.conversationId,additionalData:{brandId:o?.brandId,brandName:o?.brandName??""}})},g=()=>{r(!1),s(void 0)},y=async S=>{o?.conversationId&&m&&await nh(o.conversationId,S,"showroomReaction")},b=()=>{h("thumbs-up"),d("thumbs-up"),n?.showroom?.positive?r(!0):g(),y("thumbs-up")},C=()=>{h("thumbs-down"),d("thumbs-down"),n?.showroom?.negative?r(!0):g(),y("thumbs-down")},T=async(S,E)=>{g(),o&&R.trackEvent({name:"interaction",data:{eventName:"copilotSubmitFineConversationFeedback",eventInfo_fineFeedbackTypes:Array.from(S).join(","),eventInfo_conversationId:o.conversationId,eventInfo_additionalData:JSON.stringify({brandId:o.brandId,brandName:o.brandName,reactionType:i,showroomMessageId:o.messageId})}}),o?.conversationId&&S.size>0&&o4(o.conversationId,S,E)};return c.jsx(T4,{titleText:p("ads.showroomFeedbackTitle",{brand:o?.brandName}),subtitleText:p("ads.showroomFeedbackDescription"),positiveButtonText:p("ads.showroomFeedbackPositive"),negativeButtonText:p("ads.showroomFeedbackNegative"),positiveButtonTitle:p("reviewPrompt.positive"),negativeButtonTitle:p("reviewPrompt.negative"),modalHeaderText:p("ads.showroomFeedbackModalTitle"),onPositiveClick:b,onNegativeClick:C,isModalOpen:a,onModalClose:g,modalContent:c.jsx(D0,{onSubmit:T,feedbackOptions:i==="thumbs-up"?n?.showroom?.positive??void 0:n?.showroom?.negative}),className:t,isDebugAudioRecorderEnabled:!1})}const ECe=3e3;function TCe({className:e,feedbackType:t="voice"}){const n=M(fd),{sendPositiveFeedback:o,sendNegativeFeedback:s,sendFeedbackOptions:a,handleReviewRequestShown:r,handleReviewRequestSubmitted:i}=O0({feedbackType:t}),d=G(Ir),m=M(Tr),p=M(UT),h=M(Rc),g=G(yt),[y,b]=l.useState(),T=q("voice-upload-diagnostic-audio")&&!1,S=q1(),{t:E}=Z();E("edgeVision.verboseFeedback"),E("edgeVision.doesnotWorkVisitedPageFeedback"),E("edgeVision.stopRespondingFeedback"),E("edgeVision.irrelevantAnswersFeedback"),E("edgeVision.poorAudioQualityFeedback"),E("edgeVision.otherFeedback");const I=()=>t==="vision"?{title:E("vision.feedbackTitle"),subtitle:E("vision.feedbackSubtitle"),options:n?.vision}:S?{title:E("voice.feedback.howWasAppearanceChat"),subtitle:E("voice.feedback.giveFeedback"),options:n?.appearance}:{title:E("voice.feedback.howWasVoiceChat"),subtitle:E("voice.feedback.giveFeedback"),options:n?.call},{title:x,subtitle:w,options:P}=I(),D=l.useRef(!1),j=M(Ir)===t;l.useEffect(()=>{!j||D.current||h||(oo({msg:`${x} ${w}`,type:"assertive"}),D.current=!0)},[j,h,E,x,w]);const U=()=>{o(),d(void 0),g({title:E("chat.feedback.postSubmitHeader"),subtitle:E("chat.feedback.postSubmitDescription"),dismissable:!1,dismissAfter:ECe})},$=()=>{s(),b("feedback-options")},K=()=>{if(y==="feedback-options"&&!m&&!p){b("review-request"),r();return}b(null),d(void 0)},X=async(Se,ge)=>{a(Se,ge),K()},ne=async Se=>{i(Se),K()},me=()=>y==="feedback-options"?c.jsx(D0,{onSubmit:X,feedbackOptions:P}):y==="review-request"?c.jsx(n4,{onSubmit:ne}):null;return c.jsx(T4,{titleText:x,subtitleText:w,positiveButtonText:E("voice.feedback.good"),negativeButtonText:E("voice.feedback.bad"),positiveButtonTitle:E("reviewPrompt.positive"),negativeButtonTitle:E("reviewPrompt.negative"),modalHeaderText:E(y==="feedback-options"?"voice.feedback.chooseWhatHappened":"voice.feedback.canMicrosoftReview"),onPositiveClick:U,onNegativeClick:$,isModalOpen:!!y,onModalClose:K,modalContent:me(),className:e,isDebugAudioRecorderEnabled:T})}function wCe({className:e}){const{t}=Z();return c.jsxs("div",{className:O("flex items-center gap-2",e),children:[c.jsx(xt,{type:"reasoning",className:"size-11"}),c.jsxs("div",{className:"flex flex-col text-sm",children:[c.jsx("span",{children:t("chat.reasoningLoading.title")}),c.jsx("span",{className:"text-foreground-450 dark:text-foreground-600",children:t("chat.reasoningLoading.description")})]})]})}function ACe(){return c.jsx("div",{className:"animate-thinking-polygon h-12 w-[max(7rem,50%)] bg-accent-350 blur-md dark:bg-accent-550"})}function xCe(e){const{isActive:t,animationDuration:n,children:o,className:s,...a}=e;return c.jsx("div",{className:O(t&&"animate-shimmer-text bg-gradient-to-r from-foreground-800 from-[calc(50%-64px)] via-foreground-250 via-50% to-foreground-800 to-[calc(50%+64px)] bg-[size:400%_100%] bg-clip-text text-transparent rtl:animate-shimmer-text-reverse",s),style:{...t&&n&&{animationDuration:n}},...a,children:o})}function _Ce(e){const{title:t,className:n,isActive:o=!0}=e,{t:s}=Z(),a=s("chat.reasoningLoading.title"),r=t&&t.trim()!==""?t:a;return c.jsx("div",{className:O("my-0.5 w-max text-base-dense",n),children:c.jsx(xCe,{isActive:o,children:r})})}const K3e="rounded-2xl px-4 py-3 text-foreground-600 -outline-offset-2 squircle-16 focus-visible:text-foreground-800 safe-hover:text-foreground-800 dark:text-foreground-700 dark:focus-visible:text-foreground-800 dark:safe-hover:text-foreground-800";function kCe(e){const{className:t,children:n,isActive:o=!0,title:s}=e;return c.jsx(m1,{className:O("mb-6 w-max max-w-[80%] px-4 py-2.5",t),background:"transparent",size:"xs",stroke:!0,initial:je,animate:rt,strokeChildren:o?c.jsx("div",{className:"absolute inset-0 rtl:-scale-x-100",children:c.jsx(ACe,{})}):void 0,children:n??c.jsx(_Ce,{title:s,isActive:o})})}function w4(e){const{loadingType:t}=e;switch(t){case"spinner":return c.jsx(xt,{type:"spinnerThemed",className:"absolute -ms-2.5 -mt-2 size-11"});case"thinking-card":return c.jsx(kCe,{});case"reasoning-chat":return c.jsx(wCe,{className:"absolute -ms-2.5 -mt-2 w-max"});default:return null}}const PCe=_(e=>{const t=e(La);if(t.length===0)return!1;const n=t[t.length-1];return n?.author==="ai"&&n.content.some(o=>o.type==="activity"&&o.activity.status==="running")});function A4(){const e=Zt(),t=M(PCe),n=q("think-deeper-cot"),o=M(La),s=l.useMemo(()=>{const a=o.at(-1);return!a||a.author!=="ai"?!1:a.content.some(r=>r.type==="chainOfThought")},[o]);switch(e){case"chat":case"computerUse":case"study":case"research":case"search":case"browserAction":return t?null:"spinner";case"analyst":case"reasoning":return n?"thinking-card":"reasoning-chat";case"smart":case"smart-latest":return s?null:"spinner";case"coco":return"thinking-card";default:return null}}function x4(e){const{delay:t,className:n}=e,{t:o}=Z(),s=l.useId(),a=Zt(),r=A4();return r?c.jsxs(he.div,{"aria-hidden":!0,className:O("relative",n),initial:"start",animate:"end",variants:{start:{...je},end:{...rt,transition:{delay:t}}},children:[c.jsx(Ao,{id:s,timeout:3e3,msg:o(a==="reasoning"?"chat.reasoning":"chat.loading"),type:"polite"}),c.jsx(w4,{loadingType:r})]}):null}const MCe=l.lazy(()=>N(()=>import("./index.es-_st7_bnK.js"),__vite__mapDeps([9,1]))),RCe=yx();function NCe({onAnimationClicked:e}){const t=l.useRef(null),{t:n}=Z(),[o,s]=l.useState(null);l.useEffect(()=>{RCe.load("../../assets/lottie/character-thinking-cloud-animation.json").then(s).catch(()=>s(null))},[]),l.useEffect(()=>{const i=t.current;return i&&o&&i.playSegments([0,67],!0),()=>{i&&o&&i.playSegments([350,370],!0)}},[o]);const a=()=>{t.current?.playSegments([320,345],!0),t.current?.pause(),e(),document.getElementById(Cc)?.focus()},r=i=>{i.key==="Enter"&&a()};return c.jsx("div",{children:c.jsx(l.Suspense,{fallback:c.jsx("div",{}),children:c.jsx(MCe,{lottieRef:t,role:"button",tabIndex:0,"aria-label":n("characterAnimation.characterThinkingCloudAriaLabelText"),title:n("characterAnimation.characterThinkingCloudAriaLabelText"),animationData:o,loop:!1,onMouseDown:a,onMouseEnter:()=>t.current?.playSegments([275,295],!0),onMouseLeave:()=>t.current?.playSegments([296,315],!0),onKeyDown:r,onComplete:()=>t.current?.playSegments([68,274],!0)})})})}const LCe="/static/cmc/assets/copilot_keyboard_aqua-DknzdRcZ.webp",DCe="/static/cmc/assets/copilot_keyboard_erin-Bbvp4684.webp",OCe="/static/cmc/assets/copilot_keyboard_mica-D_zD8c6M.webp",UCe=15e3,FCe="w-[430px]";function jCe(e){switch(e){case"aqua":return LCe;case"erin":return DCe;case"mica":default:return OCe}}const BCe=e=>{const t=l.useRef(!1),[n,o]=l.useState(!1),{t:s}=Z(),a=G(yt),r=Br(),i=q("jp-characters-deprecation-toast"),d=q("jp-characters-post-deprecation-toast"),m=M(Lc),p=M(_w),h=l.useMemo(()=>{function g({className:y}){const b=jCe(m);return c.jsx("img",{src:b,alt:"","aria-hidden":"true",className:y??"size-16 rounded-lg object-cover"})}return g},[m]);return l.useEffect(()=>{const g=r&&!p&&(i||d)&&m;g||(t.current=!1),a(g?{className:FCe,title:(()=>{if(d)switch(m){case"mica":return s("settings.charactersPostDeprecationToastMicaTitle");case"aqua":return s("settings.charactersPostDeprecationToastAquaTitle");case"erin":return s("settings.charactersPostDeprecationToastErinTitle");default:return s("settings.charactersDeprecationToastTitle")}return s("settings.charactersDeprecationToastTitle")})(),subtitle:s("settings.charactersDeprecationToastSubtitle"),Icon:h,iconClassName:"rounded-lg object-cover",action:()=>{o(!0),de({pageName:e,source:"charactersDeprecationToast",scenario:"open"})},onDismiss:()=>{de({pageName:e,source:"charactersDeprecationToast",scenario:"dismiss"})},dismissAfter:UCe,removeIconBorder:!0,contentClassName:"w-auto"}:null),g&&!t.current&&(t.current=!0,Lt({page:e,scenario:"displayed",element:"charactersDeprecationToast"}))},[h,p,i,d,r,e,m,a,s]),l.useEffect(()=>()=>{a(null)},[a]),{isModalOpen:n,setIsModalOpen:o}},K2=1,VCe=l.lazy(()=>N(()=>import("./character-D7G0e5MN.js"),__vite__mapDeps([440,1,441,2])).then(e=>({default:e.Character}))),HCe=l.lazy(()=>N(()=>import("./character-deprecation-modal-CeRhy27z.js"),__vite__mapDeps([544,1,2])).then(e=>({default:e.CharacterDeprecationModal})));function zCe({animatingMessageId:e,isStreamingMessage:t,displayedCharacterId:n,setCharacterComponentHeight:o}){const s=q("characterspeech"),[a,r]=l.useState(0),[i,d]=l.useState(!1),[m,p]=Le(ra),h=M(La),g=Ba(),{isModalOpen:y,setIsModalOpen:b}=BCe("chat"),C=()=>{r(0),d(!1)};l.useEffect(()=>{let E;return s&&m==="idle"&&(E=setInterval(()=>{r(I=>I<K2?I+1:I),h.length>0&&a===K2&&!t&&(d(!0),R.trackEvent({name:"system",data:{eventName:"characterTalkToMeDisplayed",eventInfo_conversationId:B(Te),eventInfo_characterId:n}}))},1e3)),()=>clearInterval(E)},[m,n,h.length,s,a,t]),l.useEffect(()=>{s&&m!=="idle"&&m!=="hovering"&&C()},[m,s]);const T=async()=>{C(),p("responding"),await Wo.submitMessage({command:{type:"promptCharacterSpeech"},inputMethod:"promptCharacterSpeech",connectionType:g?"temporary":"regular"}),R.trackEvent({name:"interaction",data:{eventName:"characterTalkToMeClicked",eventInfo_conversationId:B(Te),eventInfo_characterId:n}})};function S(){switch(n){case"aqua":return"translate-x-9";case"mica":return"translate-x-14";case"erin":return"translate-x-16";default:throw new Error("Invalid characterId provided to getTranslateXClass")}}return c.jsxs(wI,{fallback:c.jsx(t0,{}),onError:Gz(e,n),children:[c.jsx(l.Suspense,{fallback:null,children:c.jsx(HCe,{isOpen:y,onClose:()=>b(!1),page:"chat"})}),c.jsxs("div",{"data-testid":"character-div",className:O("absolute size-full bg-gradient-chat-light-character dark:bg-background-150 dark:bg-none",at.babylonCharacter),style:{maskImage:"linear-gradient(to bottom, #000 95%, transparent 100%)"},children:[c.jsx(It,{children:i&&c.jsx(he.div,{className:O("absolute start-1/2 top-12 size-36",S()),initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:1},children:c.jsx(NCe,{onAnimationClicked:T})})}),c.jsx(l.Suspense,{fallback:c.jsx("div",{className:"flex h-full items-center justify-center",children:c.jsx(xt,{type:"spinnerThemed",className:"size-12"})}),children:c.jsx(VCe,{characterId:n,setCharacterComponentHeight:o})})]})]})}function GCe(e){const{data:t}=e;switch(t.type){case"character":return c.jsx(zCe,{animatingMessageId:t.data.animatingMessageId,isStreamingMessage:t.data.isStreaming,displayedCharacterId:t.data.characterId});default:return null}}function WCe(e){const{data:t}=e,{t:n}=Z(),{hideCloseButton:o=!1}=t,s=l.useRef(null);l.useEffect(()=>{const r=document.getElementById("app");if(!r||!s.current)return;const i=new ResizeObserver(d=>{const m=d[0];m&&r.style.setProperty("--chat-top-docked-height",`${m.contentRect.height}px`)});return i.observe(s.current),()=>{i.disconnect(),r.style.removeProperty("--chat-top-docked-height")}},[]);const a=()=>{y1(null)};return c.jsxs("div",{ref:s,className:O("sticky top-0 h-2/5 min-h-[40vh] w-full",at.chatTopDockedContainer),children:[!o&&c.jsx(ee,{title:n("common.closeText"),color:"acrylic",size:"36-sm",variant:"square",onClick:a,tooltip:!0,className:"absolute end-4 top-4 z-50",children:c.jsx(on,{className:"size-5"})}),c.jsx(GCe,{data:t})]})}function $Ce(){const e=gt({breakpoint:"md"}),t=Vs(),n=M(To);return t&&n&&!e}function qCe(){const e=gt({breakpoint:"lg"}),t=gt({breakpoint:"xl"}),n=gt({breakpoint:"2xl"}),o=$Ce(),a=!!_Y();return e||o&&t||a&&n}const _4=l.createContext({chatRef:{current:null},showStickyHeader:!1,isTopDockedVisible:!1});function KCe(){return l.useContext(_4)}const k4=l.forwardRef((e,t)=>{const{children:n,stickyHeaderProps:o,focusable:s=!1,topDockedData:a}=e,r=M(fc),{isMediaViewerOpen:i}=Ro(),d=l.useRef(null);l.useImperativeHandle(t,()=>({focus:()=>{d.current?.focus()}}),[]);const m=a!=null,p=m&&!a.hideCloseButton,b={...{hideBackground:!qCe()},...o,...p?{start:void 0,end:void 0,hideBackground:!0}:{}},C=o!==void 0,T=l.useMemo(()=>({chatRef:d,showStickyHeader:C,isTopDockedVisible:m}),[C,m]);return c.jsx(_4.Provider,{value:T,children:c.jsxs("div",{className:O("@container/chat","flex h-full max-h-dvh w-full flex-col items-center text-foreground-800 sm:min-w-secondary-panel-slim lg:min-w-secondary-panel","overflow-y-auto overflow-x-hidden","scrollbar-stable t-custom-scrollbar",J.instance().config().showScrollbarOnHover&&"scrollbar-container",i&&!r&&"invisible"),ref:d,tabIndex:s?-1:void 0,"data-testid":"chat-page",children:[C&&c.jsx(B0,{...b}),a&&c.jsx(WCe,{data:a}),n]})})});k4.displayName="ChatContainer";function Y2(e){const t=Eo(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}function wp(e,t){const n=Su(e),o=Su(t),s=+n-Y2(n),a=+o-Y2(o);return Math.round((s-a)/Kae)}function YCe(e){return Gr(e,ec(k1(e),1))}let ZCe={};function JCe(){return ZCe}function QCe(e,t){const n=JCe(),o=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,s=Eo(e),a=s.getDay(),r=(a<o?7:0)+a-o;return s.setDate(s.getDate()-r),s.setHours(0,0,0,0),s}function XCe(e,t){const n=t*7;return pc(e,n)}function eSe(e,t){return XCe(e,-1)}function tSe(e,t,n){const o=wp(e,t),s=QCe(t,{weekStartsOn:1}),a=wp(s,t),r=wp(ec(s,7),t),i=fn(e,"EEEE"),d=n(`dates.weekdays.${i.toLowerCase()}`),m=n(`dates.months.${fn(e,"MMMM").toLowerCase()}Abbr`),p=fn(e,"d"),h=n("dates.dayMonthDate",{day:d,month:m,date:p});return o>=1?h:o>=0?n("dates.today"):o>=-1?n("dates.yesterday"):o>=a?d:o>=r?n("dates.previousDay",{day:d}):h}function nSe(e,t){return tSe(e,new Date,t)}function Y3e(e,t){const n=new Date(e),o=new Date,s=P1(n),a=YCe(n),r=eSe(o);let i;return s?i=fn(n,"h:mm a"):a?i=t("dates.yesterday"):n>=r?i=fn(n,"eeee"):i=fn(n,"MM/dd"),i}function Z3e(e){const t=Math.max(0,e),n=Math.floor(t/60),o=t%60;return`${n}:${o<10?"0":""}${o}`}function oSe(e){const{date:t,className:n,labelOverride:o}=e,{t:s}=Z();return c.jsxs("div",{className:Ae("flex items-center",n),children:[c.jsx("span",{className:"opacity-70 text-sm-strong","data-testid":"date-divider",children:o??nSe(t,s)}),c.jsx(es,{verticalMargin:!1,color:"accent",className:"mt-px grow"})]})}function sSe(e){const{content:t}=e;return c.jsx("div",{className:"text-center text-foreground-450 text-sm dark:text-foreground-600",children:t})}const P4=({title:e,titleId:t,...n})=>l.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M17.5004 12.0003C20.5379 12.0003 23.0004 14.4627 23.0004 17.5003C23.0004 20.5378 20.5379 23.0003 17.5004 23.0003C14.4628 23.0003 12.0004 20.5378 12.0004 17.5003C12.0004 14.4627 14.4628 12.0003 17.5004 12.0003ZM12.0226 13.9996C11.7259 14.4629 11.4864 14.9663 11.314 15.4999L4.25278 15.5002C3.83919 15.5002 3.50391 15.8355 3.50391 16.2491V16.8267C3.50391 17.3624 3.69502 17.8805 4.04287 18.2878C5.29618 19.7555 7.26206 20.5013 10.0004 20.5013C10.5968 20.5013 11.1567 20.4659 11.6806 20.3954C11.9258 20.8903 12.2333 21.3489 12.5921 21.7618C11.7966 21.922 10.9317 22.0013 10.0004 22.0013C6.8545 22.0013 4.46849 21.0962 2.90219 19.2619C2.32242 18.583 2.00391 17.7195 2.00391 16.8267V16.2491C2.00391 15.007 3.01076 14.0002 4.25278 14.0002L12.0226 13.9996ZM17.5004 14.0002L17.4105 14.0083C17.2064 14.0453 17.0455 14.2063 17.0084 14.4104L17.0004 14.5002L16.9994 17.0003H14.5043L14.4144 17.0083C14.2103 17.0454 14.0494 17.2063 14.0123 17.4104L14.0043 17.5003L14.0123 17.5901C14.0494 17.7942 14.2103 17.9552 14.4144 17.9922L14.5043 18.0003H16.9994L17.0004 20.5002L17.0084 20.5901C17.0455 20.7942 17.2064 20.9551 17.4105 20.9922L17.5004 21.0002L17.5902 20.9922C17.7943 20.9551 17.9553 20.7942 17.9923 20.5901L18.0004 20.5002L17.9994 18.0003H20.5043L20.5941 17.9922C20.7982 17.9552 20.9592 17.7942 20.9962 17.5901L21.0043 17.5003L20.9962 17.4104C20.9592 17.2063 20.7982 17.0454 20.5941 17.0083L20.5043 17.0003H17.9994L18.0004 14.5002L17.9923 14.4104C17.9553 14.2063 17.7943 14.0453 17.5902 14.0083L17.5004 14.0002ZM10.0004 2.00488C12.7618 2.00488 15.0004 4.24346 15.0004 7.00488C15.0004 9.76631 12.7618 12.0049 10.0004 12.0049C7.23894 12.0049 5.00036 9.76631 5.00036 7.00488C5.00036 4.24346 7.23894 2.00488 10.0004 2.00488ZM10.0004 3.50488C8.06737 3.50488 6.50036 5.07189 6.50036 7.00488C6.50036 8.93788 8.06737 10.5049 10.0004 10.5049C11.9334 10.5049 13.5004 8.93788 13.5004 7.00488C13.5004 5.07189 11.9334 3.50488 10.0004 3.50488Z",fill:"currentColor"})),J3e=Object.freeze(Object.defineProperty({__proto__:null,default:P4},Symbol.toStringTag,{value:"Module"})),M4=({title:e,titleId:t,...n})=>l.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M17.5004 12.0003C20.5379 12.0003 23.0004 14.4627 23.0004 17.5003C23.0004 20.5378 20.5379 23.0003 17.5004 23.0003C14.4628 23.0003 12.0004 20.5378 12.0004 17.5003C12.0004 14.4627 14.4628 12.0003 17.5004 12.0003ZM12.0226 13.9996C11.7259 14.4629 11.4864 14.9663 11.314 15.4999L4.25391 15.5002C3.83969 15.5002 3.50391 15.836 3.50391 16.2502V17.1575C3.50391 17.8132 3.7899 18.4362 4.28707 18.8636C5.54516 19.9453 7.44117 20.5013 10.0004 20.5013C10.5992 20.5013 11.1618 20.4709 11.6885 20.4104C11.9374 20.9105 12.2512 21.3743 12.6175 21.7908C11.8153 21.9315 10.9423 22.0013 10.0004 22.0013C7.11087 22.0013 4.87205 21.3447 3.30918 20.001C2.48056 19.2887 2.00391 18.2503 2.00391 17.1575V16.2502C2.00391 15.0075 3.01127 14.0002 4.25391 14.0002L12.0226 13.9996ZM16.7196 14.5889L16.6503 14.6467L14.1347 17.163L14.0941 17.2137L14.0594 17.2711L14.0272 17.3491L14.0156 17.3923L14.0044 17.4787L14.0082 17.5661L14.0271 17.6513L14.0591 17.729L14.0837 17.7714L14.1346 17.8374L16.6503 20.3538C16.8456 20.5491 17.1622 20.5491 17.3574 20.3538C17.531 20.1802 17.5503 19.9108 17.4153 19.716L17.3574 19.6467L15.7114 18.0003H20.5004C20.7458 18.0003 20.95 17.8234 20.9923 17.5901L21.0004 17.5003C21.0004 17.2548 20.8235 17.0507 20.5902 17.0083L20.5004 17.0003H15.7114L17.3574 15.3538C17.531 15.1802 17.5503 14.9108 17.4153 14.716L17.3574 14.6467C17.1839 14.4731 16.9145 14.4539 16.7196 14.5889ZM10.0004 2.00488C12.7618 2.00488 15.0004 4.24346 15.0004 7.00488C15.0004 9.76631 12.7618 12.0049 10.0004 12.0049C7.23894 12.0049 5.00036 9.76631 5.00036 7.00488C5.00036 4.24346 7.23894 2.00488 10.0004 2.00488ZM10.0004 3.50488C8.06737 3.50488 6.50036 5.07189 6.50036 7.00488C6.50036 8.93788 8.06737 10.5049 10.0004 10.5049C11.9334 10.5049 13.5004 8.93788 13.5004 7.00488C13.5004 5.07189 11.9334 3.50488 10.0004 3.50488Z"})),Q3e=Object.freeze(Object.defineProperty({__proto__:null,default:M4},Symbol.toStringTag,{value:"Module"})),R4=({title:e,titleId:t,...n})=>l.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M17.5004 12.0003C20.5379 12.0003 23.0004 14.4627 23.0004 17.5003C23.0004 20.5378 20.5379 23.0003 17.5004 23.0003C14.4628 23.0003 12.0004 20.5378 12.0004 17.5003C12.0004 14.4627 14.4628 12.0003 17.5004 12.0003ZM12.0226 13.9996C11.7259 14.4629 11.4864 14.9663 11.314 15.4999L4.25391 15.5002C3.83969 15.5002 3.50391 15.836 3.50391 16.2502V17.1575C3.50391 17.8132 3.7899 18.4362 4.28707 18.8636C5.54516 19.9453 7.44117 20.5013 10.0004 20.5013C10.5992 20.5013 11.1618 20.4709 11.6885 20.4104C11.9374 20.9105 12.2512 21.3743 12.6175 21.7908C11.8153 21.9315 10.9423 22.0013 10.0004 22.0013C7.11087 22.0013 4.87205 21.3447 3.30918 20.001C2.48056 19.2887 2.00391 18.2503 2.00391 17.1575V16.2502C2.00391 15.0075 3.01127 14.0002 4.25391 14.0002L12.0226 13.9996ZM15.0934 14.9665L15.0242 15.0244L14.9663 15.0936C14.8482 15.2642 14.8482 15.4917 14.9663 15.6623L15.0242 15.7315L16.7937 17.5009L15.0268 19.2677L14.9689 19.337C14.8508 19.5075 14.8508 19.7351 14.9689 19.9056L15.0268 19.9749L15.096 20.0327C15.2665 20.1508 15.4941 20.1508 15.6646 20.0327L15.7339 19.9749L17.5007 18.2079L19.2698 19.9771L19.339 20.035C19.5095 20.1531 19.7371 20.1531 19.9076 20.035L19.9769 19.9771L20.0347 19.9079C20.1528 19.7373 20.1528 19.5097 20.0347 19.3392L19.9769 19.27L18.2077 17.5009L19.9796 15.7316L20.0375 15.6623C20.1556 15.4918 20.1556 15.2642 20.0375 15.0937L19.9796 15.0244L19.9104 14.9666C19.7399 14.8485 19.5123 14.8485 19.3418 14.9666L19.2725 15.0244L17.5007 16.794L15.7313 15.0244L15.662 14.9665C15.5159 14.8653 15.3278 14.8508 15.1696 14.9231L15.0934 14.9665ZM10.0004 2.00488C12.7618 2.00488 15.0004 4.24346 15.0004 7.00488C15.0004 9.76631 12.7618 12.0049 10.0004 12.0049C7.23894 12.0049 5.00036 9.76631 5.00036 7.00488C5.00036 4.24346 7.23894 2.00488 10.0004 2.00488ZM10.0004 3.50488C8.06737 3.50488 6.50036 5.07189 6.50036 7.00488C6.50036 8.93788 8.06737 10.5049 10.0004 10.5049C11.9334 10.5049 13.5004 8.93788 13.5004 7.00488C13.5004 5.07189 11.9334 3.50488 10.0004 3.50488Z",fill:"currentColor"})),X3e=Object.freeze(Object.defineProperty({__proto__:null,default:R4},Symbol.toStringTag,{value:"Module"}));function N4(){return Ae(_u("pageContainer")??"px-6","mx-auto w-full max-w-chat")}function aSe(e){switch(e){case"joined":return P4;case"left":return M4;case"kicked":return R4;default:return null}}function rSe({message:e}){const{participant:t,updateType:n}=e,o=N4(),s=aSe(n),{t:a}=Z(),r=l.useMemo(()=>{switch(n){case"joined":return a("share.invite.participantJoined",{name:t.userDisplayName});case"left":return a("share.invite.participantLeft",{name:t.userDisplayName});case"kicked":return a("share.invite.participantKicked",{name:t.userDisplayName});default:return null}},[n,t.userDisplayName,a]);return c.jsx("div",{className:O(f_,o),children:c.jsxs("div",{className:"flex gap-2 text-foreground-550 text-sm",children:[s&&c.jsx(s,{className:"size-4 shrink-0"}),r]})})}const iSe=["thumbsup","thumbsdown","report","share","copy","add-to-pages","regenerate","research-export","references","read-aloud"],eke=[...iSe],cSe=[],Z2=rs(()=>N(()=>import("./ai-message-BQLOW48u.js"),__vite__mapDeps([545,1,380,381,378,382,327,383,384,385,386,387,388,2,389,390,391,323,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411])),{moduleName:"ai-message",retryStrategy:mo,throwError:!0});function lSe(e){const{message:t,animatingMessageIds:n,conversationId:o,sideBySideComparisonId:s,isStreamingComplete:a,shouldAnimate:r,reactionsToAllow:i,isLastMessage:d}=e,{t:m}=Z(),p=G(yt),h=A4();if(!o)return null;if(!tA(t))return c.jsx(he.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.25},children:c.jsx(l.Suspense,{fallback:h&&c.jsx(w4,{loadingType:h}),children:c.jsx(Z2,{message:t,isStreamingComplete:a,shouldAnimate:!1,reactionsToAllow:i,isLastMessage:d})})});if(!s)return null;const{left:g,right:y}=t,b=S=>!n?.has(S.id)&&!S.sideBySideConfig.isStreamingComplete,C=(S,E)=>{fte({sideBySideComparisonId:s,sideBySideConfig:E}),Wo.selectSideBySideMessage({selectedMessageId:S,sideBySideComparisonId:s}),TY(o,S),p({title:m("chat.sideBySide.selectedResponseToastTitle"),subtitle:m("chat.sideBySide.selectedResponseToastSubtitle"),dismissAfter:2e3})},T=c.jsx(x4,{delay:.5,className:"mt-2"});return c.jsxs("div",{className:"flex w-full flex-col items-center gap-6 pb-4",children:[c.jsx("p",{children:m("chat.sideBySide.preambleMessage")}),c.jsx("div",{className:"flex flex-col justify-center gap-6 @5xl/chat:w-[100cqw] @5xl/chat:flex-row @5xl/chat:items-stretch @5xl/chat:px-6",children:[g,y].map(S=>c.jsxs("div",{className:"flex min-h-24 flex-col rounded-2xl border-[0.5px] border-black/12 bg-white/45 p-6 @5xl/chat:min-w-[480px] @5xl/chat:max-w-[600px] @5xl/chat:flex-[1_1_600px] dark:bg-background-650/10",children:[c.jsx("div",{className:"flex-1",children:b(S)?T:c.jsx(l.Suspense,{fallback:T,children:c.jsx(Z2,{message:S,isStreamingComplete:a,shouldAnimate:r,reactionsToAllow:cSe,isLastMessage:!0,groupHasTopMargin:!1,isInSideBySide:!0})})}),a&&c.jsx(he.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.5},children:c.jsx(ee,{size:"36-sm",className:"mx-auto mt-6",title:m("chat.actions.selectResponse"),color:"strong",onClick:()=>C(S.id,S.sideBySideConfig),children:m("chat.actions.selectResponse")})})]},S.id))})]})}function uSe(){const e=M(Rt);return q("m365-wxp-history-sync")&&e?.type==="m365"}const L4=({title:e,titleId:t,...n})=>l.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M19.5 5.5H4.5C3.94772 5.5 3.5 5.94772 3.5 6.5V15.5C3.5 16.0523 3.94772 16.5 4.5 16.5H9V18H4.5C3.11929 18 2 16.8807 2 15.5V6.5C2 5.11929 3.11929 4 4.5 4H19.5C20.8807 4 22 5.11929 22 6.5V15.5C22 16.7183 21.1285 17.7331 19.975 17.9549C19.9 17.5176 19.6598 17.1137 19.2849 16.8388L18.9461 16.5H19.5C20.0523 16.5 20.5 16.0523 20.5 15.5V6.5C20.5 5.94772 20.0523 5.5 19.5 5.5ZM11.2803 10.2197C11.0658 10.0052 10.7432 9.94103 10.463 10.0571C10.1827 10.1732 10 10.4467 10 10.75V21.25C10 21.5785 10.2138 21.8688 10.5275 21.9663C10.8413 22.0637 11.1819 21.9456 11.368 21.6749L13.8348 18.0869L18.0955 18.9839C18.4203 19.0523 18.7514 18.8991 18.9095 18.6073C19.0675 18.3154 19.015 17.9544 18.7803 17.7197L11.2803 10.2197ZM11.5 18.8353V12.5607L15.9357 16.9964L13.6545 16.5161C13.3582 16.4537 13.0535 16.5756 12.882 16.8251L11.5 18.8353Z"})),tke=Object.freeze(Object.defineProperty({__proto__:null,default:L4},Symbol.toStringTag,{value:"Module"})),D4=({title:e,titleId:t,...n})=>l.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t,...n},e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2ZM12 3.5C7.30558 3.5 3.5 7.30558 3.5 12C3.5 16.6944 7.30558 20.5 12 20.5C16.6944 20.5 20.5 16.6944 20.5 12C20.5 7.30558 16.6944 3.5 12 3.5ZM15.4462 8.39705L15.5303 8.46967C15.7966 8.73594 15.8208 9.1526 15.6029 9.44621L15.5303 9.53033L13.061 12L15.5303 14.4697C15.7966 14.7359 15.8208 15.1526 15.6029 15.4462L15.5303 15.5303C15.2641 15.7966 14.8474 15.8208 14.5538 15.6029L14.4697 15.5303L12 13.061L9.53033 15.5303C9.26406 15.7966 8.8474 15.8208 8.55379 15.6029L8.46967 15.5303C8.2034 15.2641 8.1792 14.8474 8.39705 14.5538L8.46967 14.4697L10.939 12L8.46967 9.53033C8.2034 9.26406 8.1792 8.8474 8.39705 8.55379L8.46967 8.46967C8.73594 8.2034 9.1526 8.1792 9.44621 8.39705L9.53033 8.46967L12 10.939L14.4697 8.46967C14.7359 8.2034 15.1526 8.1792 15.4462 8.39705Z"})),nke=Object.freeze(Object.defineProperty({__proto__:null,default:D4},Symbol.toStringTag,{value:"Module"})),J2="size-5",Q2="flex w-full items-center justify-end gap-1.5 text-foreground-450 dark:text-foreground-600";function dSe({type:e}){const{t}=Z();switch(e){case"takeTaskControl":return c.jsxs("div",{className:Q2,children:[c.jsx(L4,{className:J2}),t("actions.tookControl")]});case"cancelTask":return c.jsxs("div",{className:Q2,children:[c.jsx(D4,{className:J2}),t("actions.cancelledTask")]});case"createPage":case"appendToPage":case"promptCharacterSpeech":case"createCalendarEvent":case"triggerPlanningAgent":default:return null}}function mSe(e){const{t}=Z(),{item:n}=e,o=M(gd),s=n.content,a=s.type==="copilot",r=s.type==="user";if(!r&&!a)return null;const i=r&&s.id===o,d=a?t("common.copilotText"):s.displayName;return c.jsx("span",{className:O("text-base-medium",{"text-system-red-550 dark:text-system-red-350":i}),children:t("group.mentionUser",{userName:d})})}function pSe(e){const{contents:t,isParticipantMessage:n=!1}=e;return c.jsxs("div",{className:O("font-ligatures-none relative h-fit max-w-user-text-message whitespace-pre-wrap break-words bg-accent-250/60 px-4 py-2.5 squircle-16 dark:bg-accent-200",Xf("userMessage")??"text-base",{"bg-white dark:bg-accent-100":n,"self-start":n,"self-end":!n}),"data-content":"user-message",children:[n&&c.jsx("div",{className:"pointer-events-none absolute inset-0 border-squircle-card border-accent-200 squircle-stroke-16 dark:border-accent-300","aria-hidden":"true"}),t.map((o,s)=>o.type==="reference"?c.jsx(mSe,{item:o},s):c.jsx(l.Fragment,{children:o.text},s))]})}const fSe=f({contents:A(Q([x5,L5])),type:v("text-and-references")});fe("type",[k5,P5,R5,_5,fSe]);function hSe(e,t){const n=[];if(!t||!e.some(s=>s.type==="reference"))return e.map(s=>s.type==="text"||s.type==="reference"?{contents:[s],type:"text-and-references"}:s);let o=[];for(const s of e)s.type==="text"||s.type==="reference"?o.push(s):(o.length>0&&(n.push({contents:o,type:"text-and-references"}),o=[]),n.push(s));return o.length>0&&n.push({contents:o,type:"text-and-references"}),n}const O4=e=>(Ad(e7),fu({groupper:{tabbability:gSe(e?.tabBehavior)},focusable:{ignoreKeydown:e?.ignoreDefaultKeydown}})),gSe=e=>{switch(e){case"unlimited":return wm.Unlimited;case"limited":return wm.Limited;case"limited-trap-focus":return wm.LimitedTrapFocus;default:return}},U4=l.forwardRef((e,t)=>{const{children:n,tabBehavior:o="limited-trap-focus",ignoreDefaultKeydown:s,...a}=e,r=O4({tabBehavior:o,ignoreDefaultKeydown:s});return c.jsx(he.div,{ref:t,...r,...a,tabIndex:0,children:n})});U4.displayName="FocusableGroupMotion";function vSe(e){const{children:t,tabBehavior:n="limited-trap-focus",ignoreDefaultKeydown:o,...s}=e,a=O4({tabBehavior:n,ignoreDefaultKeydown:o});return c.jsx("div",{...a,...s,tabIndex:0,role:"article",children:t})}const F4=e=>c.jsx(vSe,{...e});F4.Motion=U4;function ySe({tabs:e=[]}){return e.length===0?null:c.jsx(fo,{className:"flex min-h-[60px] flex-col gap-2",tabbable:!0,tabIndex:0,children:c.jsx(a4,{showRemoveIcon:!1,tabs:e})})}const CSe=l.lazy(()=>N(()=>Promise.resolve().then(()=>Cpe),void 0));function SSe(e){const{message:t,className:n}=e,{t:o}=Z(),a=!!M(Hn),{openMediaViewer:r}=Ro(),i=M(gd),d=I0(),m=i1(),p=m,h=l.useMemo(()=>hSe(t.content,p),[t.content,p]),g=t.content.filter(U=>U.type==="document"||U.type==="image"),[y,b]=l.useState(!1),C=q("file-upload-card-v2"),T=g.slice(0,ru),S=g.filter(U=>U.type==="image"),E=l.useCallback(U=>{const $=S.findIndex(K=>K===U);r({currentMediaIndex:$,media:S.map(K=>({type:"image",url:K.localUrl??K.url,altText:K.fileName??o("chat.uploadedImageAltText"),downloadable:!0})),source:"userMessage"})},[S,r,o]),I=l.useCallback(()=>{oo({msg:o("userInput.seeAll"),type:"polite"}),b(!0)},[o,b]),x=g.length>ru,w=t.author==="groupParticipant"&&t.authorMetadata?.id!==i,P=w?t.authorMetadata?.displayName??o("share.invite.formerMemberTitle"):"",D=!!J.instance().config().composer?.smallAttachmentCard||C;function L(){return w?o("chat.participantSaid",{name:P}):o("chat.userSaid")}const j=L();return c.jsxs(F4,{className:Ae("space-y-1",n),id:`${t.id}-user-message`,"aria-labelledby":`${t.id}-user-message`,children:[c.jsxs("div",{className:"relative space-y-3",children:[c.jsx("h5",{className:"sr-only","aria-label":j,"data-copy":"false",children:j}),c.jsxs("div",{className:"flex w-full flex-col gap-1",children:[w&&c.jsx("div",{className:"px-10 text-foreground-600 text-xs","aria-hidden":"true",children:P}),c.jsxs("div",{className:"flex w-full items-start",children:[w&&c.jsx("div",{className:"z-10 -me-2 mt-2 size-8 shrink-0",role:"presentation",children:c.jsx(l.Suspense,{fallback:c.jsx("div",{className:"size-8"}),children:c.jsx(CSe,{firstName:P,nameSizeClass:"text-base-medium",showTwoCharacters:!0})})}),c.jsxs("div",{className:"flex w-full flex-col gap-1",children:[g.length>0&&c.jsxs("div",{className:O("flex w-full flex-row gap-2 overflow-hidden",{"h-32":!C&&!D,"h-small-attachment":!C&&D,"h-auto":C,"justify-start":w,"justify-end":!w,"ms-3":w}),children:[T.map((U,$)=>c.jsx(jk,{messageItem:U,size:D?"sm":"md",onClick:U.type==="image"&&m?E:void 0},`file-${$}`)),x&&c.jsx(ee,{"aria-label":o("userInput.seeAll"),title:o("userInput.seeAll"),color:"overlay-dimmed-inverted",onClick:I,className:D?"mt-1 h-small-attachment":"",children:o("userInput.seeAll")}),y&&c.jsx(Bk,{onClose:()=>b(!1),messages:g})]}),h.map((U,$)=>{if(U.type==="text-and-references")return c.jsx(pSe,{contents:U.contents,isParticipantMessage:w},$);const K=U;return K.type==="browserTabs"?d&&uee(K.tabs)?c.jsx(ySe,{tabs:K.tabs},$):null:K.type==="command"?c.jsx(dSe,{type:K.command.type},$):null})]})]}),t.emojiReaction&&c.jsx("div",{className:"absolute -bottom-3 end-3",children:t.emojiReaction})]})]}),!a&&t.brand?.brandLogo&&c.jsx("div",{className:"w-full px-3 text-right text-foreground-600 text-sm",children:o("ads.aboutBrand",{brand:t.brand.brandLogo.businessName})})]},t.id)}const X2=rs(()=>N(()=>import("./ai-message-BQLOW48u.js"),__vite__mapDeps([545,1,380,381,378,382,327,383,384,385,386,387,388,2,389,390,391,323,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411])),{moduleName:"ai-message",retryStrategy:mo,throwError:!0});function eb(e){const{chatItemClasses:t,currentConversation:n,enableLastMessageCheck:o=!1,hasNextPage:s=!1,hideDateDivider:a=!1,hideUserMessages:r=!1,isStreamingComplete:i,messages:d,previousMessageInit:m,reactionsToAllow:p,shouldAnimate:h=!1}=e,y=M(pd).get(n?.id??""),b=!it("kill-share-continue"),C=uSe(),{disableMultiturn:T}=J.instance().config();return d.map((E,I)=>{const x=new Date(E.createdAt),w=I>0?d[I-1]:m,P=w&&new Date(w.createdAt),D=!P||!Gr(x,P),L=b&&Mhe(n?.continuedAt?new Date(n.continuedAt):null,x,P),j=o&&I===d.length-1;let U;if(yY(E))U=c.jsx(lSe,{message:E,conversationId:n?.id,animatingMessageIds:y,sideBySideComparisonId:n?.sideBySideComparisonId,isStreamingComplete:i,shouldAnimate:h,reactionsToAllow:p,isLastMessage:j});else if(E.author==="ai")U=e.isNewChat?c.jsx(l.Suspense,{fallback:c.jsx("div",{"aria-hidden":!0}),children:c.jsx(X2,{message:E,isStreamingComplete:i,shouldAnimate:h,reactionsToAllow:p,isLastMessage:j})}):c.jsx(X2,{message:E,isStreamingComplete:i,shouldAnimate:h,reactionsToAllow:p,isLastMessage:j});else if(E.author==="system")U=c.jsx(rSe,{message:E});else{if(r)return null;U=c.jsx(SSe,{message:E,className:t})}const $=I===0&&s&&!w,X=C&&(I===0&&!s&&!w)?F("chat.m365.dividerFromM365Copilot"):void 0,ne=!$&&D&&!T&&!a;return c.jsxs(l.Fragment,{children:[L&&c.jsx(sSe,{content:F("chat.continuedConversationDisclaimer")}),ne&&c.jsx(oSe,{date:x,className:t,labelOverride:X}),U]},E.id)})}const tb=10,bSe=0,ISe=.2;function ESe({onClick:e,shouldShowScrollToBottomButton:t,bottomButtonClass:n=""}){const{t:o}=Z();return c.jsx(It,{children:t&&c.jsx(he.div,{className:O("pointer-events-none absolute flex justify-center",at.chatScrollToBottomButton,"inset-x-0",n),initial:{...je,y:tb},animate:{...rt,y:bSe},exit:{...je,y:tb},transition:{duration:ISe},children:c.jsx(ee,{color:"acrylic",variant:"circle",size:"36-sm",title:o("chat.scrollToBottom"),onClick:e,className:"pointer-events-auto border-none shadow-xl",testId:"scroll-to-bottom-button",children:c.jsx("span",{className:O("relative rounded-full bg-white/40 p-2 hover:bg-white hover:p-[9px] dark:bg-background-350/60","after:absolute after:inset-0 after:rounded-full after:opacity-50 after:shadow-xl","before:absolute before:-inset-px before:rounded-full before:border before:border-black/8"),children:c.jsx(Hr,{className:"size-5 rotate-180 fill-foreground-900 dark:fill-white"})})})})})}function TSe(e){const t=M(pd),n=M(Rc);return{hasAnimatingMessage:!!t.get(e?.id??"")?.size,isCurrentConversationStreaming:n}}const wSe="answerCards.ariaLabel.numberOfLocalResultsSingle",ASe="answerCards.ariaLabel.numberOfLocalResultsPlural";function xSe(e){let t="";for(const o of e.entities){if(t+=o.name,o.category&&(t+=`, ${o.category}`),o.price&&(t+=`, ${_Se(o.price)}`),o.reviews[0]){const s=o.reviews[0];t+=", ",t+=F("answerCards.ariaLabel.ratedByReviewer",{rating:s.rating,reviewCount:s.count,reviewProvider:s.providerName})}o.phoneNumber&&(t+=", ",t+=F("answerCards.ariaLabel.phoneNumber",{phoneNumber:o.phoneNumber})),o.location.address&&(t+=", ",t+=F("answerCards.ariaLabel.address",{address:o.location.address})),o.openState&&(t+=", ",t+=F("answerCards.ariaLabel.openState",{openState:o.openState})),t+=". "}const n=e.entities.length===1?wSe:ASe;return F(n,{count:e.entities.length,resultSummary:t})}function _Se(e){switch(e.length){case 1:return F("answerCards.ariaLabel.inexpensivePrices");case 2:return F("answerCards.ariaLabel.averagePrices");default:return F("answerCards.ariaLabel.expensivePrices")}}function kSe(e){const{content:t,announce:n}=e;let o;for(const s of t){switch(s.type){case"text":o=s.text;break;case"image":s.url?o=F("chat.imageGenerated",{prompt:s.prompt??""}):o=F("chat.imageGenerating");break;case"page":break;case"citation":break;case"modelStatement":break;case"card":o=PSe(s.card);break;case"error":o=s.text;break;case"task":break;case"deleted":break;case"chainOfThought":break;case"chainOfThoughtGroup":break;case"agentTaskProgressGroup":break;case"step":case"webSearch":case"textFile":case"shellCommandExecution":case"computerUse":break;case"document":break;case"activity":break;case"inline-consent-disclaimer":break;case"memorySignal":o=s.text;break;case"indicator-ai-response":o=s.text;break}o&&n({msg:o})}}function PSe(e){switch(e.type){case"localEntity":return xSe(e);case"healthcareEntity":return"";case"healthcareInfo":return"";case"shoppingProducts":return F("shopping.ariaLabel.carouselCards");case"ads":case"artifact":case"weather":case"inline-artifact":case"weatherTemperatureHourly":case"weatherTemperatureDaily":case"weatherPrecipitationHourly":case"weatherPrecipitationDaily":case"image":case"person":case"phoneImages":case"phoneLinking":case"phoneAlarm":case"phoneTimer":case"phoneSendMessage":case"video":case"sportsSchedule":case"sportsGame":case"safetyHelpline":case"shopping":case"shoppingCurated":case"suggestVision":case"fileSearch":case"windowsSettings":case"job":case"inlineVideo":case"quiz":case"financeChart":case"financeComparisonChart":case"recipe":case"mediaSpotlight":case"inlineImage":case"m365":case"file":case"computerUseFeedback":case"document":case"personalArtifacts":case"flashcard":case"consent":case"consentV2":case"newsCarousel":case"navigation":case"mediaCarousel":case"edge-passwords":case"suggestResearch":case"suggestAgentMode":case"powerPointCreator":case"federatedLogin":case"form-fill":case"composeEmail":case"createCalendarEvent":case"command":case"tapToReveal":case"audioCallSummary":return"";default:return""}}function MSe(e,t){const n=l.useRef(void 0);l.useEffect(()=>{if(t)return;const o=e.at(-1);o&&o.author==="ai"&&o.id!==n.current?.id&&(kSe({content:o.content,announce:oo}),n.current=o)},[e,t])}function RSe(e){l.useEffect(()=>{if(e.current){const t=o=>{if(o.target&&o.target instanceof Element&&o.target.closest('[data-formatless-copy="false"]'))return;const s=window.getSelection();if(s?.rangeCount){let a=document.createElement("div");const r=s.getRangeAt(0),{startContainer:i,endContainer:d}=r;a.appendChild(r.cloneContents());const m=i.parentElement?.closest("pre"),p=d.parentElement?.closest("pre"),h=!!m&&!!p&&m===p,g=!!i.parentElement?.closest("table")&&!NSe(r);a.style.position="absolute",a.style.left="-9999px",document.body.appendChild(a);const y=a.getElementsByTagName("*");for(const I of y)if(I.getAttribute("data-copy")==="false")I.remove();else{const{whiteSpace:x}=window.getComputedStyle(I);I.removeAttribute("style"),I.removeAttribute("class"),I.removeAttribute("initial"),I.removeAttribute("animate"),I.removeAttribute("variants"),I.removeAttribute("custom"),I instanceof HTMLElement&&x&&(I.style.whiteSpace=x)}if(document.body.removeChild(a),h){const I=document.createElement("pre");I.appendChild(a),a=I}if(g){const I=document.createElement("table"),x=Array.from(a.children);for(const w of x)I.appendChild(w);a=I}const{commonAncestorContainer:b}=r,C=b instanceof Element?b:b.parentElement;if(C){const{whiteSpace:I}=window.getComputedStyle(C);a.style.whiteSpace=I}a.style.position="absolute",a.style.left="-9999px",document.body.appendChild(a);const T=window.getSelection(),S=document.createRange();S.selectNodeContents(a),T?.removeAllRanges(),T?.addRange(S);const E=T?.toString()??"";T?.removeAllRanges(),T?.addRange(r),document.body.removeChild(a),a.removeAttribute("style"),o.clipboardData?.setData("text/plain",E),o.clipboardData?.setData("text/html",h||g?a.outerHTML:a.innerHTML)}o.preventDefault()},n=e.current;return n.addEventListener("copy",t),()=>{n.removeEventListener("copy",t)}}return()=>{}},[e])}function NSe(e){const{startContainer:t,endContainer:n}=e,o=t.parentElement?.closest("td")??t.parentElement?.closest("th"),s=n.parentElement?.closest("td")??n.parentElement?.closest("th");return!!(o&&s&&o===s)}const LSe=100,nb=.3,DSe=2*fR,OSe="bottom-14 h-[120px]",USe="shrink-0 min-h-14",FSe="min-h-[calc(100%-56px)]";function jSe(e,t,n){const o=Vs(),s=l.useMemo(()=>({initial:{opacity:0,y:LSe},animate:{opacity:1,y:0,transition:{duration:.4,y:{duration:nb}}},exit:{opacity:0,y:-100,transition:{duration:.2,y:{duration:nb}}},onAnimationStart:S=>{typeof S=="object"&&!Array.isArray(S)&&S.opacity===1&&e()}}),[e]),a=OSe,r=USe,i=FSe,{highlighted:d,backstage:m}=VSe(n),[p,h]=l.useState(!1),g=l.useRef(null),y=l.useCallback(S=>{g.current=S,S&&h(!0)},[]),{scrollYProgress:b}=nM({target:p?g:void 0,container:t,offset:["end start","start start"]});Hs(()=>{requestAnimationFrame(()=>{t.current?.dispatchEvent(new Event("scroll"))})},{},t.current);const C=eu(b,[DSe/100,1],[0,1]);return{highlightedMessagesProps:s,opacity:o?C:b,sentinelRef:y,sentinelClasses:a,backstageClasses:r,highlightedClasses:i,highlighted:d,backstage:m}}function BSe(e){const t=j4(e);if(!t)return[];const n=e.at(-2),o=[];fa(n)&&o.push(n),fa(t)&&o.push(t);const s=e.at(-3);if(s?.author==="human"&&o.length===2)return[s,...o];const a=t.author==="human",r=!a&&n?.author==="ai";return a||r?[t]:e.slice(-2)}function j4(e){return e.at(-1)}function VSe(e){const t=BSe(e),n=e.slice(0,-t.length);return{highlighted:t,backstage:n}}function HSe(e,t){const n=l.useRef(0),o=l.useRef(0);Jk(()=>{const s=t.current;if(!s)return;const a=s.scrollHeight-n.current,r=s.scrollTop===0;a>0&&r?s.scrollTop=a:s.scrollTop=o.current,n.current=s.scrollHeight,o.current=s.scrollTop},[e]),l.useEffect(()=>{const{current:s}=t,a=()=>{s&&(o.current=s.scrollTop)};return s?.addEventListener("scroll",a),()=>s?.removeEventListener("scroll",a)},[t])}function zSe(e,t){const n=it("kill-review-prompt"),s=!!J.instance().config().promptForReviews&&!n,a=G(Yt),r=l.useCallback(async d=>{if(!s)return;const{shown:m}=await j$.run({});if(m)return;const h=Bhe()>=Lhe,g=d>Rhe;(h||g)&&!Vhe()&&(a("prompt-review"),R.trackEvent({name:"system",data:{eventName:"inAppSurveyPopUp",eventInfo_triggerType:g?"longChat":"activeDays"}}))},[s,a]),i=l.useRef(!1);l.useEffect(()=>{t&&(i.current=!0)},[t]),l.useEffect(()=>{t||!i.current||r(e)},[e,t,r])}function GSe(e){return l.useCallback(({behavior:n="smooth",delay:o=0})=>{const s=()=>{e.current&&e.current.scrollTo({top:e.current.scrollHeight,behavior:n})};o===0?s():setTimeout(s,o)},[e])}function WSe(e){const{chatRef:t,hasMessages:n=!0}=e,o=l.useRef(null),[s,a]=l.useState(!1),r=l.useRef(n);r.current=n;const i=l.useCallback(d=>{const m=d[0];if(m){const h=!(m.intersectionRatio>0)&&r.current;a(h)}},[]);return l.useEffect(()=>{if(!t.current||!o.current)return()=>{};const d=new IntersectionObserver(i,{root:t.current});return d.observe(o.current),()=>{d.disconnect()}},[t,i]),l.useEffect(()=>{n||a(!1)},[n]),{bottomRef:o,shouldShowScrollToBottomButton:s}}async function $Se(e,t){const n=u1(t);if(n){const{message:o,part:s}=n;if(!s.task)return;const a=await wn();a.setConversationIdByMessageId({messageId:o.id,conversationId:e}),a.setMessageIdByTaskId({taskId:s.task.id,messageId:o.id})}}const qSe=window.requestIdleCallback?window.requestIdleCallback:function(t){const n=Date.now();return setTimeout(()=>{t({didTimeout:!1,timeRemaining(){return Math.max(0,50-(Date.now()-n))}})},1)};function KSe(e){if(e.author!=="ai")return!1;const t=e.content.at(-1);return t?.type==="image"&&t.status==="generating"}function YSe(e){if(e.author!=="human")return!1;const t=e.content.at(-1);return t?.type==="command"&&t.command.type==="startCall"}function ZSe(e){return e?KSe(e)||YSe(e):!1}const JSe=1.5,ob="inline-block w-full space-y-8",QSe="max-w-chat w-full";function XSe({children:e,chatRef:t,historyLength:n}){return HSe(n,t),e}function e2e(e){const{className:t,customLaunchGreeting:n,disableScrollToBottomButton:o=!1,hideDateDivider:s=!1,hideUserMessages:a=!1,reactionsToAllow:r,CustomBottomContent:i}=e,{chatRef:d,showStickyHeader:m,isTopDockedVisible:p}=KCe(),{loader:h}=t4(),g=M(La),y=M(Rt),b=M(eG),C=M(r1),T=gt({breakpoint:"sm"}),S=!$c(),E=!it("kill-coco-isolation");l.useEffect(()=>{let ft=WA()??Ft();if(E){const ct=ft;ft=Jz(ft,b);const Kn=ct!==ft&&ft==="coco",is=fK();Kn&&is&&(Ar(null),Td())}hn(ft)},[b,E]);const I=y?.sideBySideComparisonId,x=!!I,w=GSe(d);RSe(d);const{isContextualShoppingCardExpanded:P,showShoppingCardInNewChat:D}=Ha();P3({scrollableRef:d,source:"chat",customData:{conversationId:y?.id,...P&&{isContextualShoppingCardExpanded:P}}});const[L]=bCe({...h,disabled:!!h.error}),{highlightedMessagesProps:j,sentinelRef:U,sentinelClasses:$,backstageClasses:K,highlightedClasses:X,opacity:ne,highlighted:me,backstage:Se}=jSe(()=>w({behavior:"instant",delay:J.instance().config().scrollToBottomDelay}),d,g),ge=eu(ne,ft=>ft<.5?"none":"auto"),ve=()=>w({behavior:"smooth"}),{bottomRef:Pe,shouldShowScrollToBottomButton:Me}=WSe({chatRef:d,hasMessages:g.length>0&&!o}),{hasAnimatingMessage:ye,isCurrentConversationStreaming:Ie}=TSe(y),He=M(Ir),Ze=q("voice-feedback-toast"),Be=q("voice-feedback-download-audio"),be=(!Ze||Be)&&He;l.useEffect(()=>{y?.id&&($Se(y.id,g),qSe(()=>{y_("ai-message",mo)(()=>N(()=>import("./ai-message-BQLOW48u.js"),__vite__mapDeps([545,1,380,381,378,382,327,383,384,385,386,387,388,2,389,390,391,323,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411]))),N(()=>import("./markdown-0-Dwg19Q.js").then(ft=>ft.m),[])}))},[y?.id,g]),MSe(g,Ie);const re=j4(me),te=re?.author==="human"||Ie,H=!!M(gi),Y=M(Fl),ue=te&&!ye||H||Y,{disableMultiturn:oe}=J.instance().config(),De=J.instance().config().styleOverrides?.width?.chat;zSe(g.length,te);const _e=Wr(),ze=M(fc),We=!(D&&!T)&&!ze,Oe=q("chat-refactor-max-width"),qe=Oe?N4():void 0,se=Oe?"w-full":QSe,ie=!Ie,we=_e&&!p,wt=!!J.instance().config().smallScreenShowTopDisclaimerAfterSendingMessage?!_e:!we,_t=p||T&&wt,An=ue&&!x&&!ZSe(re),No=me[0],Lo=No?.createdAt,xn=Se,go=x?vY(me,I):me;return c.jsx(fo.Motion,{circular:!1,tabbable:!0,initial:S?"start":!1,animate:"end",variants:{start:je,end:{...rt,transition:{duration:.2,delay:.2}}},className:O(t,"grow",!Oe&&(_u("pageContainer")??"px-6"),se,De,"flex h-full grow flex-col",p&&"h-[calc(100%-var(--chat-top-docked-height)+40px)]"),transition:zn,"data-content":"conversation","data-copy":"false",children:c.jsx(l.Suspense,{fallback:c.jsx("div",{"aria-hidden":!0}),children:c.jsx(l.Suspense,{fallback:c.jsx("div",{"aria-hidden":!0}),children:c.jsxs(XSe,{chatRef:d,historyLength:g.length,children:[h.hasNextPage&&c.jsx("div",{ref:L}),c.jsxs(he.div,{className:O("relative",We&&K),style:{opacity:g.length>0?ne:0,pointerEvents:ge},"data-testid":"backstage-chats",children:[c.jsx("div",{className:O("absolute -z-10 w-full",$),ref:U,"data-testid":"sentinel-div"}),xn.length>0&&c.jsx("div",{className:O(m&&"pt-16","mb-8",ob),children:c.jsx(eb,{chatItemClasses:qe,currentConversation:y,hideDateDivider:s,hideUserMessages:a,isStreamingComplete:ie,messages:xn,hasNextPage:h.hasNextPage,reactionsToAllow:r,isNewChat:!1})})]}),c.jsxs("div",{className:O(m&&X,!m&&"min-h-full","flex shrink-0 flex-col"),"data-testid":"highlighted-chats",children:[c.jsx(It,{mode:"wait",initial:!0,children:c.jsxs(c.Fragment,{children:[we&&c.jsx("div",{className:O(qe,n?.layout==="fullScreen"?"flex flex-1 items-center justify-center":"pb-2"),children:n?.content}),_t&&c.jsx("div",{className:qe,children:c.jsx(b4,{})}),me.length>0&&c.jsxs(he.div,{className:O("pt-3",oe?"pb-24":"pb-6",ob),initial:j.initial,animate:j.animate,exit:j.exit,onAnimationStart:ft=>{const ct=ne.get()<1;(No?.author==="human"||ct)&&j.onAnimationStart(ft)},children:[c.jsx(eb,{chatItemClasses:qe,currentConversation:y,enableLastMessageCheck:!0,hideDateDivider:s,hideUserMessages:a,isStreamingComplete:ie,messages:go,previousMessageInit:xn[xn.length-1]??void 0,reactionsToAllow:r,shouldAnimate:ye,isNewChat:!0}),c.jsx(l.Suspense,{fallback:c.jsx("div",{"aria-hidden":!0}),children:An&&c.jsx(x4,{delay:JSe,className:qe})}),c.jsx(jt,{children:be&&c.jsx(TCe,{className:qe,feedbackType:He})}),c.jsx(jt,{children:C&&C.visible&&c.jsx(ICe,{className:qe})})]},Lo)]})}),c.jsx("div",{className:O("mt-[var(--composer-container-height)]"),ref:Pe,style:{height:0,overflow:"hidden"}}),c.jsx(ESe,{shouldShowScrollToBottomButton:Me&&!o,onClick:ve,bottomButtonClass:"bottom-[calc(var(--composer-container-height)+1rem)]"}),i&&c.jsx(i,{isVisible:!Me&&!ue})]})]})})})})}function t2e(e){const{className:t}=e,{t:n}=Z();return c.jsxs("div",{className:O("flex w-full flex-col items-start justify-start text-2xl sm:mb-4 sm:justify-end",t),"data-testid":"temporary-conversation-greeting",children:[c.jsx("h1",{children:n("chat.launchMessage.temporaryConversation")}),c.jsx("h2",{className:"mt-4 text-foreground-800 text-base",children:n("chat.launchMessage.subheadingTemporaryConversation")})]})}function n2e(){const e=j0("app"),{isGreetingCentered:t}=za(),n=am();return c.jsxs(tm,{className:"size-full overflow-hidden",children:[c.jsxs(dd,{children:[c.jsxs("div",{className:"scrollbar-stable flex size-full flex-col items-center overflow-y-auto overflow-x-hidden overscroll-contain text-foreground-800 sm:min-w-secondary-panel-slim lg:min-w-secondary-panel","data-testid":"temporary-conversation-landing",children:[c.jsx(B0,{sectionHeight:"64-legacy"}),c.jsxs("div",{className:"mb-[var(--composer-container-height)] grow px-6",children:[c.jsx("div",{className:"relative min-h-[60px] pt-10 sm:min-h-[120px]"}),c.jsx("div",{className:"mt-2 flex flex-col items-start text-pretty sm:absolute sm:inset-0 sm:mx-auto sm:mt-0 sm:max-w-chat sm:px-4 sm:pb-[calc(var(--composer-container-height))]",children:c.jsx("div",{className:"flex w-full flex-col gap-2 sm:h-full sm:justify-center",children:c.jsx(t2e,{className:O(t&&"sm:items-center sm:text-center")})})})]})]}),c.jsx(sm,{})]}),c.jsx("div",{ref:e,className:O("pointer-events-none absolute bottom-0 w-full",{"sm:bottom-1/2 sm:translate-y-1/2 sm:pt-36":n}),children:c.jsx("div",{className:O("mb-4 sm:mb-8",{"sm:mb-0":n}),children:c.jsx(om,{suppressBottomSection:!n,suppressBackgroundFade:n,_limitInputMaxHeight:n})})})]})}const o2e=["copy","regenerate"];function s2e(e){const t=l.useRef(!1);l.useEffect(()=>{t.current||(t.current=!0,e())})}function a2e(){const{createConversation:e}=$r(),t=Wr();return l.useEffect(()=>(LA(),()=>{DA()}),[]),s2e(()=>{e({isTemporary:!0,shouldNavigateToChat:!1})}),t?c.jsx(n2e,{}):c.jsxs(tm,{className:"relative h-full flex-1 overflow-hidden will-change-auto",children:[c.jsxs(dd,{children:[c.jsx(k4,{children:c.jsx(e2e,{reactionsToAllow:o2e})}),c.jsx(sm,{})]}),c.jsx(d4,{children:c.jsx(om,{suppressBottomSection:!0})})]})}const r2e=Re(Dh)({component:a2e,beforeLoad:()=>({customLayout:!0}),onEnter:()=>{LA()},onLeave:()=>{DA()}}),i2e=Re("/chats/$conversationId")({beforeLoad:()=>({customLayout:!0})}),c2e=Re("/labs_/portrait/")({staticData:{showBackButton:"auto"}}),l2e=Re("/labs_/experiments/")({beforeLoad:()=>{throw t7({to:"/labs"})}}),u2e=Re("/labs_/career-coach/")({staticData:{showBackButton:"auto"}}),d2e=Re("/labs_/audio-expression/")({staticData:{showBackButton:"auto"}}),m2e=Re("/shares/pages/$shareId")({beforeLoad:()=>({customLayout:!0})}),p2e=Re("/shares/3d-generations/$shareId")({head:e=>Rs(()=>{const{shareId:t}=e.params,{baseUrl:n,i18n:o}=e.match.context,a=`${n}/static/cmc/images/meta-image.jpg`,r=o?.t("server.share3dGeneration.metadata.title"),i=o?.t("server.share3dGeneration.metadata.description");return{meta:[...r?[{title:r}]:[],...i?[{name:"description",content:i}]:[],...Ca({title:r,description:i,url:`${n}/shares/3d-generations/${t}`,imageUrl:a,imageWidth:"1200",imageHeight:"630"}),...Sa({title:r,description:i,card:"summary_large_image",image:a})]}})}),f2e=Re("/labs_/portrait/talk")({beforeLoad:()=>({customLayout:!0})}),h2e=Re("/labs_/experiments/$experimentAlias")({staticData:{showBackButton:!0}}),g2e=Re("/health_/chats/$conversationId")({beforeLoad:()=>({customLayout:!0})}),v2e=Re("/conversations/join/$token")({head:e=>Rs(()=>{const{canonical:t,i18n:n}=e.match.context,o=n?.t("server.conversations.join.metadata.title"),s=n?.t("server.conversations.join.metadata.description");return{meta:[...o?[{title:o}]:[],...s?[{name:"description",content:s}]:[],...Ca({title:o,description:s,url:t}),...Sa({title:o,description:s,card:"summary_large_image"})]}})}),y2e=Re("/chats_/$conversationId/talk")({beforeLoad:()=>({customLayout:!0})}),C2e=Re("/labs_/experiments/3d-generations/")({staticData:{showBackButton:"auto"}}),S2e=Re("/projects_/$projectId/chats/$conversationId")({beforeLoad:()=>({customLayout:!0})}),b2e=Re("/labs_/experiments/3d-generations/my-creations")({staticData:{showBackButton:"auto"}}),I2e=Re("/topic-selection")(),E2e=Re("/login")(),T2e=Re("/imagine")(),w2e=Re("/agents")(),A2e=Re("/labs_/")(),x2e=Re("/subscription/start")(),_2e=Re("/subscription/pricing")(),k2e=Re("/subscription/manage")(),P2e=Re("/research/$researchId")(),M2e=Re("/e/sol")(),R2e=Re("/e/so")(),N2e=Re("/connector/callback")(),L2e=Re("/campaigns/$campaignId")(),D2e=Re("/subscription/redeem/enel")(),O2e=Re("/subscription/ewallet/return")(),U2e=Re("/shares/tasks/$shareId")(),F2e=Re("/shares/podcasts/$shareId")(),j2e=Re("/podcasts/$podcastType/$podcastId")(),B2e=Re("/labs_/portrait/gallery")(),V2e=Re("/labs_/career-coach/report")(),H2e=Re("/labs_/career-coach/mock-interview")(),z2e=Re("/discover/{-$modalType}/{-$modalId}")(),G2e=Re("/labs_/portrait/future-self/")(),W2e=Re("/labs_/portrait/future-self/create")(),$2e=I2e.update({id:"/topic-selection",path:"/topic-selection",getParentRoute:()=>Ye}).lazy(()=>N(()=>import("./topic-selection.lazy-C8gRKz2S.js"),__vite__mapDeps([546,1,2])).then(e=>e.Route)),q2e=E2e.update({id:"/login",path:"/login",getParentRoute:()=>Ye}).lazy(()=>N(()=>import("./login.lazy-BtqCTRJf.js"),__vite__mapDeps([547,1,463,2])).then(e=>e.Route)),V0=T2e.update({id:"/imagine",path:"/imagine",getParentRoute:()=>Ye}).lazy(()=>N(()=>import("./imagine._galleryItemId.lazy-COTafpTs.js").then(e=>e.i),__vite__mapDeps([548,1,543,549,550,551,552,553,554,555,556,557,511,512,379,558,507,385,494,495,496,499])).then(e=>e.Route)),K2e=w2e.update({id:"/agents",path:"/agents",getParentRoute:()=>Ye}).lazy(()=>N(()=>import("./agents.lazy-khLedAwL.js"),__vite__mapDeps([559,1])).then(e=>e.Route)),Y2e=hye.update({id:"/tasks",path:"/tasks",getParentRoute:()=>Ye}).lazy(()=>N(()=>import("./tasks.lazy-Ba7PLAw8.js"),__vite__mapDeps([418,1,376,377,378,373,374,342,379,2])).then(e=>e.Route)),Z2e=gye.update({id:"/shopping",path:"/shopping",getParentRoute:()=>Ye}).lazy(()=>N(()=>import("./shopping.lazy-TrDq79-Q.js"),__vite__mapDeps([560,1,561,562,563,375,391,388,381,378,2,389,390,384,385,386,387,323,398,564,565,516,511,512,414,517,518,412,495,496,519,427,505,566,529,444,350,524,567,443,347,445,353,352,442,531,568,351,506,569,570,410,571,348,332,346,349])).then(e=>e.Route)),Jr=vye.update({id:"/shares",path:"/shares",getParentRoute:()=>Ye}),J2e=yye.update({id:"/library",path:"/library",getParentRoute:()=>Ye}).lazy(()=>N(()=>import("./library.lazy-Di5mVHqk.js"),__vite__mapDeps([572,1,573,329,549,387,388,381,378,2,422,574,575,511,512,576,577,578,399,400,401,579,403,580,581,556,557])).then(e=>e.Route)),yn=Eye.update({id:"/labs_",path:"/labs",getParentRoute:()=>Ye}),Q2e=Tye.update({id:"/health",path:"/health",getParentRoute:()=>Ye}).lazy(()=>N(()=>import("./health.lazy-CogV11nL.js"),__vite__mapDeps([582,1,583,329,584,585,2])).then(e=>e.Route)),X2e=wye.update({id:"/gaming",path:"/gaming",getParentRoute:()=>Ye}).lazy(()=>N(()=>import("./gaming.lazy-Cdx-ct5T.js"),__vite__mapDeps([586,1,521,587,2])).then(e=>e.Route)),ebe=Aye.update({id:"/daily",path:"/daily",getParentRoute:()=>Ye}).lazy(()=>N(()=>import("./daily.lazy-DRWCqtVj.js"),__vite__mapDeps([588,1,589,590,591,592,593,594,595,596,597,402,400,598,401,2])).then(e=>e.Route)),tbe=tCe.update({id:"/",path:"/",getParentRoute:()=>Ye}),nbe=A2e.update({id:"/",path:"/",getParentRoute:()=>yn}).lazy(()=>N(()=>import("./index.lazy-74fkva2i.js"),__vite__mapDeps([599,1,587,600,2])).then(e=>e.Route)),obe=nCe.update({id:"/",path:"/",getParentRoute:()=>V0}),sbe=x2e.update({id:"/subscription/start",path:"/subscription/start",getParentRoute:()=>Ye}).lazy(()=>N(()=>import("./subscription.start.lazy-Bs0DT3zL.js"),__vite__mapDeps([601,1,2])).then(e=>e.Route)),abe=_2e.update({id:"/subscription/pricing",path:"/subscription/pricing",getParentRoute:()=>Ye}).lazy(()=>N(()=>import("./subscription.pricing.lazy-D8Ny2UkM.js"),__vite__mapDeps([602,1,334,335,2,336,603,604,605,606,342,607,608,6,338,344,609,610,611,612,341,613,614,615,323,616,617,618,619,620,621,622,623,624,456,625,626,627,628,629,579,428,630,631])).then(e=>e.Route)),rbe=k2e.update({id:"/subscription/manage",path:"/subscription/manage",getParentRoute:()=>Ye}).lazy(()=>N(()=>import("./subscription.manage.lazy-W9C6Vly3.js"),__vite__mapDeps([632,1,625,386,2])).then(e=>e.Route)),ibe=P2e.update({id:"/research/$researchId",path:"/research/$researchId",getParentRoute:()=>Ye}).lazy(()=>N(()=>import("./research._researchId.lazy-D4-XOxuk.js"),__vite__mapDeps([633,1,394,395,381,378,388,2,389,390,396,397,398,403,561,562,563,375,391,384,385,386,387,323,564,565,516,511,512,414,517,518,412,495,496,519,427,505,566,634,580,581,556,557])).then(e=>e.Route)),cbe=M2e.update({id:"/e/sol",path:"/e/sol",getParentRoute:()=>Ye}).lazy(()=>N(()=>import("./e.sol.lazy-PXtOSJJJ.js"),__vite__mapDeps([635,1,2])).then(e=>e.Route)),lbe=R2e.update({id:"/e/so",path:"/e/so",getParentRoute:()=>Ye}).lazy(()=>N(()=>import("./e.so.lazy-_rucXbLr.js"),__vite__mapDeps([636,1,2])).then(e=>e.Route)),ube=N2e.update({id:"/connector/callback",path:"/connector/callback",getParentRoute:()=>Ye}).lazy(()=>N(()=>import("./connector.callback.lazy-8tw92Q2p.js"),__vite__mapDeps([637,1,501,2])).then(e=>e.Route)),dbe=L2e.update({id:"/campaigns/$campaignId",path:"/campaigns/$campaignId",getParentRoute:()=>Ye}).lazy(()=>N(()=>import("./campaigns._campaignId.lazy-BtzJdI9J.js"),__vite__mapDeps([638,1,2])).then(e=>e.Route)),mbe=oCe.update({id:"/tasks_/$conversationId",path:"/tasks/$conversationId",getParentRoute:()=>Ye}).lazy(()=>N(()=>import("./tasks_._conversationId.lazy--76oaE_-.js").then(e=>e.t),__vite__mapDeps([371,1,372,373,374,375,376,377,378,342,379,380,381,382,327,383,384,385,386,387,388,2,389,390,391,323,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,370,413,414,329,415,416,417])).then(e=>e.Route)),pbe=aCe.update({id:"/$conversationId",path:"/$conversationId",getParentRoute:()=>Jr}).lazy(()=>N(()=>import("./shares._conversationId.lazy-DReKbB2S.js"),__vite__mapDeps([639,1,562,563,375,391,388,381,378,2,389,390,384,385,386,387,323,398,564,565,516,511,512,414,517,518,412,495,496,519,427,505,566])).then(e=>e.Route)),fbe=rCe.update({id:"/projects/$projectId",path:"/projects/$projectId",getParentRoute:()=>Ye}).lazy(()=>N(()=>import("./projects._projectId.lazy-nSk9fPnZ.js"),__vite__mapDeps([640,1,367,329,368,641,642,399,643,644,645,409,573,401,646,558,366,585,647,648,649,650,566,2])).then(e=>e.Route)),hbe=iCe.update({id:"/partners/feedback",path:"/partners/feedback",getParentRoute:()=>Ye}).lazy(()=>N(()=>import("./partners.feedback.lazy-BdBkb3DO.js"),__vite__mapDeps([651,1,652,5,2])).then(e=>e.Route)),gbe=cCe.update({id:"/pages/$pageId",path:"/pages/$pageId",getParentRoute:()=>Ye}).lazy(()=>N(()=>import("./pages._pageId.lazy-Bc1wRaYA.js"),__vite__mapDeps([653,1,654,385,329,574,575,511,512,428,628,655,656,393,657,658,659,430,342,415,382,660,378,416,650,472,476,480,485,661,566,662,663,664,593,665,648,649,563,375,391,388,381,2,389,390,384,386,387,323,398,564,565,516,414,517,518,412,495,496,519,427,505,666,576,667,647])).then(e=>e.Route)),vbe=uCe.update({id:"/$galleryItemId",path:"/$galleryItemId",getParentRoute:()=>V0}).lazy(()=>N(()=>import("./imagine._galleryItemId.lazy-COTafpTs.js").then(e=>e.d),__vite__mapDeps([548,1,543,549,550,551,552,553,554,555,556,557,511,512,379,558,507,385,494,495,496,499])).then(e=>e.Route)),ybe=r2e.update({id:"/chats/temporary",path:"/chats/temporary",getParentRoute:()=>Ye}),Cbe=i2e.update({id:"/chats/$conversationId",path:"/chats/$conversationId",getParentRoute:()=>Ye}).lazy(()=>N(()=>import("./chats._conversationId.lazy-BiNFmIxK.js").then(e=>e.c),__vite__mapDeps([668,1,648,649,563,375,391,388,381,378,2,389,390,384,385,386,387,323,398,564,565,516,511,512,414,517,518,412,495,496,519,427,505,566,669,562,382])).then(e=>e.Route)),Sbe=c2e.update({id:"/portrait/",path:"/portrait/",getParentRoute:()=>yn}).lazy(()=>N(()=>import("./index.lazy-DMSiybUK.js"),__vite__mapDeps([670,1,671,672,673,674,675,2])).then(e=>e.Route)),bbe=l2e.update({id:"/experiments/",path:"/experiments/",getParentRoute:()=>yn}),Ibe=u2e.update({id:"/career-coach/",path:"/career-coach/",getParentRoute:()=>yn}).lazy(()=>N(()=>import("./mock-interview.lazy-Ct4Qqhiu.js").then(e=>e.i),__vite__mapDeps([676,1,342,533,534,490])).then(e=>e.Route)),Ebe=d2e.update({id:"/audio-expression/",path:"/audio-expression/",getParentRoute:()=>yn}).lazy(()=>N(()=>import("./index.lazy-CP9oPFyl.js"),__vite__mapDeps([677,1,678,455,405,454,402,2])).then(e=>e.Route)),Tbe=D2e.update({id:"/subscription/redeem/enel",path:"/subscription/redeem/enel",getParentRoute:()=>Ye}).lazy(()=>N(()=>import("./subscription.redeem.enel.lazy-BpD05zbk.js"),__vite__mapDeps([679,1,625,2])).then(e=>e.Route)),wbe=O2e.update({id:"/subscription/ewallet/return",path:"/subscription/ewallet/return",getParentRoute:()=>Ye}).lazy(()=>N(()=>import("./subscription.ewallet.return.lazy-XtrHx5SP.js"),__vite__mapDeps([680,1,615,624,456,408,604,2])).then(e=>e.Route)),Abe=U2e.update({id:"/tasks/$shareId",path:"/tasks/$shareId",getParentRoute:()=>Jr}).lazy(()=>N(()=>import("./shares.tasks._shareId.lazy-BdzlXwhr.js"),__vite__mapDeps([681,1,665,429,581,395,381,378,388,2,389,390,396,397,398,634])).then(e=>e.Route)),xbe=F2e.update({id:"/podcasts/$shareId",path:"/podcasts/$shareId",getParentRoute:()=>Jr}).lazy(()=>N(()=>import("./shares.podcasts._shareId.lazy-B87Fbe9D.js"),__vite__mapDeps([682,1,400,401,596,597,2])).then(e=>e.Route)),_be=j2e.update({id:"/podcasts/$podcastType/$podcastId",path:"/podcasts/$podcastType/$podcastId",getParentRoute:()=>Ye}).lazy(()=>N(()=>import("./podcasts._podcastType._podcastId.lazy-DimKEsuy.js"),__vite__mapDeps([683,1,589,590,591,592,593,594,595,596,597,402,400,598,401,2])).then(e=>e.Route)),kbe=B2e.update({id:"/portrait/gallery",path:"/portrait/gallery",getParentRoute:()=>yn}).lazy(()=>N(()=>import("./gallery.lazy-BMLHZaBh.js"),__vite__mapDeps([684,1,671,672,673,674,675,2])).then(e=>e.Route)),Pbe=V2e.update({id:"/career-coach/report",path:"/career-coach/report",getParentRoute:()=>yn}).lazy(()=>N(()=>import("./mock-interview.lazy-Ct4Qqhiu.js").then(e=>e.r),__vite__mapDeps([676,1,342,533,534,490])).then(e=>e.Route)),Mbe=H2e.update({id:"/career-coach/mock-interview",path:"/career-coach/mock-interview",getParentRoute:()=>yn}).lazy(()=>N(()=>import("./mock-interview.lazy-Ct4Qqhiu.js").then(e=>e.m),__vite__mapDeps([676,1,342,533,534,490])).then(e=>e.Route)),Rbe=z2e.update({id:"/discover/{-$modalType}/{-$modalId}",path:"/discover/{-$modalType}/{-$modalId}",getParentRoute:()=>Ye}).lazy(()=>N(()=>import("./discover._-_modalType_._-_modalId_.lazy-BGQHie2b.js").then(e=>e.d),__vite__mapDeps([685,1,410,561,562,563,375,391,388,381,378,2,389,390,384,385,386,387,323,398,564,565,516,511,512,414,517,518,412,495,496,519,427,505,566,598,686])).then(e=>e.Route)),Nbe=m2e.update({id:"/pages/$shareId",path:"/pages/$shareId",getParentRoute:()=>Jr}).lazy(()=>N(()=>import("./shares.pages._shareId.lazy-DWch-mmI.js"),__vite__mapDeps([687,1,667,654,385,329,574,575,511,512,428,628,655,656,393,657,658,659,430,342,415,382,660,378,416,650,472,476,480,485,661,566,662,663,664,593,665,648,649,563,375,391,388,381,2,389,390,384,386,387,323,398,564,565,516,414,517,518,412,495,496,519,427,505,666,577,688,647])).then(e=>e.Route)),Lbe=p2e.update({id:"/3d-generations/$shareId",path:"/3d-generations/$shareId",getParentRoute:()=>Jr}).lazy(()=>N(()=>import("./shares.3d-generations._shareId.lazy-CwDujRQV.js"),__vite__mapDeps([689,1,690,342,404,555,691,587,511,512,553,554,2])).then(e=>e.Route)),Dbe=f2e.update({id:"/portrait/talk",path:"/portrait/talk",getParentRoute:()=>yn}).lazy(()=>N(()=>import("./talk.lazy-Cu0UlK4f.js"),__vite__mapDeps([692,1,693,694,404,468,464,465,466,2,563,375,391,388,381,378,389,390,384,385,386,387,323,398,564,565,516,511,512,414,517,518,412,495,496,519,427,505,566,674,669,562])).then(e=>e.Route)),Obe=h2e.update({id:"/experiments/$experimentAlias",path:"/experiments/$experimentAlias",getParentRoute:()=>yn}).lazy(()=>N(()=>import("./experiments._experimentAlias.lazy-D0_QuSnr.js"),__vite__mapDeps([695,1,455,405,587,600,2])).then(e=>e.Route)),Ube=g2e.update({id:"/health_/chats/$conversationId",path:"/health/chats/$conversationId",getParentRoute:()=>Ye}).lazy(()=>N(()=>import("./health_.chats._conversationId.lazy-Dz0WD2eE.js"),__vite__mapDeps([696,1,584,2])).then(e=>e.Route)),Fbe=v2e.update({id:"/conversations/join/$token",path:"/conversations/join/$token",getParentRoute:()=>Ye}).lazy(()=>N(()=>import("./conversations.join._token.lazy-DY30lyyz.js"),__vite__mapDeps([697,1,356,2])).then(e=>e.Route)),jbe=y2e.update({id:"/chats_/$conversationId/talk",path:"/chats/$conversationId/talk",getParentRoute:()=>Ye}).lazy(()=>N(()=>import("./chats_._conversationId.talk.lazy-KWFT6eWU.js"),__vite__mapDeps([698,1,693,694,404,468,464,465,466,2,563,375,391,388,381,378,389,390,384,385,386,387,323,398,564,565,516,511,512,414,517,518,412,495,496,519,427,505,566,674,669,562])).then(e=>e.Route)),Bbe=G2e.update({id:"/portrait/future-self/",path:"/portrait/future-self/",getParentRoute:()=>yn}).lazy(()=>N(()=>import("./index.lazy-D_SXaXQF.js"),__vite__mapDeps([699,1,672,700,329,675,674,2])).then(e=>e.Route)),Vbe=C2e.update({id:"/experiments/3d-generations/",path:"/experiments/3d-generations/",getParentRoute:()=>yn}).lazy(()=>N(()=>import("./my-creations.lazy-BLgl71t3.js").then(e=>e.i),__vite__mapDeps([701,1,702,690,342,404,555,691,587,461,2,597,661,703,704,678,705,556,557,511,512,508,554,590,591,592,329,706])).then(e=>e.Route)),Hbe=W2e.update({id:"/portrait/future-self/create",path:"/portrait/future-self/create",getParentRoute:()=>yn}).lazy(()=>N(()=>import("./create.lazy-BmvpvSey.js"),__vite__mapDeps([707,1,675,700,461,2,674])).then(e=>e.Route)),zbe=S2e.update({id:"/projects_/$projectId/chats/$conversationId",path:"/projects/$projectId/chats/$conversationId",getParentRoute:()=>Ye}).lazy(()=>N(()=>import("./projects_._projectId.chats._conversationId.lazy-BWi_dLaE.js"),__vite__mapDeps([708,1,641,642,399,643,644,645,367,329,409,573,401,646,558,585,650,566,2])).then(e=>e.Route)),Gbe=b2e.update({id:"/experiments/3d-generations/my-creations",path:"/experiments/3d-generations/my-creations",getParentRoute:()=>yn}).lazy(()=>N(()=>import("./my-creations.lazy-BLgl71t3.js").then(e=>e.m),__vite__mapDeps([701,1,702,690,342,404,555,691,587,461,2,597,661,703,704,678,705,556,557,511,512,508,554,590,591,592,329,706])).then(e=>e.Route)),Wbe={LabsIndexLazyRoute:nbe,LabsExperimentsExperimentAliasRoute:Obe,LabsPortraitTalkRoute:Dbe,LabsCareerCoachMockInterviewLazyRoute:Mbe,LabsCareerCoachReportLazyRoute:Pbe,LabsPortraitGalleryLazyRoute:kbe,LabsAudioExpressionIndexRoute:Ebe,LabsCareerCoachIndexRoute:Ibe,LabsExperimentsIndexRoute:bbe,LabsPortraitIndexRoute:Sbe,LabsExperiments3dGenerationsMyCreationsRoute:Gbe,LabsPortraitFutureSelfCreateLazyRoute:Hbe,LabsExperiments3dGenerationsIndexRoute:Vbe,LabsPortraitFutureSelfIndexLazyRoute:Bbe},$be=yn._addFileChildren(Wbe),qbe={SharesConversationIdRoute:pbe,Shares3dGenerationsShareIdRoute:Lbe,SharesPagesShareIdRoute:Nbe,SharesPodcastsShareIdLazyRoute:xbe,SharesTasksShareIdLazyRoute:Abe},Kbe=Jr._addFileChildren(qbe),Ybe={ImagineGalleryItemIdRoute:vbe,ImagineIndexRoute:obe},Zbe=V0._addFileChildren(Ybe),Jbe={IndexRoute:tbe,DailyRoute:ebe,GamingRoute:X2e,HealthRoute:Q2e,LabsRoute:$be,LibraryRoute:J2e,SharesRoute:Kbe,ShoppingRoute:Z2e,TasksRoute:Y2e,AgentsLazyRoute:K2e,ImagineLazyRoute:Zbe,LoginLazyRoute:q2e,TopicSelectionLazyRoute:$2e,ChatsConversationIdRoute:Cbe,ChatsTemporaryRoute:ybe,PagesPageIdRoute:gbe,PartnersFeedbackRoute:hbe,ProjectsProjectIdRoute:fbe,TasksConversationIdRoute:mbe,CampaignsCampaignIdLazyRoute:dbe,ConnectorCallbackLazyRoute:ube,ESoLazyRoute:lbe,ESolLazyRoute:cbe,ResearchResearchIdLazyRoute:ibe,SubscriptionManageLazyRoute:rbe,SubscriptionPricingLazyRoute:abe,SubscriptionStartLazyRoute:sbe,ChatsConversationIdTalkRoute:jbe,ConversationsJoinTokenRoute:Fbe,HealthChatsConversationIdRoute:Ube,DiscoverModalTypeModalIdLazyRoute:Rbe,PodcastsPodcastTypePodcastIdLazyRoute:_be,SubscriptionEwalletReturnLazyRoute:wbe,SubscriptionRedeemEnelLazyRoute:Tbe,ProjectsProjectIdChatsConversationIdRoute:zbe},Qbe=Ye._addFileChildren(Jbe)._addFileTypes();let sb=null;function Xbe({isEntryServerOrIsGetRouter:e}){return n7({routeTree:Qbe})}function Nn(){return sb??=Xbe({isEntryServerOrIsGetRouter:!0}),sb}(function(){const e="onabort onactivate onactivateinvisible onafterprint onafterupdate onanimationcancel onanimationend onanimationiteration onanimationstart onariarequest onauxclick onbeforeactivate onbeforecopy onbeforecut onbeforedeactivate onbeforeeditfocus onbeforepaste onbeforeprint onbeforeunload onbegin onblur onbounce oncancel oncanplay oncanplaythrough oncellchange onchange onclick onclose oncommand oncontextmenu oncontrolselect oncopy oncuechange oncut ondataavailable ondatasetchanged ondatasetcomplete ondblclick ondeactivate ondrag ondragdrop ondragend ondragenter ondragexit ondragleave ondragover ondragstart ondrop ondurationchange onemptied onend onended onerror onerrorupdate onexit onfilterchange onfinish onfocus onfocusin onfocusout onformdata onfullscreenchange onfullscreenerror ongotpointercapture onhelp oninput oninvalid onkeydown onkeypress onkeyup onlayoutcomplete onload onloadeddata onloadedmetadata onloadend onloadstart onlosecapture onlostpointercapture onmediacomplete onmediaerror onmessage onmousedown onmouseenter onmouseleave onmousemove onmouseout onmouseover onmouseup onmousewheel onmove onmoveend onmovestart onmozfullscreenchange onmozfullscreenerror onmscontentzoom onmsgesturechange onmsgesturedoubletap onmsgestureend onmsgesturehold onmsgesturestart onmsgesturetap onmsgotpointercapture onmsinertiastart onmslostpointercapture onmsmanipulationstatechanged onmspointercancel onmspointerdown onmspointerenter onmspointerleave onmspointermove onmspointerout onmspointerover onmspointerup onoffline ononline onoutofsync onoverscroll onpaste onpause onplay onplaying onpointercancel onpointerdown onpointerenter onpointerleave onpointermove onpointerout onpointerover onpointerrawupdate onpointerup onprogress onpropertychange onratechange onreadystatechange onrepeat onreset onresize onresizeend onresizestart onresume onreverse onrowdelete onrowenter onrowexit onrowinserted onscroll onscrollend onsearch onseek onseeked onseeking onselect onselectionchange onselectstart onshow onstalled onstart onstop onstorage onsubmit onsuspend onsynchrestored ontimeerror ontimeupdate ontoggle ontrackchange ontransitioncancel ontransitionend ontransitionrun ontransitionstart onunload onurlflip onvolumechange onwaiting onwebkitanimationend onwebkitanimationiteration onwebkitanimationstart onwebkitfullscreenchange onwebkitfullscreenerror onwebkittransitionend onwheel".split(" ");function t(){if(typeof window<"u"){const h=[];for(const g in HTMLElement.prototype)g.slice(0,2)==="on"&&h.push(g);return h}return e}const n=typeof window<"u",o=()=>{throw new TypeError("undefined conversion")},s=()=>null,{toLowerCase:a,toUpperCase:r}=String.prototype;function i(){throw new TypeError("Illegal constructor")}function d(){throw new TypeError("Illegal constructor")}const{l:m}=function(){function h(H){let Y=X.get(H);return Y===void 0&&(Y=I(null),X.set(H,Y)),Y}function g(H){const Y=D(H);if(Y==null||D(Y)!==L)throw Error();for(const ue of P(Y))x(H,ue,{value:H[ue]});return H}function y(H,Y){w(H.prototype),delete H.name,x(H,"name",{value:Y})}function b(H){return Y=>Y instanceof H&&X.has(Y)}function C(H,Y){function ue(De,_e){const ze=Y[_e]||(H=="default"?s:o),We=w(new De(K,H));return w({[_e](Oe,...qe){if(Oe=ze(""+Oe,...qe),Oe==null){if(H=="default")return Oe;Oe=""}return Oe=""+Oe,qe=w(I(We)),h(qe).v=Oe,qe}}[_e])}const oe=I(i.prototype);for(const De of P(re))oe[De]=ue(re[De],De);return x(oe,"name",{value:H,writable:!1,configurable:!1,enumerable:!0}),w(oe)}function T(H,Y,ue,oe="",De=""){if(H=r.apply(String(H)),(oe=De||oe)||(oe="http://www.w3.org/1999/xhtml"),oe=j.apply(Be,[oe])?Be[oe]:null){if(j.apply(oe,[H])&&oe[H]&&j.apply(oe[H][Y],[ue])&&oe[H][Y][ue])return oe[H][Y][ue];if(j.apply(oe,["*"])&&j.apply(oe["*"][Y],[ue])&&oe["*"][Y][ue])return oe["*"][Y][ue]}}function S(){return ge}const{assign:E,create:I,defineProperty:x,freeze:w,getOwnPropertyNames:P,getPrototypeOf:D,prototype:L}=Object,{hasOwnProperty:j}=L,{forEach:U,push:$}=Array.prototype,K=Symbol(),X=g(new WeakMap),ne=g([]),me=g([]);let Se=!0,ge=null,ve=!1;class Pe{constructor(Y,ue){if(Y!==K)throw Error("cannot call the constructor");x(this,"policyName",{value:ue,enumerable:!0})}toString(){return h(this).v}valueOf(){return h(this).v}}class Me extends Pe{}y(Me,"TrustedScriptURL");class ye extends Pe{}y(ye,"TrustedHTML");class Ie extends Pe{}y(Ie,"TrustedScript"),y(Pe,"TrustedType");const He=w(I(new ye(K,"")));h(He).v="";const Ze=w(I(new Ie(K,"")));h(Ze).v="";const Be={"http://www.w3.org/1999/xhtml":{EMBED:{attributes:{src:Me.name}},IFRAME:{attributes:{srcdoc:ye.name}},OBJECT:{attributes:{data:Me.name,codebase:Me.name}},SCRIPT:{attributes:{src:Me.name,text:Ie.name},properties:{innerText:Ie.name,textContent:Ie.name,text:Ie.name}},"*":{attributes:{},properties:{innerHTML:ye.name,outerHTML:ye.name}}},"http://www.w3.org/2000/svg":{"*":{attributes:{},properties:{}}}};var be={codebase:"codeBase",formaction:"formAction"};!n||"srcdoc"in HTMLIFrameElement.prototype||delete Be["http://www.w3.org/1999/xhtml"].IFRAME.attributes.srcdoc;for(const H of Object.keys(Be["http://www.w3.org/1999/xhtml"])){Be["http://www.w3.org/1999/xhtml"][H].properties||(Be["http://www.w3.org/1999/xhtml"][H].properties={});for(const Y of Object.keys(Be["http://www.w3.org/1999/xhtml"][H].attributes))Be["http://www.w3.org/1999/xhtml"][H].properties[be[Y]?be[Y]:Y]=Be["http://www.w3.org/1999/xhtml"][H].attributes[Y]}for(const H of t())Be["http://www.w3.org/1999/xhtml"]["*"].attributes[H]="TrustedScript",Be["http://www.w3.org/2000/svg"]["*"].attributes[H]="TrustedScript";const re={createHTML:ye,createScriptURL:Me,createScript:Ie},te=re.hasOwnProperty;return be=I(d.prototype),E(be,{createPolicy:function(H,Y){if(!H.match(/^[-#a-zA-Z0-9=_/@.%]+$/g))throw new TypeError("Policy "+H+" contains invalid characters.");if(ve&&me.indexOf(H)===-1&&me.indexOf("*")===-1)throw new TypeError("Policy "+H+" disallowed.");if(H==="default"&&ge)throw new TypeError("Policy "+H+" already exists.");if(ve&&!Se&&ne.indexOf(H)!==-1)throw new TypeError("Policy "+H+" exists.");ne.push(H);const ue=I(null);if(Y&&typeof Y=="object")for(const oe of P(Y))te.call(re,oe)&&(ue[oe]=Y[oe]);else console.warn("trustedTypes.createPolicy "+H+" was given an empty policy");return w(ue),Y=C(H,ue),H==="default"&&(ge=Y),Y},h:b(ye),j:b(Me),i:b(Ie),c:function(H,Y,ue="",oe=""){return Y=a.apply(String(Y)),T(H,"attributes",Y,ue,oe)||null},f:function(H,Y,ue=""){return T(H,"properties",String(Y),ue)||null},g:function(H=""){if(!H)try{H=document.documentElement.namespaceURI}catch{H="http://www.w3.org/1999/xhtml"}return(H=Be[H])?JSON.parse(JSON.stringify(H)):{}},a:He,b:Ze,o:ge,TrustedHTML:ye,TrustedScriptURL:Me,TrustedScript:Ie}),x(be,"defaultPolicy",{get:S,set:()=>{}}),{l:w(be),w:function(H,Y){ve=!0,me.length=0,U.call(H,ue=>{$.call(me,""+ue)}),Se=Y,ne.length=0},m:function(){ve=!1},s:S,u:function(){ge=null,ne.splice(ne.indexOf("default"),1)}}}();if(typeof window<"u"&&(window.TrustedTypes&&typeof window.trustedTypes>"u"&&(window.trustedTypes=Object.freeze(window.TrustedTypes)),typeof window.trustedTypes>"u")){var p=Object.create(d.prototype);Object.assign(p,{isHTML:m.h,isScriptURL:m.j,isScript:m.i,createPolicy:m.createPolicy,getAttributeType:m.c,getPropertyType:m.f,getTypeMapping:m.g,emptyHTML:m.a,emptyScript:m.b,_isPolyfill_:!0}),Object.defineProperty(p,"defaultPolicy",Object.getOwnPropertyDescriptor(m,"defaultPolicy")||{}),window.trustedTypes=Object.freeze(p),window.TrustedHTML=m.TrustedHTML,window.TrustedScriptURL=m.TrustedScriptURL,window.TrustedScript=m.TrustedScript,window.TrustedTypePolicy=i,window.TrustedTypePolicyFactory=d}}).call(void 0);let B4;function oke(e){B4=e}const ab=["copilot.microsoft.com","copilot.com","copilot-stg.com","studiostaticassetsprod.azureedge.net",window.location.hostname];function eIe(e){if(!e)return!1;const t=/^\/cl\//,n=/^https:\/\/[^/]+\.clarity\.ms\//,o=/^https:\/\/[^/]+\.cloudflare\.com\//,s=/^https:\/\/bat\.bing\.com\//,a=/^https:\/\/az416426\.vo\.msecnd\.net\//,r=/^https:\/\/fpt\.dfp\.microsoft\.com\//,i=/^https:\/\/assets\.msn\.com\//,d=/^https:\/\/content\.lifecycle\.office\.net\//,m=/^https:\/\/content\.lifecycle\.officeppe\.net\//,p=/^https:\/\/[^/]+\.paypal\.com\//,h=/^https:\/\/[^/]+\.paypalobjects\.com\//,g=/^https:\/\/cdn\.shopifycloud\.com\//,y=/^https:\/\/[^/]+\.stripe\.com\//,b=/^https:\/\/tvmodules-vidaa\.vidaahub\.com\//,C=window.location.protocol.replace(":",""),T=window.location.hostname.replace(/\./g,"\\."),S=window.location.port?`:${window.location.port}`:"",E=new RegExp(`^${C}://${T}${S}/src/workers/[^/]+\\.worker\\.ts`),I=ab.map(w=>{const P=w.replace(/\./g,"\\.");return new RegExp(`^https://${P}/.+/assets/[^/]+\\.worker-[^/]+\\.js$`)}),x=w=>{if(!w.startsWith("blob:"))return!1;const P=w.match(/^blob:(https?:\/\/[^/]+)/);if(!P||!P[1])return!1;const D=P[1];try{const L=new URL(D);return ab.some(j=>L.hostname===j)}catch{return!1}};return t.test(e)||n.test(e)||o.test(e)||s.test(e)||a.test(e)||r.test(e)||i.test(e)||d.test(e)||m.test(e)||p.test(e)||h.test(e)||g.test(e)||y.test(e)||b.test(e)||E.test(e)||I.some(w=>w.test(e))||e===B4||x(e)}function tIe(){typeof window<"u"&&(window.copilotTrustedTypesPolicy=window.trustedTypes?.createPolicy("copilotPolicy",{createHTML:e=>xv.sanitize(e)}),window.trustedTypes?.createPolicy("default",{createScriptURL:e=>{if(eIe(e))return e;throw new Error(`Unsafe script URL "${e}" blocked by CSP.`)},createHTML:e=>xv.sanitize(e)}))}function nIe(){if(typeof window>"u")return;const e=window.randomSeed;return typeof e=="number"?e:void 0}const oIe="6472538445",sIe="6738511300";function aIe(){const e=document.querySelector('meta[name="apple-itunes-app"]');e&&e.remove();let t=null;if(Ag()?t=oIe:Ez()&&(t=sIe),t){const n=document.createElement("meta");n.name="apple-itunes-app",n.content=`app-id=${t}`,document.head.appendChild(n)}}tIe();aIe();const ih=Nn();ih.update({context:{...ih.options.context,fetchAndParseAPI:pt,queryClient:Ah}});o7.hydrateRoot(document.getElementById("app"),c.jsx(l.StrictMode,{children:c.jsx(pM,{queryClient:Ah,randomSeed:nIe(),children:c.jsx(s7,{router:ih})})}));export{jse as $,R as A,ee as B,$_ as C,_s as D,ot as E,aEe as F,Je as G,BAe as H,Dse as I,q as J,jAe as K,xt as L,Bue as M,he as N,rt as O,nEe as P,je as Q,ek as R,J as S,tEe as T,$r as U,to as V,m1 as W,Go as X,aZ as Y,e5e as Z,de as _,Yge as a,oAe as a$,it as a0,_Ae as a1,kAe as a2,sn as a3,VAe as a4,Ro as a5,W as a6,Ee as a7,y1 as a8,at as a9,jn as aA,VA as aB,dwe as aC,I1 as aD,Ga as aE,Dt as aF,fxe as aG,C3 as aH,qt as aI,CEe as aJ,EIe as aK,Jo as aL,I_ as aM,Rre as aN,yee as aO,n0 as aP,AEe as aQ,U5 as aR,Dae as aS,Pk as aT,q1 as aU,Bq as aV,rTe as aW,di as aX,Nh as aY,vt as aZ,DT as a_,E3e as aa,xd as ab,P3e as ac,ixe as ad,Yt as ae,Ak as af,Fa as ag,xEe as ah,tm as ai,cye as aj,sm as ak,Yae as al,oxe as am,jt as an,f0 as ao,G3e as ap,Bt as aq,vc as ar,po as as,It as at,Wn as au,on as av,fo as aw,IA as ax,hu as ay,Os as az,LIe as b,iY as b$,ko as b0,bEe as b1,kB as b2,zd as b3,of as b4,sh as b5,wu as b6,tx as b7,Hce as b8,c1 as b9,Gd as bA,yie as bB,ss as bC,tAe as bD,Xle as bE,fwe as bF,One as bG,kwe as bH,Ce as bI,Gc as bJ,Us as bK,eoe as bL,UIe as bM,Fd as bN,z_ as bO,G_ as bP,e0 as bQ,Ah as bR,PEe as bS,em as bT,$3 as bU,C3e as bV,y3e as bW,eA as bX,p1 as bY,f1 as bZ,zn as b_,Vt as ba,hI as bb,St as bc,oq as bd,bt as be,nm as bf,js as bg,Pde as bh,yf as bi,wI as bj,Gz as bk,t0 as bl,Hn as bm,F4 as bn,cSe as bo,N4 as bp,Xf as bq,w0 as br,Lt as bs,Ao as bt,V_ as bu,lo as bv,W5e as bw,lle as bx,Zt as by,dG as bz,Ae as c,t5e as c$,moe as c0,p3 as c1,jS as c2,VEe as c3,Y5 as c4,zr as c5,Hc as c6,GK as c7,q3e as c8,oo as c9,vie as cA,h4 as cB,Yd as cC,S3e as cD,H3e as cE,W3 as cF,Jw as cG,z3e as cH,pAe as cI,kW as cJ,vy as cK,Ct as cL,Xte as cM,zxe as cN,ahe as cO,ehe as cP,ut as cQ,fG as cR,DEe as cS,Oa as cT,Dr as cU,y5e as cV,ST as cW,Ug as cX,$n as cY,Bo as cZ,ir as c_,en as ca,b3e as cb,fn as cc,mY as cd,R_ as ce,fhe as cf,La as cg,As as ch,wn as ci,Hr as cj,zTe as ck,GTe as cl,XEe as cm,Q3 as cn,Ba as co,Ar as cp,Rt as cq,i2 as cr,tS as cs,Eee as ct,$f as cu,IG as cv,Wi as cw,Ut as cx,uwe as cy,B$ as cz,DIe as d,Z5e as d$,bwe as d0,xhe as d1,Pt as d2,Owe as d3,pY as d4,PIe as d5,kIe as d6,VIe as d7,xG as d8,as as d9,Wde as dA,R3 as dB,Dh as dC,FAe as dD,Ha as dE,MAe as dF,ra as dG,Br as dH,J5 as dI,$t as dJ,DM as dK,Mg as dL,hk as dM,Hs as dN,Hxe as dO,h1 as dP,NTe as dQ,aA as dR,H$ as dS,iC as dT,F0 as dU,U0 as dV,Hhe as dW,Qg as dX,gd as dY,HT as dZ,Ur as d_,dA as da,$3e as db,m3 as dc,M0 as dd,Z_ as de,cf as df,y0 as dg,Q_ as dh,Nw as di,rAe as dj,MZ as dk,$Te as dl,Vwe as dm,qne as dn,npe as dp,yEe as dq,uG as dr,VT as ds,UW as dt,Md as du,qn as dv,Hg as dw,r0 as dx,B0 as dy,M3 as dz,O as e,G_e as e$,Gi as e0,o0 as e1,Og as e2,N0 as e3,NB as e4,wEe as e5,TEe as e6,EEe as e7,IEe as e8,Vs as e9,Ne as eA,nt as eB,bn as eC,xi as eD,owe as eE,Sk as eF,kt as eG,wIe as eH,zf as eI,jue as eJ,CG as eK,B0e as eL,Cee as eM,Lye as eN,Nye as eO,dp as eP,a1 as eQ,Tue as eR,et as eS,CI as eT,xr as eU,Qu as eV,EA as eW,K_e as eX,Nxe as eY,lye as eZ,W_e as e_,To as ea,zc as eb,Xx as ec,Bw as ed,xye as ee,uxe as ef,V3 as eg,wee as eh,uoe as ei,Xo as ej,zK as ek,Kr as el,bCe as em,oa as en,qr as eo,Hne as ep,wl as eq,Rc as er,es,rZ as et,Y3e as eu,vge as ev,T1e as ew,_1e as ex,Xc as ey,kxe as ez,zw as f,MI as f$,Y_e as f0,$_e as f1,q_e as f2,mq as f3,Sre as f4,Yr as f5,kd as f6,vA as f7,jTe as f8,gwe as f9,kEe as fA,Pn as fB,pEe as fC,ATe as fD,wTe as fE,Mk as fF,g0 as fG,Pw as fH,Y3 as fI,q3 as fJ,W1 as fK,aG as fL,io as fM,pd as fN,lTe as fO,co as fP,iTe as fQ,Bxe as fR,Mc as fS,Lre as fT,Na as fU,ws as fV,OT as fW,_h as fX,ao as fY,l0 as fZ,Q1 as f_,vwe as fa,ywe as fb,Ma as fc,EN as fd,Ri as fe,HA as ff,zA as fg,RAe as fh,hve as fi,wAe as fj,AAe as fk,Kw as fl,pf as fm,j5e as fn,M3e as fo,GIe as fp,dn as fq,Qi as fr,kI as fs,n3e as ft,o3e as fu,NS as fv,k1e as fw,w1e as fx,A1e as fy,x1e as fz,lT as g,C5 as g$,bee as g0,See as g1,k_ as g2,Wf as g3,G3 as g4,Hoe as g5,Ox as g6,ope as g7,P3 as g8,K1 as g9,k4 as gA,e2e as gB,eke as gC,d4 as gD,om as gE,Z3e as gF,IW as gG,kk as gH,H_e as gI,yc as gJ,rwe as gK,s2 as gL,ea as gM,$s as gN,fs as gO,Kf as gP,v3 as gQ,zge as gR,Xde as gS,Au as gT,Vge as gU,$Ie as gV,tSe as gW,Kt as gX,bIe as gY,v0 as gZ,YAe as g_,Bs as ga,NZ as gb,lEe as gc,uEe as gd,fd as ge,D0 as gf,BT as gg,Yo as gh,tT as gi,I$ as gj,uTe as gk,OW as gl,p5e as gm,r5e as gn,c5e as go,$Ee as gp,i5e as gq,Gr as gr,AK as gs,fue as gt,cAe as gu,bW as gv,gve as gw,fse as gx,ose as gy,qTe as gz,Va as h,N3e as h$,$Ce as h0,_u as h1,QSe as h2,rs as h3,SSe as h4,mo as h5,b1 as h6,Tve as h7,f3e as h8,Ewe as h9,Lf as hA,fY as hB,ohe as hC,fEe as hD,zwe as hE,Hwe as hF,Ra as hG,Sd as hH,Pc as hI,g4 as hJ,m5e as hK,C5e as hL,_Z as hM,hf as hN,bA as hO,AZ as hP,ff as hQ,__ as hR,_Se as hS,yx as hT,J1 as hU,kSe as hV,xCe as hW,fde as hX,bAe as hY,Nk as hZ,R3e as h_,RSe as ha,vhe as hb,t4 as hc,ghe as hd,Une as he,Lwe as hf,Wwe as hg,Gwe as hh,Nwe as hi,kY as hj,Mne as hk,jwe as hl,Bwe as hm,$we as hn,TAe as ho,Xne as hp,ld as hq,hEe as hr,Rue as hs,vEe as ht,xI as hu,Qz as hv,Xz as hw,Of as hx,ZAe as hy,B1 as hz,Mo as i,Vx as i$,fA as i0,Hk as i1,x0 as i2,swe as i3,z5e as i4,vae as i5,Cb as i6,Mme as i7,p0 as i8,m0 as i9,W3e as iA,Ds as iB,JTe as iC,qg as iD,QTe as iE,YTe as iF,Yu as iG,w3e as iH,x3e as iI,A3e as iJ,qve as iK,T3e as iL,XK as iM,iue as iN,cA as iO,f4 as iP,x1 as iQ,qAe as iR,nk as iS,M4 as iT,M_e as iU,SEe as iV,h_e as iW,gAe as iX,hse as iY,yT as iZ,cse as i_,Nme as ia,Qge as ib,bp as ic,Lme as id,Dme as ie,Ome as ig,KK as ih,Mre as ii,T4 as ij,nh as ik,o4 as il,sG as im,cxe as io,Dxe as ip,s2e as iq,zAe as ir,xIe as is,_Ie as it,dEe as iu,cEe as iv,mEe as iw,yle as ix,N3 as iy,hde as iz,fAe as j,YCe as j$,pse as j0,Sce as j1,eG as j2,uSe as j3,Wr as j4,Cs as j5,fc as j6,aT as j7,j4 as j8,Lc as j9,OAe as jA,UAe as jB,PAe as jC,S4 as jD,m4 as jE,p4 as jF,Ls as jG,jEe as jH,oT as jI,PY as jJ,Sse as jK,RW as jL,u3 as jM,nA as jN,WIe as jO,nSe as jP,Sxe as jQ,T0 as jR,Exe as jS,Ixe as jT,gxe as jU,Cxe as jV,Txe as jW,sde as jX,q5 as jY,nde as jZ,P1 as j_,kg as ja,mA as jb,lxe as jc,hn as jd,yA as je,LS as jf,tue as jg,Kne as jh,Ad as ji,_Te as jj,X_e as jk,Swe as jl,Cwe as jm,_Ee as jn,Iwe as jo,Ahe as jp,I3 as jq,c3e as jr,Xk as js,oue as jt,Lxe as ju,z_e as jv,Tk as jw,wk as jx,Zc as jy,Bf as jz,vse as k,Z3 as k$,wp as k0,EV as k1,fee as k2,dAe as k3,mAe as k4,Eo as k5,Zae as k6,qae as k7,Y2 as k8,JCe as k9,_o as kA,I3e as kB,U3e as kC,O3e as kD,Gh as kE,HTe as kF,jd as kG,Nn as kH,j0 as kI,Mxe as kJ,Su as kK,TTe as kL,vx as kM,E1e as kN,a2 as kO,C_e as kP,yae as kQ,IAe as kR,Z_e as kS,PTe as kT,qEe as kU,Zi as kV,d3 as kW,oM as kX,eu as kY,Tee as kZ,ewe as k_,rxe as ka,axe as kb,k1 as kc,MEe as kd,MY as ke,xY as kf,BN as kg,RTe as kh,mwe as ki,VC as kj,JIe as kk,qT as kl,Uk as km,l3e as kn,$1e as ko,oke as kp,J_ as kq,ZIe as kr,R_e as ks,F3e as kt,L3e as ku,V3e as kv,B3e as kw,j3e as kx,Wd as ky,D3e as kz,Boe as l,XIe as l$,Iee as l0,Ipe as l1,Vq as l2,T_e as l3,bk as l4,d0e as l5,Oxe as l6,Xn as l7,OIe as l8,SA as l9,md as lA,WEe as lB,pae as lC,GAe as lD,KAe as lE,G5e as lF,F5e as lG,QAe as lH,XAe as lI,_K as lJ,m_ as lK,WAe as lL,BTe as lM,Lr as lN,bd as lO,Da as lP,ga as lQ,Jc as lR,xh as lS,dd as lT,Xie as lU,wL as lV,X3 as lW,QIe as lX,X5 as lY,HIe as lZ,xAe as l_,Qs as la,f3 as lb,mi as lc,Um as ld,B5e as le,YIe as lf,vT as lg,MW as lh,xW as li,_W as lj,BG as lk,n5e as ll,RI as lm,hd as ln,wT as lo,IT as lp,s5e as lq,gG as lr,pxe as ls,IIe as lt,h5e as lu,g5e as lv,f5e as lw,AT as lx,o5e as ly,hle as lz,Lx as m,LAe as m$,eEe as m0,sEe as m1,oEe as m2,NAe as m3,OS as m4,qxe as m5,Wxe as m6,$xe as m7,Ode as m8,Rde as m9,f_e as mA,c_e as mB,l_e as mC,s_e as mD,i_e as mE,a_e as mF,pwe as mG,r_e as mH,sAe as mI,n_e as mJ,d_e as mK,o_e as mL,aAe as mM,wme as mN,Tme as mO,Rme as mP,Pme as mQ,REe as mR,P_e as mS,iwe as mT,gte as mU,cwe as mV,Y5e as mW,K5e as mX,Vse as mY,Bse as mZ,Jae as m_,jde as ma,Es as mb,v_e as mc,g_e as md,Gxe as me,L_e as mf,N_e as mg,uAe as mh,lAe as mi,yAe as mj,Goe as mk,_1 as ml,mse as mm,hAe as mn,iAe as mo,O5e as mp,Jk as mq,k3e as mr,AS as ms,_3e as mt,mxe as mu,Vxe as mv,a_ as mw,u_e as mx,m_e as my,p_e as mz,B as n,HW as n$,t_ as n0,Wse as n1,DAe as n2,KTe as n3,T5e as n4,ht as n5,iee as n6,E5e as n7,jg as n8,XTe as n9,bre as nA,HAe as nB,k0e as nC,qre as nD,$re as nE,S5e as nF,b5e as nG,I5e as nH,L5e as nI,Zre as nJ,NEe as nK,LEe as nL,mS as nM,no as nN,oG as nO,A5e as nP,e3 as nQ,Rxe as nR,Oq as nS,Uq as nT,Fq as nU,Ny as nV,jq as nW,Ir as nX,NIe as nY,MIe as nZ,zIe as n_,Use as na,Jf as nb,zhe as nc,vTe as nd,hTe as ne,CTe as nf,STe as ng,gTe as nh,fTe as ni,mTe as nj,dTe as nk,pTe as nl,Jq as nm,Zq as nn,Xq as no,Qq as np,sN as nq,r1 as nr,qq as ns,br as nt,KIe as nu,oK as nv,Rw as nw,yTe as nx,sE as ny,WT as nz,Te as o,Kx as o$,RIe as o0,Q5e as o1,E3 as o2,BEe as o3,HEe as o4,yG as o5,e3e as o6,t3e as o7,J5e as o8,N5e as o9,u5e as oA,d5e as oB,RG as oC,Io as oD,pa as oE,ku as oF,Wy as oG,QEe as oH,JEe as oI,Tie as oJ,bs as oK,Lg as oL,Dc as oM,vG as oN,J1e as oO,qx as oP,Ece as oQ,nwe as oR,i1 as oS,JAe as oT,I0e as oU,$ee as oV,hw as oW,H5e as oX,kCe as oY,K3e as oZ,_Ce as o_,AIe as oa,hc as ob,U5e as oc,hxe as od,X5e as oe,ZEe as of,LM as og,FIe as oh,oTe as oi,sTe as oj,eTe as ok,mw as ol,tTe as om,yd as on,xTe as oo,Vw as op,YEe as oq,p3e as or,KEe as os,SAe as ot,Xce as ou,xwe as ov,Awe as ow,LTe as ox,CIe as oy,a5e as oz,Wo as p,th as p$,CT as p0,w_e as p1,d1 as p2,_we as p3,Ade as p4,lwe as p5,S8 as p6,Or as p7,awe as p8,Twe as p9,k5e as pA,P5e as pB,LW as pC,DW as pD,NW as pE,D5e as pF,ITe as pG,q5e as pH,$5e as pI,vAe as pJ,wwe as pK,AW as pL,Bg as pM,Pg as pN,mve as pO,zEe as pP,mG as pQ,Sr as pR,bme as pS,FT as pT,B3 as pU,zz as pV,a0 as pW,mI as pX,B2 as pY,dx as pZ,_d as p_,_z as pa,$Ae as pb,Ft as pc,WTe as pd,MTe as pe,dT as pf,age as pg,D4 as ph,gY as pi,EAe as pj,OTe as pk,DTe as pl,UTe as pm,gde as pn,gee as po,R0 as pp,nTe as pq,wW as pr,x5e as ps,jIe as pt,EW as pu,Ml as pv,BIe as pw,PW as px,Tr as py,_5e as pz,Pd as q,hIe as q$,dge as q0,VW as q1,qIe as q2,Sve as q3,Fg as q4,R5e as q5,ZTe as q6,w5e as q7,M5e as q8,pG as q9,$5 as qA,rEe as qB,S0e as qC,O2 as qD,cc as qE,kn as qF,pb as qG,e8 as qH,lc as qI,gIe as qJ,or as qK,Ko as qL,x7 as qM,I8 as qN,b8 as qO,T8 as qP,w8 as qQ,Kb as qR,Hb as qS,Vi as qT,_b as qU,Zl as qV,U7 as qW,uc as qX,Ve as qY,Ii as qZ,Gs as q_,v5e as qa,Ez as qb,Wk as qc,Ui as qd,ud as qe,n3 as qf,Tle as qg,o3 as qh,s3 as qi,a3 as qj,r3 as qk,i3 as ql,_xe as qm,Kk as qn,noe as qo,u3e as qp,yue as qq,SIe as qr,TIe as qs,iEe as qt,Qy as qu,cTe as qv,SG as qw,aTe as qx,iG as qy,ia as qz,kTe as r,lI as r$,fIe as r0,K8 as r1,yIe as r2,Jl as r3,X8 as r4,R8 as r5,k8 as r6,P8 as r7,Jb as r8,lr as r9,M8 as rA,y8 as rB,mIe as rC,o8 as rD,Mp as rE,aI as rF,fb as rG,ph as rH,b7 as rI,Kl as rJ,c8 as rK,wb as rL,kb as rM,Ob as rN,i8 as rO,Ib as rP,l8 as rQ,d8 as rR,Rb as rS,u8 as rT,Lb as rU,Mb as rV,p8 as rW,y7 as rX,nM as rY,uI as rZ,da as r_,vh as ra,Ms as rb,xP as rc,Ub as rd,fh as re,E8 as rf,_p as rg,Pp as rh,S7 as ri,Sb as rj,t8 as rk,C7 as rl,zu as rm,ji as rn,bh as ro,Bu as rp,Hu as rq,xs as rr,bb as rs,u7 as rt,k7 as ru,pIe as rv,_7 as rw,g8 as rx,v8 as ry,sa as rz,Fo as s,ese as s$,qo as s0,Qb as s1,Dp as s2,yP as s3,sI as s4,bP as s5,nI as s6,hb as s7,j7 as s8,ic as s9,oI as sA,vP as sB,jb as sC,Bb as sD,Eh as sE,v7 as sF,EI as sG,Gu as sH,VTe as sI,bTe as sJ,jme as sK,Dwe as sL,qwe as sM,OEe as sN,l5e as sO,uo as sP,mge as sQ,Pwe as sR,Ud as sS,joe as sT,Rx as sU,xo as sV,FEe as sW,Lne as sX,xfe as sY,Afe as sZ,oh as s_,T7 as sa,A7 as sb,Db as sc,Vu as sd,$v as se,pl as sf,vIe as sg,h7 as sh,_P as si,dIe as sj,R7 as sk,Yl as sl,z7 as sm,uP as sn,eM as so,Th as sp,lM as sq,Wv as sr,Xl as ss,eI as st,rM as su,yh as sv,Vb as sw,Ch as sx,mc as sy,gP as sz,yt as t,Dd as t$,eAe as t0,Jwe as t1,Zwe as t2,CAe as t3,Qwe as t4,Xwe as t5,Ywe as t6,A_e as t7,x_e as t8,Y_ as t9,nxe as tA,Ace as tB,sxe as tC,pc as tD,vde as tE,oSe as tF,XN as tG,H_ as tH,V5e as tI,WSe as tJ,ESe as tK,HSe as tL,g1 as tM,Kie as tN,YM as tO,qie as tP,bxe as tQ,vxe as tR,k_e as tS,y_e as tT,__e as tU,dY as tV,yxe as tW,gc as tX,bte as tY,qA as tZ,Cte as t_,Kwe as ta,UEe as tb,Rwe as tc,Mwe as td,exe as te,txe as tf,gEe as tg,Dne as th,Fwe as ti,Uwe as tj,SB as tk,AB as tl,dr as tm,Uue as tn,Oue as to,e_e as tp,Due as tq,Q_e as tr,t_e as ts,J_e as tt,GEe as tu,dxe as tv,Lue as tw,nue as tx,nu as ty,QCe as tz,nAe as u,Ste as u0,phe as u1,_fe as u2,kl as u3,kfe as u4,A1 as u5,ETe as u6,FTe as u7,twe as u8,hwe as u9,d3e as uA,m3e as uB,h3e as uC,g3e as uD,v3e as uE,J3e as uF,Q3e as uG,X3e as uH,tke as uI,nke as uJ,Cx as ua,wxe as ub,Axe as uc,xxe as ud,Pxe as ue,Uxe as uf,Fxe as ug,jxe as uh,Kxe as ui,Yxe as uj,Zxe as uk,Jxe as ul,Qxe as um,Xxe as un,S_e as uo,b_e as up,I_e as uq,E_e as ur,D_e as us,O_e as ut,U_e as uu,F_e as uv,j_e as uw,B_e as ux,V_e as uy,s3e as uz,_Y as v,gt as w,wh as x,Nt as y,pt as z};
